{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -19.1325448432139, "policy_loss": -45961455.88023158, "vf_loss": 30406929.035714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28.5, "diff_num_grad_updates_vs_sampler_policy": 27.5}}, "num_env_steps_sampled": 5084880, "num_env_steps_trained": 5084880, "num_agent_steps_sampled": 5084880, "num_agent_steps_trained": 5084880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -27049.628746857496, "episode_reward_mean": -27049.628746857496, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496], "episode_lengths": [3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8621723643278818, "mean_inference_ms": 0.3792195477706795, "mean_action_processing_ms": 0.09385839630186277, "mean_env_wait_ms": 2.3421346065369755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009846687316894531, "StateBufferConnector_ms": 0.0024557113647460938, "ViewRequirementAgentConnector_ms": 0.0627756118774414}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -27049.628746857496, "episode_reward_mean": -27049.628746857496, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496], "episode_lengths": [3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8621723643278818, "mean_inference_ms": 0.3792195477706795, "mean_action_processing_ms": 0.09385839630186277, "mean_env_wait_ms": 2.3421346065369755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009846687316894531, "StateBufferConnector_ms": 0.0024557113647460938, "ViewRequirementAgentConnector_ms": 0.0627756118774414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5084880, "num_agent_steps_trained": 5084880, "num_env_steps_sampled": 5084880, "num_env_steps_trained": 5084880, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 267.847995111025, "num_env_steps_trained_throughput_per_sec": 267.847995111025, "timesteps_total": 5084880, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5084880, "timers": {"training_iteration_time_ms": 13440.431, "sample_time_ms": 13314.165, "load_time_ms": 0.59, "load_throughput": 6105739.749, "learn_time_ms": 124.861, "learn_throughput": 28832.061, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 5084880, "num_env_steps_trained": 5084880, "num_agent_steps_sampled": 5084880, "num_agent_steps_trained": 5084880}, "done": false, "episodes_total": 1205, "training_iteration": 576, "trial_id": "ee88a_00000", "date": "2023-07-25_03-48-32", "timestamp": 1690246112, "time_this_iter_s": 13.442899942398071, "time_total_s": 10138.245377540588, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13.442899942398071, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.044999999999998, "ram_util_percent": 79.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.864444444444444e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -224.14062200273787, "policy_loss": -50561458205.67216, "vf_loss": 35556190.73214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84.5, "diff_num_grad_updates_vs_sampler_policy": 83.5}}, "num_env_steps_sampled": 5088480, "num_env_steps_trained": 5088480, "num_agent_steps_sampled": 5088480, "num_agent_steps_trained": 5088480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -29949.19476337792, "episode_reward_mean": -28499.411755117708, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792], "episode_lengths": [3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8713451593125767, "mean_inference_ms": 0.37771825835986406, "mean_action_processing_ms": 0.09354824142036491, "mean_env_wait_ms": 2.1247537044937035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008225440979003906, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06573200225830078}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -29949.19476337792, "episode_reward_mean": -28499.411755117708, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792], "episode_lengths": [3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8713451593125767, "mean_inference_ms": 0.37771825835986406, "mean_action_processing_ms": 0.09354824142036491, "mean_env_wait_ms": 2.1247537044937035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008225440979003906, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06573200225830078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5088480, "num_agent_steps_trained": 5088480, "num_env_steps_sampled": 5088480, "num_env_steps_trained": 5088480, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 346.66437324816707, "num_env_steps_trained_throughput_per_sec": 346.66437324816707, "timesteps_total": 5088480, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5088480, "timers": {"training_iteration_time_ms": 11912.548, "sample_time_ms": 11800.236, "load_time_ms": 1.111, "load_throughput": 3239539.67, "learn_time_ms": 110.358, "learn_throughput": 32621.106, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 5088480, "num_env_steps_trained": 5088480, "num_agent_steps_sampled": 5088480, "num_agent_steps_trained": 5088480}, "done": false, "episodes_total": 1206, "training_iteration": 577, "trial_id": "ee88a_00000", "date": "2023-07-25_03-48-42", "timestamp": 1690246122, "time_this_iter_s": 10.387172937393188, "time_total_s": 10148.632550477982, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 23.83007287979126, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.392857142857142, "ram_util_percent": 77.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.764444444444447e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -425.45201110839844, "policy_loss": -17859308101115.043, "vf_loss": 36386442.678571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 140.5, "diff_num_grad_updates_vs_sampler_policy": 139.5}}, "num_env_steps_sampled": 5092080, "num_env_steps_trained": 5092080, "num_agent_steps_sampled": 5092080, "num_agent_steps_trained": 5092080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -30406.81976933798, "episode_reward_mean": -29135.214426524468, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798], "episode_lengths": [3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.876556486707286, "mean_inference_ms": 0.376479652791539, "mean_action_processing_ms": 0.09327371892567843, "mean_env_wait_ms": 1.9996911858481863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007534027099609375, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06576379140218098}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -30406.81976933798, "episode_reward_mean": -29135.214426524468, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798], "episode_lengths": [3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.876556486707286, "mean_inference_ms": 0.376479652791539, "mean_action_processing_ms": 0.09327371892567843, "mean_env_wait_ms": 1.9996911858481863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007534027099609375, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06576379140218098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5092080, "num_agent_steps_trained": 5092080, "num_env_steps_sampled": 5092080, "num_env_steps_trained": 5092080, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 351.8708621455697, "num_env_steps_trained_throughput_per_sec": 351.8708621455697, "timesteps_total": 5092080, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5092080, "timers": {"training_iteration_time_ms": 11352.034, "sample_time_ms": 11244.982, "load_time_ms": 1.205, "load_throughput": 2988618.011, "learn_time_ms": 104.968, "learn_throughput": 34296.273, "synch_weights_time_ms": 0.82}, "counters": {"num_env_steps_sampled": 5092080, "num_env_steps_trained": 5092080, "num_agent_steps_sampled": 5092080, "num_agent_steps_trained": 5092080}, "done": false, "episodes_total": 1207, "training_iteration": 578, "trial_id": "ee88a_00000", "date": "2023-07-25_03-48-52", "timestamp": 1690246132, "time_this_iter_s": 10.233505964279175, "time_total_s": 10158.86605644226, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 34.063578844070435, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.879999999999995, "ram_util_percent": 77.84666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.664444444444446e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -597.2568446568081, "policy_loss": -2448800299325643.0, "vf_loss": 36420943.58928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 196.5, "diff_num_grad_updates_vs_sampler_policy": 195.5}}, "num_env_steps_sampled": 5095680, "num_env_steps_trained": 5095680, "num_agent_steps_sampled": 5095680, "num_agent_steps_trained": 5095680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -30412.466815611497, "episode_reward_mean": -29454.527523796223, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497], "episode_lengths": [3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8805681487708651, "mean_inference_ms": 0.37589461295846216, "mean_action_processing_ms": 0.09314651238779494, "mean_env_wait_ms": 1.9196647515618253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007265806198120117, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06614923477172852}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -30412.466815611497, "episode_reward_mean": -29454.527523796223, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497], "episode_lengths": [3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8805681487708651, "mean_inference_ms": 0.37589461295846216, "mean_action_processing_ms": 0.09314651238779494, "mean_env_wait_ms": 1.9196647515618253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007265806198120117, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06614923477172852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5095680, "num_agent_steps_trained": 5095680, "num_env_steps_sampled": 5095680, "num_env_steps_trained": 5095680, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 345.46281853653574, "num_env_steps_trained_throughput_per_sec": 345.46281853653574, "timesteps_total": 5095680, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5095680, "timers": {"training_iteration_time_ms": 11119.222, "sample_time_ms": 11013.679, "load_time_ms": 1.352, "load_throughput": 2661759.182, "learn_time_ms": 103.294, "learn_throughput": 34852.051, "synch_weights_time_ms": 0.823}, "counters": {"num_env_steps_sampled": 5095680, "num_env_steps_trained": 5095680, "num_agent_steps_sampled": 5095680, "num_agent_steps_trained": 5095680}, "done": false, "episodes_total": 1208, "training_iteration": 579, "trial_id": "ee88a_00000", "date": "2023-07-25_03-49-03", "timestamp": 1690246143, "time_this_iter_s": 10.423569202423096, "time_total_s": 10169.289625644684, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 44.48714804649353, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.24666666666667, "ram_util_percent": 78.03999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.564444444444444e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -748.0032719203404, "policy_loss": -1.8938842379437926e+17, "vf_loss": 36782229.26785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 252.5, "diff_num_grad_updates_vs_sampler_policy": 251.5}}, "num_env_steps_sampled": 5099280, "num_env_steps_trained": 5099280, "num_agent_steps_sampled": 5099280, "num_agent_steps_trained": 5099280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -30616.36750597898, "episode_reward_mean": -29686.895520232774, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898], "episode_lengths": [3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.883244914789518, "mean_inference_ms": 0.37538352322360996, "mean_action_processing_ms": 0.09303767268214061, "mean_env_wait_ms": 1.8630298094881315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007042884826660156, "StateBufferConnector_ms": 0.0025892257690429688, "ViewRequirementAgentConnector_ms": 0.06587982177734375}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -30616.36750597898, "episode_reward_mean": -29686.895520232774, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898], "episode_lengths": [3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.883244914789518, "mean_inference_ms": 0.37538352322360996, "mean_action_processing_ms": 0.09303767268214061, "mean_env_wait_ms": 1.8630298094881315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007042884826660156, "StateBufferConnector_ms": 0.0025892257690429688, "ViewRequirementAgentConnector_ms": 0.06587982177734375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5099280, "num_agent_steps_trained": 5099280, "num_env_steps_sampled": 5099280, "num_env_steps_trained": 5099280, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 348.18072706720784, "num_env_steps_trained_throughput_per_sec": 348.18072706720784, "timesteps_total": 5099280, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5099280, "timers": {"training_iteration_time_ms": 10963.265, "sample_time_ms": 10859.659, "load_time_ms": 1.41, "load_throughput": 2553609.741, "learn_time_ms": 101.31, "learn_throughput": 35534.342, "synch_weights_time_ms": 0.816}, "counters": {"num_env_steps_sampled": 5099280, "num_env_steps_trained": 5099280, "num_agent_steps_sampled": 5099280, "num_agent_steps_trained": 5099280}, "done": false, "episodes_total": 1209, "training_iteration": 580, "trial_id": "ee88a_00000", "date": "2023-07-25_03-49-13", "timestamp": 1690246153, "time_this_iter_s": 10.341917991638184, "time_total_s": 10179.631543636322, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.829066038131714, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.606666666666673, "ram_util_percent": 77.65333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.464444444444443e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -835.6385879516602, "policy_loss": -4.467968970901792e+17, "vf_loss": 36787490.803571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 308.5, "diff_num_grad_updates_vs_sampler_policy": 307.5}}, "num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -30616.36750597898, "episode_reward_mean": -29838.557046276183, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8842789882491298, "mean_inference_ms": 0.37492846482756986, "mean_action_processing_ms": 0.09295213269229306, "mean_env_wait_ms": 1.8206468845403876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006898244222005208, "StateBufferConnector_ms": 0.0026067097981770835, "ViewRequirementAgentConnector_ms": 0.06628831227620442}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -30616.36750597898, "episode_reward_mean": -29838.557046276183, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8842789882491298, "mean_inference_ms": 0.37492846482756986, "mean_action_processing_ms": 0.09295213269229306, "mean_env_wait_ms": 1.8206468845403876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006898244222005208, "StateBufferConnector_ms": 0.0026067097981770835, "ViewRequirementAgentConnector_ms": 0.06628831227620442}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880, "num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 351.57400060929115, "num_env_steps_trained_throughput_per_sec": 351.57400060929115, "timesteps_total": 5102880, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5102880, "timers": {"training_iteration_time_ms": 10842.662, "sample_time_ms": 10740.445, "load_time_ms": 1.385, "load_throughput": 2598656.639, "learn_time_ms": 99.943, "learn_throughput": 36020.631, "synch_weights_time_ms": 0.821}, "counters": {"num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880}, "done": false, "episodes_total": 1210, "training_iteration": 581, "trial_id": "ee88a_00000", "date": "2023-07-25_03-49-23", "timestamp": 1690246163, "time_this_iter_s": 10.242187023162842, "time_total_s": 10189.873730659485, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 65.07125306129456, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.52857142857143, "ram_util_percent": 76.82142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.364444444444444e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -853.9953885759626, "policy_loss": -4.73559015300759e+17, "vf_loss": 36139005.41071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 364.5, "diff_num_grad_updates_vs_sampler_policy": 363.5}}, "num_env_steps_sampled": 5106480, "num_env_steps_trained": 5106480, "num_agent_steps_sampled": 5106480, "num_agent_steps_trained": 5106480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -30616.36750597898, "episode_reward_mean": -29898.503872633522, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8846203844943173, "mean_inference_ms": 0.37452543536246957, "mean_action_processing_ms": 0.09287795512947215, "mean_env_wait_ms": 1.787590328491461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006849425179617745, "StateBufferConnector_ms": 0.0026294163295200895, "ViewRequirementAgentConnector_ms": 0.06648472377232142}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -30616.36750597898, "episode_reward_mean": -29898.503872633522, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8846203844943173, "mean_inference_ms": 0.37452543536246957, "mean_action_processing_ms": 0.09287795512947215, "mean_env_wait_ms": 1.787590328491461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006849425179617745, "StateBufferConnector_ms": 0.0026294163295200895, "ViewRequirementAgentConnector_ms": 0.06648472377232142}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5106480, "num_agent_steps_trained": 5106480, "num_env_steps_sampled": 5106480, "num_env_steps_trained": 5106480, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 350.9874397612164, "num_env_steps_trained_throughput_per_sec": 350.9874397612164, "timesteps_total": 5106480, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5106480, "timers": {"training_iteration_time_ms": 10758.961, "sample_time_ms": 10657.871, "load_time_ms": 1.366, "load_throughput": 2634639.334, "learn_time_ms": 98.845, "learn_throughput": 36420.494, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 5106480, "num_env_steps_trained": 5106480, "num_agent_steps_sampled": 5106480, "num_agent_steps_trained": 5106480}, "done": false, "episodes_total": 1211, "training_iteration": 582, "trial_id": "ee88a_00000", "date": "2023-07-25_03-49-34", "timestamp": 1690246174, "time_this_iter_s": 10.25952696800232, "time_total_s": 10200.133257627487, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 75.33078002929688, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.459999999999997, "ram_util_percent": 76.72666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.264444444444447e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -863.9247600010464, "policy_loss": -4.179607356730774e+17, "vf_loss": 36887343.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 419.5}}, "num_env_steps_sampled": 5110080, "num_env_steps_trained": 5110080, "num_agent_steps_sampled": 5110080, "num_agent_steps_trained": 5110080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -30655.73632736621, "episode_reward_mean": -29993.157929475106, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8846702585000599, "mean_inference_ms": 0.3741673350349266, "mean_action_processing_ms": 0.09281250212141944, "mean_env_wait_ms": 1.7610605797298253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006815791130065918, "StateBufferConnector_ms": 0.0026106834411621094, "ViewRequirementAgentConnector_ms": 0.06630122661590576}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -30655.73632736621, "episode_reward_mean": -29993.157929475106, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8846702585000599, "mean_inference_ms": 0.3741673350349266, "mean_action_processing_ms": 0.09281250212141944, "mean_env_wait_ms": 1.7610605797298253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006815791130065918, "StateBufferConnector_ms": 0.0026106834411621094, "ViewRequirementAgentConnector_ms": 0.06630122661590576}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5110080, "num_agent_steps_trained": 5110080, "num_env_steps_sampled": 5110080, "num_env_steps_trained": 5110080, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 349.86111902122354, "num_env_steps_trained_throughput_per_sec": 349.86111902122354, "timesteps_total": 5110080, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5110080, "timers": {"training_iteration_time_ms": 10700.312, "sample_time_ms": 10599.867, "load_time_ms": 1.358, "load_throughput": 2650254.617, "learn_time_ms": 98.219, "learn_throughput": 36652.961, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 5110080, "num_env_steps_trained": 5110080, "num_agent_steps_sampled": 5110080, "num_agent_steps_trained": 5110080}, "done": false, "episodes_total": 1212, "training_iteration": 583, "trial_id": "ee88a_00000", "date": "2023-07-25_03-49-44", "timestamp": 1690246184, "time_this_iter_s": 10.292262315750122, "time_total_s": 10210.425519943237, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 85.623042345047, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.50714285714286, "ram_util_percent": 76.72857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.164444444444446e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -869.7326496669224, "policy_loss": -3.8600909731119526e+17, "vf_loss": 36637655.76785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 476.5, "diff_num_grad_updates_vs_sampler_policy": 475.5}}, "num_env_steps_sampled": 5113680, "num_env_steps_trained": 5113680, "num_agent_steps_sampled": 5113680, "num_agent_steps_trained": 5113680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -30655.73632736621, "episode_reward_mean": -30053.920091484557, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.884113194574026, "mean_inference_ms": 0.37388062543585826, "mean_action_processing_ms": 0.09276591383146009, "mean_env_wait_ms": 1.7389974030573245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006739298502604167, "StateBufferConnector_ms": 0.002643797132703993, "ViewRequirementAgentConnector_ms": 0.06648964352077907}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -30655.73632736621, "episode_reward_mean": -30053.920091484557, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.884113194574026, "mean_inference_ms": 0.37388062543585826, "mean_action_processing_ms": 0.09276591383146009, "mean_env_wait_ms": 1.7389974030573245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006739298502604167, "StateBufferConnector_ms": 0.002643797132703993, "ViewRequirementAgentConnector_ms": 0.06648964352077907}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5113680, "num_agent_steps_trained": 5113680, "num_env_steps_sampled": 5113680, "num_env_steps_trained": 5113680, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 356.30091483441043, "num_env_steps_trained_throughput_per_sec": 356.30091483441043, "timesteps_total": 5113680, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5113680, "timers": {"training_iteration_time_ms": 10634.033, "sample_time_ms": 10534.121, "load_time_ms": 1.353, "load_throughput": 2661224.902, "learn_time_ms": 97.686, "learn_throughput": 36852.634, "synch_weights_time_ms": 0.809}, "counters": {"num_env_steps_sampled": 5113680, "num_env_steps_trained": 5113680, "num_agent_steps_sampled": 5113680, "num_agent_steps_trained": 5113680}, "done": false, "episodes_total": 1213, "training_iteration": 584, "trial_id": "ee88a_00000", "date": "2023-07-25_03-49-54", "timestamp": 1690246194, "time_this_iter_s": 10.10632872581482, "time_total_s": 10220.531848669052, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 95.72937107086182, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.83333333333333, "ram_util_percent": 76.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.064444444444444e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -875.4798801967075, "policy_loss": -4.730426421321697e+17, "vf_loss": 36700453.41071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 532.5, "diff_num_grad_updates_vs_sampler_policy": 531.5}}, "num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -30655.73632736621, "episode_reward_mean": -30106.136142863903, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8841753098000987, "mean_inference_ms": 0.3736194688002613, "mean_action_processing_ms": 0.09272388110647471, "mean_env_wait_ms": 1.7207483682058324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006682872772216797, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06637096405029297}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -30655.73632736621, "episode_reward_mean": -30106.136142863903, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8841753098000987, "mean_inference_ms": 0.3736194688002613, "mean_action_processing_ms": 0.09272388110647471, "mean_env_wait_ms": 1.7207483682058324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006682872772216797, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06637096405029297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280, "num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 340.1532529573092, "num_env_steps_trained_throughput_per_sec": 340.1532529573092, "timesteps_total": 5117280, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5117280, "timers": {"training_iteration_time_ms": 10628.974, "sample_time_ms": 10529.456, "load_time_ms": 1.394, "load_throughput": 2583229.727, "learn_time_ms": 97.256, "learn_throughput": 37015.659, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280}, "done": false, "episodes_total": 1214, "training_iteration": 585, "trial_id": "ee88a_00000", "date": "2023-07-25_03-50-05", "timestamp": 1690246205, "time_this_iter_s": 10.58603811264038, "time_total_s": 10231.117886781693, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 106.3154091835022, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.32, "ram_util_percent": 76.88666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.964444444444443e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -880.095346723284, "policy_loss": -3.580977155647159e+17, "vf_loss": 37734822.85714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 588.5, "diff_num_grad_updates_vs_sampler_policy": 587.5}}, "num_env_steps_sampled": 5120880, "num_env_steps_trained": 5120880, "num_agent_steps_sampled": 5120880, "num_agent_steps_trained": 5120880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -31106.9746160766, "episode_reward_mean": -30197.121458610516, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8839207490989384, "mean_inference_ms": 0.37340545361873795, "mean_action_processing_ms": 0.09268836613468992, "mean_env_wait_ms": 1.7049819814086555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006363608620383523, "StateBufferConnector_ms": 0.0026204369284889913, "ViewRequirementAgentConnector_ms": 0.06631287661465732}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -31106.9746160766, "episode_reward_mean": -30197.121458610516, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8839207490989384, "mean_inference_ms": 0.37340545361873795, "mean_action_processing_ms": 0.09268836613468992, "mean_env_wait_ms": 1.7049819814086555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006363608620383523, "StateBufferConnector_ms": 0.0026204369284889913, "ViewRequirementAgentConnector_ms": 0.06631287661465732}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120880, "num_agent_steps_trained": 5120880, "num_env_steps_sampled": 5120880, "num_env_steps_trained": 5120880, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 355.4660012810859, "num_env_steps_trained_throughput_per_sec": 355.4660012810859, "timesteps_total": 5120880, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5120880, "timers": {"training_iteration_time_ms": 10297.684, "sample_time_ms": 10201.195, "load_time_ms": 1.508, "load_throughput": 2386554.932, "learn_time_ms": 94.102, "learn_throughput": 38256.175, "synch_weights_time_ms": 0.817}, "counters": {"num_env_steps_sampled": 5120880, "num_env_steps_trained": 5120880, "num_agent_steps_sampled": 5120880, "num_agent_steps_trained": 5120880}, "done": false, "episodes_total": 1215, "training_iteration": 586, "trial_id": "ee88a_00000", "date": "2023-07-25_03-50-15", "timestamp": 1690246215, "time_this_iter_s": 10.130086183547974, "time_total_s": 10241.24797296524, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.44549536705017, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 22.528571428571432, "ram_util_percent": 77.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.864444444444446e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -878.933474949428, "policy_loss": -3.518539859573446e+17, "vf_loss": 37703829.35714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 644.5, "diff_num_grad_updates_vs_sampler_policy": 643.5}}, "num_env_steps_sampled": 5124480, "num_env_steps_trained": 5124480, "num_agent_steps_sampled": 5124480, "num_agent_steps_trained": 5124480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -31122.35064254826, "episode_reward_mean": -30274.223890605324, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8834822496966859, "mean_inference_ms": 0.373218212975654, "mean_action_processing_ms": 0.0926579867055574, "mean_env_wait_ms": 1.69101117255666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006101528803507487, "StateBufferConnector_ms": 0.0026206175486246743, "ViewRequirementAgentConnector_ms": 0.06627440452575684}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -31122.35064254826, "episode_reward_mean": -30274.223890605324, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8834822496966859, "mean_inference_ms": 0.373218212975654, "mean_action_processing_ms": 0.0926579867055574, "mean_env_wait_ms": 1.69101117255666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006101528803507487, "StateBufferConnector_ms": 0.0026206175486246743, "ViewRequirementAgentConnector_ms": 0.06627440452575684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5124480, "num_agent_steps_trained": 5124480, "num_env_steps_sampled": 5124480, "num_env_steps_trained": 5124480, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 358.43935501544667, "num_env_steps_trained_throughput_per_sec": 358.43935501544667, "timesteps_total": 5124480, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5124480, "timers": {"training_iteration_time_ms": 10263.568, "sample_time_ms": 10165.838, "load_time_ms": 1.7, "load_throughput": 2117949.083, "learn_time_ms": 95.077, "learn_throughput": 37863.871, "synch_weights_time_ms": 0.876}, "counters": {"num_env_steps_sampled": 5124480, "num_env_steps_trained": 5124480, "num_agent_steps_sampled": 5124480, "num_agent_steps_trained": 5124480}, "done": false, "episodes_total": 1216, "training_iteration": 587, "trial_id": "ee88a_00000", "date": "2023-07-25_03-50-25", "timestamp": 1690246225, "time_this_iter_s": 10.046175003051758, "time_total_s": 10251.294147968292, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 126.49167037010193, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 26.979999999999997, "ram_util_percent": 77.21333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.764444444444445e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -881.3673520769391, "policy_loss": -3.9546096214103386e+17, "vf_loss": 39041680.053571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 700.5, "diff_num_grad_updates_vs_sampler_policy": 699.5}}, "num_env_steps_sampled": 5128080, "num_env_steps_trained": 5128080, "num_agent_steps_sampled": 5128080, "num_agent_steps_trained": 5128080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -31787.520135608433, "episode_reward_mean": -30390.6312940671, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8830275432755139, "mean_inference_ms": 0.37304734390067357, "mean_action_processing_ms": 0.09263127475383684, "mean_env_wait_ms": 1.6786501328143308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058871049147385815, "StateBufferConnector_ms": 0.0026317743154672477, "ViewRequirementAgentConnector_ms": 0.06639040433443509}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -31787.520135608433, "episode_reward_mean": -30390.6312940671, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8830275432755139, "mean_inference_ms": 0.37304734390067357, "mean_action_processing_ms": 0.09263127475383684, "mean_env_wait_ms": 1.6786501328143308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058871049147385815, "StateBufferConnector_ms": 0.0026317743154672477, "ViewRequirementAgentConnector_ms": 0.06639040433443509}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5128080, "num_agent_steps_trained": 5128080, "num_env_steps_sampled": 5128080, "num_env_steps_trained": 5128080, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 354.8276827404368, "num_env_steps_trained_throughput_per_sec": 354.8276827404368, "timesteps_total": 5128080, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5128080, "timers": {"training_iteration_time_ms": 10255.042, "sample_time_ms": 10157.503, "load_time_ms": 1.771, "load_throughput": 2033273.33, "learn_time_ms": 94.828, "learn_throughput": 37963.658, "synch_weights_time_ms": 0.864}, "counters": {"num_env_steps_sampled": 5128080, "num_env_steps_trained": 5128080, "num_agent_steps_sampled": 5128080, "num_agent_steps_trained": 5128080}, "done": false, "episodes_total": 1217, "training_iteration": 588, "trial_id": "ee88a_00000", "date": "2023-07-25_03-50-35", "timestamp": 1690246235, "time_this_iter_s": 10.148280143737793, "time_total_s": 10261.44242811203, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 136.63995051383972, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.321428571428577, "ram_util_percent": 76.82142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.664444444444446e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -884.2784718104771, "policy_loss": -3.8158775445259514e+17, "vf_loss": 38797466.03571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 756.5, "diff_num_grad_updates_vs_sampler_policy": 755.5}}, "num_env_steps_sampled": 5131680, "num_env_steps_trained": 5131680, "num_agent_steps_sampled": 5131680, "num_agent_steps_trained": 5131680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -31787.520135608433, "episode_reward_mean": -30482.674041915125, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8825238619504862, "mean_inference_ms": 0.37292800297118317, "mean_action_processing_ms": 0.09261343381389837, "mean_env_wait_ms": 1.667454579112635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005698204040527344, "StateBufferConnector_ms": 0.0026106834411621094, "ViewRequirementAgentConnector_ms": 0.06630931581769671}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -31787.520135608433, "episode_reward_mean": -30482.674041915125, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8825238619504862, "mean_inference_ms": 0.37292800297118317, "mean_action_processing_ms": 0.09261343381389837, "mean_env_wait_ms": 1.667454579112635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005698204040527344, "StateBufferConnector_ms": 0.0026106834411621094, "ViewRequirementAgentConnector_ms": 0.06630931581769671}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5131680, "num_agent_steps_trained": 5131680, "num_env_steps_sampled": 5131680, "num_env_steps_trained": 5131680, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 359.21726458836105, "num_env_steps_trained_throughput_per_sec": 359.21726458836105, "timesteps_total": 5131680, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5131680, "timers": {"training_iteration_time_ms": 10215.14, "sample_time_ms": 10118.379, "load_time_ms": 1.753, "load_throughput": 2053347.258, "learn_time_ms": 94.071, "learn_throughput": 38268.877, "synch_weights_time_ms": 0.865}, "counters": {"num_env_steps_sampled": 5131680, "num_env_steps_trained": 5131680, "num_agent_steps_sampled": 5131680, "num_agent_steps_trained": 5131680}, "done": false, "episodes_total": 1218, "training_iteration": 589, "trial_id": "ee88a_00000", "date": "2023-07-25_03-50-45", "timestamp": 1690246245, "time_this_iter_s": 10.0243079662323, "time_total_s": 10271.466736078262, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 146.66425848007202, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.3, "ram_util_percent": 77.57142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.564444444444443e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -886.9838747297015, "policy_loss": -4.1063056095007994e+17, "vf_loss": 39186186.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 812.5, "diff_num_grad_updates_vs_sampler_policy": 811.5}}, "num_env_steps_sampled": 5135280, "num_env_steps_trained": 5135280, "num_agent_steps_sampled": 5135280, "num_agent_steps_trained": 5135280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -31884.086894193308, "episode_reward_mean": -30576.101565400335, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8819116961314956, "mean_inference_ms": 0.37285633374249544, "mean_action_processing_ms": 0.092611592483189, "mean_env_wait_ms": 1.6574371656189804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005520184834798177, "StateBufferConnector_ms": 0.0026257832845052085, "ViewRequirementAgentConnector_ms": 0.06635983784993489}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -31884.086894193308, "episode_reward_mean": -30576.101565400335, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8819116961314956, "mean_inference_ms": 0.37285633374249544, "mean_action_processing_ms": 0.092611592483189, "mean_env_wait_ms": 1.6574371656189804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005520184834798177, "StateBufferConnector_ms": 0.0026257832845052085, "ViewRequirementAgentConnector_ms": 0.06635983784993489}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5135280, "num_agent_steps_trained": 5135280, "num_env_steps_sampled": 5135280, "num_env_steps_trained": 5135280, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 356.045549324052, "num_env_steps_trained_throughput_per_sec": 356.045549324052, "timesteps_total": 5135280, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5135280, "timers": {"training_iteration_time_ms": 10192.301, "sample_time_ms": 10095.537, "load_time_ms": 1.736, "load_throughput": 2073935.445, "learn_time_ms": 94.092, "learn_throughput": 38260.586, "synch_weights_time_ms": 0.865}, "counters": {"num_env_steps_sampled": 5135280, "num_env_steps_trained": 5135280, "num_agent_steps_sampled": 5135280, "num_agent_steps_trained": 5135280}, "done": false, "episodes_total": 1219, "training_iteration": 590, "trial_id": "ee88a_00000", "date": "2023-07-25_03-50-55", "timestamp": 1690246255, "time_this_iter_s": 10.113561153411865, "time_total_s": 10281.580297231674, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 156.7778196334839, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.020000000000003, "ram_util_percent": 76.92666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.40962962962963e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -891.3294808523996, "policy_loss": -3.983753258227895e+17, "vf_loss": 39672208.85714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 924.5, "diff_num_grad_updates_vs_sampler_policy": 923.5}}, "num_env_steps_sampled": 5142480, "num_env_steps_trained": 5142480, "num_agent_steps_sampled": 5142480, "num_agent_steps_trained": 5142480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -30750.83751376622, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8805414445431712, "mean_inference_ms": 0.3726753274221096, "mean_action_processing_ms": 0.09259671002797012, "mean_env_wait_ms": 1.6394321981684394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005252221051384421, "StateBufferConnector_ms": 0.002626811756807215, "ViewRequirementAgentConnector_ms": 0.06653280819163603}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -30750.83751376622, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8805414445431712, "mean_inference_ms": 0.3726753274221096, "mean_action_processing_ms": 0.09259671002797012, "mean_env_wait_ms": 1.6394321981684394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005252221051384421, "StateBufferConnector_ms": 0.002626811756807215, "ViewRequirementAgentConnector_ms": 0.06653280819163603}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5142480, "num_agent_steps_trained": 5142480, "num_env_steps_sampled": 5142480, "num_env_steps_trained": 5142480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 362.1566618897963, "num_env_steps_trained_throughput_per_sec": 362.1566618897963, "timesteps_total": 5142480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5142480, "timers": {"training_iteration_time_ms": 10130.748, "sample_time_ms": 10033.802, "load_time_ms": 1.809, "load_throughput": 1990127.372, "learn_time_ms": 94.189, "learn_throughput": 38220.927, "synch_weights_time_ms": 0.874}, "counters": {"num_env_steps_sampled": 5142480, "num_env_steps_trained": 5142480, "num_agent_steps_sampled": 5142480, "num_agent_steps_trained": 5142480}, "done": false, "episodes_total": 1221, "training_iteration": 591, "trial_id": "ee88a_00000", "date": "2023-07-25_03-51-15", "timestamp": 1690246275, "time_this_iter_s": 19.883411169052124, "time_total_s": 10301.463708400726, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 176.661230802536, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 22.550000000000004, "ram_util_percent": 76.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.342962962962965e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -893.0460183279855, "policy_loss": -3.338599541060321e+17, "vf_loss": 39152456.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 980.5, "diff_num_grad_updates_vs_sampler_policy": 979.5}}, "num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -30812.368326165786, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8799850576181155, "mean_inference_ms": 0.37258707947486214, "mean_action_processing_ms": 0.09258847701608858, "mean_env_wait_ms": 1.6317253620064835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005127323998345269, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06648964352077907}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -30812.368326165786, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8799850576181155, "mean_inference_ms": 0.37258707947486214, "mean_action_processing_ms": 0.09258847701608858, "mean_env_wait_ms": 1.6317253620064835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005127323998345269, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06648964352077907}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080, "num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 354.8313849422236, "num_env_steps_trained_throughput_per_sec": 354.8313849422236, "timesteps_total": 5146080, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5146080, "timers": {"training_iteration_time_ms": 10116.335, "sample_time_ms": 10019.592, "load_time_ms": 1.821, "load_throughput": 1977020.543, "learn_time_ms": 93.971, "learn_throughput": 38309.763, "synch_weights_time_ms": 0.877}, "counters": {"num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080}, "done": false, "episodes_total": 1222, "training_iteration": 592, "trial_id": "ee88a_00000", "date": "2023-07-25_03-51-25", "timestamp": 1690246285, "time_this_iter_s": 10.148153066635132, "time_total_s": 10311.611861467361, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 186.80938386917114, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 21.526666666666667, "ram_util_percent": 76.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.276296296296297e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -894.605207170759, "policy_loss": -3.575114864479396e+17, "vf_loss": 39246607.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1036.5, "diff_num_grad_updates_vs_sampler_policy": 1035.5}}, "num_env_steps_sampled": 5149680, "num_env_steps_trained": 5149680, "num_agent_steps_sampled": 5149680, "num_agent_steps_trained": 5149680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -30869.9910981604, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8794143489257596, "mean_inference_ms": 0.37249626735208136, "mean_action_processing_ms": 0.09257766450667981, "mean_env_wait_ms": 1.6246556000707768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005031886853669819, "StateBufferConnector_ms": 0.0026527204011615956, "ViewRequirementAgentConnector_ms": 0.06660536715858861}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -30869.9910981604, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8794143489257596, "mean_inference_ms": 0.37249626735208136, "mean_action_processing_ms": 0.09257766450667981, "mean_env_wait_ms": 1.6246556000707768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005031886853669819, "StateBufferConnector_ms": 0.0026527204011615956, "ViewRequirementAgentConnector_ms": 0.06660536715858861}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5149680, "num_agent_steps_trained": 5149680, "num_env_steps_sampled": 5149680, "num_env_steps_trained": 5149680, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 358.90598939076403, "num_env_steps_trained_throughput_per_sec": 358.90598939076403, "timesteps_total": 5149680, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5149680, "timers": {"training_iteration_time_ms": 10109.002, "sample_time_ms": 10012.331, "load_time_ms": 1.828, "load_throughput": 1968925.713, "learn_time_ms": 93.892, "learn_throughput": 38341.875, "synch_weights_time_ms": 0.875}, "counters": {"num_env_steps_sampled": 5149680, "num_env_steps_trained": 5149680, "num_agent_steps_sampled": 5149680, "num_agent_steps_trained": 5149680}, "done": false, "episodes_total": 1223, "training_iteration": 593, "trial_id": "ee88a_00000", "date": "2023-07-25_03-51-36", "timestamp": 1690246296, "time_this_iter_s": 10.032970905303955, "time_total_s": 10321.644832372665, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 196.8423547744751, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 21.342857142857145, "ram_util_percent": 76.8357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.142962962962963e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -891.8179027012417, "policy_loss": -3.4388764707549523e+17, "vf_loss": 39562888.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1148.5, "diff_num_grad_updates_vs_sampler_policy": 1147.5}}, "num_env_steps_sampled": 5156880, "num_env_steps_trained": 5156880, "num_agent_steps_sampled": 5156880, "num_agent_steps_trained": 5156880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -30973.0068744726, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8782141082759874, "mean_inference_ms": 0.37231026345710433, "mean_action_processing_ms": 0.09255148363326304, "mean_env_wait_ms": 1.61177599417851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048614683605375745, "StateBufferConnector_ms": 0.0026294163295200895, "ViewRequirementAgentConnector_ms": 0.0665903091430664}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -30973.0068744726, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8782141082759874, "mean_inference_ms": 0.37231026345710433, "mean_action_processing_ms": 0.09255148363326304, "mean_env_wait_ms": 1.61177599417851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048614683605375745, "StateBufferConnector_ms": 0.0026294163295200895, "ViewRequirementAgentConnector_ms": 0.0665903091430664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5156880, "num_agent_steps_trained": 5156880, "num_env_steps_sampled": 5156880, "num_env_steps_trained": 5156880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 361.81664684515994, "num_env_steps_trained_throughput_per_sec": 361.81664684515994, "timesteps_total": 5156880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5156880, "timers": {"training_iteration_time_ms": 10027.859, "sample_time_ms": 9931.47, "load_time_ms": 1.808, "load_throughput": 1991308.426, "learn_time_ms": 93.629, "learn_throughput": 38449.468, "synch_weights_time_ms": 0.877}, "counters": {"num_env_steps_sampled": 5156880, "num_env_steps_trained": 5156880, "num_agent_steps_sampled": 5156880, "num_agent_steps_trained": 5156880}, "done": false, "episodes_total": 1225, "training_iteration": 594, "trial_id": "ee88a_00000", "date": "2023-07-25_03-51-55", "timestamp": 1690246315, "time_this_iter_s": 19.902143001556396, "time_total_s": 10341.546975374222, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 216.7444977760315, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 22.992857142857144, "ram_util_percent": 76.91785714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.076296296296297e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -887.6306403023856, "policy_loss": -3.9433576309017555e+17, "vf_loss": 38995314.41071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1204.5, "diff_num_grad_updates_vs_sampler_policy": 1203.5}}, "num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31009.859155563707, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8776565043252162, "mean_inference_ms": 0.37222756485993197, "mean_action_processing_ms": 0.09253949654845309, "mean_env_wait_ms": 1.6060886737816247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777041348544034, "StateBufferConnector_ms": 0.0026204369284889913, "ViewRequirementAgentConnector_ms": 0.06656646728515625}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31009.859155563707, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8776565043252162, "mean_inference_ms": 0.37222756485993197, "mean_action_processing_ms": 0.09253949654845309, "mean_env_wait_ms": 1.6060886737816247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777041348544034, "StateBufferConnector_ms": 0.0026204369284889913, "ViewRequirementAgentConnector_ms": 0.06656646728515625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480, "num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 359.2867723646016, "num_env_steps_trained_throughput_per_sec": 359.2867723646016, "timesteps_total": 5160480, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5160480, "timers": {"training_iteration_time_ms": 10025.492, "sample_time_ms": 9931.049, "load_time_ms": 1.607, "load_throughput": 2240813.012, "learn_time_ms": 91.964, "learn_throughput": 39145.659, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480}, "done": false, "episodes_total": 1226, "training_iteration": 595, "trial_id": "ee88a_00000", "date": "2023-07-25_03-52-05", "timestamp": 1690246325, "time_this_iter_s": 10.022395849227905, "time_total_s": 10351.56937122345, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 226.7668936252594, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.307142857142857, "ram_util_percent": 76.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.00962962962963e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -889.4014598301479, "policy_loss": -5.441738187300431e+17, "vf_loss": 39545726.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 1259.5}}, "num_env_steps_sampled": 5164080, "num_env_steps_trained": 5164080, "num_agent_steps_sampled": 5164080, "num_agent_steps_trained": 5164080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31056.943588749826, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8771751353384613, "mean_inference_ms": 0.3721507646891943, "mean_action_processing_ms": 0.09252846122581157, "mean_env_wait_ms": 1.6007453303971264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004703065623407779, "StateBufferConnector_ms": 0.002626750780188519, "ViewRequirementAgentConnector_ms": 0.06648146587869395}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31056.943588749826, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8771751353384613, "mean_inference_ms": 0.3721507646891943, "mean_action_processing_ms": 0.09252846122581157, "mean_env_wait_ms": 1.6007453303971264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004703065623407779, "StateBufferConnector_ms": 0.002626750780188519, "ViewRequirementAgentConnector_ms": 0.06648146587869395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5164080, "num_agent_steps_trained": 5164080, "num_env_steps_sampled": 5164080, "num_env_steps_trained": 5164080, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 357.67802432699443, "num_env_steps_trained_throughput_per_sec": 357.67802432699443, "timesteps_total": 5164080, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5164080, "timers": {"training_iteration_time_ms": 10017.407, "sample_time_ms": 9922.949, "load_time_ms": 1.539, "load_throughput": 2339411.006, "learn_time_ms": 92.041, "learn_throughput": 39113.038, "synch_weights_time_ms": 0.819}, "counters": {"num_env_steps_sampled": 5164080, "num_env_steps_trained": 5164080, "num_agent_steps_sampled": 5164080, "num_agent_steps_trained": 5164080}, "done": false, "episodes_total": 1227, "training_iteration": 596, "trial_id": "ee88a_00000", "date": "2023-07-25_03-52-16", "timestamp": 1690246336, "time_this_iter_s": 10.067378997802734, "time_total_s": 10361.636750221252, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 236.83427262306213, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 24.21333333333333, "ram_util_percent": 77.03333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.942962962962962e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -892.2772303989956, "policy_loss": -4.954043772899343e+17, "vf_loss": 39472750.10714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1316.5, "diff_num_grad_updates_vs_sampler_policy": 1315.5}}, "num_env_steps_sampled": 5167680, "num_env_steps_trained": 5167680, "num_agent_steps_sampled": 5167680, "num_agent_steps_trained": 5167680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31096.067767862212, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8767060688628515, "mean_inference_ms": 0.3720778205309239, "mean_action_processing_ms": 0.09251753502254956, "mean_env_wait_ms": 1.595760166944156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004638234774271647, "StateBufferConnector_ms": 0.0026116768519083657, "ViewRequirementAgentConnector_ms": 0.06644725799560547}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31096.067767862212, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8767060688628515, "mean_inference_ms": 0.3720778205309239, "mean_action_processing_ms": 0.09251753502254956, "mean_env_wait_ms": 1.595760166944156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004638234774271647, "StateBufferConnector_ms": 0.0026116768519083657, "ViewRequirementAgentConnector_ms": 0.06644725799560547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5167680, "num_agent_steps_trained": 5167680, "num_env_steps_sampled": 5167680, "num_env_steps_trained": 5167680, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 358.43956773589287, "num_env_steps_trained_throughput_per_sec": 358.43956773589287, "timesteps_total": 5167680, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5167680, "timers": {"training_iteration_time_ms": 10019.582, "sample_time_ms": 9925.217, "load_time_ms": 1.514, "load_throughput": 2378060.383, "learn_time_ms": 91.981, "learn_throughput": 39138.505, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 5167680, "num_env_steps_trained": 5167680, "num_agent_steps_sampled": 5167680, "num_agent_steps_trained": 5167680}, "done": false, "episodes_total": 1228, "training_iteration": 597, "trial_id": "ee88a_00000", "date": "2023-07-25_03-52-26", "timestamp": 1690246346, "time_this_iter_s": 10.046064853668213, "time_total_s": 10371.68281507492, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 246.88033747673035, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.449999999999996, "ram_util_percent": 76.92142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.876296296296297e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -893.9212482997349, "policy_loss": -3.205171634702208e+17, "vf_loss": 38929443.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1372.5, "diff_num_grad_updates_vs_sampler_policy": 1371.5}}, "num_env_steps_sampled": 5171280, "num_env_steps_trained": 5171280, "num_agent_steps_sampled": 5171280, "num_agent_steps_trained": 5171280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31122.533944324972, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8762500851934186, "mean_inference_ms": 0.37200829380517, "mean_action_processing_ms": 0.09250660772154255, "mean_env_wait_ms": 1.5911044506278353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00457763671875, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06645870208740234}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31122.533944324972, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8762500851934186, "mean_inference_ms": 0.37200829380517, "mean_action_processing_ms": 0.09250660772154255, "mean_env_wait_ms": 1.5911044506278353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00457763671875, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06645870208740234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5171280, "num_agent_steps_trained": 5171280, "num_env_steps_sampled": 5171280, "num_env_steps_trained": 5171280, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 357.6513288245808, "num_env_steps_trained_throughput_per_sec": 357.6513288245808, "timesteps_total": 5171280, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5171280, "timers": {"training_iteration_time_ms": 10015.042, "sample_time_ms": 9920.695, "load_time_ms": 1.504, "load_throughput": 2393515.796, "learn_time_ms": 91.975, "learn_throughput": 39141.265, "synch_weights_time_ms": 0.81}, "counters": {"num_env_steps_sampled": 5171280, "num_env_steps_trained": 5171280, "num_agent_steps_sampled": 5171280, "num_agent_steps_trained": 5171280}, "done": false, "episodes_total": 1229, "training_iteration": 598, "trial_id": "ee88a_00000", "date": "2023-07-25_03-52-36", "timestamp": 1690246356, "time_this_iter_s": 10.068213939666748, "time_total_s": 10381.751029014587, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 256.9485514163971, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 21.057142857142857, "ram_util_percent": 77.04999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.809629629629629e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -892.3578567504883, "policy_loss": -3.678425393937944e+17, "vf_loss": 39342751.803571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1428.5, "diff_num_grad_updates_vs_sampler_policy": 1427.5}}, "num_env_steps_sampled": 5174880, "num_env_steps_trained": 5174880, "num_agent_steps_sampled": 5174880, "num_agent_steps_trained": 5174880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31154.10094795435, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.875803485619393, "mean_inference_ms": 0.37194006346002934, "mean_action_processing_ms": 0.09249581266199633, "mean_env_wait_ms": 1.5867456725307194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004523534041184645, "StateBufferConnector_ms": 0.0026262723482572115, "ViewRequirementAgentConnector_ms": 0.06646376389723557}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -32107.08700705494, "episode_reward_mean": -31154.10094795435, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.875803485619393, "mean_inference_ms": 0.37194006346002934, "mean_action_processing_ms": 0.09249581266199633, "mean_env_wait_ms": 1.5867456725307194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004523534041184645, "StateBufferConnector_ms": 0.0026262723482572115, "ViewRequirementAgentConnector_ms": 0.06646376389723557}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5174880, "num_agent_steps_trained": 5174880, "num_env_steps_sampled": 5174880, "num_env_steps_trained": 5174880, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 358.1870337408065, "num_env_steps_trained_throughput_per_sec": 358.1870337408065, "timesteps_total": 5174880, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5174880, "timers": {"training_iteration_time_ms": 10020.886, "sample_time_ms": 9926.453, "load_time_ms": 1.514, "load_throughput": 2377910.581, "learn_time_ms": 92.047, "learn_throughput": 39110.566, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 5174880, "num_env_steps_trained": 5174880, "num_agent_steps_sampled": 5174880, "num_agent_steps_trained": 5174880}, "done": false, "episodes_total": 1230, "training_iteration": 599, "trial_id": "ee88a_00000", "date": "2023-07-25_03-52-46", "timestamp": 1690246366, "time_this_iter_s": 10.053173065185547, "time_total_s": 10391.804202079773, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 267.00172448158264, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 21.753333333333334, "ram_util_percent": 77.02666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.676296296296296e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -895.4436994280134, "policy_loss": -4.3334655251909184e+17, "vf_loss": 41692900.58928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1540.5, "diff_num_grad_updates_vs_sampler_policy": 1539.5}}, "num_env_steps_sampled": 5182080, "num_env_steps_trained": 5182080, "num_agent_steps_sampled": 5182080, "num_agent_steps_trained": 5182080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31289.834553569428, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.874930647521305, "mean_inference_ms": 0.37180885743903686, "mean_action_processing_ms": 0.09247349423768401, "mean_env_wait_ms": 1.578520415635224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426070622035435, "StateBufferConnector_ms": 0.0026217528751918246, "ViewRequirementAgentConnector_ms": 0.06652559552873884}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31289.834553569428, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.874930647521305, "mean_inference_ms": 0.37180885743903686, "mean_action_processing_ms": 0.09247349423768401, "mean_env_wait_ms": 1.578520415635224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426070622035435, "StateBufferConnector_ms": 0.0026217528751918246, "ViewRequirementAgentConnector_ms": 0.06652559552873884}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5182080, "num_agent_steps_trained": 5182080, "num_env_steps_sampled": 5182080, "num_env_steps_trained": 5182080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.0056991219069, "num_env_steps_trained_throughput_per_sec": 364.0056991219069, "timesteps_total": 5182080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5182080, "timers": {"training_iteration_time_ms": 9995.438, "sample_time_ms": 9901.137, "load_time_ms": 1.498, "load_throughput": 2403689.134, "learn_time_ms": 91.944, "learn_throughput": 39154.094, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 5182080, "num_env_steps_trained": 5182080, "num_agent_steps_sampled": 5182080, "num_agent_steps_trained": 5182080}, "done": false, "episodes_total": 1232, "training_iteration": 600, "trial_id": "ee88a_00000", "date": "2023-07-25_03-53-06", "timestamp": 1690246386, "time_this_iter_s": 19.782497882843018, "time_total_s": 10411.586699962616, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 286.78422236442566, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 20.932142857142857, "ram_util_percent": 76.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.542962962962963e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -899.1057030814035, "policy_loss": -3.865013970020057e+17, "vf_loss": 41216160.10714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1652.5, "diff_num_grad_updates_vs_sampler_policy": 1651.5}}, "num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31393.816322143903, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8741716901949315, "mean_inference_ms": 0.37168922182532316, "mean_action_processing_ms": 0.0924526102713453, "mean_env_wait_ms": 1.5709598744158275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043455759684244795, "StateBufferConnector_ms": 0.0026138623555501304, "ViewRequirementAgentConnector_ms": 0.06648778915405273}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31393.816322143903, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8741716901949315, "mean_inference_ms": 0.37168922182532316, "mean_action_processing_ms": 0.0924526102713453, "mean_env_wait_ms": 1.5709598744158275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043455759684244795, "StateBufferConnector_ms": 0.0026138623555501304, "ViewRequirementAgentConnector_ms": 0.06648778915405273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280, "num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.35799299106185, "num_env_steps_trained_throughput_per_sec": 364.35799299106185, "timesteps_total": 5189280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5189280, "timers": {"training_iteration_time_ms": 9980.329, "sample_time_ms": 9885.812, "load_time_ms": 1.489, "load_throughput": 2417892.104, "learn_time_ms": 92.157, "learn_throughput": 39063.9, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280}, "done": false, "episodes_total": 1234, "training_iteration": 601, "trial_id": "ee88a_00000", "date": "2023-07-25_03-53-25", "timestamp": 1690246405, "time_this_iter_s": 19.763882875442505, "time_total_s": 10431.350582838058, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 306.54810523986816, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 21.082142857142856, "ram_util_percent": 76.74642857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.274074074074073e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -902.7427673339844, "policy_loss": -4.178732517586787e+17, "vf_loss": 41253924.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1764.5, "diff_num_grad_updates_vs_sampler_policy": 1763.5}}, "num_env_steps_sampled": 5196480, "num_env_steps_trained": 5196480, "num_agent_steps_sampled": 5196480, "num_agent_steps_trained": 5196480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31497.46954346208, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8735414420186148, "mean_inference_ms": 0.37157115503496463, "mean_action_processing_ms": 0.09243190802356702, "mean_env_wait_ms": 1.5640742725818866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004275143146514893, "StateBufferConnector_ms": 0.002615898847579956, "ViewRequirementAgentConnector_ms": 0.06659850478172302}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31497.46954346208, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8735414420186148, "mean_inference_ms": 0.37157115503496463, "mean_action_processing_ms": 0.09243190802356702, "mean_env_wait_ms": 1.5640742725818866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004275143146514893, "StateBufferConnector_ms": 0.002615898847579956, "ViewRequirementAgentConnector_ms": 0.06659850478172302}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5196480, "num_agent_steps_trained": 5196480, "num_env_steps_sampled": 5196480, "num_env_steps_trained": 5196480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 360.69567339054976, "num_env_steps_trained_throughput_per_sec": 360.69567339054976, "timesteps_total": 5196480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5196480, "timers": {"training_iteration_time_ms": 9972.668, "sample_time_ms": 9878.05, "load_time_ms": 1.417, "load_throughput": 2539992.666, "learn_time_ms": 92.32, "learn_throughput": 38994.866, "synch_weights_time_ms": 0.824}, "counters": {"num_env_steps_sampled": 5196480, "num_env_steps_trained": 5196480, "num_agent_steps_sampled": 5196480, "num_agent_steps_trained": 5196480}, "done": false, "episodes_total": 1236, "training_iteration": 602, "trial_id": "ee88a_00000", "date": "2023-07-25_03-53-45", "timestamp": 1690246425, "time_this_iter_s": 19.963937759399414, "time_total_s": 10451.314520597458, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 326.5120429992676, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 22.0, "ram_util_percent": 76.76071428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.94074074074074e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -905.7722712925503, "policy_loss": -4.364541883390284e+17, "vf_loss": 41412453.35714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1876.5, "diff_num_grad_updates_vs_sampler_policy": 1875.5}}, "num_env_steps_sampled": 5203680, "num_env_steps_trained": 5203680, "num_agent_steps_sampled": 5203680, "num_agent_steps_trained": 5203680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31587.16369421337, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8730124031329393, "mean_inference_ms": 0.37146572728535027, "mean_action_processing_ms": 0.09241249951130251, "mean_env_wait_ms": 1.5577524616576226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004213697770062615, "StateBufferConnector_ms": 0.0026261105256922103, "ViewRequirementAgentConnector_ms": 0.06665552363676183}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31587.16369421337, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8730124031329393, "mean_inference_ms": 0.37146572728535027, "mean_action_processing_ms": 0.09241249951130251, "mean_env_wait_ms": 1.5577524616576226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004213697770062615, "StateBufferConnector_ms": 0.0026261105256922103, "ViewRequirementAgentConnector_ms": 0.06665552363676183}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5203680, "num_agent_steps_trained": 5203680, "num_env_steps_sampled": 5203680, "num_env_steps_trained": 5203680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 361.1674533264834, "num_env_steps_trained_throughput_per_sec": 361.1674533264834, "timesteps_total": 5203680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5203680, "timers": {"training_iteration_time_ms": 9955.358, "sample_time_ms": 9860.685, "load_time_ms": 1.419, "load_throughput": 2536962.667, "learn_time_ms": 92.384, "learn_throughput": 38967.815, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 5203680, "num_env_steps_trained": 5203680, "num_agent_steps_sampled": 5203680, "num_agent_steps_trained": 5203680}, "done": false, "episodes_total": 1238, "training_iteration": 603, "trial_id": "ee88a_00000", "date": "2023-07-25_03-54-05", "timestamp": 1690246445, "time_this_iter_s": 19.938045740127563, "time_total_s": 10471.252566337585, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 346.45008873939514, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 22.231034482758623, "ram_util_percent": 76.83103448275861}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.607407407407407e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -908.7087860107422, "policy_loss": -3.435591593765995e+17, "vf_loss": 41308516.89285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1988.5, "diff_num_grad_updates_vs_sampler_policy": 1987.5}}, "num_env_steps_sampled": 5210880, "num_env_steps_trained": 5210880, "num_agent_steps_sampled": 5210880, "num_agent_steps_trained": 5210880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31664.199637058035, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8726174879205262, "mean_inference_ms": 0.37137690865687756, "mean_action_processing_ms": 0.09239583943796063, "mean_env_wait_ms": 1.5519225487150021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004153119193183051, "StateBufferConnector_ms": 0.0026245911916097007, "ViewRequirementAgentConnector_ms": 0.06663269466824001}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33170.44250215437, "episode_reward_mean": -31664.199637058035, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8726174879205262, "mean_inference_ms": 0.37137690865687756, "mean_action_processing_ms": 0.09239583943796063, "mean_env_wait_ms": 1.5519225487150021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004153119193183051, "StateBufferConnector_ms": 0.0026245911916097007, "ViewRequirementAgentConnector_ms": 0.06663269466824001}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5210880, "num_agent_steps_trained": 5210880, "num_env_steps_sampled": 5210880, "num_env_steps_trained": 5210880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 358.74319403062697, "num_env_steps_trained_throughput_per_sec": 358.74319403062697, "timesteps_total": 5210880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5210880, "timers": {"training_iteration_time_ms": 9950.737, "sample_time_ms": 9856.365, "load_time_ms": 1.465, "load_throughput": 2457840.023, "learn_time_ms": 92.04, "learn_throughput": 39113.474, "synch_weights_time_ms": 0.809}, "counters": {"num_env_steps_sampled": 5210880, "num_env_steps_trained": 5210880, "num_agent_steps_sampled": 5210880, "num_agent_steps_trained": 5210880}, "done": false, "episodes_total": 1240, "training_iteration": 604, "trial_id": "ee88a_00000", "date": "2023-07-25_03-54-25", "timestamp": 1690246465, "time_this_iter_s": 20.07274889945984, "time_total_s": 10491.325315237045, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 366.522837638855, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.439285714285717, "ram_util_percent": 76.83928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.274074074074074e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -910.3985366821289, "policy_loss": -3.444656052510986e+17, "vf_loss": 41523057.46428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 2099.5}}, "num_env_steps_sampled": 5218080, "num_env_steps_trained": 5218080, "num_agent_steps_sampled": 5218080, "num_agent_steps_trained": 5218080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33211.914060907926, "episode_reward_mean": -31741.83490332852, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8723209528374004, "mean_inference_ms": 0.3712884770652007, "mean_action_processing_ms": 0.09237897790226875, "mean_env_wait_ms": 1.5464872611696334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004100799560546875, "StateBufferConnector_ms": 0.0026113108584755345, "ViewRequirementAgentConnector_ms": 0.06657211404097707}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33211.914060907926, "episode_reward_mean": -31741.83490332852, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8723209528374004, "mean_inference_ms": 0.3712884770652007, "mean_action_processing_ms": 0.09237897790226875, "mean_env_wait_ms": 1.5464872611696334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004100799560546875, "StateBufferConnector_ms": 0.0026113108584755345, "ViewRequirementAgentConnector_ms": 0.06657211404097707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5218080, "num_agent_steps_trained": 5218080, "num_env_steps_sampled": 5218080, "num_env_steps_trained": 5218080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 361.6818192869336, "num_env_steps_trained_throughput_per_sec": 361.6818192869336, "timesteps_total": 5218080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5218080, "timers": {"training_iteration_time_ms": 9963.447, "sample_time_ms": 9868.809, "load_time_ms": 1.478, "load_throughput": 2436424.049, "learn_time_ms": 92.289, "learn_throughput": 39007.74, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 5218080, "num_env_steps_trained": 5218080, "num_agent_steps_sampled": 5218080, "num_agent_steps_trained": 5218080}, "done": false, "episodes_total": 1242, "training_iteration": 605, "trial_id": "ee88a_00000", "date": "2023-07-25_03-54-45", "timestamp": 1690246485, "time_this_iter_s": 19.909666061401367, "time_total_s": 10511.234981298447, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 386.43250370025635, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 21.292857142857144, "ram_util_percent": 76.58928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.940740740740742e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -912.0570951189313, "policy_loss": -3.433707239024644e+17, "vf_loss": 41563267.58928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2212.5, "diff_num_grad_updates_vs_sampler_policy": 2211.5}}, "num_env_steps_sampled": 5225280, "num_env_steps_trained": 5225280, "num_agent_steps_sampled": 5225280, "num_agent_steps_trained": 5225280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31813.96372686897, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8721068032406155, "mean_inference_ms": 0.3712068059816561, "mean_action_processing_ms": 0.09236306366815909, "mean_env_wait_ms": 1.541372205798653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004050135612487793, "StateBufferConnector_ms": 0.0026208162307739258, "ViewRequirementAgentConnector_ms": 0.06657898426055908}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31813.96372686897, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8721068032406155, "mean_inference_ms": 0.3712068059816561, "mean_action_processing_ms": 0.09236306366815909, "mean_env_wait_ms": 1.541372205798653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004050135612487793, "StateBufferConnector_ms": 0.0026208162307739258, "ViewRequirementAgentConnector_ms": 0.06657898426055908}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5225280, "num_agent_steps_trained": 5225280, "num_env_steps_sampled": 5225280, "num_env_steps_trained": 5225280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 363.0524534469721, "num_env_steps_trained_throughput_per_sec": 363.0524534469721, "timesteps_total": 5225280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5225280, "timers": {"training_iteration_time_ms": 9970.552, "sample_time_ms": 9875.986, "load_time_ms": 1.475, "load_throughput": 2440519.541, "learn_time_ms": 92.248, "learn_throughput": 39025.444, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 5225280, "num_env_steps_trained": 5225280, "num_agent_steps_sampled": 5225280, "num_agent_steps_trained": 5225280}, "done": false, "episodes_total": 1244, "training_iteration": 606, "trial_id": "ee88a_00000", "date": "2023-07-25_03-55-05", "timestamp": 1690246505, "time_this_iter_s": 19.834547996520996, "time_total_s": 10531.069529294968, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 406.26705169677734, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 21.996428571428567, "ram_util_percent": 76.5892857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.774074074074074e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -912.855449131557, "policy_loss": -3.295054287208593e+17, "vf_loss": 41284125.678571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2268.5, "diff_num_grad_updates_vs_sampler_policy": 2267.5}}, "num_env_steps_sampled": 5228880, "num_env_steps_trained": 5228880, "num_agent_steps_sampled": 5228880, "num_agent_steps_trained": 5228880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31841.91821229831, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.872026577746851, "mean_inference_ms": 0.3711681570470987, "mean_action_processing_ms": 0.09235540980967563, "mean_env_wait_ms": 1.5389623453276198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004026947951898343, "StateBufferConnector_ms": 0.0026249304050352516, "ViewRequirementAgentConnector_ms": 0.06656704879388577}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31841.91821229831, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.872026577746851, "mean_inference_ms": 0.3711681570470987, "mean_action_processing_ms": 0.09235540980967563, "mean_env_wait_ms": 1.5389623453276198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004026947951898343, "StateBufferConnector_ms": 0.0026249304050352516, "ViewRequirementAgentConnector_ms": 0.06656704879388577}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5228880, "num_agent_steps_trained": 5228880, "num_env_steps_sampled": 5228880, "num_env_steps_trained": 5228880, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 359.19461113918817, "num_env_steps_trained_throughput_per_sec": 359.19461113918817, "timesteps_total": 5228880, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5228880, "timers": {"training_iteration_time_ms": 9976.042, "sample_time_ms": 9881.605, "load_time_ms": 1.473, "load_throughput": 2443679.301, "learn_time_ms": 92.121, "learn_throughput": 39078.924, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 5228880, "num_env_steps_trained": 5228880, "num_agent_steps_sampled": 5228880, "num_agent_steps_trained": 5228880}, "done": false, "episodes_total": 1245, "training_iteration": 607, "trial_id": "ee88a_00000", "date": "2023-07-25_03-55-15", "timestamp": 1690246515, "time_this_iter_s": 10.025084018707275, "time_total_s": 10541.094613313675, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 416.2921357154846, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 22.119999999999997, "ram_util_percent": 76.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.607407407407406e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -914.0640618460519, "policy_loss": -4.4240481666974886e+17, "vf_loss": 41186415.48214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2324.5, "diff_num_grad_updates_vs_sampler_policy": 2323.5}}, "num_env_steps_sampled": 5232480, "num_env_steps_trained": 5232480, "num_agent_steps_sampled": 5232480, "num_agent_steps_trained": 5232480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31866.722007248667, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8719695183720394, "mean_inference_ms": 0.37113175527303394, "mean_action_processing_ms": 0.09234834762646425, "mean_env_wait_ms": 1.5366419764775348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004002593812488374, "StateBufferConnector_ms": 0.0026174954005650113, "ViewRequirementAgentConnector_ms": 0.06656646728515625}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31866.722007248667, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8719695183720394, "mean_inference_ms": 0.37113175527303394, "mean_action_processing_ms": 0.09234834762646425, "mean_env_wait_ms": 1.5366419764775348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004002593812488374, "StateBufferConnector_ms": 0.0026174954005650113, "ViewRequirementAgentConnector_ms": 0.06656646728515625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5232480, "num_agent_steps_trained": 5232480, "num_env_steps_sampled": 5232480, "num_env_steps_trained": 5232480, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 355.8369584357204, "num_env_steps_trained_throughput_per_sec": 355.8369584357204, "timesteps_total": 5232480, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5232480, "timers": {"training_iteration_time_ms": 9988.35, "sample_time_ms": 9893.593, "load_time_ms": 1.473, "load_throughput": 2443481.576, "learn_time_ms": 92.437, "learn_throughput": 38945.321, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 5232480, "num_env_steps_trained": 5232480, "num_agent_steps_sampled": 5232480, "num_agent_steps_trained": 5232480}, "done": false, "episodes_total": 1246, "training_iteration": 608, "trial_id": "ee88a_00000", "date": "2023-07-25_03-55-25", "timestamp": 1690246525, "time_this_iter_s": 10.120410919189453, "time_total_s": 10551.215024232864, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 426.4125466346741, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.63571428571429, "ram_util_percent": 76.53571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.4407407407407414e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -915.0264936174665, "policy_loss": -3.2867042908629165e+17, "vf_loss": 40929355.303571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2380.5, "diff_num_grad_updates_vs_sampler_policy": 2379.5}}, "num_env_steps_sampled": 5236080, "num_env_steps_trained": 5236080, "num_agent_steps_sampled": 5236080, "num_agent_steps_trained": 5236080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31888.224620366876, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.871938500328551, "mean_inference_ms": 0.37109631523290454, "mean_action_processing_ms": 0.09234135977921992, "mean_env_wait_ms": 1.534389983820988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983253656431686, "StateBufferConnector_ms": 0.002620386522869731, "ViewRequirementAgentConnector_ms": 0.06653209065282067}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31888.224620366876, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.871938500328551, "mean_inference_ms": 0.37109631523290454, "mean_action_processing_ms": 0.09234135977921992, "mean_env_wait_ms": 1.534389983820988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983253656431686, "StateBufferConnector_ms": 0.002620386522869731, "ViewRequirementAgentConnector_ms": 0.06653209065282067}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5236080, "num_agent_steps_trained": 5236080, "num_env_steps_sampled": 5236080, "num_env_steps_trained": 5236080, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 358.7066458213909, "num_env_steps_trained_throughput_per_sec": 358.7066458213909, "timesteps_total": 5236080, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5236080, "timers": {"training_iteration_time_ms": 9995.327, "sample_time_ms": 9900.177, "load_time_ms": 1.465, "load_throughput": 2457840.023, "learn_time_ms": 92.837, "learn_throughput": 38777.692, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 5236080, "num_env_steps_trained": 5236080, "num_agent_steps_sampled": 5236080, "num_agent_steps_trained": 5236080}, "done": false, "episodes_total": 1247, "training_iteration": 609, "trial_id": "ee88a_00000", "date": "2023-07-25_03-55-35", "timestamp": 1690246535, "time_this_iter_s": 10.038728952407837, "time_total_s": 10561.253753185272, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 436.4512755870819, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 22.607142857142858, "ram_util_percent": 76.53571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.107407407407408e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -910.2621776035854, "policy_loss": -3.6032394911109005e+17, "vf_loss": 41621361.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2492.5, "diff_num_grad_updates_vs_sampler_policy": 2491.5}}, "num_env_steps_sampled": 5243280, "num_env_steps_trained": 5243280, "num_agent_steps_sampled": 5243280, "num_agent_steps_trained": 5243280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31937.58487566261, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8719264247928958, "mean_inference_ms": 0.3710285066271315, "mean_action_processing_ms": 0.09232781648875646, "mean_env_wait_ms": 1.5300643951754107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039365556504991316, "StateBufferConnector_ms": 0.0026220745510525173, "ViewRequirementAgentConnector_ms": 0.06656275855170356}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33294.34805752734, "episode_reward_mean": -31937.58487566261, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8719264247928958, "mean_inference_ms": 0.3710285066271315, "mean_action_processing_ms": 0.09232781648875646, "mean_env_wait_ms": 1.5300643951754107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039365556504991316, "StateBufferConnector_ms": 0.0026220745510525173, "ViewRequirementAgentConnector_ms": 0.06656275855170356}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5243280, "num_agent_steps_trained": 5243280, "num_env_steps_sampled": 5243280, "num_env_steps_trained": 5243280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 359.6221583063068, "num_env_steps_trained_throughput_per_sec": 359.6221583063068, "timesteps_total": 5243280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5243280, "timers": {"training_iteration_time_ms": 10003.066, "sample_time_ms": 9906.483, "load_time_ms": 1.422, "load_throughput": 2530797.043, "learn_time_ms": 94.309, "learn_throughput": 38172.276, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 5243280, "num_env_steps_trained": 5243280, "num_agent_steps_sampled": 5243280, "num_agent_steps_trained": 5243280}, "done": false, "episodes_total": 1249, "training_iteration": 610, "trial_id": "ee88a_00000", "date": "2023-07-25_03-55-56", "timestamp": 1690246556, "time_this_iter_s": 20.023677110671997, "time_total_s": 10581.277430295944, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 456.4749526977539, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 21.275862068965516, "ram_util_percent": 76.55172413793103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.940740740740741e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -909.6874673025949, "policy_loss": -2.6710536348358195e+17, "vf_loss": 42772104.01785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2548.5, "diff_num_grad_updates_vs_sampler_policy": 2547.5}}, "num_env_steps_sampled": 5246880, "num_env_steps_trained": 5246880, "num_agent_steps_sampled": 5246880, "num_agent_steps_trained": 5246880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33693.33124466084, "episode_reward_mean": -31975.753274988656, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8719362931182388, "mean_inference_ms": 0.3709970962683054, "mean_action_processing_ms": 0.09232159568242147, "mean_env_wait_ms": 1.5280091717103037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003925095433774201, "StateBufferConnector_ms": 0.0026215677675993547, "ViewRequirementAgentConnector_ms": 0.06658719933551291}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33693.33124466084, "episode_reward_mean": -31975.753274988656, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8719362931182388, "mean_inference_ms": 0.3709970962683054, "mean_action_processing_ms": 0.09232159568242147, "mean_env_wait_ms": 1.5280091717103037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003925095433774201, "StateBufferConnector_ms": 0.0026215677675993547, "ViewRequirementAgentConnector_ms": 0.06658719933551291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5246880, "num_agent_steps_trained": 5246880, "num_env_steps_sampled": 5246880, "num_env_steps_trained": 5246880, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 359.8575688481224, "num_env_steps_trained_throughput_per_sec": 359.8575688481224, "timesteps_total": 5246880, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5246880, "timers": {"training_iteration_time_ms": 9993.91, "sample_time_ms": 9897.657, "load_time_ms": 1.374, "load_throughput": 2619529.926, "learn_time_ms": 94.025, "learn_throughput": 38287.499, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 5246880, "num_env_steps_trained": 5246880, "num_agent_steps_sampled": 5246880, "num_agent_steps_trained": 5246880}, "done": false, "episodes_total": 1250, "training_iteration": 611, "trial_id": "ee88a_00000", "date": "2023-07-25_03-56-06", "timestamp": 1690246566, "time_this_iter_s": 10.006572961807251, "time_total_s": 10591.284003257751, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 466.48152565956116, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.7, "ram_util_percent": 76.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.607407407407408e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -911.0107323782785, "policy_loss": -2.500956012677346e+17, "vf_loss": 42701005.553571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2660.5, "diff_num_grad_updates_vs_sampler_policy": 2659.5}}, "num_env_steps_sampled": 5254080, "num_env_steps_trained": 5254080, "num_agent_steps_sampled": 5254080, "num_agent_steps_trained": 5254080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33693.33124466084, "episode_reward_mean": -32046.317601783736, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720110896405893, "mean_inference_ms": 0.3709376749667966, "mean_action_processing_ms": 0.09230960162545708, "mean_env_wait_ms": 1.5240314732044717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038911898930867514, "StateBufferConnector_ms": 0.0026201208432515464, "ViewRequirementAgentConnector_ms": 0.06657242774963379}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33693.33124466084, "episode_reward_mean": -32046.317601783736, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720110896405893, "mean_inference_ms": 0.3709376749667966, "mean_action_processing_ms": 0.09230960162545708, "mean_env_wait_ms": 1.5240314732044717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038911898930867514, "StateBufferConnector_ms": 0.0026201208432515464, "ViewRequirementAgentConnector_ms": 0.06657242774963379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5254080, "num_agent_steps_trained": 5254080, "num_env_steps_sampled": 5254080, "num_env_steps_trained": 5254080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 360.24904253751987, "num_env_steps_trained_throughput_per_sec": 360.24904253751987, "timesteps_total": 5254080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5254080, "timers": {"training_iteration_time_ms": 10001.828, "sample_time_ms": 9906.158, "load_time_ms": 1.404, "load_throughput": 2564365.069, "learn_time_ms": 93.41, "learn_throughput": 38539.647, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 5254080, "num_env_steps_trained": 5254080, "num_agent_steps_sampled": 5254080, "num_agent_steps_trained": 5254080}, "done": false, "episodes_total": 1252, "training_iteration": 612, "trial_id": "ee88a_00000", "date": "2023-07-25_03-56-26", "timestamp": 1690246586, "time_this_iter_s": 19.988817930221558, "time_total_s": 10611.272821187973, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 486.4703435897827, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 22.806896551724144, "ram_util_percent": 76.7103448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.2740740740740746e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -908.0297982352121, "policy_loss": -2.6223489678157494e+17, "vf_loss": 43273712.553571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2772.5, "diff_num_grad_updates_vs_sampler_policy": 2771.5}}, "num_env_steps_sampled": 5261280, "num_env_steps_trained": 5261280, "num_agent_steps_sampled": 5261280, "num_agent_steps_trained": 5261280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -33952.27120926225, "episode_reward_mean": -32120.90573104552, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8721136875407641, "mean_inference_ms": 0.37088174285526976, "mean_action_processing_ms": 0.09229815326254637, "mean_env_wait_ms": 1.5202554746617445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038652420043945312, "StateBufferConnector_ms": 0.00262451171875, "ViewRequirementAgentConnector_ms": 0.0665750503540039}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -33952.27120926225, "episode_reward_mean": -32120.90573104552, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8721136875407641, "mean_inference_ms": 0.37088174285526976, "mean_action_processing_ms": 0.09229815326254637, "mean_env_wait_ms": 1.5202554746617445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038652420043945312, "StateBufferConnector_ms": 0.00262451171875, "ViewRequirementAgentConnector_ms": 0.0665750503540039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5261280, "num_agent_steps_trained": 5261280, "num_env_steps_sampled": 5261280, "num_env_steps_trained": 5261280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 362.1207783502369, "num_env_steps_trained_throughput_per_sec": 362.1207783502369, "timesteps_total": 5261280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5261280, "timers": {"training_iteration_time_ms": 10006.93, "sample_time_ms": 9911.261, "load_time_ms": 1.446, "load_throughput": 2489652.657, "learn_time_ms": 93.356, "learn_throughput": 38562.088, "synch_weights_time_ms": 0.809}, "counters": {"num_env_steps_sampled": 5261280, "num_env_steps_trained": 5261280, "num_agent_steps_sampled": 5261280, "num_agent_steps_trained": 5261280}, "done": false, "episodes_total": 1254, "training_iteration": 613, "trial_id": "ee88a_00000", "date": "2023-07-25_03-56-45", "timestamp": 1690246605, "time_this_iter_s": 19.885605096817017, "time_total_s": 10631.15842628479, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 506.35594868659973, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.553571428571427, "ram_util_percent": 76.75000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.9407407407407415e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -908.7374910627093, "policy_loss": -2.4251042138933613e+17, "vf_loss": 43353125.321428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2884.5, "diff_num_grad_updates_vs_sampler_policy": 2883.5}}, "num_env_steps_sampled": 5268480, "num_env_steps_trained": 5268480, "num_agent_steps_sampled": 5268480, "num_agent_steps_trained": 5268480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -34045.288105226005, "episode_reward_mean": -32193.152932305486, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8722480551563266, "mean_inference_ms": 0.3708290949065884, "mean_action_processing_ms": 0.09228739997004706, "mean_env_wait_ms": 1.5166369939873325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038371636317326473, "StateBufferConnector_ms": 0.0026207703810471753, "ViewRequirementAgentConnector_ms": 0.06656279930701622}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -34045.288105226005, "episode_reward_mean": -32193.152932305486, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8722480551563266, "mean_inference_ms": 0.3708290949065884, "mean_action_processing_ms": 0.09228739997004706, "mean_env_wait_ms": 1.5166369939873325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038371636317326473, "StateBufferConnector_ms": 0.0026207703810471753, "ViewRequirementAgentConnector_ms": 0.06656279930701622}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5268480, "num_agent_steps_trained": 5268480, "num_env_steps_sampled": 5268480, "num_env_steps_trained": 5268480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 363.7358050209628, "num_env_steps_trained_throughput_per_sec": 363.7358050209628, "timesteps_total": 5268480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5268480, "timers": {"training_iteration_time_ms": 9972.448, "sample_time_ms": 9876.242, "load_time_ms": 1.631, "load_throughput": 2206786.373, "learn_time_ms": 93.717, "learn_throughput": 38413.726, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 5268480, "num_env_steps_trained": 5268480, "num_agent_steps_sampled": 5268480, "num_agent_steps_trained": 5268480}, "done": false, "episodes_total": 1256, "training_iteration": 614, "trial_id": "ee88a_00000", "date": "2023-07-25_03-57-05", "timestamp": 1690246625, "time_this_iter_s": 19.797304153442383, "time_total_s": 10650.955730438232, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 526.1532528400421, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 21.62857142857143, "ram_util_percent": 76.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.607407407407408e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -910.2678560529437, "policy_loss": -2.1674991346715318e+17, "vf_loss": 43204712.46428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2996.5, "diff_num_grad_updates_vs_sampler_policy": 2995.5}}, "num_env_steps_sampled": 5275680, "num_env_steps_trained": 5275680, "num_agent_steps_sampled": 5275680, "num_agent_steps_trained": 5275680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -34045.288105226005, "episode_reward_mean": -32257.49208658834, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8724206187008233, "mean_inference_ms": 0.3707791068061781, "mean_action_processing_ms": 0.09227702665535568, "mean_env_wait_ms": 1.5131722592052006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038155802973994504, "StateBufferConnector_ms": 0.002617306179470486, "ViewRequirementAgentConnector_ms": 0.06658280337298358}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -34045.288105226005, "episode_reward_mean": -32257.49208658834, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8724206187008233, "mean_inference_ms": 0.3707791068061781, "mean_action_processing_ms": 0.09227702665535568, "mean_env_wait_ms": 1.5131722592052006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038155802973994504, "StateBufferConnector_ms": 0.002617306179470486, "ViewRequirementAgentConnector_ms": 0.06658280337298358}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5275680, "num_agent_steps_trained": 5275680, "num_env_steps_sampled": 5275680, "num_env_steps_trained": 5275680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 362.2403424960378, "num_env_steps_trained_throughput_per_sec": 362.2403424960378, "timesteps_total": 5275680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5275680, "timers": {"training_iteration_time_ms": 9959.763, "sample_time_ms": 9864.121, "load_time_ms": 1.629, "load_throughput": 2209434.22, "learn_time_ms": 93.146, "learn_throughput": 38649.036, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 5275680, "num_env_steps_trained": 5275680, "num_agent_steps_sampled": 5275680, "num_agent_steps_trained": 5275680}, "done": false, "episodes_total": 1258, "training_iteration": 615, "trial_id": "ee88a_00000", "date": "2023-07-25_03-57-25", "timestamp": 1690246645, "time_this_iter_s": 19.878912925720215, "time_total_s": 10670.834643363953, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 546.0321657657623, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 21.189285714285717, "ram_util_percent": 76.42500000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.274074074074074e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -911.8320563180106, "policy_loss": -2.4065103616306813e+17, "vf_loss": 43085996.446428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3108.5, "diff_num_grad_updates_vs_sampler_policy": 3107.5}}, "num_env_steps_sampled": 5282880, "num_env_steps_trained": 5282880, "num_agent_steps_sampled": 5282880, "num_agent_steps_trained": 5282880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -34045.288105226005, "episode_reward_mean": -32315.535684259816, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.872628285667795, "mean_inference_ms": 0.3707330148548997, "mean_action_processing_ms": 0.09226716401583147, "mean_env_wait_ms": 1.50982916062501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037870236805507113, "StateBufferConnector_ms": 0.002620901380266462, "ViewRequirementAgentConnector_ms": 0.06658264568873815}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -34045.288105226005, "episode_reward_mean": -32315.535684259816, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.872628285667795, "mean_inference_ms": 0.3707330148548997, "mean_action_processing_ms": 0.09226716401583147, "mean_env_wait_ms": 1.50982916062501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037870236805507113, "StateBufferConnector_ms": 0.002620901380266462, "ViewRequirementAgentConnector_ms": 0.06658264568873815}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5282880, "num_agent_steps_trained": 5282880, "num_env_steps_sampled": 5282880, "num_env_steps_trained": 5282880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.1086035365847, "num_env_steps_trained_throughput_per_sec": 364.1086035365847, "timesteps_total": 5282880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5282880, "timers": {"training_iteration_time_ms": 9931.41, "sample_time_ms": 9836.31, "load_time_ms": 1.629, "load_throughput": 2210081.0, "learn_time_ms": 92.598, "learn_throughput": 38877.706, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 5282880, "num_env_steps_trained": 5282880, "num_agent_steps_sampled": 5282880, "num_agent_steps_trained": 5282880}, "done": false, "episodes_total": 1260, "training_iteration": 616, "trial_id": "ee88a_00000", "date": "2023-07-25_03-57-45", "timestamp": 1690246665, "time_this_iter_s": 19.77708387374878, "time_total_s": 10690.611727237701, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 565.8092496395111, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 22.04642857142857, "ram_util_percent": 76.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.940740740740741e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -907.5238473074777, "policy_loss": -1.8436206027260845e+17, "vf_loss": 45932045.14285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3220.5, "diff_num_grad_updates_vs_sampler_policy": 3219.5}}, "num_env_steps_sampled": 5290080, "num_env_steps_trained": 5290080, "num_agent_steps_sampled": 5290080, "num_agent_steps_trained": 5290080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35237.86635760948, "episode_reward_mean": -32398.45162699483, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8728519459663171, "mean_inference_ms": 0.37069077585810095, "mean_action_processing_ms": 0.09225800560303145, "mean_env_wait_ms": 1.5065815488285652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003771124214961611, "StateBufferConnector_ms": 0.002624659702695649, "ViewRequirementAgentConnector_ms": 0.06657098901682887}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35237.86635760948, "episode_reward_mean": -32398.45162699483, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8728519459663171, "mean_inference_ms": 0.37069077585810095, "mean_action_processing_ms": 0.09225800560303145, "mean_env_wait_ms": 1.5065815488285652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003771124214961611, "StateBufferConnector_ms": 0.002624659702695649, "ViewRequirementAgentConnector_ms": 0.06657098901682887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5290080, "num_agent_steps_trained": 5290080, "num_env_steps_sampled": 5290080, "num_env_steps_trained": 5290080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.82310224694334, "num_env_steps_trained_throughput_per_sec": 367.82310224694334, "timesteps_total": 5290080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5290080, "timers": {"training_iteration_time_ms": 9890.255, "sample_time_ms": 9794.612, "load_time_ms": 1.571, "load_throughput": 2291899.821, "learn_time_ms": 93.21, "learn_throughput": 38622.315, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 5290080, "num_env_steps_trained": 5290080, "num_agent_steps_sampled": 5290080, "num_agent_steps_trained": 5290080}, "done": false, "episodes_total": 1262, "training_iteration": 617, "trial_id": "ee88a_00000", "date": "2023-07-25_03-58-05", "timestamp": 1690246685, "time_this_iter_s": 19.57736897468567, "time_total_s": 10710.189096212387, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 585.3866186141968, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 21.83928571428571, "ram_util_percent": 76.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.7740740740740744e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -908.2511771065848, "policy_loss": -1.7125998722467914e+17, "vf_loss": 45541428.48214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3276.5, "diff_num_grad_updates_vs_sampler_policy": 3275.5}}, "num_env_steps_sampled": 5293680, "num_env_steps_trained": 5293680, "num_agent_steps_sampled": 5293680, "num_agent_steps_trained": 5293680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35237.86635760948, "episode_reward_mean": -32443.19463874449, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8729714275527214, "mean_inference_ms": 0.3706712741802218, "mean_action_processing_ms": 0.09225368803829313, "mean_env_wait_ms": 1.5050205912561088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003761760259078721, "StateBufferConnector_ms": 0.002626241263696703, "ViewRequirementAgentConnector_ms": 0.06657010417873577}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35237.86635760948, "episode_reward_mean": -32443.19463874449, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8729714275527214, "mean_inference_ms": 0.3706712741802218, "mean_action_processing_ms": 0.09225368803829313, "mean_env_wait_ms": 1.5050205912561088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003761760259078721, "StateBufferConnector_ms": 0.002626241263696703, "ViewRequirementAgentConnector_ms": 0.06657010417873577}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5293680, "num_agent_steps_trained": 5293680, "num_env_steps_sampled": 5293680, "num_env_steps_trained": 5293680, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 359.35109015540195, "num_env_steps_trained_throughput_per_sec": 359.35109015540195, "timesteps_total": 5293680, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5293680, "timers": {"training_iteration_time_ms": 9897.061, "sample_time_ms": 9801.44, "load_time_ms": 1.58, "load_throughput": 2278309.227, "learn_time_ms": 93.157, "learn_throughput": 38644.625, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 5293680, "num_env_steps_trained": 5293680, "num_agent_steps_sampled": 5293680, "num_agent_steps_trained": 5293680}, "done": false, "episodes_total": 1263, "training_iteration": 618, "trial_id": "ee88a_00000", "date": "2023-07-25_03-58-15", "timestamp": 1690246695, "time_this_iter_s": 10.020990371704102, "time_total_s": 10720.210086584091, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 595.4076089859009, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 25.03571428571429, "ram_util_percent": 76.09285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.464444444444445e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -909.9371871948242, "policy_loss": -2.1056325363780637e+17, "vf_loss": 46325289.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3388.5, "diff_num_grad_updates_vs_sampler_policy": 3387.5}}, "num_env_steps_sampled": 5300880, "num_env_steps_trained": 5300880, "num_agent_steps_sampled": 5300880, "num_agent_steps_trained": 5300880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32539.236385550445, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8732260550154588, "mean_inference_ms": 0.3706342612237871, "mean_action_processing_ms": 0.09224540348636048, "mean_env_wait_ms": 1.5019141807957463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037439533921538805, "StateBufferConnector_ms": 0.0026210409695984886, "ViewRequirementAgentConnector_ms": 0.06656334048411885}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32539.236385550445, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8732260550154588, "mean_inference_ms": 0.3706342612237871, "mean_action_processing_ms": 0.09224540348636048, "mean_env_wait_ms": 1.5019141807957463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037439533921538805, "StateBufferConnector_ms": 0.0026210409695984886, "ViewRequirementAgentConnector_ms": 0.06656334048411885}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5300880, "num_agent_steps_trained": 5300880, "num_env_steps_sampled": 5300880, "num_env_steps_trained": 5300880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.42505809735076, "num_env_steps_trained_throughput_per_sec": 370.42505809735076, "timesteps_total": 5300880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5300880, "timers": {"training_iteration_time_ms": 9851.689, "sample_time_ms": 9756.102, "load_time_ms": 1.508, "load_throughput": 2387120.878, "learn_time_ms": 93.198, "learn_throughput": 38627.532, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 5300880, "num_env_steps_trained": 5300880, "num_agent_steps_sampled": 5300880, "num_agent_steps_trained": 5300880}, "done": false, "episodes_total": 1265, "training_iteration": 619, "trial_id": "ee88a_00000", "date": "2023-07-25_03-58-34", "timestamp": 1690246714, "time_this_iter_s": 19.439999103546143, "time_total_s": 10739.650085687637, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 614.847608089447, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 21.675000000000004, "ram_util_percent": 76.11785714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2644444444444442e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -911.4416166033063, "policy_loss": -1.5716987423587347e+17, "vf_loss": 45857585.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3500.5, "diff_num_grad_updates_vs_sampler_policy": 3499.5}}, "num_env_steps_sampled": 5308080, "num_env_steps_trained": 5308080, "num_agent_steps_sampled": 5308080, "num_agent_steps_trained": 5308080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32626.010296058215, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8734744529603937, "mean_inference_ms": 0.37060278646866984, "mean_action_processing_ms": 0.09223790706129616, "mean_env_wait_ms": 1.498876652870637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037310615418449282, "StateBufferConnector_ms": 0.0026263887920076885, "ViewRequirementAgentConnector_ms": 0.0665766852242606}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32626.010296058215, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8734744529603937, "mean_inference_ms": 0.37060278646866984, "mean_action_processing_ms": 0.09223790706129616, "mean_env_wait_ms": 1.498876652870637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037310615418449282, "StateBufferConnector_ms": 0.0026263887920076885, "ViewRequirementAgentConnector_ms": 0.0665766852242606}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5308080, "num_agent_steps_trained": 5308080, "num_env_steps_sampled": 5308080, "num_env_steps_trained": 5308080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.4533136030067, "num_env_steps_trained_throughput_per_sec": 372.4533136030067, "timesteps_total": 5308080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5308080, "timers": {"training_iteration_time_ms": 9811.684, "sample_time_ms": 9716.641, "load_time_ms": 1.358, "load_throughput": 2651918.648, "learn_time_ms": 92.81, "learn_throughput": 38789.118, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 5308080, "num_env_steps_trained": 5308080, "num_agent_steps_sampled": 5308080, "num_agent_steps_trained": 5308080}, "done": false, "episodes_total": 1267, "training_iteration": 620, "trial_id": "ee88a_00000", "date": "2023-07-25_03-58-53", "timestamp": 1690246733, "time_this_iter_s": 19.334026098251343, "time_total_s": 10758.984111785889, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 634.1816341876984, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 23.178571428571434, "ram_util_percent": 75.99285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.064444444444444e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -912.784069606236, "policy_loss": -1.3077513758856722e+17, "vf_loss": 45835006.53571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3612.5, "diff_num_grad_updates_vs_sampler_policy": 3611.5}}, "num_env_steps_sampled": 5315280, "num_env_steps_trained": 5315280, "num_agent_steps_sampled": 5315280, "num_agent_steps_trained": 5315280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32705.890520166442, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.873736135894472, "mean_inference_ms": 0.37057551072073724, "mean_action_processing_ms": 0.09223128057837028, "mean_env_wait_ms": 1.4959032681470752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037127274733323315, "StateBufferConnector_ms": 0.0026288399329552283, "ViewRequirementAgentConnector_ms": 0.06659801189716046}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32705.890520166442, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.873736135894472, "mean_inference_ms": 0.37057551072073724, "mean_action_processing_ms": 0.09223128057837028, "mean_env_wait_ms": 1.4959032681470752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037127274733323315, "StateBufferConnector_ms": 0.0026288399329552283, "ViewRequirementAgentConnector_ms": 0.06659801189716046}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5315280, "num_agent_steps_trained": 5315280, "num_env_steps_sampled": 5315280, "num_env_steps_trained": 5315280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.51707241566794, "num_env_steps_trained_throughput_per_sec": 370.51707241566794, "timesteps_total": 5315280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5315280, "timers": {"training_iteration_time_ms": 9773.773, "sample_time_ms": 9678.756, "load_time_ms": 1.358, "load_throughput": 2651359.86, "learn_time_ms": 92.777, "learn_throughput": 38802.705, "synch_weights_time_ms": 0.817}, "counters": {"num_env_steps_sampled": 5315280, "num_env_steps_trained": 5315280, "num_agent_steps_sampled": 5315280, "num_agent_steps_trained": 5315280}, "done": false, "episodes_total": 1269, "training_iteration": 621, "trial_id": "ee88a_00000", "date": "2023-07-25_03-59-13", "timestamp": 1690246753, "time_this_iter_s": 19.435009956359863, "time_total_s": 10778.419121742249, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 653.6166441440582, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 22.14814814814815, "ram_util_percent": 76.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8644444444444446e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -914.0845402308872, "policy_loss": -1.133152906973258e+17, "vf_loss": 46244118.53571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3724.5, "diff_num_grad_updates_vs_sampler_policy": 3723.5}}, "num_env_steps_sampled": 5322480, "num_env_steps_trained": 5322480, "num_agent_steps_sampled": 5322480, "num_agent_steps_trained": 5322480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32783.499471818744, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8740086604485575, "mean_inference_ms": 0.3705495666254742, "mean_action_processing_ms": 0.09222470835136883, "mean_env_wait_ms": 1.4930087338786282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036965555219507927, "StateBufferConnector_ms": 0.002629721342627682, "ViewRequirementAgentConnector_ms": 0.0666088132715937}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32783.499471818744, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8740086604485575, "mean_inference_ms": 0.3705495666254742, "mean_action_processing_ms": 0.09222470835136883, "mean_env_wait_ms": 1.4930087338786282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036965555219507927, "StateBufferConnector_ms": 0.002629721342627682, "ViewRequirementAgentConnector_ms": 0.0666088132715937}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5322480, "num_agent_steps_trained": 5322480, "num_env_steps_sampled": 5322480, "num_env_steps_trained": 5322480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.90149586136687, "num_env_steps_trained_throughput_per_sec": 368.90149586136687, "timesteps_total": 5322480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5322480, "timers": {"training_iteration_time_ms": 9740.078, "sample_time_ms": 9645.077, "load_time_ms": 1.366, "load_throughput": 2635486.778, "learn_time_ms": 92.758, "learn_throughput": 38810.584, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 5322480, "num_env_steps_trained": 5322480, "num_agent_steps_sampled": 5322480, "num_agent_steps_trained": 5322480}, "done": false, "episodes_total": 1271, "training_iteration": 622, "trial_id": "ee88a_00000", "date": "2023-07-25_03-59-32", "timestamp": 1690246772, "time_this_iter_s": 19.520332098007202, "time_total_s": 10797.939453840256, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 673.1369762420654, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 21.210714285714285, "ram_util_percent": 75.92142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.664444444444445e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -915.3783711024693, "policy_loss": -1.2903358802852158e+17, "vf_loss": 45626574.71428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3836.5, "diff_num_grad_updates_vs_sampler_policy": 3835.5}}, "num_env_steps_sampled": 5329680, "num_env_steps_trained": 5329680, "num_agent_steps_sampled": 5329680, "num_agent_steps_trained": 5329680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32852.766162272106, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8742986088804545, "mean_inference_ms": 0.37052517319280004, "mean_action_processing_ms": 0.09221837833932575, "mean_env_wait_ms": 1.4901835503779315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036730282548545065, "StateBufferConnector_ms": 0.0026319337927776833, "ViewRequirementAgentConnector_ms": 0.06658892700637596}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32852.766162272106, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8742986088804545, "mean_inference_ms": 0.37052517319280004, "mean_action_processing_ms": 0.09221837833932575, "mean_env_wait_ms": 1.4901835503779315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036730282548545065, "StateBufferConnector_ms": 0.0026319337927776833, "ViewRequirementAgentConnector_ms": 0.06658892700637596}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5329680, "num_agent_steps_trained": 5329680, "num_env_steps_sampled": 5329680, "num_env_steps_trained": 5329680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.68141365195834, "num_env_steps_trained_throughput_per_sec": 368.68141365195834, "timesteps_total": 5329680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5329680, "timers": {"training_iteration_time_ms": 9724.7, "sample_time_ms": 9629.813, "load_time_ms": 1.358, "load_throughput": 2650987.464, "learn_time_ms": 92.667, "learn_throughput": 38848.848, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 5329680, "num_env_steps_trained": 5329680, "num_agent_steps_sampled": 5329680, "num_agent_steps_trained": 5329680}, "done": false, "episodes_total": 1273, "training_iteration": 623, "trial_id": "ee88a_00000", "date": "2023-07-25_03-59-52", "timestamp": 1690246792, "time_this_iter_s": 19.53183388710022, "time_total_s": 10817.471287727356, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 692.6688101291656, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 21.835714285714285, "ram_util_percent": 76.08928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4644444444444444e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -916.5838732038226, "policy_loss": -8.762678764737298e+16, "vf_loss": 45631043.60714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3948.5, "diff_num_grad_updates_vs_sampler_policy": 3947.5}}, "num_env_steps_sampled": 5336880, "num_env_steps_trained": 5336880, "num_agent_steps_sampled": 5336880, "num_agent_steps_trained": 5336880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32917.43854833299, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.874592343439991, "mean_inference_ms": 0.3705029484338632, "mean_action_processing_ms": 0.09221246640803045, "mean_env_wait_ms": 1.4874383484965605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036541844757509902, "StateBufferConnector_ms": 0.0026303277888768154, "ViewRequirementAgentConnector_ms": 0.06659937576508858}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32917.43854833299, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.874592343439991, "mean_inference_ms": 0.3705029484338632, "mean_action_processing_ms": 0.09221246640803045, "mean_env_wait_ms": 1.4874383484965605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036541844757509902, "StateBufferConnector_ms": 0.0026303277888768154, "ViewRequirementAgentConnector_ms": 0.06659937576508858}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5336880, "num_agent_steps_trained": 5336880, "num_env_steps_sampled": 5336880, "num_env_steps_trained": 5336880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.34420952783717, "num_env_steps_trained_throughput_per_sec": 368.34420952783717, "timesteps_total": 5336880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5336880, "timers": {"training_iteration_time_ms": 9735.68, "sample_time_ms": 9640.512, "load_time_ms": 1.356, "load_throughput": 2655603.229, "learn_time_ms": 92.943, "learn_throughput": 38733.586, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 5336880, "num_env_steps_trained": 5336880, "num_agent_steps_sampled": 5336880, "num_agent_steps_trained": 5336880}, "done": false, "episodes_total": 1275, "training_iteration": 624, "trial_id": "ee88a_00000", "date": "2023-07-25_04-00-12", "timestamp": 1690246812, "time_this_iter_s": 19.549882173538208, "time_total_s": 10837.021169900894, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 712.2186923027039, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 22.349999999999998, "ram_util_percent": 76.19285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2644444444444444e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -917.6610706874302, "policy_loss": -7.981184274741056e+16, "vf_loss": 46021800.60714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4060.5, "diff_num_grad_updates_vs_sampler_policy": 4059.5}}, "num_env_steps_sampled": 5344080, "num_env_steps_trained": 5344080, "num_agent_steps_sampled": 5344080, "num_agent_steps_trained": 5344080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32980.98014692171, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8748993917490382, "mean_inference_ms": 0.3704833490745011, "mean_action_processing_ms": 0.09220666879283186, "mean_env_wait_ms": 1.484769588818179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036419254459746898, "StateBufferConnector_ms": 0.0026310959907427226, "ViewRequirementAgentConnector_ms": 0.06660827218669735}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -32980.98014692171, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8748993917490382, "mean_inference_ms": 0.3704833490745011, "mean_action_processing_ms": 0.09220666879283186, "mean_env_wait_ms": 1.484769588818179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036419254459746898, "StateBufferConnector_ms": 0.0026310959907427226, "ViewRequirementAgentConnector_ms": 0.06660827218669735}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5344080, "num_agent_steps_trained": 5344080, "num_env_steps_sampled": 5344080, "num_env_steps_trained": 5344080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.5114640918091, "num_env_steps_trained_throughput_per_sec": 366.5114640918091, "timesteps_total": 5344080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5344080, "timers": {"training_iteration_time_ms": 9767.02, "sample_time_ms": 9671.39, "load_time_ms": 1.388, "load_throughput": 2593523.6, "learn_time_ms": 93.369, "learn_throughput": 38556.554, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 5344080, "num_env_steps_trained": 5344080, "num_agent_steps_sampled": 5344080, "num_agent_steps_trained": 5344080}, "done": false, "episodes_total": 1277, "training_iteration": 625, "trial_id": "ee88a_00000", "date": "2023-07-25_04-00-31", "timestamp": 1690246831, "time_this_iter_s": 19.64736533164978, "time_total_s": 10856.668535232544, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 731.8660576343536, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 20.98928571428571, "ram_util_percent": 76.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0644444444444447e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": -918.5924704415457, "policy_loss": -6.499690392292513e+16, "vf_loss": 45514832.35714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4172.5, "diff_num_grad_updates_vs_sampler_policy": 4171.5}}, "num_env_steps_sampled": 5351280, "num_env_steps_trained": 5351280, "num_agent_steps_sampled": 5351280, "num_agent_steps_trained": 5351280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -33039.70163061549, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752041877911826, "mean_inference_ms": 0.3704661803155517, "mean_action_processing_ms": 0.09220131785970577, "mean_env_wait_ms": 1.482182320188831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036268234252929688, "StateBufferConnector_ms": 0.0026299158732096353, "ViewRequirementAgentConnector_ms": 0.06658331553141277}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -33039.70163061549, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8752041877911826, "mean_inference_ms": 0.3704661803155517, "mean_action_processing_ms": 0.09220131785970577, "mean_env_wait_ms": 1.482182320188831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036268234252929688, "StateBufferConnector_ms": 0.0026299158732096353, "ViewRequirementAgentConnector_ms": 0.06658331553141277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5351280, "num_agent_steps_trained": 5351280, "num_env_steps_sampled": 5351280, "num_env_steps_trained": 5351280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.57795010079093, "num_env_steps_trained_throughput_per_sec": 367.57795010079093, "timesteps_total": 5351280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5351280, "timers": {"training_iteration_time_ms": 9782.558, "sample_time_ms": 9686.995, "load_time_ms": 1.386, "load_throughput": 2596511.685, "learn_time_ms": 93.3, "learn_throughput": 38585.067, "synch_weights_time_ms": 0.819}, "counters": {"num_env_steps_sampled": 5351280, "num_env_steps_trained": 5351280, "num_agent_steps_sampled": 5351280, "num_agent_steps_trained": 5351280}, "done": false, "episodes_total": 1279, "training_iteration": 626, "trial_id": "ee88a_00000", "date": "2023-07-25_04-00-51", "timestamp": 1690246851, "time_this_iter_s": 19.590656042099, "time_total_s": 10876.259191274643, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 751.4567136764526, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 21.037037037037038, "ram_util_percent": 76.33703703703704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.774074074074077e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -919.5070539202009, "policy_loss": -6.255668522582426e+16, "vf_loss": 46153215.196428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4284.5, "diff_num_grad_updates_vs_sampler_policy": 4283.5}}, "num_env_steps_sampled": 5358480, "num_env_steps_trained": 5358480, "num_agent_steps_sampled": 5358480, "num_agent_steps_trained": 5358480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -33098.6649503305, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8754949445403422, "mean_inference_ms": 0.37045005272680503, "mean_action_processing_ms": 0.09219628340182558, "mean_env_wait_ms": 1.4796737110243061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036134348287210835, "StateBufferConnector_ms": 0.0026278681569285207, "ViewRequirementAgentConnector_ms": 0.06657142143744926}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -33098.6649503305, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8754949445403422, "mean_inference_ms": 0.37045005272680503, "mean_action_processing_ms": 0.09219628340182558, "mean_env_wait_ms": 1.4796737110243061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036134348287210835, "StateBufferConnector_ms": 0.0026278681569285207, "ViewRequirementAgentConnector_ms": 0.06657142143744926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5358480, "num_agent_steps_trained": 5358480, "num_env_steps_sampled": 5358480, "num_env_steps_trained": 5358480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.9543676633571, "num_env_steps_trained_throughput_per_sec": 369.9543676633571, "timesteps_total": 5358480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5358480, "timers": {"training_iteration_time_ms": 9777.004, "sample_time_ms": 9681.184, "load_time_ms": 1.392, "load_throughput": 2586282.719, "learn_time_ms": 93.553, "learn_throughput": 38480.952, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 5358480, "num_env_steps_trained": 5358480, "num_agent_steps_sampled": 5358480, "num_agent_steps_trained": 5358480}, "done": false, "episodes_total": 1281, "training_iteration": 627, "trial_id": "ee88a_00000", "date": "2023-07-25_04-01-10", "timestamp": 1690246870, "time_this_iter_s": 19.464666843414307, "time_total_s": 10895.723858118057, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 770.921380519867, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 21.47142857142857, "ram_util_percent": 76.24285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.440740740740741e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -920.8222405569894, "policy_loss": -5.9789779400541896e+16, "vf_loss": 45734770.946428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4396.5, "diff_num_grad_updates_vs_sampler_policy": 4395.5}}, "num_env_steps_sampled": 5365680, "num_env_steps_trained": 5365680, "num_agent_steps_sampled": 5365680, "num_agent_steps_trained": 5365680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -33152.37058811863, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.875757499056996, "mean_inference_ms": 0.3704337547989334, "mean_action_processing_ms": 0.09219116497739416, "mean_env_wait_ms": 1.4772590921044486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003602534909791584, "StateBufferConnector_ms": 0.002630149261860908, "ViewRequirementAgentConnector_ms": 0.06660087199150762}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -33152.37058811863, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.875757499056996, "mean_inference_ms": 0.3704337547989334, "mean_action_processing_ms": 0.09219116497739416, "mean_env_wait_ms": 1.4772590921044486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003602534909791584, "StateBufferConnector_ms": 0.002630149261860908, "ViewRequirementAgentConnector_ms": 0.06660087199150762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5365680, "num_agent_steps_trained": 5365680, "num_env_steps_sampled": 5365680, "num_env_steps_trained": 5365680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.6162661081439, "num_env_steps_trained_throughput_per_sec": 369.6162661081439, "timesteps_total": 5365680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5365680, "timers": {"training_iteration_time_ms": 9772.065, "sample_time_ms": 9676.305, "load_time_ms": 1.411, "load_throughput": 2550590.27, "learn_time_ms": 93.48, "learn_throughput": 38511.072, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 5365680, "num_env_steps_trained": 5365680, "num_agent_steps_sampled": 5365680, "num_agent_steps_trained": 5365680}, "done": false, "episodes_total": 1283, "training_iteration": 628, "trial_id": "ee88a_00000", "date": "2023-07-25_04-01-30", "timestamp": 1690246890, "time_this_iter_s": 19.482551097869873, "time_total_s": 10915.206409215927, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 790.4039316177368, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 20.717857142857145, "ram_util_percent": 76.26071428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.107407407407406e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -921.9390095302036, "policy_loss": -5.3628695587434136e+16, "vf_loss": 45964559.178571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4508.5, "diff_num_grad_updates_vs_sampler_policy": 4507.5}}, "num_env_steps_sampled": 5372880, "num_env_steps_trained": 5372880, "num_agent_steps_sampled": 5372880, "num_agent_steps_trained": 5372880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -33206.4359104894, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8759918153605655, "mean_inference_ms": 0.37041672610010934, "mean_action_processing_ms": 0.09218603771758287, "mean_env_wait_ms": 1.4749208555934623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035912902266890916, "StateBufferConnector_ms": 0.0026296686243127893, "ViewRequirementAgentConnector_ms": 0.06658795439166787}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35436.681905053796, "episode_reward_mean": -33206.4359104894, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8759918153605655, "mean_inference_ms": 0.37041672610010934, "mean_action_processing_ms": 0.09218603771758287, "mean_env_wait_ms": 1.4749208555934623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035912902266890916, "StateBufferConnector_ms": 0.0026296686243127893, "ViewRequirementAgentConnector_ms": 0.06658795439166787}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5372880, "num_agent_steps_trained": 5372880, "num_env_steps_sampled": 5372880, "num_env_steps_trained": 5372880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 373.06898278940565, "num_env_steps_trained_throughput_per_sec": 373.06898278940565, "timesteps_total": 5372880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5372880, "timers": {"training_iteration_time_ms": 9747.31, "sample_time_ms": 9651.528, "load_time_ms": 1.463, "load_throughput": 2460804.172, "learn_time_ms": 93.443, "learn_throughput": 38526.155, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 5372880, "num_env_steps_trained": 5372880, "num_agent_steps_sampled": 5372880, "num_agent_steps_trained": 5372880}, "done": false, "episodes_total": 1285, "training_iteration": 629, "trial_id": "ee88a_00000", "date": "2023-07-25_04-01-49", "timestamp": 1690246909, "time_this_iter_s": 19.302250146865845, "time_total_s": 10934.508659362793, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 809.7061817646027, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 21.2, "ram_util_percent": 76.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.774074074074073e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -923.0311083112445, "policy_loss": -4.98454601180998e+16, "vf_loss": 46225814.28571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4620.5, "diff_num_grad_updates_vs_sampler_policy": 4619.5}}, "num_env_steps_sampled": 5380080, "num_env_steps_trained": 5380080, "num_agent_steps_sampled": 5380080, "num_agent_steps_trained": 5380080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33260.42028205037, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8762074871535712, "mean_inference_ms": 0.37040082277547204, "mean_action_processing_ms": 0.09218123473119912, "mean_env_wait_ms": 1.4726568800734257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035794384508247836, "StateBufferConnector_ms": 0.0026274876422192677, "ViewRequirementAgentConnector_ms": 0.06656876529555723}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33260.42028205037, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8762074871535712, "mean_inference_ms": 0.37040082277547204, "mean_action_processing_ms": 0.09218123473119912, "mean_env_wait_ms": 1.4726568800734257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035794384508247836, "StateBufferConnector_ms": 0.0026274876422192677, "ViewRequirementAgentConnector_ms": 0.06656876529555723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5380080, "num_agent_steps_trained": 5380080, "num_env_steps_sampled": 5380080, "num_env_steps_trained": 5380080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.69173258438985, "num_env_steps_trained_throughput_per_sec": 370.69173258438985, "timesteps_total": 5380080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5380080, "timers": {"training_iteration_time_ms": 9725.156, "sample_time_ms": 9629.953, "load_time_ms": 1.466, "load_throughput": 2456040.99, "learn_time_ms": 92.873, "learn_throughput": 38762.79, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 5380080, "num_env_steps_trained": 5380080, "num_agent_steps_sampled": 5380080, "num_agent_steps_trained": 5380080}, "done": false, "episodes_total": 1287, "training_iteration": 630, "trial_id": "ee88a_00000", "date": "2023-07-25_04-02-09", "timestamp": 1690246929, "time_this_iter_s": 19.4260311126709, "time_total_s": 10953.934690475464, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 829.1322128772736, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 20.24444444444444, "ram_util_percent": 76.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.44074074074074e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -923.9591663905552, "policy_loss": -4.716979541261129e+16, "vf_loss": 46007807.91071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4732.5, "diff_num_grad_updates_vs_sampler_policy": 4731.5}}, "num_env_steps_sampled": 5387280, "num_env_steps_trained": 5387280, "num_agent_steps_sampled": 5387280, "num_agent_steps_trained": 5387280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33306.05520671405, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8764237312007584, "mean_inference_ms": 0.37038497668590836, "mean_action_processing_ms": 0.09217668213674812, "mean_env_wait_ms": 1.4704381526159058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003565619973575368, "StateBufferConnector_ms": 0.00262905569637523, "ViewRequirementAgentConnector_ms": 0.06656169891357422}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33306.05520671405, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8764237312007584, "mean_inference_ms": 0.37038497668590836, "mean_action_processing_ms": 0.09217668213674812, "mean_env_wait_ms": 1.4704381526159058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003565619973575368, "StateBufferConnector_ms": 0.00262905569637523, "ViewRequirementAgentConnector_ms": 0.06656169891357422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5387280, "num_agent_steps_trained": 5387280, "num_env_steps_sampled": 5387280, "num_env_steps_trained": 5387280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.8381429253495, "num_env_steps_trained_throughput_per_sec": 372.8381429253495, "timesteps_total": 5387280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5387280, "timers": {"training_iteration_time_ms": 9697.521, "sample_time_ms": 9601.855, "load_time_ms": 1.501, "load_throughput": 2398115.495, "learn_time_ms": 93.302, "learn_throughput": 38584.18, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 5387280, "num_env_steps_trained": 5387280, "num_agent_steps_sampled": 5387280, "num_agent_steps_trained": 5387280}, "done": false, "episodes_total": 1289, "training_iteration": 631, "trial_id": "ee88a_00000", "date": "2023-07-25_04-02-28", "timestamp": 1690246948, "time_this_iter_s": 19.314130783081055, "time_total_s": 10973.248821258545, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 848.4463436603546, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.11428571428571, "ram_util_percent": 76.23571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.107407407407408e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -924.9000876290457, "policy_loss": -4.869531016239884e+16, "vf_loss": 45394204.85714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4844.5, "diff_num_grad_updates_vs_sampler_policy": 4843.5}}, "num_env_steps_sampled": 5394480, "num_env_steps_trained": 5394480, "num_agent_steps_sampled": 5394480, "num_agent_steps_trained": 5394480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33348.72437894699, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8766433978788168, "mean_inference_ms": 0.3703700433786339, "mean_action_processing_ms": 0.09217231668473486, "mean_env_wait_ms": 1.468273432487707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003557643671145384, "StateBufferConnector_ms": 0.0026335661438689835, "ViewRequirementAgentConnector_ms": 0.066601544961162}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33348.72437894699, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8766433978788168, "mean_inference_ms": 0.3703700433786339, "mean_action_processing_ms": 0.09217231668473486, "mean_env_wait_ms": 1.468273432487707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003557643671145384, "StateBufferConnector_ms": 0.0026335661438689835, "ViewRequirementAgentConnector_ms": 0.066601544961162}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5394480, "num_agent_steps_trained": 5394480, "num_env_steps_sampled": 5394480, "num_env_steps_trained": 5394480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.3432354716695, "num_env_steps_trained_throughput_per_sec": 369.3432354716695, "timesteps_total": 5394480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5394480, "timers": {"training_iteration_time_ms": 9700.741, "sample_time_ms": 9604.634, "load_time_ms": 1.533, "load_throughput": 2348617.131, "learn_time_ms": 93.703, "learn_throughput": 38419.443, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 5394480, "num_env_steps_trained": 5394480, "num_agent_steps_sampled": 5394480, "num_agent_steps_trained": 5394480}, "done": false, "episodes_total": 1291, "training_iteration": 632, "trial_id": "ee88a_00000", "date": "2023-07-25_04-02-48", "timestamp": 1690246968, "time_this_iter_s": 19.49699831008911, "time_total_s": 10992.745819568634, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 867.9433419704437, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 20.559259259259257, "ram_util_percent": 76.1148148148148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.774074074074074e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -926.1415143694196, "policy_loss": -4.7041427703413944e+16, "vf_loss": 45218271.23214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4956.5, "diff_num_grad_updates_vs_sampler_policy": 4955.5}}, "num_env_steps_sampled": 5401680, "num_env_steps_trained": 5401680, "num_agent_steps_sampled": 5401680, "num_agent_steps_trained": 5401680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33386.29797851347, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8768688201246492, "mean_inference_ms": 0.37035600815553016, "mean_action_processing_ms": 0.09216822181377901, "mean_env_wait_ms": 1.4661629855081824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035489543100421348, "StateBufferConnector_ms": 0.0026290336351716117, "ViewRequirementAgentConnector_ms": 0.06659379166163755}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33386.29797851347, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8768688201246492, "mean_inference_ms": 0.37035600815553016, "mean_action_processing_ms": 0.09216822181377901, "mean_env_wait_ms": 1.4661629855081824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035489543100421348, "StateBufferConnector_ms": 0.0026290336351716117, "ViewRequirementAgentConnector_ms": 0.06659379166163755}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5401680, "num_agent_steps_trained": 5401680, "num_env_steps_sampled": 5401680, "num_env_steps_trained": 5401680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.1519335395728, "num_env_steps_trained_throughput_per_sec": 368.1519335395728, "timesteps_total": 5401680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5401680, "timers": {"training_iteration_time_ms": 9708.49, "sample_time_ms": 9612.615, "load_time_ms": 1.528, "load_throughput": 2355799.111, "learn_time_ms": 93.477, "learn_throughput": 38512.133, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 5401680, "num_env_steps_trained": 5401680, "num_agent_steps_sampled": 5401680, "num_agent_steps_trained": 5401680}, "done": false, "episodes_total": 1293, "training_iteration": 633, "trial_id": "ee88a_00000", "date": "2023-07-25_04-03-07", "timestamp": 1690246987, "time_this_iter_s": 19.55988311767578, "time_total_s": 11012.30570268631, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 887.5032250881195, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.539285714285715, "ram_util_percent": 76.11071428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.440740740740741e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -927.3383636474609, "policy_loss": -4.5477389030994536e+16, "vf_loss": 45244221.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5068.5, "diff_num_grad_updates_vs_sampler_policy": 5067.5}}, "num_env_steps_sampled": 5408880, "num_env_steps_trained": 5408880, "num_agent_steps_sampled": 5408880, "num_agent_steps_trained": 5408880}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33419.894181722935, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8771006846568066, "mean_inference_ms": 0.37034306169319364, "mean_action_processing_ms": 0.09216436842427925, "mean_env_wait_ms": 1.464105831018548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003539598905123197, "StateBufferConnector_ms": 0.0026315123170286745, "ViewRequirementAgentConnector_ms": 0.06656777727734911}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33419.894181722935, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8771006846568066, "mean_inference_ms": 0.37034306169319364, "mean_action_processing_ms": 0.09216436842427925, "mean_env_wait_ms": 1.464105831018548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003539598905123197, "StateBufferConnector_ms": 0.0026315123170286745, "ViewRequirementAgentConnector_ms": 0.06656777727734911}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5408880, "num_agent_steps_trained": 5408880, "num_env_steps_sampled": 5408880, "num_env_steps_trained": 5408880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.29875872458024, "num_env_steps_trained_throughput_per_sec": 367.29875872458024, "timesteps_total": 5408880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5408880, "timers": {"training_iteration_time_ms": 9738.809, "sample_time_ms": 9643.281, "load_time_ms": 1.479, "load_throughput": 2434656.218, "learn_time_ms": 93.191, "learn_throughput": 38630.318, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 5408880, "num_env_steps_trained": 5408880, "num_agent_steps_sampled": 5408880, "num_agent_steps_trained": 5408880}, "done": false, "episodes_total": 1295, "training_iteration": 634, "trial_id": "ee88a_00000", "date": "2023-07-25_04-03-27", "timestamp": 1690247007, "time_this_iter_s": 19.605411052703857, "time_total_s": 11031.911113739014, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 907.1086361408234, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.99642857142857, "ram_util_percent": 76.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.107407407407409e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -926.7007282802036, "policy_loss": -3.893817087137812e+16, "vf_loss": 45297817.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5180.5, "diff_num_grad_updates_vs_sampler_policy": 5179.5}}, "num_env_steps_sampled": 5416080, "num_env_steps_trained": 5416080, "num_agent_steps_sampled": 5416080, "num_agent_steps_trained": 5416080}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33455.842502326195, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8773339338122079, "mean_inference_ms": 0.37033099119271573, "mean_action_processing_ms": 0.09216071540806722, "mean_env_wait_ms": 1.4620963830380218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035268004222582744, "StateBufferConnector_ms": 0.00263208984046854, "ViewRequirementAgentConnector_ms": 0.06654313815537319}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35498.49082086122, "episode_reward_mean": -33455.842502326195, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8773339338122079, "mean_inference_ms": 0.37033099119271573, "mean_action_processing_ms": 0.09216071540806722, "mean_env_wait_ms": 1.4620963830380218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035268004222582744, "StateBufferConnector_ms": 0.00263208984046854, "ViewRequirementAgentConnector_ms": 0.06654313815537319}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5416080, "num_agent_steps_trained": 5416080, "num_env_steps_sampled": 5416080, "num_env_steps_trained": 5416080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.6264405632532, "num_env_steps_trained_throughput_per_sec": 369.6264405632532, "timesteps_total": 5416080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5416080, "timers": {"training_iteration_time_ms": 9744.406, "sample_time_ms": 9648.599, "load_time_ms": 1.48, "load_throughput": 2431754.691, "learn_time_ms": 93.456, "learn_throughput": 38520.995, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 5416080, "num_env_steps_trained": 5416080, "num_agent_steps_sampled": 5416080, "num_agent_steps_trained": 5416080}, "done": false, "episodes_total": 1297, "training_iteration": 635, "trial_id": "ee88a_00000", "date": "2023-07-25_04-03-46", "timestamp": 1690247026, "time_this_iter_s": 19.482080936431885, "time_total_s": 11051.393194675446, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 926.5907170772552, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 21.98214285714286, "ram_util_percent": 76.03214285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.774074074074075e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -925.9513222830636, "policy_loss": -4.430059884701915e+16, "vf_loss": 46488496.35714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5292.5, "diff_num_grad_updates_vs_sampler_policy": 5291.5}}, "num_env_steps_sampled": 5423280, "num_env_steps_trained": 5423280, "num_agent_steps_sampled": 5423280, "num_agent_steps_trained": 5423280}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35510.45139526488, "episode_reward_mean": -33495.987876616244, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8775710839809479, "mean_inference_ms": 0.3703196208185166, "mean_action_processing_ms": 0.09215724947485703, "mean_env_wait_ms": 1.460126953844573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517803392912212, "StateBufferConnector_ms": 0.002634901749460321, "ViewRequirementAgentConnector_ms": 0.06653610028718647}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35510.45139526488, "episode_reward_mean": -33495.987876616244, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8775710839809479, "mean_inference_ms": 0.3703196208185166, "mean_action_processing_ms": 0.09215724947485703, "mean_env_wait_ms": 1.460126953844573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517803392912212, "StateBufferConnector_ms": 0.002634901749460321, "ViewRequirementAgentConnector_ms": 0.06653610028718647}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5423280, "num_agent_steps_trained": 5423280, "num_env_steps_sampled": 5423280, "num_env_steps_trained": 5423280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.6715579602989, "num_env_steps_trained_throughput_per_sec": 370.6715579602989, "timesteps_total": 5423280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5423280, "timers": {"training_iteration_time_ms": 9755.693, "sample_time_ms": 9660.162, "load_time_ms": 1.444, "load_throughput": 2492406.061, "learn_time_ms": 93.219, "learn_throughput": 38618.778, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 5423280, "num_env_steps_trained": 5423280, "num_agent_steps_sampled": 5423280, "num_agent_steps_trained": 5423280}, "done": false, "episodes_total": 1299, "training_iteration": 636, "trial_id": "ee88a_00000", "date": "2023-07-25_04-04-06", "timestamp": 1690247046, "time_this_iter_s": 19.42742419242859, "time_total_s": 11070.820618867874, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 946.0181412696838, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 22.088888888888892, "ram_util_percent": 76.14444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.440740740740743e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -926.9071742466518, "policy_loss": -4.241673605115531e+16, "vf_loss": 46258703.821428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5404.5, "diff_num_grad_updates_vs_sampler_policy": 5403.5}}, "num_env_steps_sampled": 5430480, "num_env_steps_trained": 5430480, "num_agent_steps_sampled": 5430480, "num_agent_steps_trained": 5430480}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35510.45139526488, "episode_reward_mean": -33533.95821648382, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8778046084047674, "mean_inference_ms": 0.3703094571060989, "mean_action_processing_ms": 0.09215400316473396, "mean_env_wait_ms": 1.4581992512532411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035128642603294135, "StateBufferConnector_ms": 0.0026351397799462386, "ViewRequirementAgentConnector_ms": 0.0665082144983036}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35510.45139526488, "episode_reward_mean": -33533.95821648382, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8778046084047674, "mean_inference_ms": 0.3703094571060989, "mean_action_processing_ms": 0.09215400316473396, "mean_env_wait_ms": 1.4581992512532411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035128642603294135, "StateBufferConnector_ms": 0.0026351397799462386, "ViewRequirementAgentConnector_ms": 0.0665082144983036}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5430480, "num_agent_steps_trained": 5430480, "num_env_steps_sampled": 5430480, "num_env_steps_trained": 5430480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.8869013180827, "num_env_steps_trained_throughput_per_sec": 371.8869013180827, "timesteps_total": 5430480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5430480, "timers": {"training_iteration_time_ms": 9742.36, "sample_time_ms": 9647.488, "load_time_ms": 1.469, "load_throughput": 2451057.464, "learn_time_ms": 92.533, "learn_throughput": 38904.872, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 5430480, "num_env_steps_trained": 5430480, "num_agent_steps_sampled": 5430480, "num_agent_steps_trained": 5430480}, "done": false, "episodes_total": 1301, "training_iteration": 637, "trial_id": "ee88a_00000", "date": "2023-07-25_04-04-25", "timestamp": 1690247065, "time_this_iter_s": 19.363707065582275, "time_total_s": 11090.184325933456, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 965.3818483352661, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 22.753571428571426, "ram_util_percent": 76.10714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.107407407407407e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -927.8686022077288, "policy_loss": -3.379726397494546e+16, "vf_loss": 45950347.196428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5516.5, "diff_num_grad_updates_vs_sampler_policy": 5515.5}}, "num_env_steps_sampled": 5437680, "num_env_steps_trained": 5437680, "num_agent_steps_sampled": 5437680, "num_agent_steps_trained": 5437680}, "sampler_results": {"episode_reward_max": -27049.628746857496, "episode_reward_min": -35510.45139526488, "episode_reward_mean": -33570.68765033795, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8780340318506475, "mean_inference_ms": 0.37030020658361495, "mean_action_processing_ms": 0.09215093992691992, "mean_env_wait_ms": 1.4563096127968143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505475593335701, "StateBufferConnector_ms": 0.0026389805957524465, "ViewRequirementAgentConnector_ms": 0.06653154739225754}}, "episode_reward_max": -27049.628746857496, "episode_reward_min": -35510.45139526488, "episode_reward_mean": -33570.68765033795, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27049.628746857496, -29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8780340318506475, "mean_inference_ms": 0.37030020658361495, "mean_action_processing_ms": 0.09215093992691992, "mean_env_wait_ms": 1.4563096127968143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505475593335701, "StateBufferConnector_ms": 0.0026389805957524465, "ViewRequirementAgentConnector_ms": 0.06653154739225754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5437680, "num_agent_steps_trained": 5437680, "num_env_steps_sampled": 5437680, "num_env_steps_trained": 5437680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 373.0115201672096, "num_env_steps_trained_throughput_per_sec": 373.0115201672096, "timesteps_total": 5437680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5437680, "timers": {"training_iteration_time_ms": 9716.88, "sample_time_ms": 9621.622, "load_time_ms": 1.482, "load_throughput": 2429563.533, "learn_time_ms": 92.91, "learn_throughput": 38747.213, "synch_weights_time_ms": 0.81}, "counters": {"num_env_steps_sampled": 5437680, "num_env_steps_trained": 5437680, "num_agent_steps_sampled": 5437680, "num_agent_steps_trained": 5437680}, "done": false, "episodes_total": 1303, "training_iteration": 638, "trial_id": "ee88a_00000", "date": "2023-07-25_04-04-44", "timestamp": 1690247084, "time_this_iter_s": 19.30533194541931, "time_total_s": 11109.489657878876, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 984.6871802806854, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 21.86296296296297, "ram_util_percent": 75.57407407407406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.774074074074074e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -928.8647319248745, "policy_loss": -3.2938595247601976e+16, "vf_loss": 46224081.78571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5628.5, "diff_num_grad_updates_vs_sampler_policy": 5627.5}}, "num_env_steps_sampled": 5444880, "num_env_steps_trained": 5444880, "num_agent_steps_sampled": 5444880, "num_agent_steps_trained": 5444880}, "sampler_results": {"episode_reward_max": -29949.19476337792, "episode_reward_min": -35510.45139526488, "episode_reward_mean": -33671.67729839453, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8784192733337894, "mean_inference_ms": 0.3702019533875692, "mean_action_processing_ms": 0.09213077447742851, "mean_env_wait_ms": 1.4455838510111072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035042762756347656, "StateBufferConnector_ms": 0.002637147903442383, "ViewRequirementAgentConnector_ms": 0.06652569770812988}}, "episode_reward_max": -29949.19476337792, "episode_reward_min": -35510.45139526488, "episode_reward_mean": -33671.67729839453, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29949.19476337792, -30406.81976933798, -30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8784192733337894, "mean_inference_ms": 0.3702019533875692, "mean_action_processing_ms": 0.09213077447742851, "mean_env_wait_ms": 1.4455838510111072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035042762756347656, "StateBufferConnector_ms": 0.002637147903442383, "ViewRequirementAgentConnector_ms": 0.06652569770812988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5444880, "num_agent_steps_trained": 5444880, "num_env_steps_sampled": 5444880, "num_env_steps_trained": 5444880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.49241366662704, "num_env_steps_trained_throughput_per_sec": 372.49241366662704, "timesteps_total": 5444880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5444880, "timers": {"training_iteration_time_ms": 9689.548, "sample_time_ms": 9594.367, "load_time_ms": 1.504, "load_throughput": 2393591.681, "learn_time_ms": 92.81, "learn_throughput": 38788.869, "synch_weights_time_ms": 0.809}, "counters": {"num_env_steps_sampled": 5444880, "num_env_steps_trained": 5444880, "num_agent_steps_sampled": 5444880, "num_agent_steps_trained": 5444880}, "done": false, "episodes_total": 1305, "training_iteration": 639, "trial_id": "ee88a_00000", "date": "2023-07-25_04-05-04", "timestamp": 1690247104, "time_this_iter_s": 19.332237005233765, "time_total_s": 11128.82189488411, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1004.0194172859192, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 21.825925925925926, "ram_util_percent": 75.78888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.440740740740741e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -929.7166769845145, "policy_loss": -3.3031137276258916e+16, "vf_loss": 46739725.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5740.5, "diff_num_grad_updates_vs_sampler_policy": 5739.5}}, "num_env_steps_sampled": 5452080, "num_env_steps_trained": 5452080, "num_agent_steps_sampled": 5452080, "num_agent_steps_trained": 5452080}, "sampler_results": {"episode_reward_max": -30258.184830777547, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -33779.23934121248, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.878544109370762, "mean_inference_ms": 0.3700974108330125, "mean_action_processing_ms": 0.09211119355564978, "mean_env_wait_ms": 1.4362428513186012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035011768341064453, "StateBufferConnector_ms": 0.0026361942291259766, "ViewRequirementAgentConnector_ms": 0.0665128231048584}}, "episode_reward_max": -30258.184830777547, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -33779.23934121248, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30412.466815611497, -30616.36750597898, -30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.878544109370762, "mean_inference_ms": 0.3700974108330125, "mean_action_processing_ms": 0.09211119355564978, "mean_env_wait_ms": 1.4362428513186012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035011768341064453, "StateBufferConnector_ms": 0.0026361942291259766, "ViewRequirementAgentConnector_ms": 0.0665128231048584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5452080, "num_agent_steps_trained": 5452080, "num_env_steps_sampled": 5452080, "num_env_steps_trained": 5452080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.04931499463373, "num_env_steps_trained_throughput_per_sec": 368.04931499463373, "timesteps_total": 5452080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5452080, "timers": {"training_iteration_time_ms": 9697.895, "sample_time_ms": 9602.729, "load_time_ms": 1.482, "load_throughput": 2429250.833, "learn_time_ms": 92.819, "learn_throughput": 38785.243, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 5452080, "num_env_steps_trained": 5452080, "num_agent_steps_sampled": 5452080, "num_agent_steps_trained": 5452080}, "done": false, "episodes_total": 1307, "training_iteration": 640, "trial_id": "ee88a_00000", "date": "2023-07-25_04-05-23", "timestamp": 1690247123, "time_this_iter_s": 19.565541982650757, "time_total_s": 11148.38743686676, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1023.58495926857, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 21.203571428571426, "ram_util_percent": 76.01071428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.107407407407408e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -928.2898657662528, "policy_loss": -2.74780916122677e+16, "vf_loss": 46036280.98214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5852.5, "diff_num_grad_updates_vs_sampler_policy": 5851.5}}, "num_env_steps_sampled": 5459280, "num_env_steps_trained": 5459280, "num_agent_steps_sampled": 5459280, "num_agent_steps_trained": 5459280}, "sampler_results": {"episode_reward_max": -30258.184830777547, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -33875.16460160626, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8784753269425639, "mean_inference_ms": 0.3700212200958153, "mean_action_processing_ms": 0.09209771425741514, "mean_env_wait_ms": 1.4302850625335197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498077392578125, "StateBufferConnector_ms": 0.0026369094848632812, "ViewRequirementAgentConnector_ms": 0.06649899482727051}}, "episode_reward_max": -30258.184830777547, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -33875.16460160626, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30596.864676493213, -30258.184830777547, -30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8784753269425639, "mean_inference_ms": 0.3700212200958153, "mean_action_processing_ms": 0.09209771425741514, "mean_env_wait_ms": 1.4302850625335197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498077392578125, "StateBufferConnector_ms": 0.0026369094848632812, "ViewRequirementAgentConnector_ms": 0.06649899482727051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5459280, "num_agent_steps_trained": 5459280, "num_env_steps_sampled": 5459280, "num_env_steps_trained": 5459280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.1132217770364, "num_env_steps_trained_throughput_per_sec": 372.1132217770364, "timesteps_total": 5459280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5459280, "timers": {"training_iteration_time_ms": 9690.371, "sample_time_ms": 9595.779, "load_time_ms": 1.485, "load_throughput": 2423986.13, "learn_time_ms": 92.247, "learn_throughput": 39025.655, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 5459280, "num_env_steps_trained": 5459280, "num_agent_steps_sampled": 5459280, "num_agent_steps_trained": 5459280}, "done": false, "episodes_total": 1309, "training_iteration": 641, "trial_id": "ee88a_00000", "date": "2023-07-25_04-05-43", "timestamp": 1690247143, "time_this_iter_s": 19.351964235305786, "time_total_s": 11167.739401102066, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1042.9369235038757, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 22.18888888888889, "ram_util_percent": 76.26296296296296}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.774074074074075e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -928.6428887503488, "policy_loss": -2.7369499059304492e+16, "vf_loss": 45642051.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5964.5, "diff_num_grad_updates_vs_sampler_policy": 5963.5}}, "num_env_steps_sampled": 5466480, "num_env_steps_trained": 5466480, "num_agent_steps_sampled": 5466480, "num_agent_steps_trained": 5466480}, "sampler_results": {"episode_reward_max": -30540.017387560172, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -33968.32229892249, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8785119969402493, "mean_inference_ms": 0.36997202138703356, "mean_action_processing_ms": 0.09208833290878779, "mean_env_wait_ms": 1.4254923279582514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034952163696289062, "StateBufferConnector_ms": 0.0026302337646484375, "ViewRequirementAgentConnector_ms": 0.06644392013549805}}, "episode_reward_max": -30540.017387560172, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -33968.32229892249, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30655.73632736621, -30540.017387560172, -30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8785119969402493, "mean_inference_ms": 0.36997202138703356, "mean_action_processing_ms": 0.09208833290878779, "mean_env_wait_ms": 1.4254923279582514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034952163696289062, "StateBufferConnector_ms": 0.0026302337646484375, "ViewRequirementAgentConnector_ms": 0.06644392013549805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5466480, "num_agent_steps_trained": 5466480, "num_env_steps_sampled": 5466480, "num_env_steps_trained": 5466480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.8930899043747, "num_env_steps_trained_throughput_per_sec": 367.8930899043747, "timesteps_total": 5466480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5466480, "timers": {"training_iteration_time_ms": 9711.388, "sample_time_ms": 9617.074, "load_time_ms": 1.418, "load_throughput": 2539010.325, "learn_time_ms": 92.049, "learn_throughput": 39109.502, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 5466480, "num_env_steps_trained": 5466480, "num_agent_steps_sampled": 5466480, "num_agent_steps_trained": 5466480}, "done": false, "episodes_total": 1311, "training_iteration": 642, "trial_id": "ee88a_00000", "date": "2023-07-25_04-06-02", "timestamp": 1690247162, "time_this_iter_s": 19.57378602027893, "time_total_s": 11187.313187122345, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1062.5107095241547, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 20.599999999999998, "ram_util_percent": 76.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.440740740740741e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -929.466552734375, "policy_loss": -2.3373493246698532e+16, "vf_loss": 46085121.21428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6076.5, "diff_num_grad_updates_vs_sampler_policy": 6075.5}}, "num_env_steps_sampled": 5473680, "num_env_steps_trained": 5473680, "num_agent_steps_sampled": 5473680, "num_agent_steps_trained": 5473680}, "sampler_results": {"episode_reward_max": -30576.080605278035, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34057.27017976608, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.878660573367971, "mean_inference_ms": 0.3699378497792472, "mean_action_processing_ms": 0.09208098725886138, "mean_env_wait_ms": 1.4212899074838532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484964370727539, "StateBufferConnector_ms": 0.0026340484619140625, "ViewRequirementAgentConnector_ms": 0.06643986701965332}}, "episode_reward_max": -30576.080605278035, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34057.27017976608, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30576.080605278035, -31106.9746160766, -31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.878660573367971, "mean_inference_ms": 0.3699378497792472, "mean_action_processing_ms": 0.09208098725886138, "mean_env_wait_ms": 1.4212899074838532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484964370727539, "StateBufferConnector_ms": 0.0026340484619140625, "ViewRequirementAgentConnector_ms": 0.06643986701965332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5473680, "num_agent_steps_trained": 5473680, "num_env_steps_sampled": 5473680, "num_env_steps_trained": 5473680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.59616957321424, "num_env_steps_trained_throughput_per_sec": 367.59616957321424, "timesteps_total": 5473680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5473680, "timers": {"training_iteration_time_ms": 9739.825, "sample_time_ms": 9645.439, "load_time_ms": 1.431, "load_throughput": 2515324.738, "learn_time_ms": 92.093, "learn_throughput": 39090.994, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 5473680, "num_env_steps_trained": 5473680, "num_agent_steps_sampled": 5473680, "num_agent_steps_trained": 5473680}, "done": false, "episodes_total": 1313, "training_iteration": 643, "trial_id": "ee88a_00000", "date": "2023-07-25_04-06-22", "timestamp": 1690247182, "time_this_iter_s": 19.589745044708252, "time_total_s": 11206.902932167053, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1082.100454568863, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 21.77142857142857, "ram_util_percent": 76.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.107407407407408e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -930.2427248273577, "policy_loss": -2.1865109089020372e+16, "vf_loss": 45658577.83928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6188.5, "diff_num_grad_updates_vs_sampler_policy": 6187.5}}, "num_env_steps_sampled": 5480880, "num_env_steps_trained": 5480880, "num_agent_steps_sampled": 5480880, "num_agent_steps_trained": 5480880}, "sampler_results": {"episode_reward_max": -31122.35064254826, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34142.49989028049, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8787834465554606, "mean_inference_ms": 0.3699104424360455, "mean_action_processing_ms": 0.09207425992297409, "mean_env_wait_ms": 1.4174180786063264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034818649291992188, "StateBufferConnector_ms": 0.002639293670654297, "ViewRequirementAgentConnector_ms": 0.06645369529724121}}, "episode_reward_max": -31122.35064254826, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34142.49989028049, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31122.35064254826, -31787.520135608433, -31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8787834465554606, "mean_inference_ms": 0.3699104424360455, "mean_action_processing_ms": 0.09207425992297409, "mean_env_wait_ms": 1.4174180786063264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034818649291992188, "StateBufferConnector_ms": 0.002639293670654297, "ViewRequirementAgentConnector_ms": 0.06645369529724121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5480880, "num_agent_steps_trained": 5480880, "num_env_steps_sampled": 5480880, "num_env_steps_trained": 5480880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.6229413169857, "num_env_steps_trained_throughput_per_sec": 370.6229413169857, "timesteps_total": 5480880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5480880, "timers": {"training_iteration_time_ms": 9749.575, "sample_time_ms": 9654.677, "load_time_ms": 1.443, "load_throughput": 2495165.562, "learn_time_ms": 92.593, "learn_throughput": 38879.738, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 5480880, "num_env_steps_trained": 5480880, "num_agent_steps_sampled": 5480880, "num_agent_steps_trained": 5480880}, "done": false, "episodes_total": 1315, "training_iteration": 644, "trial_id": "ee88a_00000", "date": "2023-07-25_04-06-41", "timestamp": 1690247201, "time_this_iter_s": 19.429682970046997, "time_total_s": 11226.3326151371, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1101.53013753891, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 21.18148148148148, "ram_util_percent": 76.37407407407409}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.774074074074075e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -931.0308205740793, "policy_loss": -2.0578045343175424e+16, "vf_loss": 45919592.53571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6300.5, "diff_num_grad_updates_vs_sampler_policy": 6299.5}}, "num_env_steps_sampled": 5488080, "num_env_steps_trained": 5488080, "num_agent_steps_sampled": 5488080, "num_agent_steps_trained": 5488080}, "sampler_results": {"episode_reward_max": -31679.22976393938, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34214.92936396564, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.878992685831826, "mean_inference_ms": 0.3698863491112161, "mean_action_processing_ms": 0.09206778865207714, "mean_env_wait_ms": 1.4139033524791587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347900390625, "StateBufferConnector_ms": 0.002639293670654297, "ViewRequirementAgentConnector_ms": 0.06644392013549805}}, "episode_reward_max": -31679.22976393938, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34214.92936396564, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31679.22976393938, -31884.086894193308, -32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.878992685831826, "mean_inference_ms": 0.3698863491112161, "mean_action_processing_ms": 0.09206778865207714, "mean_env_wait_ms": 1.4139033524791587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347900390625, "StateBufferConnector_ms": 0.002639293670654297, "ViewRequirementAgentConnector_ms": 0.06644392013549805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5488080, "num_agent_steps_trained": 5488080, "num_env_steps_sampled": 5488080, "num_env_steps_trained": 5488080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.5501571062941, "num_env_steps_trained_throughput_per_sec": 369.5501571062941, "timesteps_total": 5488080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5488080, "timers": {"training_iteration_time_ms": 9741.63, "sample_time_ms": 9646.679, "load_time_ms": 1.438, "load_throughput": 2503771.436, "learn_time_ms": 92.653, "learn_throughput": 38854.646, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 5488080, "num_env_steps_trained": 5488080, "num_agent_steps_sampled": 5488080, "num_agent_steps_trained": 5488080}, "done": false, "episodes_total": 1317, "training_iteration": 645, "trial_id": "ee88a_00000", "date": "2023-07-25_04-07-01", "timestamp": 1690247221, "time_this_iter_s": 19.4859881401062, "time_total_s": 11245.818603277206, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1121.016125679016, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 19.54642857142857, "ram_util_percent": 76.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.4407407407407404e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -931.8931405203683, "policy_loss": -1.813143438009175e+16, "vf_loss": 45756157.14285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6412.5, "diff_num_grad_updates_vs_sampler_policy": 6411.5}}, "num_env_steps_sampled": 5495280, "num_env_steps_trained": 5495280, "num_agent_steps_sampled": 5495280, "num_agent_steps_trained": 5495280}, "sampler_results": {"episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34280.06242664656, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8792636771351294, "mean_inference_ms": 0.3698510067908295, "mean_action_processing_ms": 0.09205785555715237, "mean_env_wait_ms": 1.4106578446598232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347900390625, "StateBufferConnector_ms": 0.0026404857635498047, "ViewRequirementAgentConnector_ms": 0.06642937660217285}}, "episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34280.06242664656, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32015.627245965738, -32107.08700705494, -31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8792636771351294, "mean_inference_ms": 0.3698510067908295, "mean_action_processing_ms": 0.09205785555715237, "mean_env_wait_ms": 1.4106578446598232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347900390625, "StateBufferConnector_ms": 0.0026404857635498047, "ViewRequirementAgentConnector_ms": 0.06642937660217285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5495280, "num_agent_steps_trained": 5495280, "num_env_steps_sampled": 5495280, "num_env_steps_trained": 5495280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.35580824538033, "num_env_steps_trained_throughput_per_sec": 372.35580824538033, "timesteps_total": 5495280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5495280, "timers": {"training_iteration_time_ms": 9740.369, "sample_time_ms": 9644.547, "load_time_ms": 1.492, "load_throughput": 2413139.168, "learn_time_ms": 93.46, "learn_throughput": 38518.971, "synch_weights_time_ms": 0.81}, "counters": {"num_env_steps_sampled": 5495280, "num_env_steps_trained": 5495280, "num_agent_steps_sampled": 5495280, "num_agent_steps_trained": 5495280}, "done": false, "episodes_total": 1319, "training_iteration": 646, "trial_id": "ee88a_00000", "date": "2023-07-25_04-07-20", "timestamp": 1690247240, "time_this_iter_s": 19.339493989944458, "time_total_s": 11265.15809726715, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1140.3556196689606, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 21.296296296296298, "ram_util_percent": 76.3037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1074074074074076e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -932.766363961356, "policy_loss": -1.468811087690687e+16, "vf_loss": 45159197.053571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6524.5, "diff_num_grad_updates_vs_sampler_policy": 6523.5}}, "num_env_steps_sampled": 5502480, "num_env_steps_trained": 5502480, "num_agent_steps_sampled": 5502480, "num_agent_steps_trained": 5502480}, "sampler_results": {"episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34340.228440007406, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8796240778477682, "mean_inference_ms": 0.36982157327198983, "mean_action_processing_ms": 0.09204789456022124, "mean_env_wait_ms": 1.4076946966039872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003475666046142578, "StateBufferConnector_ms": 0.0026416778564453125, "ViewRequirementAgentConnector_ms": 0.06640291213989258}}, "episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34340.228440007406, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31858.392136958446, -31907.200994063474, -31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8796240778477682, "mean_inference_ms": 0.36982157327198983, "mean_action_processing_ms": 0.09204789456022124, "mean_env_wait_ms": 1.4076946966039872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003475666046142578, "StateBufferConnector_ms": 0.0026416778564453125, "ViewRequirementAgentConnector_ms": 0.06640291213989258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5502480, "num_agent_steps_trained": 5502480, "num_env_steps_sampled": 5502480, "num_env_steps_trained": 5502480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.76323959752375, "num_env_steps_trained_throughput_per_sec": 370.76323959752375, "timesteps_total": 5502480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5502480, "timers": {"training_iteration_time_ms": 9725.218, "sample_time_ms": 9629.25, "load_time_ms": 1.511, "load_throughput": 2382337.672, "learn_time_ms": 93.552, "learn_throughput": 38481.285, "synch_weights_time_ms": 0.845}, "counters": {"num_env_steps_sampled": 5502480, "num_env_steps_trained": 5502480, "num_agent_steps_sampled": 5502480, "num_agent_steps_trained": 5502480}, "done": false, "episodes_total": 1321, "training_iteration": 647, "trial_id": "ee88a_00000", "date": "2023-07-25_04-07-40", "timestamp": 1690247260, "time_this_iter_s": 19.422395944595337, "time_total_s": 11284.580493211746, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1159.778015613556, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 21.482142857142854, "ram_util_percent": 76.37500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.7740740740740743e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -933.5014659336636, "policy_loss": -1.2687266695100478e+16, "vf_loss": 45541738.875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6636.5, "diff_num_grad_updates_vs_sampler_policy": 6635.5}}, "num_env_steps_sampled": 5509680, "num_env_steps_trained": 5509680, "num_agent_steps_sampled": 5509680, "num_agent_steps_trained": 5509680}, "sampler_results": {"episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34402.31745165509, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8799973969372996, "mean_inference_ms": 0.36979906597888873, "mean_action_processing_ms": 0.09203939010452941, "mean_env_wait_ms": 1.4048194130401617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034749507904052734, "StateBufferConnector_ms": 0.002638101577758789, "ViewRequirementAgentConnector_ms": 0.06638956069946289}}, "episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34402.31745165509, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31864.617770268378, -32038.695728608633, -31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8799973969372996, "mean_inference_ms": 0.36979906597888873, "mean_action_processing_ms": 0.09203939010452941, "mean_env_wait_ms": 1.4048194130401617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034749507904052734, "StateBufferConnector_ms": 0.002638101577758789, "ViewRequirementAgentConnector_ms": 0.06638956069946289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5509680, "num_agent_steps_trained": 5509680, "num_env_steps_sampled": 5509680, "num_env_steps_trained": 5509680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.10887009437124, "num_env_steps_trained_throughput_per_sec": 369.10887009437124, "timesteps_total": 5509680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5509680, "timers": {"training_iteration_time_ms": 9717.191, "sample_time_ms": 9621.721, "load_time_ms": 1.548, "load_throughput": 2325467.712, "learn_time_ms": 93.02, "learn_throughput": 38701.152, "synch_weights_time_ms": 0.839}, "counters": {"num_env_steps_sampled": 5509680, "num_env_steps_trained": 5509680, "num_agent_steps_sampled": 5509680, "num_agent_steps_trained": 5509680}, "done": false, "episodes_total": 1323, "training_iteration": 648, "trial_id": "ee88a_00000", "date": "2023-07-25_04-07-59", "timestamp": 1690247279, "time_this_iter_s": 19.509317874908447, "time_total_s": 11304.089811086655, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1179.2873334884644, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 21.064285714285713, "ram_util_percent": 76.36428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.464444444444445e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -934.2004699707031, "policy_loss": -1.1857749013305578e+16, "vf_loss": 45080259.78571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6748.5, "diff_num_grad_updates_vs_sampler_policy": 6747.5}}, "num_env_steps_sampled": 5516880, "num_env_steps_trained": 5516880, "num_agent_steps_sampled": 5516880, "num_agent_steps_trained": 5516880}, "sampler_results": {"episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34464.5039766318, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8804419839038751, "mean_inference_ms": 0.36978549281974665, "mean_action_processing_ms": 0.09203324499656955, "mean_env_wait_ms": 1.4021097516434682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473520278930664, "StateBufferConnector_ms": 0.002641439437866211, "ViewRequirementAgentConnector_ms": 0.06638026237487793}}, "episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34464.5039766318, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31783.757058476913, -32092.801118844385, -31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8804419839038751, "mean_inference_ms": 0.36978549281974665, "mean_action_processing_ms": 0.09203324499656955, "mean_env_wait_ms": 1.4021097516434682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473520278930664, "StateBufferConnector_ms": 0.002641439437866211, "ViewRequirementAgentConnector_ms": 0.06638026237487793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5516880, "num_agent_steps_trained": 5516880, "num_env_steps_sampled": 5516880, "num_env_steps_trained": 5516880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.66585433343374, "num_env_steps_trained_throughput_per_sec": 369.66585433343374, "timesteps_total": 5516880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5516880, "timers": {"training_iteration_time_ms": 9722.22, "sample_time_ms": 9626.461, "load_time_ms": 1.551, "load_throughput": 2321035.186, "learn_time_ms": 93.308, "learn_throughput": 38582.07, "synch_weights_time_ms": 0.841}, "counters": {"num_env_steps_sampled": 5516880, "num_env_steps_trained": 5516880, "num_agent_steps_sampled": 5516880, "num_agent_steps_trained": 5516880}, "done": false, "episodes_total": 1325, "training_iteration": 649, "trial_id": "ee88a_00000", "date": "2023-07-25_04-08-19", "timestamp": 1690247299, "time_this_iter_s": 19.47990608215332, "time_total_s": 11323.569717168808, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1198.7672395706177, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 26.662962962962965, "ram_util_percent": 76.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2644444444444443e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -934.9960447038923, "policy_loss": -9953656369373670.0, "vf_loss": 46261150.178571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6860.5, "diff_num_grad_updates_vs_sampler_policy": 6859.5}}, "num_env_steps_sampled": 5524080, "num_env_steps_trained": 5524080, "num_agent_steps_sampled": 5524080, "num_agent_steps_trained": 5524080}, "sampler_results": {"episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34529.38633315919, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8809068891047097, "mean_inference_ms": 0.3697746664596218, "mean_action_processing_ms": 0.09202753083569341, "mean_env_wait_ms": 1.399460994317244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003469705581665039, "StateBufferConnector_ms": 0.0026450157165527344, "ViewRequirementAgentConnector_ms": 0.06642556190490723}}, "episode_reward_max": -31757.722179431283, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34529.38633315919, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31995.923887447152, -31757.722179431283, -31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8809068891047097, "mean_inference_ms": 0.3697746664596218, "mean_action_processing_ms": 0.09202753083569341, "mean_env_wait_ms": 1.399460994317244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003469705581665039, "StateBufferConnector_ms": 0.0026450157165527344, "ViewRequirementAgentConnector_ms": 0.06642556190490723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5524080, "num_agent_steps_trained": 5524080, "num_env_steps_sampled": 5524080, "num_env_steps_trained": 5524080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.93606799834635, "num_env_steps_trained_throughput_per_sec": 370.93606799834635, "timesteps_total": 5524080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5524080, "timers": {"training_iteration_time_ms": 9714.941, "sample_time_ms": 9619.142, "load_time_ms": 1.541, "load_throughput": 2336045.052, "learn_time_ms": 93.346, "learn_throughput": 38566.195, "synch_weights_time_ms": 0.851}, "counters": {"num_env_steps_sampled": 5524080, "num_env_steps_trained": 5524080, "num_agent_steps_sampled": 5524080, "num_agent_steps_trained": 5524080}, "done": false, "episodes_total": 1327, "training_iteration": 650, "trial_id": "ee88a_00000", "date": "2023-07-25_04-08-38", "timestamp": 1690247318, "time_this_iter_s": 19.41349506378174, "time_total_s": 11342.98321223259, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1218.1807346343994, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 24.482142857142858, "ram_util_percent": 76.23571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0644444444444445e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -935.8090765816825, "policy_loss": -8585280778458018.0, "vf_loss": 45601320.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6972.5, "diff_num_grad_updates_vs_sampler_policy": 6971.5}}, "num_env_steps_sampled": 5531280, "num_env_steps_trained": 5531280, "num_agent_steps_sampled": 5531280, "num_agent_steps_trained": 5531280}, "sampler_results": {"episode_reward_max": -31943.276038688782, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34591.60751382034, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8813946682732898, "mean_inference_ms": 0.3697664448410305, "mean_action_processing_ms": 0.09202257132849773, "mean_env_wait_ms": 1.3968789764364613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034685134887695312, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.0664212703704834}}, "episode_reward_max": -31943.276038688782, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34591.60751382034, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31943.276038688782, -32938.30035097645, -33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8813946682732898, "mean_inference_ms": 0.3697664448410305, "mean_action_processing_ms": 0.09202257132849773, "mean_env_wait_ms": 1.3968789764364613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034685134887695312, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.0664212703704834}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5531280, "num_agent_steps_trained": 5531280, "num_env_steps_sampled": 5531280, "num_env_steps_trained": 5531280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.51545406680214, "num_env_steps_trained_throughput_per_sec": 370.51545406680214, "timesteps_total": 5531280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5531280, "timers": {"training_iteration_time_ms": 9724.545, "sample_time_ms": 9628.815, "load_time_ms": 1.487, "load_throughput": 2421226.432, "learn_time_ms": 93.334, "learn_throughput": 38571.288, "synch_weights_time_ms": 0.849}, "counters": {"num_env_steps_sampled": 5531280, "num_env_steps_trained": 5531280, "num_agent_steps_sampled": 5531280, "num_agent_steps_trained": 5531280}, "done": false, "episodes_total": 1329, "training_iteration": 651, "trial_id": "ee88a_00000", "date": "2023-07-25_04-08-58", "timestamp": 1690247338, "time_this_iter_s": 19.435415983200073, "time_total_s": 11362.41862821579, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1237.6161506175995, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 21.82592592592593, "ram_util_percent": 76.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8644444444444445e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -936.608266557966, "policy_loss": -7862668980790110.0, "vf_loss": 45876470.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7084.5, "diff_num_grad_updates_vs_sampler_policy": 7083.5}}, "num_env_steps_sampled": 5538480, "num_env_steps_trained": 5538480, "num_agent_steps_sampled": 5538480, "num_agent_steps_trained": 5538480}, "sampler_results": {"episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34644.157956444484, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8819241930196062, "mean_inference_ms": 0.36976255802019303, "mean_action_processing_ms": 0.09201866519657184, "mean_env_wait_ms": 1.3943881498386503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034613609313964844, "StateBufferConnector_ms": 0.002651214599609375, "ViewRequirementAgentConnector_ms": 0.06640934944152832}}, "episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34644.157956444484, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33170.44250215437, -32794.64587929836, -32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8819241930196062, "mean_inference_ms": 0.36976255802019303, "mean_action_processing_ms": 0.09201866519657184, "mean_env_wait_ms": 1.3943881498386503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034613609313964844, "StateBufferConnector_ms": 0.002651214599609375, "ViewRequirementAgentConnector_ms": 0.06640934944152832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5538480, "num_agent_steps_trained": 5538480, "num_env_steps_sampled": 5538480, "num_env_steps_trained": 5538480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.953398505062, "num_env_steps_trained_throughput_per_sec": 366.953398505062, "timesteps_total": 5538480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5538480, "timers": {"training_iteration_time_ms": 9744.708, "sample_time_ms": 9648.865, "load_time_ms": 1.471, "load_throughput": 2448037.354, "learn_time_ms": 93.489, "learn_throughput": 38507.36, "synch_weights_time_ms": 0.824}, "counters": {"num_env_steps_sampled": 5538480, "num_env_steps_trained": 5538480, "num_agent_steps_sampled": 5538480, "num_agent_steps_trained": 5538480}, "done": false, "episodes_total": 1331, "training_iteration": 652, "trial_id": "ee88a_00000", "date": "2023-07-25_04-09-17", "timestamp": 1690247357, "time_this_iter_s": 19.62379813194275, "time_total_s": 11382.042426347733, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1257.2399487495422, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 21.085714285714285, "ram_util_percent": 76.40714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6644444444444445e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -936.0344815935407, "policy_loss": -6584119106765307.0, "vf_loss": 45127367.35714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7196.5, "diff_num_grad_updates_vs_sampler_policy": 7195.5}}, "num_env_steps_sampled": 5545680, "num_env_steps_trained": 5545680, "num_agent_steps_sampled": 5545680, "num_agent_steps_trained": 5545680}, "sampler_results": {"episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34685.875058705424, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8824740231356284, "mean_inference_ms": 0.3697612624153429, "mean_action_processing_ms": 0.09201549875525923, "mean_env_wait_ms": 1.3920060778807448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459930419921875, "StateBufferConnector_ms": 0.0026497840881347656, "ViewRequirementAgentConnector_ms": 0.06640386581420898}}, "episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34685.875058705424, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32904.476285074845, -33163.85286600665, -32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8824740231356284, "mean_inference_ms": 0.3697612624153429, "mean_action_processing_ms": 0.09201549875525923, "mean_env_wait_ms": 1.3920060778807448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459930419921875, "StateBufferConnector_ms": 0.0026497840881347656, "ViewRequirementAgentConnector_ms": 0.06640386581420898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5545680, "num_agent_steps_trained": 5545680, "num_env_steps_sampled": 5545680, "num_env_steps_trained": 5545680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.1857347213095, "num_env_steps_trained_throughput_per_sec": 367.1857347213095, "timesteps_total": 5545680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5545680, "timers": {"training_iteration_time_ms": 9754.925, "sample_time_ms": 9658.715, "load_time_ms": 1.43, "load_throughput": 2518135.25, "learn_time_ms": 93.904, "learn_throughput": 38336.901, "synch_weights_time_ms": 0.817}, "counters": {"num_env_steps_sampled": 5545680, "num_env_steps_trained": 5545680, "num_agent_steps_sampled": 5545680, "num_agent_steps_trained": 5545680}, "done": false, "episodes_total": 1333, "training_iteration": 653, "trial_id": "ee88a_00000", "date": "2023-07-25_04-09-37", "timestamp": 1690247377, "time_this_iter_s": 19.611592054367065, "time_total_s": 11401.6540184021, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1276.8515408039093, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 21.178571428571427, "ram_util_percent": 76.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4644444444444445e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -936.6245269775391, "policy_loss": -5322311009627893.0, "vf_loss": 45354815.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7308.5, "diff_num_grad_updates_vs_sampler_policy": 7307.5}}, "num_env_steps_sampled": 5552880, "num_env_steps_trained": 5552880, "num_agent_steps_sampled": 5552880, "num_agent_steps_trained": 5552880}, "sampler_results": {"episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34722.17423806062, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8830263788139433, "mean_inference_ms": 0.36976319902012256, "mean_action_processing_ms": 0.09201291185768859, "mean_env_wait_ms": 1.3897230706321857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034520626068115234, "StateBufferConnector_ms": 0.0026543140411376953, "ViewRequirementAgentConnector_ms": 0.06637191772460938}}, "episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34722.17423806062, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32940.68286046272, -33010.5678515344, -33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8830263788139433, "mean_inference_ms": 0.36976319902012256, "mean_action_processing_ms": 0.09201291185768859, "mean_env_wait_ms": 1.3897230706321857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034520626068115234, "StateBufferConnector_ms": 0.0026543140411376953, "ViewRequirementAgentConnector_ms": 0.06637191772460938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5552880, "num_agent_steps_trained": 5552880, "num_env_steps_sampled": 5552880, "num_env_steps_trained": 5552880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.2804233403537, "num_env_steps_trained_throughput_per_sec": 364.2804233403537, "timesteps_total": 5552880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5552880, "timers": {"training_iteration_time_ms": 9783.72, "sample_time_ms": 9688.067, "load_time_ms": 1.441, "load_throughput": 2497518.013, "learn_time_ms": 93.334, "learn_throughput": 38571.229, "synch_weights_time_ms": 0.82}, "counters": {"num_env_steps_sampled": 5552880, "num_env_steps_trained": 5552880, "num_agent_steps_sampled": 5552880, "num_agent_steps_trained": 5552880}, "done": false, "episodes_total": 1335, "training_iteration": 654, "trial_id": "ee88a_00000", "date": "2023-07-25_04-09-57", "timestamp": 1690247397, "time_this_iter_s": 19.767938137054443, "time_total_s": 11421.421956539154, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1296.6194789409637, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 21.592857142857145, "ram_util_percent": 76.51785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2644444444444447e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -937.1869855608259, "policy_loss": -4293708283696962.5, "vf_loss": 44918093.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7420.5, "diff_num_grad_updates_vs_sampler_policy": 7419.5}}, "num_env_steps_sampled": 5560080, "num_env_steps_trained": 5560080, "num_agent_steps_sampled": 5560080, "num_agent_steps_trained": 5560080}, "sampler_results": {"episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34758.80406901075, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8835776424784637, "mean_inference_ms": 0.36976765287642865, "mean_action_processing_ms": 0.09201084552994039, "mean_env_wait_ms": 1.387512520463555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448486328125, "StateBufferConnector_ms": 0.0026471614837646484, "ViewRequirementAgentConnector_ms": 0.06633973121643066}}, "episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34758.80406901075, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33033.97236093366, -32954.68170657696, -32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8835776424784637, "mean_inference_ms": 0.36976765287642865, "mean_action_processing_ms": 0.09201084552994039, "mean_env_wait_ms": 1.387512520463555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448486328125, "StateBufferConnector_ms": 0.0026471614837646484, "ViewRequirementAgentConnector_ms": 0.06633973121643066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5560080, "num_agent_steps_trained": 5560080, "num_env_steps_sampled": 5560080, "num_env_steps_trained": 5560080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 365.3877722880393, "num_env_steps_trained_throughput_per_sec": 365.3877722880393, "timesteps_total": 5560080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5560080, "timers": {"training_iteration_time_ms": 9813.194, "sample_time_ms": 9717.613, "load_time_ms": 1.445, "load_throughput": 2491460.177, "learn_time_ms": 93.263, "learn_throughput": 38600.475, "synch_weights_time_ms": 0.816}, "counters": {"num_env_steps_sampled": 5560080, "num_env_steps_trained": 5560080, "num_agent_steps_sampled": 5560080, "num_agent_steps_trained": 5560080}, "done": false, "episodes_total": 1337, "training_iteration": 655, "trial_id": "ee88a_00000", "date": "2023-07-25_04-10-17", "timestamp": 1690247417, "time_this_iter_s": 19.708048343658447, "time_total_s": 11441.130004882812, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1316.3275272846222, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 22.467857142857138, "ram_util_percent": 76.46428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0644444444444445e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": -936.9584350585938, "policy_loss": -3403849696775497.5, "vf_loss": 45545655.28571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7532.5, "diff_num_grad_updates_vs_sampler_policy": 7531.5}}, "num_env_steps_sampled": 5567280, "num_env_steps_trained": 5567280, "num_agent_steps_sampled": 5567280, "num_agent_steps_trained": 5567280}, "sampler_results": {"episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34796.594927556536, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8841201761053713, "mean_inference_ms": 0.369772170694357, "mean_action_processing_ms": 0.09200902859130157, "mean_env_wait_ms": 1.3853663895156658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003446817398071289, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.06635355949401855}}, "episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34796.594927556536, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32992.93962425777, -33211.914060907926, -33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8841201761053713, "mean_inference_ms": 0.369772170694357, "mean_action_processing_ms": 0.09200902859130157, "mean_env_wait_ms": 1.3853663895156658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003446817398071289, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.06635355949401855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5567280, "num_agent_steps_trained": 5567280, "num_env_steps_sampled": 5567280, "num_env_steps_trained": 5567280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.0225145563362, "num_env_steps_trained_throughput_per_sec": 366.0225145563362, "timesteps_total": 5567280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5567280, "timers": {"training_iteration_time_ms": 9837.047, "sample_time_ms": 9741.541, "load_time_ms": 1.472, "load_throughput": 2444945.497, "learn_time_ms": 93.164, "learn_throughput": 38641.411, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 5567280, "num_env_steps_trained": 5567280, "num_agent_steps_sampled": 5567280, "num_agent_steps_trained": 5567280}, "done": false, "episodes_total": 1339, "training_iteration": 656, "trial_id": "ee88a_00000", "date": "2023-07-25_04-10-36", "timestamp": 1690247436, "time_this_iter_s": 19.673918962478638, "time_total_s": 11460.803923845291, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1336.0014462471008, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 21.574999999999996, "ram_util_percent": 76.56785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.774074074074074e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -937.2518375941685, "policy_loss": -3078789193178544.0, "vf_loss": 45891322.35714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7644.5, "diff_num_grad_updates_vs_sampler_policy": 7643.5}}, "num_env_steps_sampled": 5574480, "num_env_steps_trained": 5574480, "num_agent_steps_sampled": 5574480, "num_agent_steps_trained": 5574480}, "sampler_results": {"episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34836.55951217658, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8846453159893961, "mean_inference_ms": 0.36977904095716063, "mean_action_processing_ms": 0.09200775578611615, "mean_env_wait_ms": 1.383289062280741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034432411193847656, "StateBufferConnector_ms": 0.002655506134033203, "ViewRequirementAgentConnector_ms": 0.06633996963500977}}, "episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34836.55951217658, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33066.62533148651, -33294.34805752734, -33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8846453159893961, "mean_inference_ms": 0.36977904095716063, "mean_action_processing_ms": 0.09200775578611615, "mean_env_wait_ms": 1.383289062280741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034432411193847656, "StateBufferConnector_ms": 0.002655506134033203, "ViewRequirementAgentConnector_ms": 0.06633996963500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5574480, "num_agent_steps_trained": 5574480, "num_env_steps_sampled": 5574480, "num_env_steps_trained": 5574480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.68239471327104, "num_env_steps_trained_throughput_per_sec": 364.68239471327104, "timesteps_total": 5574480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5574480, "timers": {"training_iteration_time_ms": 9849.266, "sample_time_ms": 9753.637, "load_time_ms": 1.491, "load_throughput": 2415223.52, "learn_time_ms": 93.266, "learn_throughput": 38599.449, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 5574480, "num_env_steps_trained": 5574480, "num_agent_steps_sampled": 5574480, "num_agent_steps_trained": 5574480}, "done": false, "episodes_total": 1341, "training_iteration": 657, "trial_id": "ee88a_00000", "date": "2023-07-25_04-10-56", "timestamp": 1690247456, "time_this_iter_s": 19.746075868606567, "time_total_s": 11480.549999713898, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1355.7475221157074, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 22.267857142857142, "ram_util_percent": 76.25357142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.440740740740738e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -937.6950204031808, "policy_loss": -2494595631075982.5, "vf_loss": 45102071.78571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7756.5, "diff_num_grad_updates_vs_sampler_policy": 7755.5}}, "num_env_steps_sampled": 5581680, "num_env_steps_trained": 5581680, "num_agent_steps_sampled": 5581680, "num_agent_steps_trained": 5581680}, "sampler_results": {"episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34872.842217605066, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8851553557557744, "mean_inference_ms": 0.3697887304819874, "mean_action_processing_ms": 0.09200708829615913, "mean_env_wait_ms": 1.3812855241433641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034475326538085938, "StateBufferConnector_ms": 0.002660989761352539, "ViewRequirementAgentConnector_ms": 0.06644558906555176}}, "episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34872.842217605066, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33074.47469074783, -32960.09762947191, -32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8851553557557744, "mean_inference_ms": 0.3697887304819874, "mean_action_processing_ms": 0.09200708829615913, "mean_env_wait_ms": 1.3812855241433641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034475326538085938, "StateBufferConnector_ms": 0.002660989761352539, "ViewRequirementAgentConnector_ms": 0.06644558906555176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5581680, "num_agent_steps_trained": 5581680, "num_env_steps_sampled": 5581680, "num_env_steps_trained": 5581680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.3773870710651, "num_env_steps_trained_throughput_per_sec": 366.3773870710651, "timesteps_total": 5581680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5581680, "timers": {"training_iteration_time_ms": 9853.591, "sample_time_ms": 9758.026, "load_time_ms": 1.488, "load_throughput": 2418899.188, "learn_time_ms": 93.194, "learn_throughput": 38628.925, "synch_weights_time_ms": 0.825}, "counters": {"num_env_steps_sampled": 5581680, "num_env_steps_trained": 5581680, "num_agent_steps_sampled": 5581680, "num_agent_steps_trained": 5581680}, "done": false, "episodes_total": 1343, "training_iteration": 658, "trial_id": "ee88a_00000", "date": "2023-07-25_04-11-16", "timestamp": 1690247476, "time_this_iter_s": 19.654876232147217, "time_total_s": 11500.204875946045, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1375.4023983478546, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 21.625, "ram_util_percent": 76.15357142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.107407407407408e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -938.1129771641323, "policy_loss": -2469895458015151.0, "vf_loss": 45855023.821428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7868.5, "diff_num_grad_updates_vs_sampler_policy": 7867.5}}, "num_env_steps_sampled": 5588880, "num_env_steps_trained": 5588880, "num_agent_steps_sampled": 5588880, "num_agent_steps_trained": 5588880}, "sampler_results": {"episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34915.35778709458, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8856519423294995, "mean_inference_ms": 0.36979892614535687, "mean_action_processing_ms": 0.09200666358292406, "mean_env_wait_ms": 1.3793332804101026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034482479095458984, "StateBufferConnector_ms": 0.002655506134033203, "ViewRequirementAgentConnector_ms": 0.06644082069396973}}, "episode_reward_max": -32791.33437133164, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34915.35778709458, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32883.67760021341, -32791.33437133164, -32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8856519423294995, "mean_inference_ms": 0.36979892614535687, "mean_action_processing_ms": 0.09200666358292406, "mean_env_wait_ms": 1.3793332804101026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034482479095458984, "StateBufferConnector_ms": 0.002655506134033203, "ViewRequirementAgentConnector_ms": 0.06644082069396973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5588880, "num_agent_steps_trained": 5588880, "num_env_steps_sampled": 5588880, "num_env_steps_trained": 5588880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.2596520533228, "num_env_steps_trained_throughput_per_sec": 366.2596520533228, "timesteps_total": 5588880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5588880, "timers": {"training_iteration_time_ms": 9842.91, "sample_time_ms": 9747.711, "load_time_ms": 1.439, "load_throughput": 2502443.594, "learn_time_ms": 92.88, "learn_throughput": 38759.606, "synch_weights_time_ms": 0.823}, "counters": {"num_env_steps_sampled": 5588880, "num_env_steps_trained": 5588880, "num_agent_steps_sampled": 5588880, "num_agent_steps_trained": 5588880}, "done": false, "episodes_total": 1345, "training_iteration": 659, "trial_id": "ee88a_00000", "date": "2023-07-25_04-11-35", "timestamp": 1690247495, "time_this_iter_s": 19.661192893981934, "time_total_s": 11519.866068840027, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1395.0635912418365, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 20.892592592592592, "ram_util_percent": 76.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.774074074074074e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -938.5086920601981, "policy_loss": -2218197922054858.2, "vf_loss": 45215583.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7980.5, "diff_num_grad_updates_vs_sampler_policy": 7979.5}}, "num_env_steps_sampled": 5596080, "num_env_steps_trained": 5596080, "num_agent_steps_sampled": 5596080, "num_agent_steps_trained": 5596080}, "sampler_results": {"episode_reward_max": -32886.96251424698, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34958.2203283024, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.886119023362041, "mean_inference_ms": 0.3698093089197947, "mean_action_processing_ms": 0.09200620780037713, "mean_env_wait_ms": 1.3774274073865842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034494400024414062, "StateBufferConnector_ms": 0.002657175064086914, "ViewRequirementAgentConnector_ms": 0.06646418571472168}}, "episode_reward_max": -32886.96251424698, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34958.2203283024, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32886.96251424698, -33110.698214794684, -33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.886119023362041, "mean_inference_ms": 0.3698093089197947, "mean_action_processing_ms": 0.09200620780037713, "mean_env_wait_ms": 1.3774274073865842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034494400024414062, "StateBufferConnector_ms": 0.002657175064086914, "ViewRequirementAgentConnector_ms": 0.06646418571472168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5596080, "num_agent_steps_trained": 5596080, "num_env_steps_sampled": 5596080, "num_env_steps_trained": 5596080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 365.63984738940934, "num_env_steps_trained_throughput_per_sec": 365.63984738940934, "timesteps_total": 5596080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5596080, "timers": {"training_iteration_time_ms": 9841.551, "sample_time_ms": 9746.408, "load_time_ms": 1.439, "load_throughput": 2502568.019, "learn_time_ms": 92.823, "learn_throughput": 38783.529, "synch_weights_time_ms": 0.825}, "counters": {"num_env_steps_sampled": 5596080, "num_env_steps_trained": 5596080, "num_agent_steps_sampled": 5596080, "num_agent_steps_trained": 5596080}, "done": false, "episodes_total": 1347, "training_iteration": 660, "trial_id": "ee88a_00000", "date": "2023-07-25_04-11-55", "timestamp": 1690247515, "time_this_iter_s": 19.694464921951294, "time_total_s": 11539.560533761978, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1414.7580561637878, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 21.12857142857143, "ram_util_percent": 76.03928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.44074074074074e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -938.8856179373605, "policy_loss": -1971000607202070.8, "vf_loss": 45138915.446428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8092.5, "diff_num_grad_updates_vs_sampler_policy": 8091.5}}, "num_env_steps_sampled": 5603280, "num_env_steps_trained": 5603280, "num_agent_steps_sampled": 5603280, "num_agent_steps_trained": 5603280}, "sampler_results": {"episode_reward_max": -33661.03305925355, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34999.73904842991, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.886554394550841, "mean_inference_ms": 0.3698205591846926, "mean_action_processing_ms": 0.0920059987908029, "mean_env_wait_ms": 1.3755794848236633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034575462341308594, "StateBufferConnector_ms": 0.002658843994140625, "ViewRequirementAgentConnector_ms": 0.0664680004119873}}, "episode_reward_max": -33661.03305925355, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -34999.73904842991, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33693.33124466084, -33677.561176887124, -33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.886554394550841, "mean_inference_ms": 0.3698205591846926, "mean_action_processing_ms": 0.0920059987908029, "mean_env_wait_ms": 1.3755794848236633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034575462341308594, "StateBufferConnector_ms": 0.002658843994140625, "ViewRequirementAgentConnector_ms": 0.0664680004119873}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5603280, "num_agent_steps_trained": 5603280, "num_env_steps_sampled": 5603280, "num_env_steps_trained": 5603280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.42183711785503, "num_env_steps_trained_throughput_per_sec": 371.42183711785503, "timesteps_total": 5603280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5603280, "timers": {"training_iteration_time_ms": 9812.957, "sample_time_ms": 9718.04, "load_time_ms": 1.41, "load_throughput": 2552746.306, "learn_time_ms": 92.621, "learn_throughput": 38867.988, "synch_weights_time_ms": 0.827}, "counters": {"num_env_steps_sampled": 5603280, "num_env_steps_trained": 5603280, "num_agent_steps_sampled": 5603280, "num_agent_steps_trained": 5603280}, "done": false, "episodes_total": 1349, "training_iteration": 661, "trial_id": "ee88a_00000", "date": "2023-07-25_04-12-15", "timestamp": 1690247535, "time_this_iter_s": 19.38794708251953, "time_total_s": 11558.948480844498, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1434.1460032463074, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 23.12142857142857, "ram_util_percent": 76.26428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.107407407407409e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -939.2427215576172, "policy_loss": -1621235161624295.5, "vf_loss": 45913033.428571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8204.5, "diff_num_grad_updates_vs_sampler_policy": 8203.5}}, "num_env_steps_sampled": 5610480, "num_env_steps_trained": 5610480, "num_agent_steps_sampled": 5610480, "num_agent_steps_trained": 5610480}, "sampler_results": {"episode_reward_max": -33661.03305925355, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35029.61547227797, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8869499989698931, "mean_inference_ms": 0.36983118924906605, "mean_action_processing_ms": 0.09200565435815995, "mean_env_wait_ms": 1.373785276167584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034515857696533203, "StateBufferConnector_ms": 0.002663135528564453, "ViewRequirementAgentConnector_ms": 0.06644797325134277}}, "episode_reward_max": -33661.03305925355, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35029.61547227797, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33661.03305925355, -33869.770457394494, -33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8869499989698931, "mean_inference_ms": 0.36983118924906605, "mean_action_processing_ms": 0.09200565435815995, "mean_env_wait_ms": 1.373785276167584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034515857696533203, "StateBufferConnector_ms": 0.002663135528564453, "ViewRequirementAgentConnector_ms": 0.06644797325134277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5610480, "num_agent_steps_trained": 5610480, "num_env_steps_sampled": 5610480, "num_env_steps_trained": 5610480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 373.7036386860764, "num_env_steps_trained_throughput_per_sec": 373.7036386860764, "timesteps_total": 5610480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5610480, "timers": {"training_iteration_time_ms": 9765.296, "sample_time_ms": 9670.136, "load_time_ms": 1.434, "load_throughput": 2510056.254, "learn_time_ms": 92.835, "learn_throughput": 38778.599, "synch_weights_time_ms": 0.832}, "counters": {"num_env_steps_sampled": 5610480, "num_env_steps_trained": 5610480, "num_agent_steps_sampled": 5610480, "num_agent_steps_trained": 5610480}, "done": false, "episodes_total": 1351, "training_iteration": 662, "trial_id": "ee88a_00000", "date": "2023-07-25_04-12-34", "timestamp": 1690247554, "time_this_iter_s": 19.270048141479492, "time_total_s": 11578.218528985977, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1453.4160513877869, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 20.62222222222222, "ram_util_percent": 76.28148148148149}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.774074074074074e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -939.5799124581473, "policy_loss": -1610024206876045.8, "vf_loss": 45298598.83928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8316.5, "diff_num_grad_updates_vs_sampler_policy": 8315.5}}, "num_env_steps_sampled": 5617680, "num_env_steps_trained": 5617680, "num_agent_steps_sampled": 5617680, "num_agent_steps_trained": 5617680}, "sampler_results": {"episode_reward_max": -33834.07467923595, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35055.15614611359, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8873107068070601, "mean_inference_ms": 0.36984164342064907, "mean_action_processing_ms": 0.09200537878654216, "mean_env_wait_ms": 1.3720478180541238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034453868865966797, "StateBufferConnector_ms": 0.0026612281799316406, "ViewRequirementAgentConnector_ms": 0.06644654273986816}}, "episode_reward_max": -33834.07467923595, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35055.15614611359, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33952.27120926225, -34045.288105226005, -33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8873107068070601, "mean_inference_ms": 0.36984164342064907, "mean_action_processing_ms": 0.09200537878654216, "mean_env_wait_ms": 1.3720478180541238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034453868865966797, "StateBufferConnector_ms": 0.0026612281799316406, "ViewRequirementAgentConnector_ms": 0.06644654273986816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5617680, "num_agent_steps_trained": 5617680, "num_env_steps_sampled": 5617680, "num_env_steps_trained": 5617680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.1651150784775, "num_env_steps_trained_throughput_per_sec": 372.1651150784775, "timesteps_total": 5617680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5617680, "timers": {"training_iteration_time_ms": 9734.733, "sample_time_ms": 9639.391, "load_time_ms": 1.44, "load_throughput": 2499792.13, "learn_time_ms": 93.01, "learn_throughput": 38705.348, "synch_weights_time_ms": 0.833}, "counters": {"num_env_steps_sampled": 5617680, "num_env_steps_trained": 5617680, "num_agent_steps_sampled": 5617680, "num_agent_steps_trained": 5617680}, "done": false, "episodes_total": 1353, "training_iteration": 663, "trial_id": "ee88a_00000", "date": "2023-07-25_04-12-53", "timestamp": 1690247573, "time_this_iter_s": 19.349167823791504, "time_total_s": 11597.567696809769, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1472.7652192115784, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 21.496296296296297, "ram_util_percent": 76.35555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.44074074074074e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -939.9082848685129, "policy_loss": -1444344768597356.5, "vf_loss": 45707174.053571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8428.5, "diff_num_grad_updates_vs_sampler_policy": 8427.5}}, "num_env_steps_sampled": 5624880, "num_env_steps_trained": 5624880, "num_agent_steps_sampled": 5624880, "num_agent_steps_trained": 5624880}, "sampler_results": {"episode_reward_max": -33834.07467923595, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35079.03255185526, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8876446082950311, "mean_inference_ms": 0.36985238980023427, "mean_action_processing_ms": 0.09200523233828947, "mean_env_wait_ms": 1.3703689568921975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.0026607513427734375, "ViewRequirementAgentConnector_ms": 0.06644415855407715}}, "episode_reward_max": -33834.07467923595, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35079.03255185526, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33953.37782238314, -33953.11503539783, -33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8876446082950311, "mean_inference_ms": 0.36985238980023427, "mean_action_processing_ms": 0.09200523233828947, "mean_env_wait_ms": 1.3703689568921975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.0026607513427734375, "ViewRequirementAgentConnector_ms": 0.06644415855407715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5624880, "num_agent_steps_trained": 5624880, "num_env_steps_sampled": 5624880, "num_env_steps_trained": 5624880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.184936722403, "num_env_steps_trained_throughput_per_sec": 371.184936722403, "timesteps_total": 5624880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5624880, "timers": {"training_iteration_time_ms": 9708.649, "sample_time_ms": 9613.25, "load_time_ms": 1.495, "load_throughput": 2407521.668, "learn_time_ms": 93.021, "learn_throughput": 38700.745, "synch_weights_time_ms": 0.822}, "counters": {"num_env_steps_sampled": 5624880, "num_env_steps_trained": 5624880, "num_agent_steps_sampled": 5624880, "num_agent_steps_trained": 5624880}, "done": false, "episodes_total": 1355, "training_iteration": 664, "trial_id": "ee88a_00000", "date": "2023-07-25_04-13-13", "timestamp": 1690247593, "time_this_iter_s": 19.400251865386963, "time_total_s": 11616.967948675156, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1492.1654710769653, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 21.264285714285716, "ram_util_percent": 76.19285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.107407407407409e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -940.2293079921177, "policy_loss": -1187020537662814.0, "vf_loss": 45548522.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8540.5, "diff_num_grad_updates_vs_sampler_policy": 8539.5}}, "num_env_steps_sampled": 5632080, "num_env_steps_trained": 5632080, "num_agent_steps_sampled": 5632080, "num_agent_steps_trained": 5632080}, "sampler_results": {"episode_reward_max": -33834.07467923595, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35101.28348521153, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8879541751909272, "mean_inference_ms": 0.36986297343288527, "mean_action_processing_ms": 0.0920050338661963, "mean_env_wait_ms": 1.3687468248106511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034465789794921875, "StateBufferConnector_ms": 0.0026628971099853516, "ViewRequirementAgentConnector_ms": 0.06643486022949219}}, "episode_reward_max": -33834.07467923595, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35101.28348521153, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33907.50516048715, -33931.35096354365, -33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8879541751909272, "mean_inference_ms": 0.36986297343288527, "mean_action_processing_ms": 0.0920050338661963, "mean_env_wait_ms": 1.3687468248106511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034465789794921875, "StateBufferConnector_ms": 0.0026628971099853516, "ViewRequirementAgentConnector_ms": 0.06643486022949219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632080, "num_agent_steps_trained": 5632080, "num_env_steps_sampled": 5632080, "num_env_steps_trained": 5632080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.9228130205774, "num_env_steps_trained_throughput_per_sec": 369.9228130205774, "timesteps_total": 5632080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5632080, "timers": {"training_iteration_time_ms": 9685.85, "sample_time_ms": 9590.404, "load_time_ms": 1.506, "load_throughput": 2390749.295, "learn_time_ms": 93.073, "learn_throughput": 38679.292, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 5632080, "num_env_steps_trained": 5632080, "num_agent_steps_sampled": 5632080, "num_agent_steps_trained": 5632080}, "done": false, "episodes_total": 1357, "training_iteration": 665, "trial_id": "ee88a_00000", "date": "2023-07-25_04-13-32", "timestamp": 1690247612, "time_this_iter_s": 19.466295957565308, "time_total_s": 11636.434244632721, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1511.6317670345306, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 19.657142857142855, "ram_util_percent": 76.24285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.774074074074074e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -940.5264064243862, "policy_loss": -1073417670017793.1, "vf_loss": 45635074.03571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8652.5, "diff_num_grad_updates_vs_sampler_policy": 8651.5}}, "num_env_steps_sampled": 5639280, "num_env_steps_trained": 5639280, "num_agent_steps_sampled": 5639280, "num_agent_steps_trained": 5639280}, "sampler_results": {"episode_reward_max": -33834.07467923595, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35125.39214459375, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8882390540968782, "mean_inference_ms": 0.3698738435010796, "mean_action_processing_ms": 0.09200499333652715, "mean_env_wait_ms": 1.3671786426663544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034503936767578125, "StateBufferConnector_ms": 0.0026624202728271484, "ViewRequirementAgentConnector_ms": 0.06641316413879395}}, "episode_reward_max": -33834.07467923595, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35125.39214459375, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33834.07467923595, -34202.32968954089, -35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8882390540968782, "mean_inference_ms": 0.3698738435010796, "mean_action_processing_ms": 0.09200499333652715, "mean_env_wait_ms": 1.3671786426663544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034503936767578125, "StateBufferConnector_ms": 0.0026624202728271484, "ViewRequirementAgentConnector_ms": 0.06641316413879395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5639280, "num_agent_steps_trained": 5639280, "num_env_steps_sampled": 5639280, "num_env_steps_trained": 5639280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.9119380446822, "num_env_steps_trained_throughput_per_sec": 369.9119380446822, "timesteps_total": 5639280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5639280, "timers": {"training_iteration_time_ms": 9693.762, "sample_time_ms": 9598.229, "load_time_ms": 1.543, "load_throughput": 2332832.926, "learn_time_ms": 93.122, "learn_throughput": 38659.021, "synch_weights_time_ms": 0.809}, "counters": {"num_env_steps_sampled": 5639280, "num_env_steps_trained": 5639280, "num_agent_steps_sampled": 5639280, "num_agent_steps_trained": 5639280}, "done": false, "episodes_total": 1359, "training_iteration": 666, "trial_id": "ee88a_00000", "date": "2023-07-25_04-13-52", "timestamp": 1690247632, "time_this_iter_s": 19.467009782791138, "time_total_s": 11655.901254415512, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1531.0987768173218, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 21.68148148148148, "ram_util_percent": 76.21851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.440740740740741e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -940.9763543265207, "policy_loss": -986802483453718.6, "vf_loss": 45943289.71428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8764.5, "diff_num_grad_updates_vs_sampler_policy": 8763.5}}, "num_env_steps_sampled": 5646480, "num_env_steps_trained": 5646480, "num_agent_steps_sampled": 5646480, "num_agent_steps_trained": 5646480}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35149.46526448858, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8885100132184496, "mean_inference_ms": 0.36988451493055424, "mean_action_processing_ms": 0.09200498068616783, "mean_env_wait_ms": 1.3656710187157062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034487247467041016, "StateBufferConnector_ms": 0.002660512924194336, "ViewRequirementAgentConnector_ms": 0.06640982627868652}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35149.46526448858, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35237.86635760948, -35038.28932022479, -35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8885100132184496, "mean_inference_ms": 0.36988451493055424, "mean_action_processing_ms": 0.09200498068616783, "mean_env_wait_ms": 1.3656710187157062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034487247467041016, "StateBufferConnector_ms": 0.002660512924194336, "ViewRequirementAgentConnector_ms": 0.06640982627868652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5646480, "num_agent_steps_trained": 5646480, "num_env_steps_sampled": 5646480, "num_env_steps_trained": 5646480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.3919437348865, "num_env_steps_trained_throughput_per_sec": 367.3919437348865, "timesteps_total": 5646480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5646480, "timers": {"training_iteration_time_ms": 9726.863, "sample_time_ms": 9631.204, "load_time_ms": 1.505, "load_throughput": 2391733.891, "learn_time_ms": 93.302, "learn_throughput": 38584.426, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 5646480, "num_env_steps_trained": 5646480, "num_agent_steps_sampled": 5646480, "num_agent_steps_trained": 5646480}, "done": false, "episodes_total": 1361, "training_iteration": 667, "trial_id": "ee88a_00000", "date": "2023-07-25_04-14-11", "timestamp": 1690247651, "time_this_iter_s": 19.600526094436646, "time_total_s": 11675.501780509949, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1550.6993029117584, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 22.178571428571427, "ram_util_percent": 76.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.107407407407407e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.1924187796457, "policy_loss": -935833706022897.1, "vf_loss": 45359883.08928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8876.5, "diff_num_grad_updates_vs_sampler_policy": 8875.5}}, "num_env_steps_sampled": 5653680, "num_env_steps_trained": 5653680, "num_agent_steps_sampled": 5653680, "num_agent_steps_trained": 5653680}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35146.814859430204, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8887707999554276, "mean_inference_ms": 0.36989449966665733, "mean_action_processing_ms": 0.09200486882334644, "mean_env_wait_ms": 1.364200887522304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034422874450683594, "StateBufferConnector_ms": 0.002656698226928711, "ViewRequirementAgentConnector_ms": 0.06641435623168945}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35146.814859430204, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35308.25392759859, -35436.681905053796, -35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8887707999554276, "mean_inference_ms": 0.36989449966665733, "mean_action_processing_ms": 0.09200486882334644, "mean_env_wait_ms": 1.364200887522304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034422874450683594, "StateBufferConnector_ms": 0.002656698226928711, "ViewRequirementAgentConnector_ms": 0.06641435623168945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5653680, "num_agent_steps_trained": 5653680, "num_env_steps_sampled": 5653680, "num_env_steps_trained": 5653680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.29764773465155, "num_env_steps_trained_throughput_per_sec": 368.29764773465155, "timesteps_total": 5653680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5653680, "timers": {"training_iteration_time_ms": 9747.179, "sample_time_ms": 9651.588, "load_time_ms": 1.462, "load_throughput": 2462048.036, "learn_time_ms": 93.282, "learn_throughput": 38592.503, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 5653680, "num_env_steps_trained": 5653680, "num_agent_steps_sampled": 5653680, "num_agent_steps_trained": 5653680}, "done": false, "episodes_total": 1363, "training_iteration": 668, "trial_id": "ee88a_00000", "date": "2023-07-25_04-14-31", "timestamp": 1690247671, "time_this_iter_s": 19.552303075790405, "time_total_s": 11695.05408358574, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1570.2516059875488, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 20.667857142857144, "ram_util_percent": 76.32142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.774074074074075e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3589684622629, "policy_loss": -826688076545393.9, "vf_loss": 45342283.08928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8988.5, "diff_num_grad_updates_vs_sampler_policy": 8987.5}}, "num_env_steps_sampled": 5660880, "num_env_steps_trained": 5660880, "num_agent_steps_sampled": 5660880, "num_agent_steps_trained": 5660880}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35137.14030833538, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8890133695008781, "mean_inference_ms": 0.3699038040776448, "mean_action_processing_ms": 0.09200470159885475, "mean_env_wait_ms": 1.362816124705252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034449100494384766, "StateBufferConnector_ms": 0.002658367156982422, "ViewRequirementAgentConnector_ms": 0.06639337539672852}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35137.14030833538, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35364.508461754594, -35180.720671336036, -35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8890133695008781, "mean_inference_ms": 0.3699038040776448, "mean_action_processing_ms": 0.09200470159885475, "mean_env_wait_ms": 1.362816124705252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034449100494384766, "StateBufferConnector_ms": 0.002658367156982422, "ViewRequirementAgentConnector_ms": 0.06639337539672852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5660880, "num_agent_steps_trained": 5660880, "num_env_steps_sampled": 5660880, "num_env_steps_trained": 5660880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.9220906584279, "num_env_steps_trained_throughput_per_sec": 366.9220906584279, "timesteps_total": 5660880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5660880, "timers": {"training_iteration_time_ms": 9769.714, "sample_time_ms": 9673.648, "load_time_ms": 1.408, "load_throughput": 2556809.537, "learn_time_ms": 93.799, "learn_throughput": 38380.069, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 5660880, "num_env_steps_trained": 5660880, "num_agent_steps_sampled": 5660880, "num_agent_steps_trained": 5660880}, "done": false, "episodes_total": 1365, "training_iteration": 669, "trial_id": "ee88a_00000", "date": "2023-07-25_04-14-50", "timestamp": 1690247690, "time_this_iter_s": 19.625627994537354, "time_total_s": 11714.679711580276, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1589.8772339820862, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 21.75925925925926, "ram_util_percent": 76.28148148148148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.440740740740741e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3440573556082, "policy_loss": -689960001464225.2, "vf_loss": 46208834.51785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9100.5, "diff_num_grad_updates_vs_sampler_policy": 9099.5}}, "num_env_steps_sampled": 5668080, "num_env_steps_trained": 5668080, "num_agent_steps_sampled": 5668080, "num_agent_steps_trained": 5668080}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35133.31476127588, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8892573320142876, "mean_inference_ms": 0.3699112606703533, "mean_action_processing_ms": 0.09200436016015918, "mean_env_wait_ms": 1.361499985352282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003441333770751953, "StateBufferConnector_ms": 0.0026543140411376953, "ViewRequirementAgentConnector_ms": 0.06637740135192871}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35133.31476127588, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35250.98576596583, -35193.249393185215, -35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8892573320142876, "mean_inference_ms": 0.3699112606703533, "mean_action_processing_ms": 0.09200436016015918, "mean_env_wait_ms": 1.361499985352282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003441333770751953, "StateBufferConnector_ms": 0.0026543140411376953, "ViewRequirementAgentConnector_ms": 0.06637740135192871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5668080, "num_agent_steps_trained": 5668080, "num_env_steps_sampled": 5668080, "num_env_steps_trained": 5668080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.05789623032774, "num_env_steps_trained_throughput_per_sec": 367.05789623032774, "timesteps_total": 5668080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5668080, "timers": {"training_iteration_time_ms": 9784.906, "sample_time_ms": 9688.912, "load_time_ms": 1.4, "load_throughput": 2572184.454, "learn_time_ms": 93.735, "learn_throughput": 38406.241, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 5668080, "num_env_steps_trained": 5668080, "num_agent_steps_sampled": 5668080, "num_agent_steps_trained": 5668080}, "done": false, "episodes_total": 1367, "training_iteration": 670, "trial_id": "ee88a_00000", "date": "2023-07-25_04-15-10", "timestamp": 1690247710, "time_this_iter_s": 19.61848497390747, "time_total_s": 11734.298196554184, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1609.4957189559937, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 20.317857142857147, "ram_util_percent": 76.24999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.107407407407406e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4343032836914, "policy_loss": -627518065889988.9, "vf_loss": 46064082.83928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9212.5, "diff_num_grad_updates_vs_sampler_policy": 9211.5}}, "num_env_steps_sampled": 5675280, "num_env_steps_trained": 5675280, "num_agent_steps_sampled": 5675280, "num_agent_steps_trained": 5675280}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35132.06903733818, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8894887062024551, "mean_inference_ms": 0.36991762548539314, "mean_action_processing_ms": 0.09200381100078925, "mean_env_wait_ms": 1.3602478737294905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034437179565429688, "StateBufferConnector_ms": 0.0026564598083496094, "ViewRequirementAgentConnector_ms": 0.06637978553771973}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35132.06903733818, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35254.00410030067, -35357.57670073628, -35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8894887062024551, "mean_inference_ms": 0.36991762548539314, "mean_action_processing_ms": 0.09200381100078925, "mean_env_wait_ms": 1.3602478737294905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034437179565429688, "StateBufferConnector_ms": 0.0026564598083496094, "ViewRequirementAgentConnector_ms": 0.06637978553771973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5675280, "num_agent_steps_trained": 5675280, "num_env_steps_sampled": 5675280, "num_env_steps_trained": 5675280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.90403596332357, "num_env_steps_trained_throughput_per_sec": 369.90403596332357, "timesteps_total": 5675280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5675280, "timers": {"training_iteration_time_ms": 9784.947, "sample_time_ms": 9689.336, "load_time_ms": 1.369, "load_throughput": 2630253.175, "learn_time_ms": 93.384, "learn_throughput": 38550.372, "synch_weights_time_ms": 0.8}, "counters": {"num_env_steps_sampled": 5675280, "num_env_steps_trained": 5675280, "num_agent_steps_sampled": 5675280, "num_agent_steps_trained": 5675280}, "done": false, "episodes_total": 1369, "training_iteration": 671, "trial_id": "ee88a_00000", "date": "2023-07-25_04-15-30", "timestamp": 1690247730, "time_this_iter_s": 19.46748185157776, "time_total_s": 11753.765678405762, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1628.9632008075714, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 21.532142857142862, "ram_util_percent": 76.44642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.774074074074073e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.5155781337193, "policy_loss": -488035684849008.3, "vf_loss": 46012296.946428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9324.5, "diff_num_grad_updates_vs_sampler_policy": 9323.5}}, "num_env_steps_sampled": 5682480, "num_env_steps_trained": 5682480, "num_agent_steps_sampled": 5682480, "num_agent_steps_trained": 5682480}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35131.40193103396, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8897064025051755, "mean_inference_ms": 0.3699265685801737, "mean_action_processing_ms": 0.09200398016595561, "mean_env_wait_ms": 1.359049702980991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003439664840698242, "StateBufferConnector_ms": 0.0026602745056152344, "ViewRequirementAgentConnector_ms": 0.06637811660766602}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35131.40193103396, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35241.10497097703, -35105.29561394236, -35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8897064025051755, "mean_inference_ms": 0.3699265685801737, "mean_action_processing_ms": 0.09200398016595561, "mean_env_wait_ms": 1.359049702980991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003439664840698242, "StateBufferConnector_ms": 0.0026602745056152344, "ViewRequirementAgentConnector_ms": 0.06637811660766602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5682480, "num_agent_steps_trained": 5682480, "num_env_steps_sampled": 5682480, "num_env_steps_trained": 5682480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.55749561548254, "num_env_steps_trained_throughput_per_sec": 367.55749561548254, "timesteps_total": 5682480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5682480, "timers": {"training_iteration_time_ms": 9784.063, "sample_time_ms": 9688.604, "load_time_ms": 1.401, "load_throughput": 2569077.211, "learn_time_ms": 93.167, "learn_throughput": 38640.402, "synch_weights_time_ms": 0.825}, "counters": {"num_env_steps_sampled": 5682480, "num_env_steps_trained": 5682480, "num_agent_steps_sampled": 5682480, "num_agent_steps_trained": 5682480}, "done": false, "episodes_total": 1371, "training_iteration": 672, "trial_id": "ee88a_00000", "date": "2023-07-25_04-15-49", "timestamp": 1690247749, "time_this_iter_s": 19.591827869415283, "time_total_s": 11773.357506275177, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1648.5550286769867, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 30.424999999999994, "ram_util_percent": 76.08571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.4407407407407413e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.5904704502651, "policy_loss": -477245041289445.0, "vf_loss": 46163606.64285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9436.5, "diff_num_grad_updates_vs_sampler_policy": 9435.5}}, "num_env_steps_sampled": 5689680, "num_env_steps_trained": 5689680, "num_agent_steps_sampled": 5689680, "num_agent_steps_trained": 5689680}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35131.92841627421, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8899065477453081, "mean_inference_ms": 0.369936046327822, "mean_action_processing_ms": 0.09200438224158537, "mean_env_wait_ms": 1.357907092853918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034456253051757812, "StateBufferConnector_ms": 0.0026547908782958984, "ViewRequirementAgentConnector_ms": 0.06637859344482422}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35131.92841627421, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35214.010772303634, -35083.26096256379, -35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8899065477453081, "mean_inference_ms": 0.369936046327822, "mean_action_processing_ms": 0.09200438224158537, "mean_env_wait_ms": 1.357907092853918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034456253051757812, "StateBufferConnector_ms": 0.0026547908782958984, "ViewRequirementAgentConnector_ms": 0.06637859344482422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5689680, "num_agent_steps_trained": 5689680, "num_env_steps_sampled": 5689680, "num_env_steps_trained": 5689680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.29723899534906, "num_env_steps_trained_throughput_per_sec": 368.29723899534906, "timesteps_total": 5689680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5689680, "timers": {"training_iteration_time_ms": 9784.066, "sample_time_ms": 9688.529, "load_time_ms": 1.404, "load_throughput": 2563581.392, "learn_time_ms": 93.246, "learn_throughput": 38607.571, "synch_weights_time_ms": 0.821}, "counters": {"num_env_steps_sampled": 5689680, "num_env_steps_trained": 5689680, "num_agent_steps_sampled": 5689680, "num_agent_steps_trained": 5689680}, "done": false, "episodes_total": 1373, "training_iteration": 673, "trial_id": "ee88a_00000", "date": "2023-07-25_04-16-09", "timestamp": 1690247769, "time_this_iter_s": 19.552473068237305, "time_total_s": 11792.909979343414, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1668.107501745224, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 20.822222222222223, "ram_util_percent": 74.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.1074074074074066e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.6597104753766, "policy_loss": -356511354528352.3, "vf_loss": 45247516.21428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9548.5, "diff_num_grad_updates_vs_sampler_policy": 9547.5}}, "num_env_steps_sampled": 5696880, "num_env_steps_trained": 5696880, "num_agent_steps_sampled": 5696880, "num_agent_steps_trained": 5696880}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35131.72627478734, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8900983959183896, "mean_inference_ms": 0.36994480416497866, "mean_action_processing_ms": 0.09200469910799665, "mean_env_wait_ms": 1.356810444904256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449678421020508, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.06637978553771973}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35131.72627478734, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35219.58486783853, -35253.82892580395, -35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8900983959183896, "mean_inference_ms": 0.36994480416497866, "mean_action_processing_ms": 0.09200469910799665, "mean_env_wait_ms": 1.356810444904256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449678421020508, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.06637978553771973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5696880, "num_agent_steps_trained": 5696880, "num_env_steps_sampled": 5696880, "num_env_steps_trained": 5696880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.3369135528286, "num_env_steps_trained_throughput_per_sec": 367.3369135528286, "timesteps_total": 5696880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5696880, "timers": {"training_iteration_time_ms": 9781.85, "sample_time_ms": 9686.475, "load_time_ms": 1.427, "load_throughput": 2522257.479, "learn_time_ms": 93.07, "learn_throughput": 38680.749, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 5696880, "num_env_steps_trained": 5696880, "num_agent_steps_sampled": 5696880, "num_agent_steps_trained": 5696880}, "done": false, "episodes_total": 1375, "training_iteration": 674, "trial_id": "ee88a_00000", "date": "2023-07-25_04-16-28", "timestamp": 1690247788, "time_this_iter_s": 19.603513956069946, "time_total_s": 11812.513493299484, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1687.711015701294, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 21.967857142857145, "ram_util_percent": 76.22142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.774074074074074e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.7190955025809, "policy_loss": -302169870352203.06, "vf_loss": 45335582.26785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9660.5, "diff_num_grad_updates_vs_sampler_policy": 9659.5}}, "num_env_steps_sampled": 5704080, "num_env_steps_trained": 5704080, "num_agent_steps_sampled": 5704080, "num_agent_steps_trained": 5704080}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35128.59083435613, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8902717582865233, "mean_inference_ms": 0.3699529676914222, "mean_action_processing_ms": 0.09200520796201359, "mean_env_wait_ms": 1.3557566660246936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034487247467041016, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.06637096405029297}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35128.59083435613, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35341.629927664144, -35024.44164321286, -35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8902717582865233, "mean_inference_ms": 0.3699529676914222, "mean_action_processing_ms": 0.09200520796201359, "mean_env_wait_ms": 1.3557566660246936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034487247467041016, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.06637096405029297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5704080, "num_agent_steps_trained": 5704080, "num_env_steps_sampled": 5704080, "num_env_steps_trained": 5704080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.2694213514596, "num_env_steps_trained_throughput_per_sec": 369.2694213514596, "timesteps_total": 5704080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5704080, "timers": {"training_iteration_time_ms": 9770.102, "sample_time_ms": 9674.493, "load_time_ms": 1.456, "load_throughput": 2471801.594, "learn_time_ms": 93.273, "learn_throughput": 38596.272, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 5704080, "num_env_steps_trained": 5704080, "num_agent_steps_sampled": 5704080, "num_agent_steps_trained": 5704080}, "done": false, "episodes_total": 1377, "training_iteration": 675, "trial_id": "ee88a_00000", "date": "2023-07-25_04-16-48", "timestamp": 1690247808, "time_this_iter_s": 19.500686168670654, "time_total_s": 11832.014179468155, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1707.2117018699646, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 22.63214285714286, "ram_util_percent": 76.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.4407407407407403e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.7711900983538, "policy_loss": -252726948019639.8, "vf_loss": 45429223.33928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9772.5, "diff_num_grad_updates_vs_sampler_policy": 9771.5}}, "num_env_steps_sampled": 5711280, "num_env_steps_trained": 5711280, "num_agent_steps_sampled": 5711280, "num_agent_steps_trained": 5711280}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35126.34419542914, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8904387216546235, "mean_inference_ms": 0.3699604261693131, "mean_action_processing_ms": 0.09200561526003716, "mean_env_wait_ms": 1.3547405074182886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448486328125, "StateBufferConnector_ms": 0.002653360366821289, "ViewRequirementAgentConnector_ms": 0.06640386581420898}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35126.34419542914, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35307.12075127677, -35312.45812801014, -35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8904387216546235, "mean_inference_ms": 0.3699604261693131, "mean_action_processing_ms": 0.09200561526003716, "mean_env_wait_ms": 1.3547405074182886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448486328125, "StateBufferConnector_ms": 0.002653360366821289, "ViewRequirementAgentConnector_ms": 0.06640386581420898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5711280, "num_agent_steps_trained": 5711280, "num_env_steps_sampled": 5711280, "num_env_steps_trained": 5711280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.85191486529965, "num_env_steps_trained_throughput_per_sec": 366.85191486529965, "timesteps_total": 5711280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5711280, "timers": {"training_iteration_time_ms": 9786.296, "sample_time_ms": 9690.061, "load_time_ms": 1.471, "load_throughput": 2448037.354, "learn_time_ms": 93.885, "learn_throughput": 38344.981, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 5711280, "num_env_steps_trained": 5711280, "num_agent_steps_sampled": 5711280, "num_agent_steps_trained": 5711280}, "done": false, "episodes_total": 1379, "training_iteration": 676, "trial_id": "ee88a_00000", "date": "2023-07-25_04-17-08", "timestamp": 1690247828, "time_this_iter_s": 19.62930679321289, "time_total_s": 11851.643486261368, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1726.8410086631775, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 21.048148148148147, "ram_util_percent": 77.04074074074073}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.107407407407407e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.8167299543109, "policy_loss": -224612769009520.0, "vf_loss": 45435055.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9884.5, "diff_num_grad_updates_vs_sampler_policy": 9883.5}}, "num_env_steps_sampled": 5718480, "num_env_steps_trained": 5718480, "num_agent_steps_sampled": 5718480, "num_agent_steps_trained": 5718480}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35122.31108188516, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8906069353226544, "mean_inference_ms": 0.3699673494528748, "mean_action_processing_ms": 0.09200590049486296, "mean_env_wait_ms": 1.3537609840580853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003446340560913086, "StateBufferConnector_ms": 0.0026607513427734375, "ViewRequirementAgentConnector_ms": 0.06642675399780273}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35122.31108188516, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35297.16494714439, -35142.91033877941, -35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8906069353226544, "mean_inference_ms": 0.3699673494528748, "mean_action_processing_ms": 0.09200590049486296, "mean_env_wait_ms": 1.3537609840580853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003446340560913086, "StateBufferConnector_ms": 0.0026607513427734375, "ViewRequirementAgentConnector_ms": 0.06642675399780273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5718480, "num_agent_steps_trained": 5718480, "num_env_steps_sampled": 5718480, "num_env_steps_trained": 5718480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.32728027443136, "num_env_steps_trained_throughput_per_sec": 367.32728027443136, "timesteps_total": 5718480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5718480, "timers": {"training_iteration_time_ms": 9787.523, "sample_time_ms": 9691.455, "load_time_ms": 1.433, "load_throughput": 2511726.396, "learn_time_ms": 93.785, "learn_throughput": 38385.757, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 5718480, "num_env_steps_trained": 5718480, "num_agent_steps_sampled": 5718480, "num_agent_steps_trained": 5718480}, "done": false, "episodes_total": 1381, "training_iteration": 677, "trial_id": "ee88a_00000", "date": "2023-07-25_04-17-27", "timestamp": 1690247847, "time_this_iter_s": 19.603979110717773, "time_total_s": 11871.247465372086, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1746.4449877738953, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 21.007142857142856, "ram_util_percent": 77.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.774074074074074e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.6598107474191, "policy_loss": -166442678471332.28, "vf_loss": 45321780.78571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9996.5, "diff_num_grad_updates_vs_sampler_policy": 9995.5}}, "num_env_steps_sampled": 5725680, "num_env_steps_trained": 5725680, "num_agent_steps_sampled": 5725680, "num_agent_steps_trained": 5725680}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35119.73054033573, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8907843421194849, "mean_inference_ms": 0.36997475679063674, "mean_action_processing_ms": 0.09200641741329242, "mean_env_wait_ms": 1.3528057707443495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451108932495117, "StateBufferConnector_ms": 0.002660512924194336, "ViewRequirementAgentConnector_ms": 0.06644225120544434}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35119.73054033573, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35378.37748599941, -35305.654802269615, -35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8907843421194849, "mean_inference_ms": 0.36997475679063674, "mean_action_processing_ms": 0.09200641741329242, "mean_env_wait_ms": 1.3528057707443495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451108932495117, "StateBufferConnector_ms": 0.002660512924194336, "ViewRequirementAgentConnector_ms": 0.06644225120544434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5725680, "num_agent_steps_trained": 5725680, "num_env_steps_sampled": 5725680, "num_env_steps_trained": 5725680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.0948809761355, "num_env_steps_trained_throughput_per_sec": 367.0948809761355, "timesteps_total": 5725680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5725680, "timers": {"training_iteration_time_ms": 9793.927, "sample_time_ms": 9698.145, "load_time_ms": 1.462, "load_throughput": 2461767.054, "learn_time_ms": 93.457, "learn_throughput": 38520.307, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 5725680, "num_env_steps_trained": 5725680, "num_agent_steps_sampled": 5725680, "num_agent_steps_trained": 5725680}, "done": false, "episodes_total": 1383, "training_iteration": 678, "trial_id": "ee88a_00000", "date": "2023-07-25_04-17-47", "timestamp": 1690247867, "time_this_iter_s": 19.616340160369873, "time_total_s": 11890.863805532455, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1766.0613279342651, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 21.53928571428571, "ram_util_percent": 77.07142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4644444444444444e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.641731262207, "policy_loss": -129810248900435.03, "vf_loss": 46283762.321428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10108.5, "diff_num_grad_updates_vs_sampler_policy": 10107.5}}, "num_env_steps_sampled": 5732880, "num_env_steps_trained": 5732880, "num_agent_steps_sampled": 5732880, "num_agent_steps_trained": 5732880}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35118.835822256864, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8909689413799362, "mean_inference_ms": 0.36998290747064905, "mean_action_processing_ms": 0.09200708277532935, "mean_env_wait_ms": 1.3518811123709664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034558773040771484, "StateBufferConnector_ms": 0.0026617050170898438, "ViewRequirementAgentConnector_ms": 0.06654238700866699}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35118.835822256864, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35498.49082086122, -35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8909689413799362, "mean_inference_ms": 0.36998290747064905, "mean_action_processing_ms": 0.09200708277532935, "mean_env_wait_ms": 1.3518811123709664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034558773040771484, "StateBufferConnector_ms": 0.0026617050170898438, "ViewRequirementAgentConnector_ms": 0.06654238700866699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5732880, "num_agent_steps_trained": 5732880, "num_env_steps_sampled": 5732880, "num_env_steps_trained": 5732880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.96777296277423, "num_env_steps_trained_throughput_per_sec": 370.96777296277423, "timesteps_total": 5732880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5732880, "timers": {"training_iteration_time_ms": 9774.742, "sample_time_ms": 9678.794, "load_time_ms": 1.441, "load_throughput": 2498137.816, "learn_time_ms": 93.648, "learn_throughput": 38441.931, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 5732880, "num_env_steps_trained": 5732880, "num_agent_steps_sampled": 5732880, "num_agent_steps_trained": 5732880}, "done": false, "episodes_total": 1385, "training_iteration": 679, "trial_id": "ee88a_00000", "date": "2023-07-25_04-18-06", "timestamp": 1690247886, "time_this_iter_s": 19.411603927612305, "time_total_s": 11910.275409460068, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1785.4729318618774, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 21.435714285714287, "ram_util_percent": 77.24642857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.364444444444444e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.6518031529018, "policy_loss": -117439345566313.17, "vf_loss": 45583739.625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10164.5, "diff_num_grad_updates_vs_sampler_policy": 10163.5}}, "num_env_steps_sampled": 5736480, "num_env_steps_trained": 5736480, "num_agent_steps_sampled": 5736480, "num_agent_steps_trained": 5736480}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35114.427063281924, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8910642918446147, "mean_inference_ms": 0.3699868286683876, "mean_action_processing_ms": 0.09200737842885763, "mean_env_wait_ms": 1.351440400175874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034580230712890625, "StateBufferConnector_ms": 0.002661466598510742, "ViewRequirementAgentConnector_ms": 0.06658411026000977}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35114.427063281924, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35395.08383967762, -35154.7512578176, -35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8910642918446147, "mean_inference_ms": 0.3699868286683876, "mean_action_processing_ms": 0.09200737842885763, "mean_env_wait_ms": 1.351440400175874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034580230712890625, "StateBufferConnector_ms": 0.002661466598510742, "ViewRequirementAgentConnector_ms": 0.06658411026000977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5736480, "num_agent_steps_trained": 5736480, "num_env_steps_sampled": 5736480, "num_env_steps_trained": 5736480, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 351.7979972564429, "num_env_steps_trained_throughput_per_sec": 351.7979972564429, "timesteps_total": 5736480, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5736480, "timers": {"training_iteration_time_ms": 9830.673, "sample_time_ms": 9734.936, "load_time_ms": 1.423, "load_throughput": 2530288.127, "learn_time_ms": 93.441, "learn_throughput": 38526.794, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 5736480, "num_env_steps_trained": 5736480, "num_agent_steps_sampled": 5736480, "num_agent_steps_trained": 5736480}, "done": false, "episodes_total": 1386, "training_iteration": 680, "trial_id": "ee88a_00000", "date": "2023-07-25_04-18-17", "timestamp": 1690247897, "time_this_iter_s": 10.235827922821045, "time_total_s": 11920.511237382889, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1795.7087597846985, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 24.607142857142854, "ram_util_percent": 78.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.164444444444444e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.6713017054966, "policy_loss": -97299642499989.78, "vf_loss": 45910323.946428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10276.5, "diff_num_grad_updates_vs_sampler_policy": 10275.5}}, "num_env_steps_sampled": 5743680, "num_env_steps_trained": 5743680, "num_agent_steps_sampled": 5743680, "num_agent_steps_trained": 5743680}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35113.999216704186, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8912399172925329, "mean_inference_ms": 0.3699952402518188, "mean_action_processing_ms": 0.09200798103551419, "mean_env_wait_ms": 1.3505755656005964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034699440002441406, "StateBufferConnector_ms": 0.002661466598510742, "ViewRequirementAgentConnector_ms": 0.0666196346282959}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35113.999216704186, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35245.05790269608, -35359.2408043688, -34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8912399172925329, "mean_inference_ms": 0.3699952402518188, "mean_action_processing_ms": 0.09200798103551419, "mean_env_wait_ms": 1.3505755656005964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034699440002441406, "StateBufferConnector_ms": 0.002661466598510742, "ViewRequirementAgentConnector_ms": 0.0666196346282959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5743680, "num_agent_steps_trained": 5743680, "num_env_steps_sampled": 5743680, "num_env_steps_trained": 5743680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 377.33127691730317, "num_env_steps_trained_throughput_per_sec": 377.33127691730317, "timesteps_total": 5743680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5743680, "timers": {"training_iteration_time_ms": 9775.304, "sample_time_ms": 9679.777, "load_time_ms": 1.47, "load_throughput": 2449427.269, "learn_time_ms": 93.189, "learn_throughput": 38631.139, "synch_weights_time_ms": 0.81}, "counters": {"num_env_steps_sampled": 5743680, "num_env_steps_trained": 5743680, "num_agent_steps_sampled": 5743680, "num_agent_steps_trained": 5743680}, "done": false, "episodes_total": 1388, "training_iteration": 681, "trial_id": "ee88a_00000", "date": "2023-07-25_04-18-36", "timestamp": 1690247916, "time_this_iter_s": 19.08440899848938, "time_total_s": 11939.595646381378, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1814.7931687831879, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.259259259259263, "ram_util_percent": 77.67777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9644444444444439e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.5847887311663, "policy_loss": -80300541285897.34, "vf_loss": 45693479.21428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10388.5, "diff_num_grad_updates_vs_sampler_policy": 10387.5}}, "num_env_steps_sampled": 5750880, "num_env_steps_trained": 5750880, "num_agent_steps_sampled": 5750880, "num_agent_steps_trained": 5750880}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35110.176742073905, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8913936219391906, "mean_inference_ms": 0.37000337858857546, "mean_action_processing_ms": 0.09200846491549147, "mean_env_wait_ms": 1.3497594477722603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034737586975097656, "StateBufferConnector_ms": 0.002658843994140625, "ViewRequirementAgentConnector_ms": 0.06656002998352051}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35110.176742073905, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34965.08759332429, -35137.77290830973, -34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8913936219391906, "mean_inference_ms": 0.37000337858857546, "mean_action_processing_ms": 0.09200846491549147, "mean_env_wait_ms": 1.3497594477722603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034737586975097656, "StateBufferConnector_ms": 0.002658843994140625, "ViewRequirementAgentConnector_ms": 0.06656002998352051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5750880, "num_agent_steps_trained": 5750880, "num_env_steps_sampled": 5750880, "num_env_steps_trained": 5750880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.5519385362632, "num_env_steps_trained_throughput_per_sec": 371.5519385362632, "timesteps_total": 5750880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5750880, "timers": {"training_iteration_time_ms": 9753.89, "sample_time_ms": 9657.843, "load_time_ms": 1.476, "load_throughput": 2438351.942, "learn_time_ms": 93.71, "learn_throughput": 38416.355, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 5750880, "num_env_steps_trained": 5750880, "num_agent_steps_sampled": 5750880, "num_agent_steps_trained": 5750880}, "done": false, "episodes_total": 1390, "training_iteration": 682, "trial_id": "ee88a_00000", "date": "2023-07-25_04-18-55", "timestamp": 1690247935, "time_this_iter_s": 19.381284952163696, "time_total_s": 11958.976931333542, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1834.1744537353516, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 20.081481481481482, "ram_util_percent": 77.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7644444444444447e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.5980922154018, "policy_loss": -64026411702472.57, "vf_loss": 45494190.571428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10500.5, "diff_num_grad_updates_vs_sampler_policy": 10499.5}}, "num_env_steps_sampled": 5758080, "num_env_steps_trained": 5758080, "num_agent_steps_sampled": 5758080, "num_agent_steps_trained": 5758080}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35110.51129054257, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8915289965691201, "mean_inference_ms": 0.3700113822350313, "mean_action_processing_ms": 0.0920089113479799, "mean_env_wait_ms": 1.3489803636643507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470897674560547, "StateBufferConnector_ms": 0.0026617050170898438, "ViewRequirementAgentConnector_ms": 0.06656455993652344}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35110.51129054257, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34903.726211001864, -34929.573229526744, -34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8915289965691201, "mean_inference_ms": 0.3700113822350313, "mean_action_processing_ms": 0.0920089113479799, "mean_env_wait_ms": 1.3489803636643507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470897674560547, "StateBufferConnector_ms": 0.0026617050170898438, "ViewRequirementAgentConnector_ms": 0.06656455993652344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5758080, "num_agent_steps_trained": 5758080, "num_env_steps_sampled": 5758080, "num_env_steps_trained": 5758080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.61592759817154, "num_env_steps_trained_throughput_per_sec": 370.61592759817154, "timesteps_total": 5758080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5758080, "timers": {"training_iteration_time_ms": 9736.027, "sample_time_ms": 9640.495, "load_time_ms": 1.477, "load_throughput": 2436699.275, "learn_time_ms": 93.204, "learn_throughput": 38625.071, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 5758080, "num_env_steps_trained": 5758080, "num_agent_steps_sampled": 5758080, "num_agent_steps_trained": 5758080}, "done": false, "episodes_total": 1392, "training_iteration": 683, "trial_id": "ee88a_00000", "date": "2023-07-25_04-19-15", "timestamp": 1690247955, "time_this_iter_s": 19.43001699447632, "time_total_s": 11978.406948328018, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1853.6044707298279, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 20.575, "ram_util_percent": 77.62142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5644444444444448e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.607786996024, "policy_loss": -48988608013687.57, "vf_loss": 45189600.98214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10612.5, "diff_num_grad_updates_vs_sampler_policy": 10611.5}}, "num_env_steps_sampled": 5765280, "num_env_steps_trained": 5765280, "num_agent_steps_sampled": 5765280, "num_agent_steps_trained": 5765280}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35114.27308587187, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8916491227267622, "mean_inference_ms": 0.37001880256187514, "mean_action_processing_ms": 0.09200925809059193, "mean_env_wait_ms": 1.3482269347045628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034737586975097656, "StateBufferConnector_ms": 0.002663850784301758, "ViewRequirementAgentConnector_ms": 0.06660723686218262}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35114.27308587187, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34900.27721956182, -35290.967704675095, -34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8916491227267622, "mean_inference_ms": 0.37001880256187514, "mean_action_processing_ms": 0.09200925809059193, "mean_env_wait_ms": 1.3482269347045628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034737586975097656, "StateBufferConnector_ms": 0.002663850784301758, "ViewRequirementAgentConnector_ms": 0.06660723686218262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5765280, "num_agent_steps_trained": 5765280, "num_env_steps_sampled": 5765280, "num_env_steps_trained": 5765280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 373.2821407117582, "num_env_steps_trained_throughput_per_sec": 373.2821407117582, "timesteps_total": 5765280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5765280, "timers": {"training_iteration_time_ms": 9703.179, "sample_time_ms": 9607.266, "load_time_ms": 1.518, "load_throughput": 2370928.367, "learn_time_ms": 93.54, "learn_throughput": 38486.228, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 5765280, "num_env_steps_trained": 5765280, "num_agent_steps_sampled": 5765280, "num_agent_steps_trained": 5765280}, "done": false, "episodes_total": 1394, "training_iteration": 684, "trial_id": "ee88a_00000", "date": "2023-07-25_04-19-34", "timestamp": 1690247974, "time_this_iter_s": 19.291275024414062, "time_total_s": 11997.698223352432, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1872.895745754242, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 24.42222222222222, "ram_util_percent": 76.89629629629631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3644444444444446e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4930866786411, "policy_loss": -38681084709142.43, "vf_loss": 45701708.66071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10724.5, "diff_num_grad_updates_vs_sampler_policy": 10723.5}}, "num_env_steps_sampled": 5772480, "num_env_steps_trained": 5772480, "num_agent_steps_sampled": 5772480, "num_agent_steps_trained": 5772480}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35113.49139933972, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8917533400569311, "mean_inference_ms": 0.37002790328480634, "mean_action_processing_ms": 0.09201002065338111, "mean_env_wait_ms": 1.3475037539268113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034775733947753906, "StateBufferConnector_ms": 0.002666473388671875, "ViewRequirementAgentConnector_ms": 0.06664419174194336}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35113.49139933972, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34892.01447487447, -35215.044166941676, -35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8917533400569311, "mean_inference_ms": 0.37002790328480634, "mean_action_processing_ms": 0.09201002065338111, "mean_env_wait_ms": 1.3475037539268113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034775733947753906, "StateBufferConnector_ms": 0.002666473388671875, "ViewRequirementAgentConnector_ms": 0.06664419174194336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5772480, "num_agent_steps_trained": 5772480, "num_env_steps_sampled": 5772480, "num_env_steps_trained": 5772480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.83213075899346, "num_env_steps_trained_throughput_per_sec": 369.83213075899346, "timesteps_total": 5772480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5772480, "timers": {"training_iteration_time_ms": 9664.316, "sample_time_ms": 9567.64, "load_time_ms": 1.521, "load_throughput": 2367434.055, "learn_time_ms": 94.305, "learn_throughput": 38174.11, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 5772480, "num_env_steps_trained": 5772480, "num_agent_steps_sampled": 5772480, "num_agent_steps_trained": 5772480}, "done": false, "episodes_total": 1396, "training_iteration": 685, "trial_id": "ee88a_00000", "date": "2023-07-25_04-19-53", "timestamp": 1690247993, "time_this_iter_s": 19.47118830680847, "time_total_s": 12017.16941165924, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1892.3669340610504, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 30.71428571428571, "ram_util_percent": 76.76785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1644444444444445e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4967520577567, "policy_loss": -27821659492816.785, "vf_loss": 45866756.553571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10836.5, "diff_num_grad_updates_vs_sampler_policy": 10835.5}}, "num_env_steps_sampled": 5779680, "num_env_steps_trained": 5779680, "num_agent_steps_sampled": 5779680, "num_agent_steps_trained": 5779680}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35117.81135596928, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8918480305867686, "mean_inference_ms": 0.3700369181291147, "mean_action_processing_ms": 0.09201079377310674, "mean_env_wait_ms": 1.346810002697135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034792423248291016, "StateBufferConnector_ms": 0.0026667118072509766, "ViewRequirementAgentConnector_ms": 0.06665158271789551}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35117.81135596928, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35510.45139526488, -35280.26529234699, -35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8918480305867686, "mean_inference_ms": 0.3700369181291147, "mean_action_processing_ms": 0.09201079377310674, "mean_env_wait_ms": 1.346810002697135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034792423248291016, "StateBufferConnector_ms": 0.0026667118072509766, "ViewRequirementAgentConnector_ms": 0.06665158271789551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5779680, "num_agent_steps_trained": 5779680, "num_env_steps_sampled": 5779680, "num_env_steps_trained": 5779680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.62219990614597, "num_env_steps_trained_throughput_per_sec": 370.62219990614597, "timesteps_total": 5779680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5779680, "timers": {"training_iteration_time_ms": 9698.858, "sample_time_ms": 9601.831, "load_time_ms": 1.51, "load_throughput": 2384369.132, "learn_time_ms": 94.659, "learn_throughput": 38031.251, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 5779680, "num_env_steps_trained": 5779680, "num_agent_steps_sampled": 5779680, "num_agent_steps_trained": 5779680}, "done": false, "episodes_total": 1398, "training_iteration": 686, "trial_id": "ee88a_00000", "date": "2023-07-25_04-20-13", "timestamp": 1690248013, "time_this_iter_s": 19.429798126220703, "time_total_s": 12036.599209785461, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1911.7967321872711, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 24.262962962962963, "ram_util_percent": 76.85925925925925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.881481481481482e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4974975585938, "policy_loss": -21621934184868.215, "vf_loss": 45452601.89285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10948.5, "diff_num_grad_updates_vs_sampler_policy": 10947.5}}, "num_env_steps_sampled": 5786880, "num_env_steps_trained": 5786880, "num_agent_steps_sampled": 5786880, "num_agent_steps_trained": 5786880}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35108.87956073322, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8919379685895024, "mean_inference_ms": 0.37004607883910834, "mean_action_processing_ms": 0.09201163134763357, "mean_env_wait_ms": 1.3461454668655994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.002663850784301758, "ViewRequirementAgentConnector_ms": 0.06664705276489258}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35108.87956073322, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35394.833428040474, -35468.851675805636, -35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8919379685895024, "mean_inference_ms": 0.37004607883910834, "mean_action_processing_ms": 0.09201163134763357, "mean_env_wait_ms": 1.3461454668655994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.002663850784301758, "ViewRequirementAgentConnector_ms": 0.06664705276489258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5786880, "num_agent_steps_trained": 5786880, "num_env_steps_sampled": 5786880, "num_env_steps_trained": 5786880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.8278581833826, "num_env_steps_trained_throughput_per_sec": 368.8278581833826, "timesteps_total": 5786880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5786880, "timers": {"training_iteration_time_ms": 9713.166, "sample_time_ms": 9615.871, "load_time_ms": 1.612, "load_throughput": 2232629.179, "learn_time_ms": 94.714, "learn_throughput": 38009.098, "synch_weights_time_ms": 0.881}, "counters": {"num_env_steps_sampled": 5786880, "num_env_steps_trained": 5786880, "num_agent_steps_sampled": 5786880, "num_agent_steps_trained": 5786880}, "done": false, "episodes_total": 1400, "training_iteration": 687, "trial_id": "ee88a_00000", "date": "2023-07-25_04-20-32", "timestamp": 1690248032, "time_this_iter_s": 19.524930238723755, "time_total_s": 12056.124140024185, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1931.3216624259949, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 23.77142857142857, "ram_util_percent": 76.82142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.214814814814816e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4976806640625, "policy_loss": -17576656283711.41, "vf_loss": 46248307.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11060.5, "diff_num_grad_updates_vs_sampler_policy": 11059.5}}, "num_env_steps_sampled": 5794080, "num_env_steps_trained": 5794080, "num_agent_steps_sampled": 5794080, "num_agent_steps_trained": 5794080}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35106.79647844005, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8920274898689885, "mean_inference_ms": 0.3700549517869945, "mean_action_processing_ms": 0.09201248300949301, "mean_env_wait_ms": 1.345510809264541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476381301879883, "StateBufferConnector_ms": 0.0026688575744628906, "ViewRequirementAgentConnector_ms": 0.0666346549987793}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35106.79647844005, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35235.27870872051, -35345.92802735819, -35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8920274898689885, "mean_inference_ms": 0.3700549517869945, "mean_action_processing_ms": 0.09201248300949301, "mean_env_wait_ms": 1.345510809264541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476381301879883, "StateBufferConnector_ms": 0.0026688575744628906, "ViewRequirementAgentConnector_ms": 0.0666346549987793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5794080, "num_agent_steps_trained": 5794080, "num_env_steps_sampled": 5794080, "num_env_steps_trained": 5794080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.5825137480159, "num_env_steps_trained_throughput_per_sec": 367.5825137480159, "timesteps_total": 5794080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5794080, "timers": {"training_iteration_time_ms": 9729.198, "sample_time_ms": 9631.192, "load_time_ms": 1.678, "load_throughput": 2145088.776, "learn_time_ms": 95.332, "learn_throughput": 37762.595, "synch_weights_time_ms": 0.907}, "counters": {"num_env_steps_sampled": 5794080, "num_env_steps_trained": 5794080, "num_agent_steps_sampled": 5794080, "num_agent_steps_trained": 5794080}, "done": false, "episodes_total": 1402, "training_iteration": 688, "trial_id": "ee88a_00000", "date": "2023-07-25_04-20-52", "timestamp": 1690248052, "time_this_iter_s": 19.590462923049927, "time_total_s": 12075.714602947235, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1950.9121253490448, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 22.09642857142857, "ram_util_percent": 77.21071428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.548148148148149e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.497928074428, "policy_loss": -15027487801110.857, "vf_loss": 46095316.58928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11172.5, "diff_num_grad_updates_vs_sampler_policy": 11171.5}}, "num_env_steps_sampled": 5801280, "num_env_steps_trained": 5801280, "num_agent_steps_sampled": 5801280, "num_agent_steps_trained": 5801280}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35103.21740888133, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8921184270737156, "mean_inference_ms": 0.37006410920504423, "mean_action_processing_ms": 0.09201341274542445, "mean_env_wait_ms": 1.3449030551717345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480672836303711, "StateBufferConnector_ms": 0.002663135528564453, "ViewRequirementAgentConnector_ms": 0.0666813850402832}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35103.21740888133, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35373.35317549436, -35503.458945979466, -35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8921184270737156, "mean_inference_ms": 0.37006410920504423, "mean_action_processing_ms": 0.09201341274542445, "mean_env_wait_ms": 1.3449030551717345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480672836303711, "StateBufferConnector_ms": 0.002663135528564453, "ViewRequirementAgentConnector_ms": 0.0666813850402832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5801280, "num_agent_steps_trained": 5801280, "num_env_steps_sampled": 5801280, "num_env_steps_trained": 5801280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.68851619663707, "num_env_steps_trained_throughput_per_sec": 367.68851619663707, "timesteps_total": 5801280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5801280, "timers": {"training_iteration_time_ms": 9758.542, "sample_time_ms": 9660.424, "load_time_ms": 1.632, "load_throughput": 2206238.223, "learn_time_ms": 95.501, "learn_throughput": 37695.83, "synch_weights_time_ms": 0.901}, "counters": {"num_env_steps_sampled": 5801280, "num_env_steps_trained": 5801280, "num_agent_steps_sampled": 5801280, "num_agent_steps_trained": 5801280}, "done": false, "episodes_total": 1404, "training_iteration": 689, "trial_id": "ee88a_00000", "date": "2023-07-25_04-21-12", "timestamp": 1690248072, "time_this_iter_s": 19.584980249404907, "time_total_s": 12095.29958319664, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1970.4971055984497, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 21.639285714285716, "ram_util_percent": 77.20714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.881481481481481e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.498044695173, "policy_loss": -14154855567664.143, "vf_loss": 45440536.89285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11284.5, "diff_num_grad_updates_vs_sampler_policy": 11283.5}}, "num_env_steps_sampled": 5808480, "num_env_steps_trained": 5808480, "num_agent_steps_sampled": 5808480, "num_agent_steps_trained": 5808480}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35094.970801195326, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.892206785396844, "mean_inference_ms": 0.3700730855744572, "mean_action_processing_ms": 0.09201436551571758, "mean_env_wait_ms": 1.344321593326689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034770965576171875, "StateBufferConnector_ms": 0.002669095993041992, "ViewRequirementAgentConnector_ms": 0.066680908203125}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35608.75986853174, "episode_reward_mean": -35094.970801195326, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35608.75986853174, -35353.46030373057, -35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.892206785396844, "mean_inference_ms": 0.3700730855744572, "mean_action_processing_ms": 0.09201436551571758, "mean_env_wait_ms": 1.344321593326689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034770965576171875, "StateBufferConnector_ms": 0.002669095993041992, "ViewRequirementAgentConnector_ms": 0.066680908203125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5808480, "num_agent_steps_trained": 5808480, "num_env_steps_sampled": 5808480, "num_env_steps_trained": 5808480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 365.5925239006852, "num_env_steps_trained_throughput_per_sec": 365.5925239006852, "timesteps_total": 5808480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5808480, "timers": {"training_iteration_time_ms": 9781.118, "sample_time_ms": 9683.588, "load_time_ms": 1.617, "load_throughput": 2226801.321, "learn_time_ms": 94.899, "learn_throughput": 37935.226, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 5808480, "num_env_steps_trained": 5808480, "num_agent_steps_sampled": 5808480, "num_agent_steps_trained": 5808480}, "done": false, "episodes_total": 1406, "training_iteration": 690, "trial_id": "ee88a_00000", "date": "2023-07-25_04-21-31", "timestamp": 1690248091, "time_this_iter_s": 19.6975839138031, "time_total_s": 12114.997167110443, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1990.1946895122528, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 21.014285714285716, "ram_util_percent": 77.10714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.214814814814815e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4980850219727, "policy_loss": -11993763751310.857, "vf_loss": 45918618.553571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11396.5, "diff_num_grad_updates_vs_sampler_policy": 11395.5}}, "num_env_steps_sampled": 5815680, "num_env_steps_trained": 5815680, "num_agent_steps_sampled": 5815680, "num_agent_steps_trained": 5815680}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35087.04391554715, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8922971132710384, "mean_inference_ms": 0.3700825340462255, "mean_action_processing_ms": 0.09201533854846566, "mean_env_wait_ms": 1.3437578132166157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034830570220947266, "StateBufferConnector_ms": 0.0026679039001464844, "ViewRequirementAgentConnector_ms": 0.06669878959655762}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35087.04391554715, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35267.9000572374, -35066.18154966673, -35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8922971132710384, "mean_inference_ms": 0.3700825340462255, "mean_action_processing_ms": 0.09201533854846566, "mean_env_wait_ms": 1.3437578132166157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034830570220947266, "StateBufferConnector_ms": 0.0026679039001464844, "ViewRequirementAgentConnector_ms": 0.06669878959655762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5815680, "num_agent_steps_trained": 5815680, "num_env_steps_sampled": 5815680, "num_env_steps_trained": 5815680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.80225889252887, "num_env_steps_trained_throughput_per_sec": 366.80225889252887, "timesteps_total": 5815680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5815680, "timers": {"training_iteration_time_ms": 9801.349, "sample_time_ms": 9704.114, "load_time_ms": 1.569, "load_throughput": 2294790.863, "learn_time_ms": 94.658, "learn_throughput": 38031.835, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 5815680, "num_env_steps_trained": 5815680, "num_agent_steps_sampled": 5815680, "num_agent_steps_trained": 5815680}, "done": false, "episodes_total": 1408, "training_iteration": 691, "trial_id": "ee88a_00000", "date": "2023-07-25_04-21-51", "timestamp": 1690248111, "time_this_iter_s": 19.63203191757202, "time_total_s": 12134.629199028015, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2009.8267214298248, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 23.266666666666666, "ram_util_percent": 77.02222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.548148148148148e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4981035505023, "policy_loss": -8640416176025.357, "vf_loss": 46058587.73214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11508.5, "diff_num_grad_updates_vs_sampler_policy": 11507.5}}, "num_env_steps_sampled": 5822880, "num_env_steps_trained": 5822880, "num_agent_steps_sampled": 5822880, "num_agent_steps_trained": 5822880}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35087.12155351085, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8923937543058585, "mean_inference_ms": 0.3700918151586287, "mean_action_processing_ms": 0.09201628299688476, "mean_env_wait_ms": 1.3432048025136467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476858139038086, "StateBufferConnector_ms": 0.002671957015991211, "ViewRequirementAgentConnector_ms": 0.06670427322387695}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35087.12155351085, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35104.63768922716, -34765.29306214835, -35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8923937543058585, "mean_inference_ms": 0.3700918151586287, "mean_action_processing_ms": 0.09201628299688476, "mean_env_wait_ms": 1.3432048025136467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476858139038086, "StateBufferConnector_ms": 0.002671957015991211, "ViewRequirementAgentConnector_ms": 0.06670427322387695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5822880, "num_agent_steps_trained": 5822880, "num_env_steps_sampled": 5822880, "num_env_steps_trained": 5822880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.4211465057079, "num_env_steps_trained_throughput_per_sec": 368.4211465057079, "timesteps_total": 5822880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5822880, "timers": {"training_iteration_time_ms": 9803.508, "sample_time_ms": 9706.865, "load_time_ms": 1.506, "load_throughput": 2390825.005, "learn_time_ms": 94.247, "learn_throughput": 38197.548, "synch_weights_time_ms": 0.833}, "counters": {"num_env_steps_sampled": 5822880, "num_env_steps_trained": 5822880, "num_agent_steps_sampled": 5822880, "num_agent_steps_trained": 5822880}, "done": false, "episodes_total": 1410, "training_iteration": 692, "trial_id": "ee88a_00000", "date": "2023-07-25_04-22-11", "timestamp": 1690248131, "time_this_iter_s": 19.546114921569824, "time_total_s": 12154.175313949585, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2029.3728363513947, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 21.61428571428571, "ram_util_percent": 77.13571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.881481481481481e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4981024605887, "policy_loss": -6994081516604.088, "vf_loss": 45274349.10714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11620.5, "diff_num_grad_updates_vs_sampler_policy": 11619.5}}, "num_env_steps_sampled": 5830080, "num_env_steps_trained": 5830080, "num_agent_steps_sampled": 5830080, "num_agent_steps_trained": 5830080}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35089.78217784702, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8924955770855738, "mean_inference_ms": 0.3701011816427592, "mean_action_processing_ms": 0.0920172142616029, "mean_env_wait_ms": 1.3426558804820619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034847259521484375, "StateBufferConnector_ms": 0.0026712417602539062, "ViewRequirementAgentConnector_ms": 0.06670784950256348}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35089.78217784702, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35325.248737137204, -35142.47592987593, -35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8924955770855738, "mean_inference_ms": 0.3701011816427592, "mean_action_processing_ms": 0.0920172142616029, "mean_env_wait_ms": 1.3426558804820619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034847259521484375, "StateBufferConnector_ms": 0.0026712417602539062, "ViewRequirementAgentConnector_ms": 0.06670784950256348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5830080, "num_agent_steps_trained": 5830080, "num_env_steps_sampled": 5830080, "num_env_steps_trained": 5830080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.9657005086253, "num_env_steps_trained_throughput_per_sec": 368.9657005086253, "timesteps_total": 5830080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5830080, "timers": {"training_iteration_time_ms": 9796.165, "sample_time_ms": 9699.591, "load_time_ms": 1.442, "load_throughput": 2496444.415, "learn_time_ms": 94.248, "learn_throughput": 38197.093, "synch_weights_time_ms": 0.826}, "counters": {"num_env_steps_sampled": 5830080, "num_env_steps_trained": 5830080, "num_agent_steps_sampled": 5830080, "num_agent_steps_trained": 5830080}, "done": false, "episodes_total": 1412, "training_iteration": 693, "trial_id": "ee88a_00000", "date": "2023-07-25_04-22-30", "timestamp": 1690248150, "time_this_iter_s": 19.517101049423218, "time_total_s": 12173.692414999008, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2048.889937400818, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 21.946428571428573, "ram_util_percent": 77.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.214814814814814e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4791673932757, "policy_loss": -5445361191753.929, "vf_loss": 45715091.51785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11732.5, "diff_num_grad_updates_vs_sampler_policy": 11731.5}}, "num_env_steps_sampled": 5837280, "num_env_steps_trained": 5837280, "num_agent_steps_sampled": 5837280, "num_agent_steps_trained": 5837280}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35087.78044745825, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8926076334426283, "mean_inference_ms": 0.37011116554788176, "mean_action_processing_ms": 0.092018270425927, "mean_env_wait_ms": 1.3421091315248004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003488779067993164, "StateBufferConnector_ms": 0.0026710033416748047, "ViewRequirementAgentConnector_ms": 0.06671619415283203}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35087.78044745825, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35063.55034291961, -34906.40326359777, -35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8926076334426283, "mean_inference_ms": 0.37011116554788176, "mean_action_processing_ms": 0.092018270425927, "mean_env_wait_ms": 1.3421091315248004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003488779067993164, "StateBufferConnector_ms": 0.0026710033416748047, "ViewRequirementAgentConnector_ms": 0.06671619415283203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5837280, "num_agent_steps_trained": 5837280, "num_env_steps_sampled": 5837280, "num_env_steps_trained": 5837280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.62169490899794, "num_env_steps_trained_throughput_per_sec": 368.62169490899794, "timesteps_total": 5837280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5837280, "timers": {"training_iteration_time_ms": 9791.208, "sample_time_ms": 9694.704, "load_time_ms": 1.469, "load_throughput": 2450381.266, "learn_time_ms": 94.142, "learn_throughput": 38240.267, "synch_weights_time_ms": 0.836}, "counters": {"num_env_steps_sampled": 5837280, "num_env_steps_trained": 5837280, "num_agent_steps_sampled": 5837280, "num_agent_steps_trained": 5837280}, "done": false, "episodes_total": 1414, "training_iteration": 694, "trial_id": "ee88a_00000", "date": "2023-07-25_04-22-50", "timestamp": 1690248170, "time_this_iter_s": 19.535211086273193, "time_total_s": 12193.227626085281, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2068.425148487091, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 21.425000000000004, "ram_util_percent": 77.2535714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.638518518518519e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.479124886649, "policy_loss": -4814959979422.286, "vf_loss": 45843944.71428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11844.5, "diff_num_grad_updates_vs_sampler_policy": 11843.5}}, "num_env_steps_sampled": 5844480, "num_env_steps_trained": 5844480, "num_agent_steps_sampled": 5844480, "num_agent_steps_trained": 5844480}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35089.306890633336, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8927355535253915, "mean_inference_ms": 0.3701215110800479, "mean_action_processing_ms": 0.0920194665085303, "mean_env_wait_ms": 1.3415646446685074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034842491149902344, "StateBufferConnector_ms": 0.002666950225830078, "ViewRequirementAgentConnector_ms": 0.06669282913208008}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35089.306890633336, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35246.414883074176, -34920.65294651439, -35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8927355535253915, "mean_inference_ms": 0.3701215110800479, "mean_action_processing_ms": 0.0920194665085303, "mean_env_wait_ms": 1.3415646446685074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034842491149902344, "StateBufferConnector_ms": 0.002666950225830078, "ViewRequirementAgentConnector_ms": 0.06669282913208008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5844480, "num_agent_steps_trained": 5844480, "num_env_steps_sampled": 5844480, "num_env_steps_trained": 5844480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.14931753907894, "num_env_steps_trained_throughput_per_sec": 366.14931753907894, "timesteps_total": 5844480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5844480, "timers": {"training_iteration_time_ms": 9788.213, "sample_time_ms": 9691.608, "load_time_ms": 1.487, "load_throughput": 2420527.789, "learn_time_ms": 94.238, "learn_throughput": 38201.172, "synch_weights_time_ms": 0.823}, "counters": {"num_env_steps_sampled": 5844480, "num_env_steps_trained": 5844480, "num_agent_steps_sampled": 5844480, "num_agent_steps_trained": 5844480}, "done": false, "episodes_total": 1416, "training_iteration": 695, "trial_id": "ee88a_00000", "date": "2023-07-25_04-23-09", "timestamp": 1690248189, "time_this_iter_s": 19.667128801345825, "time_total_s": 12212.894754886627, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2088.092277288437, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 21.97407407407407, "ram_util_percent": 77.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.105185185185184e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4735194614956, "policy_loss": -3677500560279.0024, "vf_loss": 45608071.28571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11956.5, "diff_num_grad_updates_vs_sampler_policy": 11955.5}}, "num_env_steps_sampled": 5851680, "num_env_steps_trained": 5851680, "num_agent_steps_sampled": 5851680, "num_agent_steps_trained": 5851680}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35091.691282165986, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8928734998173639, "mean_inference_ms": 0.3701325115526167, "mean_action_processing_ms": 0.09202084772928398, "mean_env_wait_ms": 1.3410255695275726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034792423248291016, "StateBufferConnector_ms": 0.002668619155883789, "ViewRequirementAgentConnector_ms": 0.06668424606323242}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35091.691282165986, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35155.96997971056, -35268.384375309644, -34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8928734998173639, "mean_inference_ms": 0.3701325115526167, "mean_action_processing_ms": 0.09202084772928398, "mean_env_wait_ms": 1.3410255695275726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034792423248291016, "StateBufferConnector_ms": 0.002668619155883789, "ViewRequirementAgentConnector_ms": 0.06668424606323242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5851680, "num_agent_steps_trained": 5851680, "num_env_steps_sampled": 5851680, "num_env_steps_trained": 5851680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.93270973473153, "num_env_steps_trained_throughput_per_sec": 368.93270973473153, "timesteps_total": 5851680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5851680, "timers": {"training_iteration_time_ms": 9776.878, "sample_time_ms": 9680.283, "load_time_ms": 1.521, "load_throughput": 2367508.294, "learn_time_ms": 94.187, "learn_throughput": 38222.03, "synch_weights_time_ms": 0.829}, "counters": {"num_env_steps_sampled": 5851680, "num_env_steps_trained": 5851680, "num_agent_steps_sampled": 5851680, "num_agent_steps_trained": 5851680}, "done": false, "episodes_total": 1418, "training_iteration": 696, "trial_id": "ee88a_00000", "date": "2023-07-25_04-23-29", "timestamp": 1690248209, "time_this_iter_s": 19.518577098846436, "time_total_s": 12232.413331985474, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2107.6108543872833, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 22.967857142857145, "ram_util_percent": 77.13214285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.571851851851851e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4725341796875, "policy_loss": -2570876721920.0, "vf_loss": 45527218.73214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12068.5, "diff_num_grad_updates_vs_sampler_policy": 12067.5}}, "num_env_steps_sampled": 5858880, "num_env_steps_trained": 5858880, "num_agent_steps_sampled": 5858880, "num_agent_steps_trained": 5858880}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35087.14251493356, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8930136235878985, "mean_inference_ms": 0.37014371075221414, "mean_action_processing_ms": 0.09202231240652761, "mean_env_wait_ms": 1.3405008417707571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034835338592529297, "StateBufferConnector_ms": 0.0026674270629882812, "ViewRequirementAgentConnector_ms": 0.06668353080749512}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35087.14251493356, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34870.93121379618, -34918.04444604249, -35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8930136235878985, "mean_inference_ms": 0.37014371075221414, "mean_action_processing_ms": 0.09202231240652761, "mean_env_wait_ms": 1.3405008417707571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034835338592529297, "StateBufferConnector_ms": 0.0026674270629882812, "ViewRequirementAgentConnector_ms": 0.06668353080749512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5858880, "num_agent_steps_trained": 5858880, "num_env_steps_sampled": 5858880, "num_env_steps_trained": 5858880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.1974873044687, "num_env_steps_trained_throughput_per_sec": 369.1974873044687, "timesteps_total": 5858880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5858880, "timers": {"training_iteration_time_ms": 9772.769, "sample_time_ms": 9676.345, "load_time_ms": 1.489, "load_throughput": 2417543.693, "learn_time_ms": 94.042, "learn_throughput": 38280.675, "synch_weights_time_ms": 0.834}, "counters": {"num_env_steps_sampled": 5858880, "num_env_steps_trained": 5858880, "num_agent_steps_sampled": 5858880, "num_agent_steps_trained": 5858880}, "done": false, "episodes_total": 1420, "training_iteration": 697, "trial_id": "ee88a_00000", "date": "2023-07-25_04-23-48", "timestamp": 1690248228, "time_this_iter_s": 19.50463104248047, "time_total_s": 12251.917963027954, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2127.115485429764, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 21.17142857142857, "ram_util_percent": 77.20714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.038518518518518e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4725341796875, "policy_loss": -1877238634266.3572, "vf_loss": 46298247.60714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12180.5, "diff_num_grad_updates_vs_sampler_policy": 12179.5}}, "num_env_steps_sampled": 5866080, "num_env_steps_trained": 5866080, "num_agent_steps_sampled": 5866080, "num_agent_steps_trained": 5866080}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35094.11662958549, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8931452890685125, "mean_inference_ms": 0.3701545793106986, "mean_action_processing_ms": 0.09202369008669063, "mean_env_wait_ms": 1.339996041224756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034818649291992188, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06668400764465332}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35094.11662958549, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35056.44984974774, -35299.433888716245, -34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8931452890685125, "mean_inference_ms": 0.3701545793106986, "mean_action_processing_ms": 0.09202369008669063, "mean_env_wait_ms": 1.339996041224756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034818649291992188, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06668400764465332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5866080, "num_agent_steps_trained": 5866080, "num_env_steps_sampled": 5866080, "num_env_steps_trained": 5866080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.87393049576474, "num_env_steps_trained_throughput_per_sec": 369.87393049576474, "timesteps_total": 5866080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5866080, "timers": {"training_iteration_time_ms": 9767.977, "sample_time_ms": 9671.514, "load_time_ms": 1.596, "load_throughput": 2255642.192, "learn_time_ms": 93.979, "learn_throughput": 38306.624, "synch_weights_time_ms": 0.83}, "counters": {"num_env_steps_sampled": 5866080, "num_env_steps_trained": 5866080, "num_agent_steps_sampled": 5866080, "num_agent_steps_trained": 5866080}, "done": false, "episodes_total": 1422, "training_iteration": 698, "trial_id": "ee88a_00000", "date": "2023-07-25_04-24-08", "timestamp": 1690248248, "time_this_iter_s": 19.46907687187195, "time_total_s": 12271.387039899826, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2146.5845623016357, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 21.55185185185185, "ram_util_percent": 77.10740740740741}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5051851851851847e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4725341796875, "policy_loss": -1211985331401.0715, "vf_loss": 45472652.03571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12292.5, "diff_num_grad_updates_vs_sampler_policy": 12291.5}}, "num_env_steps_sampled": 5873280, "num_env_steps_trained": 5873280, "num_agent_steps_sampled": 5873280, "num_agent_steps_trained": 5873280}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35094.70290008248, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8932610359309734, "mean_inference_ms": 0.3701655635812767, "mean_action_processing_ms": 0.09202498935316264, "mean_env_wait_ms": 1.339514119038472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034804344177246094, "StateBufferConnector_ms": 0.0026717185974121094, "ViewRequirementAgentConnector_ms": 0.06666827201843262}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35094.70290008248, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34822.53210783134, -35003.951890274984, -35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8932610359309734, "mean_inference_ms": 0.3701655635812767, "mean_action_processing_ms": 0.09202498935316264, "mean_env_wait_ms": 1.339514119038472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034804344177246094, "StateBufferConnector_ms": 0.0026717185974121094, "ViewRequirementAgentConnector_ms": 0.06666827201843262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5873280, "num_agent_steps_trained": 5873280, "num_env_steps_sampled": 5873280, "num_env_steps_trained": 5873280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.63265908871637, "num_env_steps_trained_throughput_per_sec": 371.63265908871637, "timesteps_total": 5873280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5873280, "timers": {"training_iteration_time_ms": 9752.152, "sample_time_ms": 9655.0, "load_time_ms": 1.56, "load_throughput": 2307803.142, "learn_time_ms": 94.704, "learn_throughput": 38013.213, "synch_weights_time_ms": 0.829}, "counters": {"num_env_steps_sampled": 5873280, "num_env_steps_trained": 5873280, "num_agent_steps_sampled": 5873280, "num_agent_steps_trained": 5873280}, "done": false, "episodes_total": 1424, "training_iteration": 699, "trial_id": "ee88a_00000", "date": "2023-07-25_04-24-27", "timestamp": 1690248267, "time_this_iter_s": 19.376880168914795, "time_total_s": 12290.76392006874, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2165.9614424705505, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 23.092857142857145, "ram_util_percent": 77.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9718518518518516e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4725341796875, "policy_loss": -785835948465.5, "vf_loss": 46065498.178571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12404.5, "diff_num_grad_updates_vs_sampler_policy": 12403.5}}, "num_env_steps_sampled": 5880480, "num_env_steps_trained": 5880480, "num_agent_steps_sampled": 5880480, "num_agent_steps_trained": 5880480}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35100.37943653848, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8933631799459775, "mean_inference_ms": 0.3701754807447611, "mean_action_processing_ms": 0.09202614058647242, "mean_env_wait_ms": 1.3390585297459727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034885406494140625, "StateBufferConnector_ms": 0.00267791748046875, "ViewRequirementAgentConnector_ms": 0.06677818298339844}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35100.37943653848, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35360.84193978602, -34915.930619311235, -35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8933631799459775, "mean_inference_ms": 0.3701754807447611, "mean_action_processing_ms": 0.09202614058647242, "mean_env_wait_ms": 1.3390585297459727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034885406494140625, "StateBufferConnector_ms": 0.00267791748046875, "ViewRequirementAgentConnector_ms": 0.06677818298339844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5880480, "num_agent_steps_trained": 5880480, "num_env_steps_sampled": 5880480, "num_env_steps_trained": 5880480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.7999946903759, "num_env_steps_trained_throughput_per_sec": 369.7999946903759, "timesteps_total": 5880480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5880480, "timers": {"training_iteration_time_ms": 9732.74, "sample_time_ms": 9635.726, "load_time_ms": 1.597, "load_throughput": 2253622.244, "learn_time_ms": 94.542, "learn_throughput": 38078.342, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 5880480, "num_env_steps_trained": 5880480, "num_agent_steps_sampled": 5880480, "num_agent_steps_trained": 5880480}, "done": false, "episodes_total": 1426, "training_iteration": 700, "trial_id": "ee88a_00000", "date": "2023-07-25_04-24-47", "timestamp": 1690248287, "time_this_iter_s": 19.472826719284058, "time_total_s": 12310.236746788025, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2185.4342691898346, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 20.97777777777778, "ram_util_percent": 77.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4385185185185184e-08, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4725341796875, "policy_loss": -490988714045.7857, "vf_loss": 45969814.85714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12516.5, "diff_num_grad_updates_vs_sampler_policy": 12515.5}}, "num_env_steps_sampled": 5887680, "num_env_steps_trained": 5887680, "num_agent_steps_sampled": 5887680, "num_agent_steps_trained": 5887680}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35100.38701738206, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8934524507213549, "mean_inference_ms": 0.3701846325880578, "mean_action_processing_ms": 0.09202715572024517, "mean_env_wait_ms": 1.338625671636638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034885406494140625, "StateBufferConnector_ms": 0.002674102783203125, "ViewRequirementAgentConnector_ms": 0.06673550605773926}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35100.38701738206, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35059.83351368199, -34964.75756518244, -35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8934524507213549, "mean_inference_ms": 0.3701846325880578, "mean_action_processing_ms": 0.09202715572024517, "mean_env_wait_ms": 1.338625671636638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034885406494140625, "StateBufferConnector_ms": 0.002674102783203125, "ViewRequirementAgentConnector_ms": 0.06673550605773926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5887680, "num_agent_steps_trained": 5887680, "num_env_steps_sampled": 5887680, "num_env_steps_trained": 5887680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.05581940781565, "num_env_steps_trained_throughput_per_sec": 372.05581940781565, "timesteps_total": 5887680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5887680, "timers": {"training_iteration_time_ms": 9716.357, "sample_time_ms": 9618.769, "load_time_ms": 1.597, "load_throughput": 2254901.125, "learn_time_ms": 95.13, "learn_throughput": 37842.775, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 5887680, "num_env_steps_trained": 5887680, "num_agent_steps_sampled": 5887680, "num_agent_steps_trained": 5887680}, "done": false, "episodes_total": 1428, "training_iteration": 701, "trial_id": "ee88a_00000", "date": "2023-07-25_04-25-06", "timestamp": 1690248306, "time_this_iter_s": 19.35478711128235, "time_total_s": 12329.591533899307, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2204.789056301117, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 21.17142857142857, "ram_util_percent": 77.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4725341796875, "policy_loss": -193517400406.35715, "vf_loss": 45746272.58928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12628.5, "diff_num_grad_updates_vs_sampler_policy": 12627.5}}, "num_env_steps_sampled": 5894880, "num_env_steps_trained": 5894880, "num_agent_steps_sampled": 5894880, "num_agent_steps_trained": 5894880}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35101.274616884046, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8935316338289857, "mean_inference_ms": 0.37019271543575927, "mean_action_processing_ms": 0.092028004927089, "mean_env_wait_ms": 1.338210004554868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487110137939453, "StateBufferConnector_ms": 0.0026748180389404297, "ViewRequirementAgentConnector_ms": 0.06670117378234863}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35408.67166681946, "episode_reward_mean": -35101.274616884046, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35171.86308689748, -35291.876224355576, -34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8935316338289857, "mean_inference_ms": 0.37019271543575927, "mean_action_processing_ms": 0.092028004927089, "mean_env_wait_ms": 1.338210004554868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487110137939453, "StateBufferConnector_ms": 0.0026748180389404297, "ViewRequirementAgentConnector_ms": 0.06670117378234863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5894880, "num_agent_steps_trained": 5894880, "num_env_steps_sampled": 5894880, "num_env_steps_trained": 5894880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.6181517643052, "num_env_steps_trained_throughput_per_sec": 370.6181517643052, "timesteps_total": 5894880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5894880, "timers": {"training_iteration_time_ms": 9708.881, "sample_time_ms": 9610.881, "load_time_ms": 1.596, "load_throughput": 2255642.192, "learn_time_ms": 95.54, "learn_throughput": 37680.713, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 5894880, "num_env_steps_trained": 5894880, "num_agent_steps_sampled": 5894880, "num_agent_steps_trained": 5894880}, "done": false, "episodes_total": 1430, "training_iteration": 702, "trial_id": "ee88a_00000", "date": "2023-07-25_04-25-26", "timestamp": 1690248326, "time_this_iter_s": 19.42980718612671, "time_total_s": 12349.021341085434, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2224.2188634872437, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 21.23703703703704, "ram_util_percent": 76.9074074074074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4725341796875, "policy_loss": -190794518702.4643, "vf_loss": 45567435.071428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12740.5, "diff_num_grad_updates_vs_sampler_policy": 12739.5}}, "num_env_steps_sampled": 5902080, "num_env_steps_trained": 5902080, "num_agent_steps_sampled": 5902080, "num_agent_steps_trained": 5902080}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35448.30848367166, "episode_reward_mean": -35101.63265889687, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8936026237638989, "mean_inference_ms": 0.3702005165550935, "mean_action_processing_ms": 0.09202882537362644, "mean_env_wait_ms": 1.3378053956111429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003496408462524414, "StateBufferConnector_ms": 0.002674579620361328, "ViewRequirementAgentConnector_ms": 0.06672930717468262}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35448.30848367166, "episode_reward_mean": -35101.63265889687, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34844.9223831903, -34727.44596362891, -34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8936026237638989, "mean_inference_ms": 0.3702005165550935, "mean_action_processing_ms": 0.09202882537362644, "mean_env_wait_ms": 1.3378053956111429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003496408462524414, "StateBufferConnector_ms": 0.002674579620361328, "ViewRequirementAgentConnector_ms": 0.06672930717468262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5902080, "num_agent_steps_trained": 5902080, "num_env_steps_sampled": 5902080, "num_env_steps_trained": 5902080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.8881286113222, "num_env_steps_trained_throughput_per_sec": 369.8881286113222, "timesteps_total": 5902080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5902080, "timers": {"training_iteration_time_ms": 9708.807, "sample_time_ms": 9610.702, "load_time_ms": 1.511, "load_throughput": 2382788.808, "learn_time_ms": 95.731, "learn_throughput": 37605.375, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 5902080, "num_env_steps_trained": 5902080, "num_agent_steps_sampled": 5902080, "num_agent_steps_trained": 5902080}, "done": false, "episodes_total": 1432, "training_iteration": 703, "trial_id": "ee88a_00000", "date": "2023-07-25_04-25-45", "timestamp": 1690248345, "time_this_iter_s": 19.46814799308777, "time_total_s": 12368.489489078522, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2243.6870114803314, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 21.83928571428571, "ram_util_percent": 77.0142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4725341796875, "policy_loss": -198585981816.73215, "vf_loss": 46482370.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12852.5, "diff_num_grad_updates_vs_sampler_policy": 12851.5}}, "num_env_steps_sampled": 5909280, "num_env_steps_trained": 5909280, "num_agent_steps_sampled": 5909280, "num_agent_steps_trained": 5909280}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35112.80264156867, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8936685729856373, "mean_inference_ms": 0.3702080610089903, "mean_action_processing_ms": 0.09202962828497957, "mean_env_wait_ms": 1.3374057210566779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034990310668945312, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.0667257308959961}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35112.80264156867, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34970.80112297206, -34899.163960638936, -34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8936685729856373, "mean_inference_ms": 0.3702080610089903, "mean_action_processing_ms": 0.09202962828497957, "mean_env_wait_ms": 1.3374057210566779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034990310668945312, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.0667257308959961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5909280, "num_agent_steps_trained": 5909280, "num_env_steps_sampled": 5909280, "num_env_steps_trained": 5909280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.7536979577048, "num_env_steps_trained_throughput_per_sec": 369.7536979577048, "timesteps_total": 5909280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5909280, "timers": {"training_iteration_time_ms": 9718.652, "sample_time_ms": 9621.262, "load_time_ms": 1.497, "load_throughput": 2405144.059, "learn_time_ms": 95.037, "learn_throughput": 37880.152, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 5909280, "num_env_steps_trained": 5909280, "num_agent_steps_sampled": 5909280, "num_agent_steps_trained": 5909280}, "done": false, "episodes_total": 1434, "training_iteration": 704, "trial_id": "ee88a_00000", "date": "2023-07-25_04-26-05", "timestamp": 1690248365, "time_this_iter_s": 19.47526216506958, "time_total_s": 12387.964751243591, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2263.162273645401, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 21.07037037037037, "ram_util_percent": 76.88888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.467282976423, "policy_loss": -194933318762.2143, "vf_loss": 45311539.428571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12964.5, "diff_num_grad_updates_vs_sampler_policy": 12963.5}}, "num_env_steps_sampled": 5916480, "num_env_steps_trained": 5916480, "num_agent_steps_sampled": 5916480, "num_agent_steps_trained": 5916480}, "sampler_results": {"episode_reward_max": -34715.069846370985, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35114.012989785435, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8937324260194585, "mean_inference_ms": 0.37021543610190194, "mean_action_processing_ms": 0.09203049741528649, "mean_env_wait_ms": 1.33700882990155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350189208984375, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.06673717498779297}}, "episode_reward_max": -34715.069846370985, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35114.012989785435, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34715.069846370985, -34717.395488745125, -35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8937324260194585, "mean_inference_ms": 0.37021543610190194, "mean_action_processing_ms": 0.09203049741528649, "mean_env_wait_ms": 1.33700882990155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350189208984375, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.06673717498779297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5916480, "num_agent_steps_trained": 5916480, "num_env_steps_sampled": 5916480, "num_env_steps_trained": 5916480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.2998085464697, "num_env_steps_trained_throughput_per_sec": 367.2998085464697, "timesteps_total": 5916480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5916480, "timers": {"training_iteration_time_ms": 9731.905, "sample_time_ms": 9634.607, "load_time_ms": 1.462, "load_throughput": 2461887.467, "learn_time_ms": 94.973, "learn_throughput": 37905.389, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 5916480, "num_env_steps_trained": 5916480, "num_agent_steps_sampled": 5916480, "num_agent_steps_trained": 5916480}, "done": false, "episodes_total": 1436, "training_iteration": 705, "trial_id": "ee88a_00000", "date": "2023-07-25_04-26-24", "timestamp": 1690248384, "time_this_iter_s": 19.605448961257935, "time_total_s": 12407.57020020485, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2282.767722606659, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 23.12857142857143, "ram_util_percent": 77.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4670333862305, "policy_loss": -179118449521.99554, "vf_loss": 45459778.71428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13076.5, "diff_num_grad_updates_vs_sampler_policy": 13075.5}}, "num_env_steps_sampled": 5923680, "num_env_steps_trained": 5923680, "num_agent_steps_sampled": 5923680, "num_agent_steps_trained": 5923680}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35122.38616764593, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8937838107414916, "mean_inference_ms": 0.3702236206975492, "mean_action_processing_ms": 0.09203138963049495, "mean_env_wait_ms": 1.336619200274834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003507852554321289, "StateBufferConnector_ms": 0.002669095993041992, "ViewRequirementAgentConnector_ms": 0.06670761108398438}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35122.38616764593, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35050.34443334461, -34970.529522381585, -35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8937838107414916, "mean_inference_ms": 0.3702236206975492, "mean_action_processing_ms": 0.09203138963049495, "mean_env_wait_ms": 1.336619200274834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003507852554321289, "StateBufferConnector_ms": 0.002669095993041992, "ViewRequirementAgentConnector_ms": 0.06670761108398438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5923680, "num_agent_steps_trained": 5923680, "num_env_steps_sampled": 5923680, "num_env_steps_trained": 5923680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.8788661949517, "num_env_steps_trained_throughput_per_sec": 372.8788661949517, "timesteps_total": 5923680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5923680, "timers": {"training_iteration_time_ms": 9727.634, "sample_time_ms": 9631.082, "load_time_ms": 1.439, "load_throughput": 2501200.02, "learn_time_ms": 94.251, "learn_throughput": 38195.857, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 5923680, "num_env_steps_trained": 5923680, "num_agent_steps_sampled": 5923680, "num_agent_steps_trained": 5923680}, "done": false, "episodes_total": 1438, "training_iteration": 706, "trial_id": "ee88a_00000", "date": "2023-07-25_04-26-44", "timestamp": 1690248404, "time_this_iter_s": 19.3121178150177, "time_total_s": 12426.882318019867, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2302.0798404216766, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 24.35357142857143, "ram_util_percent": 77.33214285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4672219412668, "policy_loss": -197787408176.0, "vf_loss": 45856681.33928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13188.5, "diff_num_grad_updates_vs_sampler_policy": 13187.5}}, "num_env_steps_sampled": 5930880, "num_env_steps_trained": 5930880, "num_agent_steps_sampled": 5930880, "num_agent_steps_trained": 5930880}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.11014672933, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8938305272568928, "mean_inference_ms": 0.3702313568834172, "mean_action_processing_ms": 0.09203206759055217, "mean_env_wait_ms": 1.3362341293422464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035080909729003906, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.0667734146118164}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.11014672933, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35230.782624788706, -35147.63732288114, -34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8938305272568928, "mean_inference_ms": 0.3702313568834172, "mean_action_processing_ms": 0.09203206759055217, "mean_env_wait_ms": 1.3362341293422464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035080909729003906, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.0667734146118164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5930880, "num_agent_steps_trained": 5930880, "num_env_steps_sampled": 5930880, "num_env_steps_trained": 5930880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.3911780635061, "num_env_steps_trained_throughput_per_sec": 369.3911780635061, "timesteps_total": 5930880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5930880, "timers": {"training_iteration_time_ms": 9734.087, "sample_time_ms": 9637.782, "load_time_ms": 1.433, "load_throughput": 2511684.615, "learn_time_ms": 94.009, "learn_throughput": 38294.092, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 5930880, "num_env_steps_trained": 5930880, "num_agent_steps_sampled": 5930880, "num_agent_steps_trained": 5930880}, "done": false, "episodes_total": 1440, "training_iteration": 707, "trial_id": "ee88a_00000", "date": "2023-07-25_04-27-03", "timestamp": 1690248423, "time_this_iter_s": 19.494475841522217, "time_total_s": 12446.37679386139, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2321.574316263199, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 21.792592592592595, "ram_util_percent": 77.10740740740741}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4672230311802, "policy_loss": -194304347237.25, "vf_loss": 45436933.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13300.5, "diff_num_grad_updates_vs_sampler_policy": 13299.5}}, "num_env_steps_sampled": 5938080, "num_env_steps_trained": 5938080, "num_agent_steps_sampled": 5938080, "num_agent_steps_trained": 5938080}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.10362931291, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8938749730805361, "mean_inference_ms": 0.37023796349074983, "mean_action_processing_ms": 0.09203253082658286, "mean_env_wait_ms": 1.3358534894499416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035021305084228516, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.06667661666870117}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.10362931291, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34841.606608981165, -35106.407515700725, -35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8938749730805361, "mean_inference_ms": 0.37023796349074983, "mean_action_processing_ms": 0.09203253082658286, "mean_env_wait_ms": 1.3358534894499416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035021305084228516, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.06667661666870117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5938080, "num_agent_steps_trained": 5938080, "num_env_steps_sampled": 5938080, "num_env_steps_trained": 5938080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.2933178391293, "num_env_steps_trained_throughput_per_sec": 368.2933178391293, "timesteps_total": 5938080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5938080, "timers": {"training_iteration_time_ms": 9742.516, "sample_time_ms": 9646.315, "load_time_ms": 1.411, "load_throughput": 2551193.593, "learn_time_ms": 93.933, "learn_throughput": 38325.078, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 5938080, "num_env_steps_trained": 5938080, "num_agent_steps_sampled": 5938080, "num_agent_steps_trained": 5938080}, "done": false, "episodes_total": 1442, "training_iteration": 708, "trial_id": "ee88a_00000", "date": "2023-07-25_04-27-23", "timestamp": 1690248443, "time_this_iter_s": 19.552651166915894, "time_total_s": 12465.929445028305, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2341.1269674301147, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 21.682142857142857, "ram_util_percent": 77.16785714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4672230311802, "policy_loss": -190243461518.4107, "vf_loss": 45696296.35714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13412.5, "diff_num_grad_updates_vs_sampler_policy": 13411.5}}, "num_env_steps_sampled": 5945280, "num_env_steps_trained": 5945280, "num_agent_steps_sampled": 5945280, "num_agent_steps_trained": 5945280}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.79139086009, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8939165346240041, "mean_inference_ms": 0.3702446153190678, "mean_action_processing_ms": 0.09203299422878221, "mean_env_wait_ms": 1.3354788443152006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035042762756347656, "StateBufferConnector_ms": 0.002672433853149414, "ViewRequirementAgentConnector_ms": 0.06669354438781738}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.79139086009, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35179.72175347056, -35075.85010934763, -34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8939165346240041, "mean_inference_ms": 0.3702446153190678, "mean_action_processing_ms": 0.09203299422878221, "mean_env_wait_ms": 1.3354788443152006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035042762756347656, "StateBufferConnector_ms": 0.002672433853149414, "ViewRequirementAgentConnector_ms": 0.06669354438781738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5945280, "num_agent_steps_trained": 5945280, "num_env_steps_sampled": 5945280, "num_env_steps_trained": 5945280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.5494298727988, "num_env_steps_trained_throughput_per_sec": 367.5494298727988, "timesteps_total": 5945280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5945280, "timers": {"training_iteration_time_ms": 9754.194, "sample_time_ms": 9657.451, "load_time_ms": 1.432, "load_throughput": 2514445.122, "learn_time_ms": 94.456, "learn_throughput": 38113.02, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 5945280, "num_env_steps_trained": 5945280, "num_agent_steps_sampled": 5945280, "num_agent_steps_trained": 5945280}, "done": false, "episodes_total": 1444, "training_iteration": 709, "trial_id": "ee88a_00000", "date": "2023-07-25_04-27-42", "timestamp": 1690248462, "time_this_iter_s": 19.59205198287964, "time_total_s": 12485.521497011185, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2360.7190194129944, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 21.749999999999996, "ram_util_percent": 77.11071428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4672219412668, "policy_loss": -192135211482.7857, "vf_loss": 45354446.60714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13524.5, "diff_num_grad_updates_vs_sampler_policy": 13523.5}}, "num_env_steps_sampled": 5952480, "num_env_steps_trained": 5952480, "num_agent_steps_sampled": 5952480, "num_agent_steps_trained": 5952480}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.25382200432, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8939576439406798, "mean_inference_ms": 0.3702518580319845, "mean_action_processing_ms": 0.09203349605023035, "mean_env_wait_ms": 1.3351101392668445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.0026733875274658203, "ViewRequirementAgentConnector_ms": 0.06668734550476074}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.25382200432, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34885.41598297861, -35268.02833128053, -34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8939576439406798, "mean_inference_ms": 0.3702518580319845, "mean_action_processing_ms": 0.09203349605023035, "mean_env_wait_ms": 1.3351101392668445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.0026733875274658203, "ViewRequirementAgentConnector_ms": 0.06668734550476074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5952480, "num_agent_steps_trained": 5952480, "num_env_steps_sampled": 5952480, "num_env_steps_trained": 5952480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.5001908620701, "num_env_steps_trained_throughput_per_sec": 364.5001908620701, "timesteps_total": 5952480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5952480, "timers": {"training_iteration_time_ms": 9769.25, "sample_time_ms": 9672.442, "load_time_ms": 1.46, "load_throughput": 2466431.624, "learn_time_ms": 94.499, "learn_throughput": 38095.76, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 5952480, "num_env_steps_trained": 5952480, "num_agent_steps_sampled": 5952480, "num_agent_steps_trained": 5952480}, "done": false, "episodes_total": 1446, "training_iteration": 710, "trial_id": "ee88a_00000", "date": "2023-07-25_04-28-02", "timestamp": 1690248482, "time_this_iter_s": 19.7562518119812, "time_total_s": 12505.277748823166, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2380.4752712249756, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 21.09642857142858, "ram_util_percent": 77.03928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4672230311802, "policy_loss": -190236387486.51785, "vf_loss": 45474308.821428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13636.5, "diff_num_grad_updates_vs_sampler_policy": 13635.5}}, "num_env_steps_sampled": 5959680, "num_env_steps_trained": 5959680, "num_agent_steps_sampled": 5959680, "num_agent_steps_trained": 5959680}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35124.769915343284, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8940030639547177, "mean_inference_ms": 0.37026024199177615, "mean_action_processing_ms": 0.09203421602069034, "mean_env_wait_ms": 1.33474681607498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.0026717185974121094, "ViewRequirementAgentConnector_ms": 0.06666779518127441}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35124.769915343284, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34881.50441051284, -35154.841001519904, -35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8940030639547177, "mean_inference_ms": 0.37026024199177615, "mean_action_processing_ms": 0.09203421602069034, "mean_env_wait_ms": 1.33474681607498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.0026717185974121094, "ViewRequirementAgentConnector_ms": 0.06666779518127441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5959680, "num_agent_steps_trained": 5959680, "num_env_steps_sampled": 5959680, "num_env_steps_trained": 5959680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.5897646495473, "num_env_steps_trained_throughput_per_sec": 364.5897646495473, "timesteps_total": 5959680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5959680, "timers": {"training_iteration_time_ms": 9813.15, "sample_time_ms": 9715.673, "load_time_ms": 1.456, "load_throughput": 2471680.21, "learn_time_ms": 95.162, "learn_throughput": 37830.298, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 5959680, "num_env_steps_trained": 5959680, "num_agent_steps_sampled": 5959680, "num_agent_steps_trained": 5959680}, "done": false, "episodes_total": 1448, "training_iteration": 711, "trial_id": "ee88a_00000", "date": "2023-07-25_04-28-22", "timestamp": 1690248502, "time_this_iter_s": 19.751039028167725, "time_total_s": 12525.028787851334, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2400.2263102531433, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 23.85714285714286, "ram_util_percent": 76.84285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.456910269601, "policy_loss": -189040216617.14508, "vf_loss": 45310963.16071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13748.5, "diff_num_grad_updates_vs_sampler_policy": 13747.5}}, "num_env_steps_sampled": 5966880, "num_env_steps_trained": 5966880, "num_agent_steps_sampled": 5966880, "num_agent_steps_trained": 5966880}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35124.649330758315, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8940565032597414, "mean_inference_ms": 0.37026941320174034, "mean_action_processing_ms": 0.09203515029108374, "mean_env_wait_ms": 1.3343895767654788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.0026743412017822266, "ViewRequirementAgentConnector_ms": 0.0666649341583252}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35124.649330758315, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35203.6938048337, -35150.421285226934, -34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8940565032597414, "mean_inference_ms": 0.37026941320174034, "mean_action_processing_ms": 0.09203515029108374, "mean_env_wait_ms": 1.3343895767654788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.0026743412017822266, "ViewRequirementAgentConnector_ms": 0.0666649341583252}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5966880, "num_agent_steps_trained": 5966880, "num_env_steps_sampled": 5966880, "num_env_steps_trained": 5966880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.84683475288193, "num_env_steps_trained_throughput_per_sec": 367.84683475288193, "timesteps_total": 5966880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5966880, "timers": {"training_iteration_time_ms": 9821.332, "sample_time_ms": 9723.888, "load_time_ms": 1.452, "load_throughput": 2480124.569, "learn_time_ms": 95.142, "learn_throughput": 37838.204, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 5966880, "num_env_steps_trained": 5966880, "num_agent_steps_sampled": 5966880, "num_agent_steps_trained": 5966880}, "done": false, "episodes_total": 1450, "training_iteration": 712, "trial_id": "ee88a_00000", "date": "2023-07-25_04-28-42", "timestamp": 1690248522, "time_this_iter_s": 19.576235055923462, "time_total_s": 12544.605022907257, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2419.8025453090668, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 22.081481481481482, "ram_util_percent": 75.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4548873901367, "policy_loss": -195277295114.7857, "vf_loss": 45359044.678571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13860.5, "diff_num_grad_updates_vs_sampler_policy": 13859.5}}, "num_env_steps_sampled": 5974080, "num_env_steps_trained": 5974080, "num_agent_steps_sampled": 5974080, "num_agent_steps_trained": 5974080}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35121.43205016042, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8941247088717266, "mean_inference_ms": 0.37027963125289465, "mean_action_processing_ms": 0.09203623183416287, "mean_env_wait_ms": 1.3340358405564836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035085678100585938, "StateBufferConnector_ms": 0.0026738643646240234, "ViewRequirementAgentConnector_ms": 0.06669950485229492}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35121.43205016042, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34934.44961498339, -35229.87845811675, -35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8941247088717266, "mean_inference_ms": 0.37027963125289465, "mean_action_processing_ms": 0.09203623183416287, "mean_env_wait_ms": 1.3340358405564836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035085678100585938, "StateBufferConnector_ms": 0.0026738643646240234, "ViewRequirementAgentConnector_ms": 0.06669950485229492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5974080, "num_agent_steps_trained": 5974080, "num_env_steps_sampled": 5974080, "num_env_steps_trained": 5974080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.47821669464855, "num_env_steps_trained_throughput_per_sec": 364.47821669464855, "timesteps_total": 5974080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5974080, "timers": {"training_iteration_time_ms": 9841.797, "sample_time_ms": 9744.111, "load_time_ms": 1.45, "load_throughput": 2482367.107, "learn_time_ms": 95.377, "learn_throughput": 37744.811, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 5974080, "num_env_steps_trained": 5974080, "num_agent_steps_sampled": 5974080, "num_agent_steps_trained": 5974080}, "done": false, "episodes_total": 1452, "training_iteration": 713, "trial_id": "ee88a_00000", "date": "2023-07-25_04-29-01", "timestamp": 1690248541, "time_this_iter_s": 19.75728487968445, "time_total_s": 12564.362307786942, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2439.559830188751, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 21.36428571428571, "ram_util_percent": 76.21071428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4548797607422, "policy_loss": -196003162158.57144, "vf_loss": 45538753.28571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13972.5, "diff_num_grad_updates_vs_sampler_policy": 13971.5}}, "num_env_steps_sampled": 5981280, "num_env_steps_trained": 5981280, "num_agent_steps_sampled": 5981280, "num_agent_steps_trained": 5981280}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35121.40888267005, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8942038044282, "mean_inference_ms": 0.3702904419066347, "mean_action_processing_ms": 0.09203740290032357, "mean_env_wait_ms": 1.3336832603057027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035104751586914062, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06668663024902344}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35121.40888267005, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35155.32143053913, -35077.65198596081, -35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8942038044282, "mean_inference_ms": 0.3702904419066347, "mean_action_processing_ms": 0.09203740290032357, "mean_env_wait_ms": 1.3336832603057027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035104751586914062, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06668663024902344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5981280, "num_agent_steps_trained": 5981280, "num_env_steps_sampled": 5981280, "num_env_steps_trained": 5981280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.6158049559021, "num_env_steps_trained_throughput_per_sec": 367.6158049559021, "timesteps_total": 5981280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5981280, "timers": {"training_iteration_time_ms": 9841.443, "sample_time_ms": 9744.139, "load_time_ms": 1.475, "load_throughput": 2439927.995, "learn_time_ms": 94.959, "learn_throughput": 37910.976, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 5981280, "num_env_steps_trained": 5981280, "num_agent_steps_sampled": 5981280, "num_agent_steps_trained": 5981280}, "done": false, "episodes_total": 1454, "training_iteration": 714, "trial_id": "ee88a_00000", "date": "2023-07-25_04-29-21", "timestamp": 1690248561, "time_this_iter_s": 19.588477849960327, "time_total_s": 12583.950785636902, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2459.1483080387115, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 21.739285714285717, "ram_util_percent": 76.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4462629045759, "policy_loss": -199244782789.75894, "vf_loss": 46262087.21428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14084.5, "diff_num_grad_updates_vs_sampler_policy": 14083.5}}, "num_env_steps_sampled": 5988480, "num_env_steps_trained": 5988480, "num_agent_steps_sampled": 5988480, "num_agent_steps_trained": 5988480}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.11566123015, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8942848925128116, "mean_inference_ms": 0.37030201193852974, "mean_action_processing_ms": 0.09203867632076305, "mean_env_wait_ms": 1.3333344952723671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035054683685302734, "StateBufferConnector_ms": 0.002674579620361328, "ViewRequirementAgentConnector_ms": 0.06669163703918457}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.11566123015, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35053.93420744604, -35140.745117562874, -35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8942848925128116, "mean_inference_ms": 0.37030201193852974, "mean_action_processing_ms": 0.09203867632076305, "mean_env_wait_ms": 1.3333344952723671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035054683685302734, "StateBufferConnector_ms": 0.002674579620361328, "ViewRequirementAgentConnector_ms": 0.06669163703918457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5988480, "num_agent_steps_trained": 5988480, "num_env_steps_sampled": 5988480, "num_env_steps_trained": 5988480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.6052619781576, "num_env_steps_trained_throughput_per_sec": 370.6052619781576, "timesteps_total": 5988480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5988480, "timers": {"training_iteration_time_ms": 9808.903, "sample_time_ms": 9711.407, "load_time_ms": 1.433, "load_throughput": 2512436.879, "learn_time_ms": 95.192, "learn_throughput": 37818.151, "synch_weights_time_ms": 0.809}, "counters": {"num_env_steps_sampled": 5988480, "num_env_steps_trained": 5988480, "num_agent_steps_sampled": 5988480, "num_agent_steps_trained": 5988480}, "done": false, "episodes_total": 1456, "training_iteration": 715, "trial_id": "ee88a_00000", "date": "2023-07-25_04-29-40", "timestamp": 1690248580, "time_this_iter_s": 19.43052887916565, "time_total_s": 12603.381314516068, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2478.578836917877, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 20.99642857142857, "ram_util_percent": 76.62142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4463500976562, "policy_loss": -190431563461.92856, "vf_loss": 45453649.85714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14196.5, "diff_num_grad_updates_vs_sampler_policy": 14195.5}}, "num_env_steps_sampled": 5995680, "num_env_steps_trained": 5995680, "num_agent_steps_sampled": 5995680, "num_agent_steps_trained": 5995680}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.88057888172, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8943594243720551, "mean_inference_ms": 0.3703140510391668, "mean_action_processing_ms": 0.09204011501302974, "mean_env_wait_ms": 1.3329957108552009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506898880004883, "StateBufferConnector_ms": 0.002675771713256836, "ViewRequirementAgentConnector_ms": 0.06671452522277832}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.88057888172, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35108.97694469025, -35212.80591304811, -35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8943594243720551, "mean_inference_ms": 0.3703140510391668, "mean_action_processing_ms": 0.09204011501302974, "mean_env_wait_ms": 1.3329957108552009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506898880004883, "StateBufferConnector_ms": 0.002675771713256836, "ViewRequirementAgentConnector_ms": 0.06671452522277832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5995680, "num_agent_steps_trained": 5995680, "num_env_steps_sampled": 5995680, "num_env_steps_trained": 5995680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.78540802734227, "num_env_steps_trained_throughput_per_sec": 371.78540802734227, "timesteps_total": 5995680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 5995680, "timers": {"training_iteration_time_ms": 9770.682, "sample_time_ms": 9673.912, "load_time_ms": 1.422, "load_throughput": 2532027.769, "learn_time_ms": 94.482, "learn_throughput": 38102.374, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 5995680, "num_env_steps_trained": 5995680, "num_agent_steps_sampled": 5995680, "num_agent_steps_trained": 5995680}, "done": false, "episodes_total": 1458, "training_iteration": 716, "trial_id": "ee88a_00000", "date": "2023-07-25_04-30-00", "timestamp": 1690248600, "time_this_iter_s": 19.36904788017273, "time_total_s": 12622.75036239624, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2497.94788479805, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 21.66296296296296, "ram_util_percent": 76.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4343675885882, "policy_loss": -197157906891.04242, "vf_loss": 45623805.76785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14308.5, "diff_num_grad_updates_vs_sampler_policy": 14307.5}}, "num_env_steps_sampled": 6002880, "num_env_steps_trained": 6002880, "num_agent_steps_sampled": 6002880, "num_agent_steps_trained": 6002880}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35122.80904135229, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8944251643286841, "mean_inference_ms": 0.37032616323727596, "mean_action_processing_ms": 0.09204157643690096, "mean_env_wait_ms": 1.3326680450161756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034995079040527344, "StateBufferConnector_ms": 0.002679109573364258, "ViewRequirementAgentConnector_ms": 0.0666964054107666}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35122.80904135229, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35230.91044521124, -35042.30606707049, -34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8944251643286841, "mean_inference_ms": 0.37032616323727596, "mean_action_processing_ms": 0.09204157643690096, "mean_env_wait_ms": 1.3326680450161756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034995079040527344, "StateBufferConnector_ms": 0.002679109573364258, "ViewRequirementAgentConnector_ms": 0.0666964054107666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6002880, "num_agent_steps_trained": 6002880, "num_env_steps_sampled": 6002880, "num_env_steps_trained": 6002880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.08141857920896, "num_env_steps_trained_throughput_per_sec": 371.08141857920896, "timesteps_total": 6002880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6002880, "timers": {"training_iteration_time_ms": 9753.62, "sample_time_ms": 9656.921, "load_time_ms": 1.437, "load_throughput": 2505433.222, "learn_time_ms": 94.348, "learn_throughput": 38156.457, "synch_weights_time_ms": 0.849}, "counters": {"num_env_steps_sampled": 6002880, "num_env_steps_trained": 6002880, "num_agent_steps_sampled": 6002880, "num_agent_steps_trained": 6002880}, "done": false, "episodes_total": 1460, "training_iteration": 717, "trial_id": "ee88a_00000", "date": "2023-07-25_04-30-19", "timestamp": 1690248619, "time_this_iter_s": 19.40578007698059, "time_total_s": 12642.15614247322, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2517.3536648750305, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 21.86785714285714, "ram_util_percent": 76.72142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.43310546875, "policy_loss": -198550863940.92856, "vf_loss": 45528896.875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14420.5, "diff_num_grad_updates_vs_sampler_policy": 14419.5}}, "num_env_steps_sampled": 6010080, "num_env_steps_trained": 6010080, "num_agent_steps_sampled": 6010080, "num_agent_steps_trained": 6010080}, "sampler_results": {"episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35122.19643000612, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8944804245517355, "mean_inference_ms": 0.3703380146662606, "mean_action_processing_ms": 0.09204304905724861, "mean_env_wait_ms": 1.332354408918129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035049915313720703, "StateBufferConnector_ms": 0.002687692642211914, "ViewRequirementAgentConnector_ms": 0.06678199768066406}}, "episode_reward_max": -34824.68868298677, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35122.19643000612, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34968.80910492589, -34824.68868298677, -34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8944804245517355, "mean_inference_ms": 0.3703380146662606, "mean_action_processing_ms": 0.09204304905724861, "mean_env_wait_ms": 1.332354408918129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035049915313720703, "StateBufferConnector_ms": 0.002687692642211914, "ViewRequirementAgentConnector_ms": 0.06678199768066406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6010080, "num_agent_steps_trained": 6010080, "num_env_steps_sampled": 6010080, "num_env_steps_trained": 6010080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.9120906801623, "num_env_steps_trained_throughput_per_sec": 368.9120906801623, "timesteps_total": 6010080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6010080, "timers": {"training_iteration_time_ms": 9729.878, "sample_time_ms": 9633.968, "load_time_ms": 1.487, "load_throughput": 2420683.008, "learn_time_ms": 93.517, "learn_throughput": 38495.658, "synch_weights_time_ms": 0.841}, "counters": {"num_env_steps_sampled": 6010080, "num_env_steps_trained": 6010080, "num_agent_steps_sampled": 6010080, "num_agent_steps_trained": 6010080}, "done": false, "episodes_total": 1462, "training_iteration": 718, "trial_id": "ee88a_00000", "date": "2023-07-25_04-30-39", "timestamp": 1690248639, "time_this_iter_s": 19.519618034362793, "time_total_s": 12661.675760507584, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2536.8732829093933, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 20.2, "ram_util_percent": 76.65925925925927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.43310546875, "policy_loss": -192836555156.92856, "vf_loss": 45778418.83928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14532.5, "diff_num_grad_updates_vs_sampler_policy": 14531.5}}, "num_env_steps_sampled": 6017280, "num_env_steps_trained": 6017280, "num_agent_steps_sampled": 6017280, "num_agent_steps_trained": 6017280}, "sampler_results": {"episode_reward_max": -34827.85459181275, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35127.20707516073, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8945276904909822, "mean_inference_ms": 0.3703498878684037, "mean_action_processing_ms": 0.09204453364922, "mean_env_wait_ms": 1.332049303556485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034995079040527344, "StateBufferConnector_ms": 0.0026886463165283203, "ViewRequirementAgentConnector_ms": 0.06681036949157715}}, "episode_reward_max": -34827.85459181275, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35127.20707516073, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34952.79204018344, -34827.85459181275, -35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8945276904909822, "mean_inference_ms": 0.3703498878684037, "mean_action_processing_ms": 0.09204453364922, "mean_env_wait_ms": 1.332049303556485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034995079040527344, "StateBufferConnector_ms": 0.0026886463165283203, "ViewRequirementAgentConnector_ms": 0.06681036949157715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6017280, "num_agent_steps_trained": 6017280, "num_env_steps_sampled": 6017280, "num_env_steps_trained": 6017280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.78846386895356, "num_env_steps_trained_throughput_per_sec": 370.78846386895356, "timesteps_total": 6017280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6017280, "timers": {"training_iteration_time_ms": 9713.119, "sample_time_ms": 9617.452, "load_time_ms": 1.486, "load_throughput": 2422858.17, "learn_time_ms": 93.284, "learn_throughput": 38591.921, "synch_weights_time_ms": 0.832}, "counters": {"num_env_steps_sampled": 6017280, "num_env_steps_trained": 6017280, "num_agent_steps_sampled": 6017280, "num_agent_steps_trained": 6017280}, "done": false, "episodes_total": 1464, "training_iteration": 719, "trial_id": "ee88a_00000", "date": "2023-07-25_04-30-58", "timestamp": 1690248658, "time_this_iter_s": 19.42101788520813, "time_total_s": 12681.096778392792, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2556.2943007946014, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 21.210714285714285, "ram_util_percent": 76.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.43310546875, "policy_loss": -189011950992.5982, "vf_loss": 45306382.46428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14644.5, "diff_num_grad_updates_vs_sampler_policy": 14643.5}}, "num_env_steps_sampled": 6024480, "num_env_steps_trained": 6024480, "num_agent_steps_sampled": 6024480, "num_agent_steps_trained": 6024480}, "sampler_results": {"episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35132.88912481715, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.89457007676233, "mean_inference_ms": 0.370361882196227, "mean_action_processing_ms": 0.09204608852443329, "mean_env_wait_ms": 1.3317504215379523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035054683685302734, "StateBufferConnector_ms": 0.002695322036743164, "ViewRequirementAgentConnector_ms": 0.06690478324890137}}, "episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35132.88912481715, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35334.81983532785, -35002.6856855305, -35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.89457007676233, "mean_inference_ms": 0.370361882196227, "mean_action_processing_ms": 0.09204608852443329, "mean_env_wait_ms": 1.3317504215379523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035054683685302734, "StateBufferConnector_ms": 0.002695322036743164, "ViewRequirementAgentConnector_ms": 0.06690478324890137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6024480, "num_agent_steps_trained": 6024480, "num_env_steps_sampled": 6024480, "num_env_steps_trained": 6024480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.74965710933645, "num_env_steps_trained_throughput_per_sec": 368.74965710933645, "timesteps_total": 6024480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6024480, "timers": {"training_iteration_time_ms": 9722.896, "sample_time_ms": 9627.532, "load_time_ms": 1.538, "load_throughput": 2340898.005, "learn_time_ms": 92.93, "learn_throughput": 38738.803, "synch_weights_time_ms": 0.834}, "counters": {"num_env_steps_sampled": 6024480, "num_env_steps_trained": 6024480, "num_agent_steps_sampled": 6024480, "num_agent_steps_trained": 6024480}, "done": false, "episodes_total": 1466, "training_iteration": 720, "trial_id": "ee88a_00000", "date": "2023-07-25_04-31-18", "timestamp": 1690248678, "time_this_iter_s": 19.52841019630432, "time_total_s": 12700.625188589096, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2575.8227109909058, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 21.83333333333334, "ram_util_percent": 76.58888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.43310546875, "policy_loss": -194786890855.83035, "vf_loss": 45417880.51785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14756.5, "diff_num_grad_updates_vs_sampler_policy": 14755.5}}, "num_env_steps_sampled": 6031680, "num_env_steps_trained": 6031680, "num_agent_steps_sampled": 6031680, "num_agent_steps_trained": 6031680}, "sampler_results": {"episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35129.59987978156, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8946090250279588, "mean_inference_ms": 0.3703737839908017, "mean_action_processing_ms": 0.092047730940315, "mean_env_wait_ms": 1.331460400031188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.002695798873901367, "ViewRequirementAgentConnector_ms": 0.0668783187866211}}, "episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35129.59987978156, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35316.977079851626, -35241.977413156885, -35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8946090250279588, "mean_inference_ms": 0.3703737839908017, "mean_action_processing_ms": 0.092047730940315, "mean_env_wait_ms": 1.331460400031188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.002695798873901367, "ViewRequirementAgentConnector_ms": 0.0668783187866211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6031680, "num_agent_steps_trained": 6031680, "num_env_steps_sampled": 6031680, "num_env_steps_trained": 6031680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.42976028615124, "num_env_steps_trained_throughput_per_sec": 367.42976028615124, "timesteps_total": 6031680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6031680, "timers": {"training_iteration_time_ms": 9745.853, "sample_time_ms": 9649.7, "load_time_ms": 1.543, "load_throughput": 2332905.012, "learn_time_ms": 93.715, "learn_throughput": 38414.351, "synch_weights_time_ms": 0.833}, "counters": {"num_env_steps_sampled": 6031680, "num_env_steps_trained": 6031680, "num_agent_steps_sampled": 6031680, "num_agent_steps_trained": 6031680}, "done": false, "episodes_total": 1468, "training_iteration": 721, "trial_id": "ee88a_00000", "date": "2023-07-25_04-31-37", "timestamp": 1690248697, "time_this_iter_s": 19.59852910041809, "time_total_s": 12720.223717689514, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2595.421240091324, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 21.985714285714288, "ram_util_percent": 76.60714285714288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.43310546875, "policy_loss": -191893524933.37946, "vf_loss": 45791984.71428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14868.5, "diff_num_grad_updates_vs_sampler_policy": 14867.5}}, "num_env_steps_sampled": 6038880, "num_env_steps_trained": 6038880, "num_agent_steps_sampled": 6038880, "num_agent_steps_trained": 6038880}, "sampler_results": {"episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.988371035644, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8946487545051869, "mean_inference_ms": 0.37038439325240446, "mean_action_processing_ms": 0.09204915063086457, "mean_env_wait_ms": 1.3311799657804437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035071372985839844, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.0668783187866211}}, "episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.988371035644, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35302.892757457776, -35035.720695958946, -35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8946487545051869, "mean_inference_ms": 0.37038439325240446, "mean_action_processing_ms": 0.09204915063086457, "mean_env_wait_ms": 1.3311799657804437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035071372985839844, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.0668783187866211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6038880, "num_agent_steps_trained": 6038880, "num_env_steps_sampled": 6038880, "num_env_steps_trained": 6038880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.91335796782374, "num_env_steps_trained_throughput_per_sec": 364.91335796782374, "timesteps_total": 6038880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6038880, "timers": {"training_iteration_time_ms": 9778.65, "sample_time_ms": 9682.658, "load_time_ms": 1.542, "load_throughput": 2334275.485, "learn_time_ms": 93.601, "learn_throughput": 38461.299, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 6038880, "num_env_steps_trained": 6038880, "num_agent_steps_sampled": 6038880, "num_agent_steps_trained": 6038880}, "done": false, "episodes_total": 1470, "training_iteration": 722, "trial_id": "ee88a_00000", "date": "2023-07-25_04-31-57", "timestamp": 1690248717, "time_this_iter_s": 19.73373579978943, "time_total_s": 12739.957453489304, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2615.1549758911133, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 20.78571428571428, "ram_util_percent": 76.49285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.43310546875, "policy_loss": -185942687456.2857, "vf_loss": 45698961.73214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14980.5, "diff_num_grad_updates_vs_sampler_policy": 14979.5}}, "num_env_steps_sampled": 6046080, "num_env_steps_trained": 6046080, "num_agent_steps_sampled": 6046080, "num_agent_steps_trained": 6046080}, "sampler_results": {"episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.98812901086, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8946884815567029, "mean_inference_ms": 0.3703935436922643, "mean_action_processing_ms": 0.09205026651669698, "mean_env_wait_ms": 1.3309022182407464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509521484375, "StateBufferConnector_ms": 0.002687692642211914, "ViewRequirementAgentConnector_ms": 0.06687664985656738}}, "episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.98812901086, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35363.32841298553, -35367.186882907314, -34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8946884815567029, "mean_inference_ms": 0.3703935436922643, "mean_action_processing_ms": 0.09205026651669698, "mean_env_wait_ms": 1.3309022182407464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509521484375, "StateBufferConnector_ms": 0.002687692642211914, "ViewRequirementAgentConnector_ms": 0.06687664985656738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6046080, "num_agent_steps_trained": 6046080, "num_env_steps_sampled": 6046080, "num_env_steps_trained": 6046080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.6192843254162, "num_env_steps_trained_throughput_per_sec": 370.6192843254162, "timesteps_total": 6046080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6046080, "timers": {"training_iteration_time_ms": 9769.659, "sample_time_ms": 9673.191, "load_time_ms": 1.512, "load_throughput": 2380572.366, "learn_time_ms": 94.083, "learn_throughput": 38264.038, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 6046080, "num_env_steps_trained": 6046080, "num_agent_steps_sampled": 6046080, "num_agent_steps_trained": 6046080}, "done": false, "episodes_total": 1472, "training_iteration": 723, "trial_id": "ee88a_00000", "date": "2023-07-25_04-32-17", "timestamp": 1690248737, "time_this_iter_s": 19.429785013198853, "time_total_s": 12759.387238502502, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2634.584760904312, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 23.357142857142854, "ram_util_percent": 76.27142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.43310546875, "policy_loss": -198800490011.0, "vf_loss": 45166773.071428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15092.5, "diff_num_grad_updates_vs_sampler_policy": 15091.5}}, "num_env_steps_sampled": 6053280, "num_env_steps_trained": 6053280, "num_agent_steps_sampled": 6053280, "num_agent_steps_trained": 6053280}, "sampler_results": {"episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35120.19563963995, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8947225009485202, "mean_inference_ms": 0.37040253938771117, "mean_action_processing_ms": 0.092051355515122, "mean_env_wait_ms": 1.3306283485435153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511190414428711, "StateBufferConnector_ms": 0.0026912689208984375, "ViewRequirementAgentConnector_ms": 0.0668799877166748}}, "episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35120.19563963995, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34909.870703272834, -35199.35051167379, -34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8947225009485202, "mean_inference_ms": 0.37040253938771117, "mean_action_processing_ms": 0.092051355515122, "mean_env_wait_ms": 1.3306283485435153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511190414428711, "StateBufferConnector_ms": 0.0026912689208984375, "ViewRequirementAgentConnector_ms": 0.0668799877166748}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6053280, "num_agent_steps_trained": 6053280, "num_env_steps_sampled": 6053280, "num_env_steps_trained": 6053280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 373.05773309906334, "num_env_steps_trained_throughput_per_sec": 373.05773309906334, "timesteps_total": 6053280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6053280, "timers": {"training_iteration_time_ms": 9757.848, "sample_time_ms": 9661.097, "load_time_ms": 1.491, "load_throughput": 2414142.295, "learn_time_ms": 94.389, "learn_throughput": 38139.88, "synch_weights_time_ms": 0.81}, "counters": {"num_env_steps_sampled": 6053280, "num_env_steps_trained": 6053280, "num_agent_steps_sampled": 6053280, "num_agent_steps_trained": 6053280}, "done": false, "episodes_total": 1474, "training_iteration": 724, "trial_id": "ee88a_00000", "date": "2023-07-25_04-32-36", "timestamp": 1690248756, "time_this_iter_s": 19.302922010421753, "time_total_s": 12778.690160512924, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2653.887682914734, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 23.44814814814815, "ram_util_percent": 76.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.43310546875, "policy_loss": -195637493188.57144, "vf_loss": 46056577.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15204.5, "diff_num_grad_updates_vs_sampler_policy": 15203.5}}, "num_env_steps_sampled": 6060480, "num_env_steps_trained": 6060480, "num_agent_steps_sampled": 6060480, "num_agent_steps_trained": 6060480}, "sampler_results": {"episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.15316622046, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8947550574478982, "mean_inference_ms": 0.37041138289516157, "mean_action_processing_ms": 0.09205244583390425, "mean_env_wait_ms": 1.3303595461679594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035152435302734375, "StateBufferConnector_ms": 0.002692699432373047, "ViewRequirementAgentConnector_ms": 0.06687116622924805}}, "episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.15316622046, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34960.51923884724, -35190.46524263516, -34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8947550574478982, "mean_inference_ms": 0.37041138289516157, "mean_action_processing_ms": 0.09205244583390425, "mean_env_wait_ms": 1.3303595461679594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035152435302734375, "StateBufferConnector_ms": 0.002692699432373047, "ViewRequirementAgentConnector_ms": 0.06687116622924805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6060480, "num_agent_steps_trained": 6060480, "num_env_steps_sampled": 6060480, "num_env_steps_trained": 6060480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.69585796256314, "num_env_steps_trained_throughput_per_sec": 368.69585796256314, "timesteps_total": 6060480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6060480, "timers": {"training_iteration_time_ms": 9758.133, "sample_time_ms": 9661.252, "load_time_ms": 1.433, "load_throughput": 2512227.872, "learn_time_ms": 94.571, "learn_throughput": 38066.803, "synch_weights_time_ms": 0.82}, "counters": {"num_env_steps_sampled": 6060480, "num_env_steps_trained": 6060480, "num_agent_steps_sampled": 6060480, "num_agent_steps_trained": 6060480}, "done": false, "episodes_total": 1476, "training_iteration": 725, "trial_id": "ee88a_00000", "date": "2023-07-25_04-32-56", "timestamp": 1690248776, "time_this_iter_s": 19.531128883361816, "time_total_s": 12798.221289396286, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2673.4188117980957, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 21.003571428571426, "ram_util_percent": 76.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.43310546875, "policy_loss": -187233987220.9643, "vf_loss": 46086494.03571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15316.5, "diff_num_grad_updates_vs_sampler_policy": 15315.5}}, "num_env_steps_sampled": 6067680, "num_env_steps_trained": 6067680, "num_agent_steps_sampled": 6067680, "num_agent_steps_trained": 6067680}, "sampler_results": {"episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.47480805572, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8947861723719504, "mean_inference_ms": 0.37042028158949125, "mean_action_processing_ms": 0.09205363212318762, "mean_env_wait_ms": 1.3300938675179226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511667251586914, "StateBufferConnector_ms": 0.002694845199584961, "ViewRequirementAgentConnector_ms": 0.06683564186096191}}, "episode_reward_max": -34880.75652006739, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35125.47480805572, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34950.942435543446, -35189.12639039599, -35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8947861723719504, "mean_inference_ms": 0.37042028158949125, "mean_action_processing_ms": 0.09205363212318762, "mean_env_wait_ms": 1.3300938675179226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511667251586914, "StateBufferConnector_ms": 0.002694845199584961, "ViewRequirementAgentConnector_ms": 0.06683564186096191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6067680, "num_agent_steps_trained": 6067680, "num_env_steps_sampled": 6067680, "num_env_steps_trained": 6067680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.7587685259172, "num_env_steps_trained_throughput_per_sec": 369.7587685259172, "timesteps_total": 6067680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6067680, "timers": {"training_iteration_time_ms": 9745.79, "sample_time_ms": 9649.434, "load_time_ms": 1.423, "load_throughput": 2529101.452, "learn_time_ms": 94.037, "learn_throughput": 38282.849, "synch_weights_time_ms": 0.838}, "counters": {"num_env_steps_sampled": 6067680, "num_env_steps_trained": 6067680, "num_agent_steps_sampled": 6067680, "num_agent_steps_trained": 6067680}, "done": false, "episodes_total": 1478, "training_iteration": 726, "trial_id": "ee88a_00000", "date": "2023-07-25_04-33-15", "timestamp": 1690248795, "time_this_iter_s": 19.475116968154907, "time_total_s": 12817.696406364441, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2692.8939287662506, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 22.44814814814815, "ram_util_percent": 76.27407407407408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4296297345843, "policy_loss": -191852787094.0, "vf_loss": 45185957.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15428.5, "diff_num_grad_updates_vs_sampler_policy": 15427.5}}, "num_env_steps_sampled": 6074880, "num_env_steps_trained": 6074880, "num_agent_steps_sampled": 6074880, "num_agent_steps_trained": 6074880}, "sampler_results": {"episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.392965913205, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8948149333132388, "mean_inference_ms": 0.37042968351093647, "mean_action_processing_ms": 0.09205492578844869, "mean_env_wait_ms": 1.32983146203137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035147666931152344, "StateBufferConnector_ms": 0.0026955604553222656, "ViewRequirementAgentConnector_ms": 0.06684231758117676}}, "episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35123.392965913205, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35027.141134492835, -35227.7673938628, -34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8948149333132388, "mean_inference_ms": 0.37042968351093647, "mean_action_processing_ms": 0.09205492578844869, "mean_env_wait_ms": 1.32983146203137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035147666931152344, "StateBufferConnector_ms": 0.0026955604553222656, "ViewRequirementAgentConnector_ms": 0.06684231758117676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6074880, "num_agent_steps_trained": 6074880, "num_env_steps_sampled": 6074880, "num_env_steps_trained": 6074880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.4606093390762, "num_env_steps_trained_throughput_per_sec": 368.4606093390762, "timesteps_total": 6074880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6074880, "timers": {"training_iteration_time_ms": 9726.795, "sample_time_ms": 9629.988, "load_time_ms": 1.428, "load_throughput": 2520194.679, "learn_time_ms": 94.478, "learn_throughput": 38103.96, "synch_weights_time_ms": 0.841}, "counters": {"num_env_steps_sampled": 6074880, "num_env_steps_trained": 6074880, "num_agent_steps_sampled": 6074880, "num_agent_steps_trained": 6074880}, "done": false, "episodes_total": 1480, "training_iteration": 727, "trial_id": "ee88a_00000", "date": "2023-07-25_04-33-35", "timestamp": 1690248815, "time_this_iter_s": 19.543635845184326, "time_total_s": 12837.240042209625, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2712.437564611435, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 22.27857142857143, "ram_util_percent": 76.37857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4296297345843, "policy_loss": -191374904993.0, "vf_loss": 46059646.53571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15540.5, "diff_num_grad_updates_vs_sampler_policy": 15539.5}}, "num_env_steps_sampled": 6082080, "num_env_steps_trained": 6082080, "num_agent_steps_sampled": 6082080, "num_agent_steps_trained": 6082080}, "sampler_results": {"episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35127.975291642295, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.894843645652414, "mean_inference_ms": 0.3704394214858091, "mean_action_processing_ms": 0.09205627524651741, "mean_env_wait_ms": 1.3295689945091729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035114288330078125, "StateBufferConnector_ms": 0.0026886463165283203, "ViewRequirementAgentConnector_ms": 0.06671476364135742}}, "episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35127.975291642295, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34954.25373711748, -35210.278519141924, -35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.894843645652414, "mean_inference_ms": 0.3704394214858091, "mean_action_processing_ms": 0.09205627524651741, "mean_env_wait_ms": 1.3295689945091729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035114288330078125, "StateBufferConnector_ms": 0.0026886463165283203, "ViewRequirementAgentConnector_ms": 0.06671476364135742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6082080, "num_agent_steps_trained": 6082080, "num_env_steps_sampled": 6082080, "num_env_steps_trained": 6082080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.76886933113406, "num_env_steps_trained_throughput_per_sec": 369.76886933113406, "timesteps_total": 6082080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6082080, "timers": {"training_iteration_time_ms": 9731.263, "sample_time_ms": 9634.629, "load_time_ms": 1.417, "load_throughput": 2540847.494, "learn_time_ms": 94.326, "learn_throughput": 38165.436, "synch_weights_time_ms": 0.832}, "counters": {"num_env_steps_sampled": 6082080, "num_env_steps_trained": 6082080, "num_agent_steps_sampled": 6082080, "num_agent_steps_trained": 6082080}, "done": false, "episodes_total": 1482, "training_iteration": 728, "trial_id": "ee88a_00000", "date": "2023-07-25_04-33-54", "timestamp": 1690248834, "time_this_iter_s": 19.47461223602295, "time_total_s": 12856.714654445648, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2731.912176847458, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 22.896296296296295, "ram_util_percent": 76.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4296319144113, "policy_loss": -196584310699.5357, "vf_loss": 45929486.85714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15652.5, "diff_num_grad_updates_vs_sampler_policy": 15651.5}}, "num_env_steps_sampled": 6089280, "num_env_steps_trained": 6089280, "num_agent_steps_sampled": 6089280, "num_agent_steps_trained": 6089280}, "sampler_results": {"episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35130.52119286085, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8948770127471856, "mean_inference_ms": 0.3704498515371183, "mean_action_processing_ms": 0.09205766830210398, "mean_env_wait_ms": 1.3293071673174972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035080909729003906, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.06675910949707031}}, "episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35130.52119286085, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35384.281961241155, -35057.61492336669, -35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8948770127471856, "mean_inference_ms": 0.3704498515371183, "mean_action_processing_ms": 0.09205766830210398, "mean_env_wait_ms": 1.3293071673174972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035080909729003906, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.06675910949707031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6089280, "num_agent_steps_trained": 6089280, "num_env_steps_sampled": 6089280, "num_env_steps_trained": 6089280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.08142300256134, "num_env_steps_trained_throughput_per_sec": 367.08142300256134, "timesteps_total": 6089280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6089280, "timers": {"training_iteration_time_ms": 9762.684, "sample_time_ms": 9666.466, "load_time_ms": 1.391, "load_throughput": 2587568.016, "learn_time_ms": 93.943, "learn_throughput": 38320.983, "synch_weights_time_ms": 0.826}, "counters": {"num_env_steps_sampled": 6089280, "num_env_steps_trained": 6089280, "num_agent_steps_sampled": 6089280, "num_agent_steps_trained": 6089280}, "done": false, "episodes_total": 1484, "training_iteration": 729, "trial_id": "ee88a_00000", "date": "2023-07-25_04-34-14", "timestamp": 1690248854, "time_this_iter_s": 19.617249965667725, "time_total_s": 12876.331904411316, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2751.5294268131256, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 21.821428571428573, "ram_util_percent": 76.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4296308244977, "policy_loss": -187813427205.39285, "vf_loss": 45454642.446428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15764.5, "diff_num_grad_updates_vs_sampler_policy": 15763.5}}, "num_env_steps_sampled": 6096480, "num_env_steps_trained": 6096480, "num_agent_steps_sampled": 6096480, "num_agent_steps_trained": 6096480}, "sampler_results": {"episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35126.4456525417, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8949139081842193, "mean_inference_ms": 0.37046050304512584, "mean_action_processing_ms": 0.09205908082041685, "mean_env_wait_ms": 1.3290430558422202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498554229736328, "StateBufferConnector_ms": 0.002691030502319336, "ViewRequirementAgentConnector_ms": 0.06658363342285156}}, "episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35126.4456525417, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35279.86705126553, -35227.183388456346, -35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8949139081842193, "mean_inference_ms": 0.37046050304512584, "mean_action_processing_ms": 0.09205908082041685, "mean_env_wait_ms": 1.3290430558422202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498554229736328, "StateBufferConnector_ms": 0.002691030502319336, "ViewRequirementAgentConnector_ms": 0.06658363342285156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6096480, "num_agent_steps_trained": 6096480, "num_env_steps_sampled": 6096480, "num_env_steps_trained": 6096480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.3592854390422, "num_env_steps_trained_throughput_per_sec": 364.3592854390422, "timesteps_total": 6096480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6096480, "timers": {"training_iteration_time_ms": 9785.927, "sample_time_ms": 9690.003, "load_time_ms": 1.394, "load_throughput": 2582346.149, "learn_time_ms": 93.651, "learn_throughput": 38440.502, "synch_weights_time_ms": 0.82}, "counters": {"num_env_steps_sampled": 6096480, "num_env_steps_trained": 6096480, "num_agent_steps_sampled": 6096480, "num_agent_steps_trained": 6096480}, "done": false, "episodes_total": 1486, "training_iteration": 730, "trial_id": "ee88a_00000", "date": "2023-07-25_04-34-34", "timestamp": 1690248874, "time_this_iter_s": 19.76368999481201, "time_total_s": 12896.095594406128, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2771.2931168079376, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 21.625, "ram_util_percent": 76.51428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4215752737863, "policy_loss": -195811249300.78793, "vf_loss": 46184450.58928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15876.5, "diff_num_grad_updates_vs_sampler_policy": 15875.5}}, "num_env_steps_sampled": 6103680, "num_env_steps_trained": 6103680, "num_agent_steps_sampled": 6103680, "num_agent_steps_trained": 6103680}, "sampler_results": {"episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35126.67809423675, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8949611621133952, "mean_inference_ms": 0.3704714937288003, "mean_action_processing_ms": 0.09206051093798688, "mean_env_wait_ms": 1.3287813986556736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034923553466796875, "StateBufferConnector_ms": 0.002691984176635742, "ViewRequirementAgentConnector_ms": 0.0665903091430664}}, "episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35126.67809423675, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35093.978537653515, -35128.07270638331, -35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8949611621133952, "mean_inference_ms": 0.3704714937288003, "mean_action_processing_ms": 0.09206051093798688, "mean_env_wait_ms": 1.3287813986556736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034923553466796875, "StateBufferConnector_ms": 0.002691984176635742, "ViewRequirementAgentConnector_ms": 0.0665903091430664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6103680, "num_agent_steps_trained": 6103680, "num_env_steps_sampled": 6103680, "num_env_steps_trained": 6103680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.20535753532755, "num_env_steps_trained_throughput_per_sec": 367.20535753532755, "timesteps_total": 6103680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6103680, "timers": {"training_iteration_time_ms": 9799.467, "sample_time_ms": 9703.859, "load_time_ms": 1.455, "load_throughput": 2473988.564, "learn_time_ms": 93.289, "learn_throughput": 38589.682, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 6103680, "num_env_steps_trained": 6103680, "num_agent_steps_sampled": 6103680, "num_agent_steps_trained": 6103680}, "done": false, "episodes_total": 1488, "training_iteration": 731, "trial_id": "ee88a_00000", "date": "2023-07-25_04-34-53", "timestamp": 1690248893, "time_this_iter_s": 19.61040496826172, "time_total_s": 12915.70599937439, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2790.9035217761993, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 22.053571428571427, "ram_util_percent": 76.42142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4200439453125, "policy_loss": -194555539481.625, "vf_loss": 45966663.48214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15988.5, "diff_num_grad_updates_vs_sampler_policy": 15987.5}}, "num_env_steps_sampled": 6110880, "num_env_steps_trained": 6110880, "num_agent_steps_sampled": 6110880, "num_agent_steps_trained": 6110880}, "sampler_results": {"episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35129.7583330586, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8950185365789602, "mean_inference_ms": 0.37048376898880675, "mean_action_processing_ms": 0.09206213235252403, "mean_env_wait_ms": 1.3285187277503487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034890174865722656, "StateBufferConnector_ms": 0.0026884078979492188, "ViewRequirementAgentConnector_ms": 0.06659817695617676}}, "episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35129.7583330586, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35090.017241120964, -35046.29810738063, -35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8950185365789602, "mean_inference_ms": 0.37048376898880675, "mean_action_processing_ms": 0.09206213235252403, "mean_env_wait_ms": 1.3285187277503487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034890174865722656, "StateBufferConnector_ms": 0.0026884078979492188, "ViewRequirementAgentConnector_ms": 0.06659817695617676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6110880, "num_agent_steps_trained": 6110880, "num_env_steps_sampled": 6110880, "num_env_steps_trained": 6110880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.1506538026764, "num_env_steps_trained_throughput_per_sec": 366.1506538026764, "timesteps_total": 6110880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6110880, "timers": {"training_iteration_time_ms": 9811.794, "sample_time_ms": 9716.126, "load_time_ms": 1.477, "load_throughput": 2437053.23, "learn_time_ms": 93.34, "learn_throughput": 38568.5, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 6110880, "num_env_steps_trained": 6110880, "num_agent_steps_sampled": 6110880, "num_agent_steps_trained": 6110880}, "done": false, "episodes_total": 1490, "training_iteration": 732, "trial_id": "ee88a_00000", "date": "2023-07-25_04-35-13", "timestamp": 1690248913, "time_this_iter_s": 19.667004108428955, "time_total_s": 12935.373003482819, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2810.5705258846283, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 22.02142857142857, "ram_util_percent": 76.27857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4200439453125, "policy_loss": -195137659240.2857, "vf_loss": 45509708.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16100.5, "diff_num_grad_updates_vs_sampler_policy": 16099.5}}, "num_env_steps_sampled": 6118080, "num_env_steps_trained": 6118080, "num_agent_steps_sampled": 6118080, "num_agent_steps_trained": 6118080}, "sampler_results": {"episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35127.85638089407, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8950781729283398, "mean_inference_ms": 0.37049601689631906, "mean_action_processing_ms": 0.09206374069716244, "mean_env_wait_ms": 1.328261179566627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003489971160888672, "StateBufferConnector_ms": 0.0026869773864746094, "ViewRequirementAgentConnector_ms": 0.06664276123046875}}, "episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35127.85638089407, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35311.24912225199, -34898.22985120575, -34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8950781729283398, "mean_inference_ms": 0.37049601689631906, "mean_action_processing_ms": 0.09206374069716244, "mean_env_wait_ms": 1.328261179566627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003489971160888672, "StateBufferConnector_ms": 0.0026869773864746094, "ViewRequirementAgentConnector_ms": 0.06664276123046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6118080, "num_agent_steps_trained": 6118080, "num_env_steps_sampled": 6118080, "num_env_steps_trained": 6118080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.50661534058054, "num_env_steps_trained_throughput_per_sec": 367.50661534058054, "timesteps_total": 6118080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6118080, "timers": {"training_iteration_time_ms": 9823.781, "sample_time_ms": 9727.927, "load_time_ms": 1.479, "load_throughput": 2434459.951, "learn_time_ms": 93.528, "learn_throughput": 38491.222, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 6118080, "num_env_steps_trained": 6118080, "num_agent_steps_sampled": 6118080, "num_agent_steps_trained": 6118080}, "done": false, "episodes_total": 1492, "training_iteration": 733, "trial_id": "ee88a_00000", "date": "2023-07-25_04-35-33", "timestamp": 1690248933, "time_this_iter_s": 19.595045804977417, "time_total_s": 12954.968049287796, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2830.1655716896057, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 20.792857142857144, "ram_util_percent": 76.29642857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4200439453125, "policy_loss": -188247835343.92856, "vf_loss": 46098890.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16212.5, "diff_num_grad_updates_vs_sampler_policy": 16211.5}}, "num_env_steps_sampled": 6125280, "num_env_steps_trained": 6125280, "num_agent_steps_sampled": 6125280, "num_agent_steps_trained": 6125280}, "sampler_results": {"episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35130.72686815914, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8951321460289899, "mean_inference_ms": 0.3705083491942295, "mean_action_processing_ms": 0.09206536447832878, "mean_env_wait_ms": 1.3280152610056126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00348663330078125, "StateBufferConnector_ms": 0.002684354782104492, "ViewRequirementAgentConnector_ms": 0.0666046142578125}}, "episode_reward_max": -34865.65740556062, "episode_reward_min": -35461.18516568839, "episode_reward_mean": -35130.72686815914, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34967.166422714625, -35145.909848307405, -35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8951321460289899, "mean_inference_ms": 0.3705083491942295, "mean_action_processing_ms": 0.09206536447832878, "mean_env_wait_ms": 1.3280152610056126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00348663330078125, "StateBufferConnector_ms": 0.002684354782104492, "ViewRequirementAgentConnector_ms": 0.0666046142578125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6125280, "num_agent_steps_trained": 6125280, "num_env_steps_sampled": 6125280, "num_env_steps_trained": 6125280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.9006862207434, "num_env_steps_trained_throughput_per_sec": 372.9006862207434, "timesteps_total": 6125280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6125280, "timers": {"training_iteration_time_ms": 9793.172, "sample_time_ms": 9697.43, "load_time_ms": 1.484, "load_throughput": 2426206.218, "learn_time_ms": 93.382, "learn_throughput": 38551.169, "synch_weights_time_ms": 0.817}, "counters": {"num_env_steps_sampled": 6125280, "num_env_steps_trained": 6125280, "num_agent_steps_sampled": 6125280, "num_agent_steps_trained": 6125280}, "done": false, "episodes_total": 1494, "training_iteration": 734, "trial_id": "ee88a_00000", "date": "2023-07-25_04-35-52", "timestamp": 1690248952, "time_this_iter_s": 19.31115412712097, "time_total_s": 12974.279203414917, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2849.4767258167267, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 21.51481481481481, "ram_util_percent": 76.2925925925926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4200439453125, "policy_loss": -193545872797.57144, "vf_loss": 45551882.35714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16324.5, "diff_num_grad_updates_vs_sampler_policy": 16323.5}}, "num_env_steps_sampled": 6132480, "num_env_steps_trained": 6132480, "num_agent_steps_sampled": 6132480, "num_agent_steps_trained": 6132480}, "sampler_results": {"episode_reward_max": -34865.65740556062, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35135.966353427015, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.895186536930702, "mean_inference_ms": 0.37051829695922145, "mean_action_processing_ms": 0.09206646134717142, "mean_env_wait_ms": 1.327774188495716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034852027893066406, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06659913063049316}}, "episode_reward_max": -34865.65740556062, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35135.966353427015, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35340.33750079458, -35198.71680397686, -34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.895186536930702, "mean_inference_ms": 0.37051829695922145, "mean_action_processing_ms": 0.09206646134717142, "mean_env_wait_ms": 1.327774188495716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034852027893066406, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06659913063049316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6132480, "num_agent_steps_trained": 6132480, "num_env_steps_sampled": 6132480, "num_env_steps_trained": 6132480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.4646412555433, "num_env_steps_trained_throughput_per_sec": 371.4646412555433, "timesteps_total": 6132480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6132480, "timers": {"training_iteration_time_ms": 9755.374, "sample_time_ms": 9659.717, "load_time_ms": 1.492, "load_throughput": 2413370.585, "learn_time_ms": 93.299, "learn_throughput": 38585.59, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 6132480, "num_env_steps_trained": 6132480, "num_agent_steps_sampled": 6132480, "num_agent_steps_trained": 6132480}, "done": false, "episodes_total": 1496, "training_iteration": 735, "trial_id": "ee88a_00000", "date": "2023-07-25_04-36-11", "timestamp": 1690248971, "time_this_iter_s": 19.385637044906616, "time_total_s": 12993.664840459824, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2868.8623628616333, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 21.081481481481482, "ram_util_percent": 76.40370370370371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4200439453125, "policy_loss": -188905252048.6652, "vf_loss": 45125352.196428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16436.5, "diff_num_grad_updates_vs_sampler_policy": 16435.5}}, "num_env_steps_sampled": 6139680, "num_env_steps_trained": 6139680, "num_agent_steps_sampled": 6139680, "num_agent_steps_trained": 6139680}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35129.61581511138, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8952353297597265, "mean_inference_ms": 0.3705277936670829, "mean_action_processing_ms": 0.09206744545677191, "mean_env_wait_ms": 1.3275445709878084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484010696411133, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06660342216491699}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35129.61581511138, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34880.75652006739, -35016.78064393851, -35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8952353297597265, "mean_inference_ms": 0.3705277936670829, "mean_action_processing_ms": 0.09206744545677191, "mean_env_wait_ms": 1.3275445709878084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484010696411133, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06660342216491699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6139680, "num_agent_steps_trained": 6139680, "num_env_steps_sampled": 6139680, "num_env_steps_trained": 6139680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.47756215484424, "num_env_steps_trained_throughput_per_sec": 369.47756215484424, "timesteps_total": 6139680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6139680, "timers": {"training_iteration_time_ms": 9743.316, "sample_time_ms": 9647.739, "load_time_ms": 1.458, "load_throughput": 2468568.738, "learn_time_ms": 93.255, "learn_throughput": 38603.781, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 6139680, "num_env_steps_trained": 6139680, "num_agent_steps_sampled": 6139680, "num_agent_steps_trained": 6139680}, "done": false, "episodes_total": 1498, "training_iteration": 736, "trial_id": "ee88a_00000", "date": "2023-07-25_04-36-31", "timestamp": 1690248991, "time_this_iter_s": 19.489789247512817, "time_total_s": 13013.154629707336, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2888.352152109146, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 21.139285714285712, "ram_util_percent": 76.63214285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4200439453125, "policy_loss": -197471816677.1875, "vf_loss": 45727063.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16548.5, "diff_num_grad_updates_vs_sampler_policy": 16547.5}}, "num_env_steps_sampled": 6146880, "num_env_steps_trained": 6146880, "num_agent_steps_sampled": 6146880, "num_agent_steps_trained": 6146880}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35135.73563905668, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8952802634142176, "mean_inference_ms": 0.3705366520044284, "mean_action_processing_ms": 0.09206832518363388, "mean_env_wait_ms": 1.3273219429775336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482818603515625, "StateBufferConnector_ms": 0.002683401107788086, "ViewRequirementAgentConnector_ms": 0.06660223007202148}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35135.73563905668, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35246.70520770991, -35408.67166681946, -34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8952802634142176, "mean_inference_ms": 0.3705366520044284, "mean_action_processing_ms": 0.09206832518363388, "mean_env_wait_ms": 1.3273219429775336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482818603515625, "StateBufferConnector_ms": 0.002683401107788086, "ViewRequirementAgentConnector_ms": 0.06660223007202148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6146880, "num_agent_steps_trained": 6146880, "num_env_steps_sampled": 6146880, "num_env_steps_trained": 6146880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.6692753256629, "num_env_steps_trained_throughput_per_sec": 369.6692753256629, "timesteps_total": 6146880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6146880, "timers": {"training_iteration_time_ms": 9724.599, "sample_time_ms": 9628.642, "load_time_ms": 1.44, "load_throughput": 2499254.237, "learn_time_ms": 93.642, "learn_throughput": 38444.377, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 6146880, "num_env_steps_trained": 6146880, "num_agent_steps_sampled": 6146880, "num_agent_steps_trained": 6146880}, "done": false, "episodes_total": 1500, "training_iteration": 737, "trial_id": "ee88a_00000", "date": "2023-07-25_04-36-50", "timestamp": 1690249010, "time_this_iter_s": 19.480284929275513, "time_total_s": 13032.634914636612, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2907.8324370384216, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 21.810714285714287, "ram_util_percent": 76.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4200439453125, "policy_loss": -191365492092.07144, "vf_loss": 45899824.053571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16660.5, "diff_num_grad_updates_vs_sampler_policy": 16659.5}}, "num_env_steps_sampled": 6154080, "num_env_steps_trained": 6154080, "num_agent_steps_sampled": 6154080, "num_agent_steps_trained": 6154080}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.2308884769, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8953224539912994, "mean_inference_ms": 0.37054483436770896, "mean_action_processing_ms": 0.0920690772821229, "mean_env_wait_ms": 1.3271045090968832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003483295440673828, "StateBufferConnector_ms": 0.0026793479919433594, "ViewRequirementAgentConnector_ms": 0.06661224365234375}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.2308884769, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34908.92328373013, -35314.37649647728, -35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8953224539912994, "mean_inference_ms": 0.37054483436770896, "mean_action_processing_ms": 0.0920690772821229, "mean_env_wait_ms": 1.3271045090968832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003483295440673828, "StateBufferConnector_ms": 0.0026793479919433594, "ViewRequirementAgentConnector_ms": 0.06661224365234375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6154080, "num_agent_steps_trained": 6154080, "num_env_steps_sampled": 6154080, "num_env_steps_trained": 6154080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.1814720441786, "num_env_steps_trained_throughput_per_sec": 368.1814720441786, "timesteps_total": 6154080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6154080, "timers": {"training_iteration_time_ms": 9721.008, "sample_time_ms": 9624.731, "load_time_ms": 1.478, "load_throughput": 2435795.193, "learn_time_ms": 93.939, "learn_throughput": 38322.598, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 6154080, "num_env_steps_trained": 6154080, "num_agent_steps_sampled": 6154080, "num_agent_steps_trained": 6154080}, "done": false, "episodes_total": 1502, "training_iteration": 738, "trial_id": "ee88a_00000", "date": "2023-07-25_04-37-10", "timestamp": 1690249030, "time_this_iter_s": 19.558345079421997, "time_total_s": 13052.193259716034, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2927.3907821178436, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 20.90740740740741, "ram_util_percent": 76.33703703703704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4197202410016, "policy_loss": -194901766176.21652, "vf_loss": 46187327.60714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16772.5, "diff_num_grad_updates_vs_sampler_policy": 16771.5}}, "num_env_steps_sampled": 6161280, "num_env_steps_trained": 6161280, "num_agent_steps_sampled": 6161280, "num_agent_steps_trained": 6161280}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35135.011131062165, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.895360977865655, "mean_inference_ms": 0.37055242608768313, "mean_action_processing_ms": 0.09206975597765968, "mean_env_wait_ms": 1.3268929885165357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.0026836395263671875, "ViewRequirementAgentConnector_ms": 0.0665733814239502}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35135.011131062165, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35068.103863758115, -34984.04748911488, -34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.895360977865655, "mean_inference_ms": 0.37055242608768313, "mean_action_processing_ms": 0.09206975597765968, "mean_env_wait_ms": 1.3268929885165357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.0026836395263671875, "ViewRequirementAgentConnector_ms": 0.0665733814239502}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6161280, "num_agent_steps_trained": 6161280, "num_env_steps_sampled": 6161280, "num_env_steps_trained": 6161280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.2581120223081, "num_env_steps_trained_throughput_per_sec": 368.2581120223081, "timesteps_total": 6161280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6161280, "timers": {"training_iteration_time_ms": 9745.35, "sample_time_ms": 9647.814, "load_time_ms": 1.477, "load_throughput": 2436699.275, "learn_time_ms": 95.209, "learn_throughput": 37811.636, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 6161280, "num_env_steps_trained": 6161280, "num_agent_steps_sampled": 6161280, "num_agent_steps_trained": 6161280}, "done": false, "episodes_total": 1504, "training_iteration": 739, "trial_id": "ee88a_00000", "date": "2023-07-25_04-37-30", "timestamp": 1690249050, "time_this_iter_s": 19.55478811264038, "time_total_s": 13071.748047828674, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2946.945570230484, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 21.03571428571428, "ram_util_percent": 76.35714285714288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4198597499302, "policy_loss": -190783597087.8125, "vf_loss": 45198571.39285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16884.5, "diff_num_grad_updates_vs_sampler_policy": 16883.5}}, "num_env_steps_sampled": 6168480, "num_env_steps_trained": 6168480, "num_agent_steps_sampled": 6168480, "num_agent_steps_trained": 6168480}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.79691780025, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8953976654972496, "mean_inference_ms": 0.37056013933383014, "mean_action_processing_ms": 0.09207043441626485, "mean_env_wait_ms": 1.3266827992414953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003472566604614258, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06654500961303711}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.79691780025, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34955.46931393304, -35214.06229351078, -35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8953976654972496, "mean_inference_ms": 0.37056013933383014, "mean_action_processing_ms": 0.09207043441626485, "mean_env_wait_ms": 1.3266827992414953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003472566604614258, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06654500961303711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6168480, "num_agent_steps_trained": 6168480, "num_env_steps_sampled": 6168480, "num_env_steps_trained": 6168480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.2223478089042, "num_env_steps_trained_throughput_per_sec": 367.2223478089042, "timesteps_total": 6168480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6168480, "timers": {"training_iteration_time_ms": 9767.74, "sample_time_ms": 9670.008, "load_time_ms": 1.473, "load_throughput": 2444312.235, "learn_time_ms": 95.401, "learn_throughput": 37735.302, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 6168480, "num_env_steps_trained": 6168480, "num_agent_steps_sampled": 6168480, "num_agent_steps_trained": 6168480}, "done": false, "episodes_total": 1506, "training_iteration": 740, "trial_id": "ee88a_00000", "date": "2023-07-25_04-37-49", "timestamp": 1690249069, "time_this_iter_s": 19.609545946121216, "time_total_s": 13091.357593774796, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2966.555116176605, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 21.878571428571426, "ram_util_percent": 76.46071428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4198575701032, "policy_loss": -182232480630.4732, "vf_loss": 45418434.76785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16996.5, "diff_num_grad_updates_vs_sampler_policy": 16995.5}}, "num_env_steps_sampled": 6175680, "num_env_steps_trained": 6175680, "num_agent_steps_sampled": 6175680, "num_agent_steps_trained": 6175680}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.13836794696, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8954317809951726, "mean_inference_ms": 0.3705668559768073, "mean_action_processing_ms": 0.09207101921673341, "mean_env_wait_ms": 1.3264757838021957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473043441772461, "StateBufferConnector_ms": 0.0026862621307373047, "ViewRequirementAgentConnector_ms": 0.0665888786315918}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.13836794696, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35043.17785773224, -35298.667545541946, -35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8954317809951726, "mean_inference_ms": 0.3705668559768073, "mean_action_processing_ms": 0.09207101921673341, "mean_env_wait_ms": 1.3264757838021957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473043441772461, "StateBufferConnector_ms": 0.0026862621307373047, "ViewRequirementAgentConnector_ms": 0.0665888786315918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6175680, "num_agent_steps_trained": 6175680, "num_env_steps_sampled": 6175680, "num_env_steps_trained": 6175680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.05848853903035, "num_env_steps_trained_throughput_per_sec": 369.05848853903035, "timesteps_total": 6175680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6175680, "timers": {"training_iteration_time_ms": 9769.953, "sample_time_ms": 9671.566, "load_time_ms": 1.473, "load_throughput": 2444193.535, "learn_time_ms": 96.061, "learn_throughput": 37476.042, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 6175680, "num_env_steps_trained": 6175680, "num_agent_steps_sampled": 6175680, "num_agent_steps_trained": 6175680}, "done": false, "episodes_total": 1508, "training_iteration": 741, "trial_id": "ee88a_00000", "date": "2023-07-25_04-38-09", "timestamp": 1690249089, "time_this_iter_s": 19.512088775634766, "time_total_s": 13110.86968255043, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2986.06720495224, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 21.762962962962963, "ram_util_percent": 76.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4198608398438, "policy_loss": -195985089863.0357, "vf_loss": 45745742.696428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17108.5, "diff_num_grad_updates_vs_sampler_policy": 17107.5}}, "num_env_steps_sampled": 6182880, "num_env_steps_trained": 6182880, "num_agent_steps_sampled": 6182880, "num_agent_steps_trained": 6182880}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.797976806934, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8954642895215926, "mean_inference_ms": 0.3705731339994061, "mean_action_processing_ms": 0.09207150887996349, "mean_env_wait_ms": 1.326275011754792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003475189208984375, "StateBufferConnector_ms": 0.0026845932006835938, "ViewRequirementAgentConnector_ms": 0.06657958030700684}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.797976806934, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35201.68977668743, -34934.30340830519, -35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8954642895215926, "mean_inference_ms": 0.3705731339994061, "mean_action_processing_ms": 0.09207150887996349, "mean_env_wait_ms": 1.326275011754792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003475189208984375, "StateBufferConnector_ms": 0.0026845932006835938, "ViewRequirementAgentConnector_ms": 0.06657958030700684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6182880, "num_agent_steps_trained": 6182880, "num_env_steps_sampled": 6182880, "num_env_steps_trained": 6182880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.72186825158315, "num_env_steps_trained_throughput_per_sec": 366.72186825158315, "timesteps_total": 6182880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6182880, "timers": {"training_iteration_time_ms": 9785.607, "sample_time_ms": 9687.571, "load_time_ms": 1.452, "load_throughput": 2479554.388, "learn_time_ms": 95.734, "learn_throughput": 37604.045, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 6182880, "num_env_steps_trained": 6182880, "num_agent_steps_sampled": 6182880, "num_agent_steps_trained": 6182880}, "done": false, "episodes_total": 1510, "training_iteration": 742, "trial_id": "ee88a_00000", "date": "2023-07-25_04-38-28", "timestamp": 1690249108, "time_this_iter_s": 19.63617706298828, "time_total_s": 13130.505859613419, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3005.7033820152283, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 21.41428571428571, "ram_util_percent": 76.37857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4227294921875, "policy_loss": -195395544249.32144, "vf_loss": 45683890.78571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17220.5, "diff_num_grad_updates_vs_sampler_policy": 17219.5}}, "num_env_steps_sampled": 6190080, "num_env_steps_trained": 6190080, "num_agent_steps_sampled": 6190080, "num_agent_steps_trained": 6190080}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.94880057879, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8954959121261322, "mean_inference_ms": 0.37057957856641366, "mean_action_processing_ms": 0.09207206244549716, "mean_env_wait_ms": 1.326079917109576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034749507904052734, "StateBufferConnector_ms": 0.0026853084564208984, "ViewRequirementAgentConnector_ms": 0.06658124923706055}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.94880057879, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35121.71491237938, -35145.83671575754, -34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8954959121261322, "mean_inference_ms": 0.37057957856641366, "mean_action_processing_ms": 0.09207206244549716, "mean_env_wait_ms": 1.326079917109576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034749507904052734, "StateBufferConnector_ms": 0.0026853084564208984, "ViewRequirementAgentConnector_ms": 0.06658124923706055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6190080, "num_agent_steps_trained": 6190080, "num_env_steps_sampled": 6190080, "num_env_steps_trained": 6190080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.57869292694534, "num_env_steps_trained_throughput_per_sec": 366.57869292694534, "timesteps_total": 6190080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6190080, "timers": {"training_iteration_time_ms": 9794.157, "sample_time_ms": 9696.651, "load_time_ms": 1.411, "load_throughput": 2552185.386, "learn_time_ms": 95.236, "learn_throughput": 37800.797, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 6190080, "num_env_steps_trained": 6190080, "num_agent_steps_sampled": 6190080, "num_agent_steps_trained": 6190080}, "done": false, "episodes_total": 1512, "training_iteration": 743, "trial_id": "ee88a_00000", "date": "2023-07-25_04-38-48", "timestamp": 1690249128, "time_this_iter_s": 19.644063234329224, "time_total_s": 13150.149922847748, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3025.3474452495575, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 21.896428571428572, "ram_util_percent": 76.58928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4227294921875, "policy_loss": -195817835301.0357, "vf_loss": 46080999.10714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17332.5, "diff_num_grad_updates_vs_sampler_policy": 17331.5}}, "num_env_steps_sampled": 6197280, "num_env_steps_trained": 6197280, "num_agent_steps_sampled": 6197280, "num_agent_steps_trained": 6197280}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35139.60379278072, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8955254481238023, "mean_inference_ms": 0.3705857459882606, "mean_action_processing_ms": 0.09207255929695432, "mean_env_wait_ms": 1.3258874205448672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034754276275634766, "StateBufferConnector_ms": 0.002679586410522461, "ViewRequirementAgentConnector_ms": 0.06660151481628418}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35139.60379278072, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34925.29125044584, -35197.306673580606, -35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8955254481238023, "mean_inference_ms": 0.3705857459882606, "mean_action_processing_ms": 0.09207255929695432, "mean_env_wait_ms": 1.3258874205448672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034754276275634766, "StateBufferConnector_ms": 0.002679586410522461, "ViewRequirementAgentConnector_ms": 0.06660151481628418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6197280, "num_agent_steps_trained": 6197280, "num_env_steps_sampled": 6197280, "num_env_steps_trained": 6197280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.9571645472818, "num_env_steps_trained_throughput_per_sec": 370.9571645472818, "timesteps_total": 6197280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6197280, "timers": {"training_iteration_time_ms": 9779.931, "sample_time_ms": 9682.979, "load_time_ms": 1.425, "load_throughput": 2525759.326, "learn_time_ms": 94.685, "learn_throughput": 38020.928, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 6197280, "num_env_steps_trained": 6197280, "num_agent_steps_sampled": 6197280, "num_agent_steps_trained": 6197280}, "done": false, "episodes_total": 1514, "training_iteration": 744, "trial_id": "ee88a_00000", "date": "2023-07-25_04-39-07", "timestamp": 1690249147, "time_this_iter_s": 19.41211700439453, "time_total_s": 13169.562039852142, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3044.759562253952, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 22.467857142857145, "ram_util_percent": 76.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4227294921875, "policy_loss": -190687635521.9643, "vf_loss": 46074596.178571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17444.5, "diff_num_grad_updates_vs_sampler_policy": 17443.5}}, "num_env_steps_sampled": 6204480, "num_env_steps_trained": 6204480, "num_agent_steps_sampled": 6204480, "num_agent_steps_trained": 6204480}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35140.96895397991, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8955538114133498, "mean_inference_ms": 0.3705917886024341, "mean_action_processing_ms": 0.09207301466932247, "mean_env_wait_ms": 1.325698087325823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034782886505126953, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.06659078598022461}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35140.96895397991, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35306.67683808191, -35098.83014477088, -34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8955538114133498, "mean_inference_ms": 0.3705917886024341, "mean_action_processing_ms": 0.09207301466932247, "mean_env_wait_ms": 1.325698087325823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034782886505126953, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.06659078598022461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6204480, "num_agent_steps_trained": 6204480, "num_env_steps_sampled": 6204480, "num_env_steps_trained": 6204480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 365.60605439685963, "num_env_steps_trained_throughput_per_sec": 365.60605439685963, "timesteps_total": 6204480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6204480, "timers": {"training_iteration_time_ms": 9788.6, "sample_time_ms": 9691.362, "load_time_ms": 1.455, "load_throughput": 2474353.435, "learn_time_ms": 94.942, "learn_throughput": 37917.897, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 6204480, "num_env_steps_trained": 6204480, "num_agent_steps_sampled": 6204480, "num_agent_steps_trained": 6204480}, "done": false, "episodes_total": 1516, "training_iteration": 745, "trial_id": "ee88a_00000", "date": "2023-07-25_04-39-27", "timestamp": 1690249167, "time_this_iter_s": 19.696369171142578, "time_total_s": 13189.258409023285, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3064.4559314250946, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 21.392857142857142, "ram_util_percent": 76.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4141235351562, "policy_loss": -194842385416.0, "vf_loss": 45761660.16071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17556.5, "diff_num_grad_updates_vs_sampler_policy": 17555.5}}, "num_env_steps_sampled": 6211680, "num_env_steps_trained": 6211680, "num_agent_steps_sampled": 6211680, "num_agent_steps_trained": 6211680}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35138.44536657988, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8955845217227698, "mean_inference_ms": 0.3705978826645599, "mean_action_processing_ms": 0.09207349451415124, "mean_env_wait_ms": 1.325509402965026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034830570220947266, "StateBufferConnector_ms": 0.002678394317626953, "ViewRequirementAgentConnector_ms": 0.06661748886108398}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35138.44536657988, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34907.94717552436, -35061.530456253706, -35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8955845217227698, "mean_inference_ms": 0.3705978826645599, "mean_action_processing_ms": 0.09207349451415124, "mean_env_wait_ms": 1.325509402965026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034830570220947266, "StateBufferConnector_ms": 0.002678394317626953, "ViewRequirementAgentConnector_ms": 0.06661748886108398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6211680, "num_agent_steps_trained": 6211680, "num_env_steps_sampled": 6211680, "num_env_steps_trained": 6211680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.25010980195844, "num_env_steps_trained_throughput_per_sec": 368.25010980195844, "timesteps_total": 6211680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6211680, "timers": {"training_iteration_time_ms": 9792.883, "sample_time_ms": 9695.714, "load_time_ms": 1.456, "load_throughput": 2473016.1, "learn_time_ms": 94.856, "learn_throughput": 37952.265, "synch_weights_time_ms": 0.8}, "counters": {"num_env_steps_sampled": 6211680, "num_env_steps_trained": 6211680, "num_agent_steps_sampled": 6211680, "num_agent_steps_trained": 6211680}, "done": false, "episodes_total": 1518, "training_iteration": 746, "trial_id": "ee88a_00000", "date": "2023-07-25_04-39-47", "timestamp": 1690249187, "time_this_iter_s": 19.554721117019653, "time_total_s": 13208.813130140305, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3084.0106525421143, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 23.355555555555558, "ram_util_percent": 76.48518518518519}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4132548740932, "policy_loss": -196869240972.51117, "vf_loss": 45883087.89285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17668.5, "diff_num_grad_updates_vs_sampler_policy": 17667.5}}, "num_env_steps_sampled": 6218880, "num_env_steps_trained": 6218880, "num_agent_steps_sampled": 6218880, "num_agent_steps_trained": 6218880}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35139.783966351955, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8956186444757107, "mean_inference_ms": 0.370604027975965, "mean_action_processing_ms": 0.09207394075911485, "mean_env_wait_ms": 1.3253226593213043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034766197204589844, "StateBufferConnector_ms": 0.002680063247680664, "ViewRequirementAgentConnector_ms": 0.06662821769714355}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35139.783966351955, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35083.1753370505, -35403.21178798093, -35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8956186444757107, "mean_inference_ms": 0.370604027975965, "mean_action_processing_ms": 0.09207394075911485, "mean_env_wait_ms": 1.3253226593213043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034766197204589844, "StateBufferConnector_ms": 0.002680063247680664, "ViewRequirementAgentConnector_ms": 0.06662821769714355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6218880, "num_agent_steps_trained": 6218880, "num_env_steps_sampled": 6218880, "num_env_steps_trained": 6218880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.1542453368938, "num_env_steps_trained_throughput_per_sec": 366.1542453368938, "timesteps_total": 6218880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6218880, "timers": {"training_iteration_time_ms": 9795.926, "sample_time_ms": 9699.001, "load_time_ms": 1.452, "load_throughput": 2479472.955, "learn_time_ms": 94.628, "learn_throughput": 38043.593, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 6218880, "num_env_steps_trained": 6218880, "num_agent_steps_sampled": 6218880, "num_agent_steps_trained": 6218880}, "done": false, "episodes_total": 1520, "training_iteration": 747, "trial_id": "ee88a_00000", "date": "2023-07-25_04-40-06", "timestamp": 1690249206, "time_this_iter_s": 19.666728973388672, "time_total_s": 13228.479859113693, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3103.677381515503, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 20.132142857142856, "ram_util_percent": 76.40714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4131437029157, "policy_loss": -193227954171.33035, "vf_loss": 45776791.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17780.5, "diff_num_grad_updates_vs_sampler_policy": 17779.5}}, "num_env_steps_sampled": 6226080, "num_env_steps_trained": 6226080, "num_agent_steps_sampled": 6226080, "num_agent_steps_trained": 6226080}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35136.910060843235, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8956615732042036, "mean_inference_ms": 0.370610209978903, "mean_action_processing_ms": 0.0920743699337688, "mean_env_wait_ms": 1.3251330133225707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034775733947753906, "StateBufferConnector_ms": 0.002672910690307617, "ViewRequirementAgentConnector_ms": 0.06662559509277344}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35136.910060843235, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35400.46133110867, -35014.04945705372, -35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8956615732042036, "mean_inference_ms": 0.370610209978903, "mean_action_processing_ms": 0.0920743699337688, "mean_env_wait_ms": 1.3251330133225707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034775733947753906, "StateBufferConnector_ms": 0.002672910690307617, "ViewRequirementAgentConnector_ms": 0.06662559509277344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6226080, "num_agent_steps_trained": 6226080, "num_env_steps_sampled": 6226080, "num_env_steps_trained": 6226080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.441587552373, "num_env_steps_trained_throughput_per_sec": 366.441587552373, "timesteps_total": 6226080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6226080, "timers": {"training_iteration_time_ms": 9796.661, "sample_time_ms": 9699.293, "load_time_ms": 1.468, "load_throughput": 2452729.671, "learn_time_ms": 95.046, "learn_throughput": 37876.408, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 6226080, "num_env_steps_trained": 6226080, "num_agent_steps_sampled": 6226080, "num_agent_steps_trained": 6226080}, "done": false, "episodes_total": 1522, "training_iteration": 748, "trial_id": "ee88a_00000", "date": "2023-07-25_04-40-26", "timestamp": 1690249226, "time_this_iter_s": 19.651346921920776, "time_total_s": 13248.131206035614, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3123.3287284374237, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 22.267857142857142, "ram_util_percent": 76.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4131458827427, "policy_loss": -188521347721.73215, "vf_loss": 45941935.58928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17892.5, "diff_num_grad_updates_vs_sampler_policy": 17891.5}}, "num_env_steps_sampled": 6233280, "num_env_steps_trained": 6233280, "num_agent_steps_sampled": 6233280, "num_agent_steps_trained": 6233280}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35136.486930788014, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8957141588767271, "mean_inference_ms": 0.37061614315065783, "mean_action_processing_ms": 0.09207479485227703, "mean_env_wait_ms": 1.3249417733524975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034804344177246094, "StateBufferConnector_ms": 0.002671480178833008, "ViewRequirementAgentConnector_ms": 0.06662130355834961}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35136.486930788014, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35071.08654498058, -35323.051098726515, -35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8957141588767271, "mean_inference_ms": 0.37061614315065783, "mean_action_processing_ms": 0.09207479485227703, "mean_env_wait_ms": 1.3249417733524975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034804344177246094, "StateBufferConnector_ms": 0.002671480178833008, "ViewRequirementAgentConnector_ms": 0.06662130355834961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6233280, "num_agent_steps_trained": 6233280, "num_env_steps_sampled": 6233280, "num_env_steps_trained": 6233280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.9898849947649, "num_env_steps_trained_throughput_per_sec": 366.9898849947649, "timesteps_total": 6233280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6233280, "timers": {"training_iteration_time_ms": 9817.644, "sample_time_ms": 9720.684, "load_time_ms": 1.459, "load_throughput": 2468044.197, "learn_time_ms": 94.638, "learn_throughput": 38039.884, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 6233280, "num_env_steps_trained": 6233280, "num_agent_steps_sampled": 6233280, "num_agent_steps_trained": 6233280}, "done": false, "episodes_total": 1524, "training_iteration": 749, "trial_id": "ee88a_00000", "date": "2023-07-25_04-40-46", "timestamp": 1690249246, "time_this_iter_s": 19.621943712234497, "time_total_s": 13267.753149747849, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3142.950672149658, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 22.817857142857143, "ram_util_percent": 76.82499999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4131437029157, "policy_loss": -186775137308.57144, "vf_loss": 45584146.678571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18004.5, "diff_num_grad_updates_vs_sampler_policy": 18003.5}}, "num_env_steps_sampled": 6240480, "num_env_steps_trained": 6240480, "num_agent_steps_sampled": 6240480, "num_agent_steps_trained": 6240480}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.44866059177, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8957710757128943, "mean_inference_ms": 0.3706222575509884, "mean_action_processing_ms": 0.09207525052386989, "mean_env_wait_ms": 1.3247516791515155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034699440002441406, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06657052040100098}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.44866059177, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35030.345342715664, -35247.18530073883, -34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8957710757128943, "mean_inference_ms": 0.3706222575509884, "mean_action_processing_ms": 0.09207525052386989, "mean_env_wait_ms": 1.3247516791515155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034699440002441406, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06657052040100098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6240480, "num_agent_steps_trained": 6240480, "num_env_steps_sampled": 6240480, "num_env_steps_trained": 6240480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.35675042375976, "num_env_steps_trained_throughput_per_sec": 366.35675042375976, "timesteps_total": 6240480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6240480, "timers": {"training_iteration_time_ms": 9813.608, "sample_time_ms": 9717.048, "load_time_ms": 1.5, "load_throughput": 2399373.028, "learn_time_ms": 94.201, "learn_throughput": 38216.226, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 6240480, "num_env_steps_trained": 6240480, "num_agent_steps_sampled": 6240480, "num_agent_steps_trained": 6240480}, "done": false, "episodes_total": 1526, "training_iteration": 750, "trial_id": "ee88a_00000", "date": "2023-07-25_04-41-05", "timestamp": 1690249265, "time_this_iter_s": 19.655985355377197, "time_total_s": 13287.409135103226, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3162.6066575050354, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 21.760714285714283, "ram_util_percent": 76.86428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4105834960938, "policy_loss": -190722099205.10715, "vf_loss": 45794168.28571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18116.5, "diff_num_grad_updates_vs_sampler_policy": 18115.5}}, "num_env_steps_sampled": 6247680, "num_env_steps_trained": 6247680, "num_agent_steps_sampled": 6247680, "num_agent_steps_trained": 6247680}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.282931337424, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8958311035343499, "mean_inference_ms": 0.37062795833971907, "mean_action_processing_ms": 0.09207567142222924, "mean_env_wait_ms": 1.3245659679685742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467559814453125, "StateBufferConnector_ms": 0.0026717185974121094, "ViewRequirementAgentConnector_ms": 0.0665597915649414}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.282931337424, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34991.95706402922, -35121.39396503403, -35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8958311035343499, "mean_inference_ms": 0.37062795833971907, "mean_action_processing_ms": 0.09207567142222924, "mean_env_wait_ms": 1.3245659679685742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467559814453125, "StateBufferConnector_ms": 0.0026717185974121094, "ViewRequirementAgentConnector_ms": 0.0665597915649414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6247680, "num_agent_steps_trained": 6247680, "num_env_steps_sampled": 6247680, "num_env_steps_trained": 6247680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.1279552247797, "num_env_steps_trained_throughput_per_sec": 368.1279552247797, "timesteps_total": 6247680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6247680, "timers": {"training_iteration_time_ms": 9814.257, "sample_time_ms": 9718.143, "load_time_ms": 1.503, "load_throughput": 2394426.73, "learn_time_ms": 93.757, "learn_throughput": 38397.256, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 6247680, "num_env_steps_trained": 6247680, "num_agent_steps_sampled": 6247680, "num_agent_steps_trained": 6247680}, "done": false, "episodes_total": 1528, "training_iteration": 751, "trial_id": "ee88a_00000", "date": "2023-07-25_04-41-25", "timestamp": 1690249285, "time_this_iter_s": 19.561341047286987, "time_total_s": 13306.970476150513, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3182.1679985523224, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 20.87777777777778, "ram_util_percent": 76.9851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4105834960938, "policy_loss": -194114153222.49332, "vf_loss": 46401852.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18228.5, "diff_num_grad_updates_vs_sampler_policy": 18227.5}}, "num_env_steps_sampled": 6254880, "num_env_steps_trained": 6254880, "num_agent_steps_sampled": 6254880, "num_agent_steps_trained": 6254880}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35137.56710843783, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8958891833712463, "mean_inference_ms": 0.3706343896548928, "mean_action_processing_ms": 0.09207616654973437, "mean_env_wait_ms": 1.3243855312018442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034723281860351562, "StateBufferConnector_ms": 0.002666473388671875, "ViewRequirementAgentConnector_ms": 0.0665445327758789}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35137.56710843783, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35448.30848367166, -35051.2350288641, -35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8958891833712463, "mean_inference_ms": 0.3706343896548928, "mean_action_processing_ms": 0.09207616654973437, "mean_env_wait_ms": 1.3243855312018442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034723281860351562, "StateBufferConnector_ms": 0.002666473388671875, "ViewRequirementAgentConnector_ms": 0.0665445327758789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6254880, "num_agent_steps_trained": 6254880, "num_env_steps_sampled": 6254880, "num_env_steps_trained": 6254880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.98106876794816, "num_env_steps_trained_throughput_per_sec": 368.98106876794816, "timesteps_total": 6254880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6254880, "timers": {"training_iteration_time_ms": 9799.192, "sample_time_ms": 9702.861, "load_time_ms": 1.506, "load_throughput": 2390446.506, "learn_time_ms": 93.956, "learn_throughput": 38315.722, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 6254880, "num_env_steps_trained": 6254880, "num_agent_steps_sampled": 6254880, "num_agent_steps_trained": 6254880}, "done": false, "episodes_total": 1530, "training_iteration": 752, "trial_id": "ee88a_00000", "date": "2023-07-25_04-41-45", "timestamp": 1690249305, "time_this_iter_s": 19.516090154647827, "time_total_s": 13326.48656630516, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3201.68408870697, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 21.821428571428566, "ram_util_percent": 77.01071428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4105834960938, "policy_loss": -194575952953.42856, "vf_loss": 45172785.178571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18340.5, "diff_num_grad_updates_vs_sampler_policy": 18339.5}}, "num_env_steps_sampled": 6262080, "num_env_steps_trained": 6262080, "num_agent_steps_sampled": 6262080, "num_agent_steps_trained": 6262080}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.74657845811, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8959395591730488, "mean_inference_ms": 0.370640558176422, "mean_action_processing_ms": 0.09207655904260113, "mean_env_wait_ms": 1.3242138964885837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034711360931396484, "StateBufferConnector_ms": 0.002669811248779297, "ViewRequirementAgentConnector_ms": 0.06659579277038574}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.74657845811, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35228.18144830997, -35461.18516568839, -35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8959395591730488, "mean_inference_ms": 0.370640558176422, "mean_action_processing_ms": 0.09207655904260113, "mean_env_wait_ms": 1.3242138964885837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034711360931396484, "StateBufferConnector_ms": 0.002669811248779297, "ViewRequirementAgentConnector_ms": 0.06659579277038574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6262080, "num_agent_steps_trained": 6262080, "num_env_steps_sampled": 6262080, "num_env_steps_trained": 6262080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.6615924135372, "num_env_steps_trained_throughput_per_sec": 371.6615924135372, "timesteps_total": 6262080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6262080, "timers": {"training_iteration_time_ms": 9771.596, "sample_time_ms": 9675.314, "load_time_ms": 1.494, "load_throughput": 2409211.858, "learn_time_ms": 93.93, "learn_throughput": 38326.605, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 6262080, "num_env_steps_trained": 6262080, "num_agent_steps_sampled": 6262080, "num_agent_steps_trained": 6262080}, "done": false, "episodes_total": 1532, "training_iteration": 753, "trial_id": "ee88a_00000", "date": "2023-07-25_04-42-04", "timestamp": 1690249324, "time_this_iter_s": 19.37549901008606, "time_total_s": 13345.862065315247, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3221.0595877170563, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 21.0962962962963, "ram_util_percent": 77.00370370370372}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4074990408761, "policy_loss": -195451073357.60938, "vf_loss": 45898602.053571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18452.5, "diff_num_grad_updates_vs_sampler_policy": 18451.5}}, "num_env_steps_sampled": 6269280, "num_env_steps_trained": 6269280, "num_agent_steps_sampled": 6269280, "num_agent_steps_trained": 6269280}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.67796101938, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8959817819497421, "mean_inference_ms": 0.3706463090492882, "mean_action_processing_ms": 0.09207688023902494, "mean_env_wait_ms": 1.3240515554300003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003469228744506836, "StateBufferConnector_ms": 0.002671957015991211, "ViewRequirementAgentConnector_ms": 0.06659412384033203}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.67796101938, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35012.93159796605, -34978.06830732179, -35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8959817819497421, "mean_inference_ms": 0.3706463090492882, "mean_action_processing_ms": 0.09207688023902494, "mean_env_wait_ms": 1.3240515554300003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003469228744506836, "StateBufferConnector_ms": 0.002671957015991211, "ViewRequirementAgentConnector_ms": 0.06659412384033203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6269280, "num_agent_steps_trained": 6269280, "num_env_steps_sampled": 6269280, "num_env_steps_trained": 6269280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.5818514380533, "num_env_steps_trained_throughput_per_sec": 371.5818514380533, "timesteps_total": 6269280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6269280, "timers": {"training_iteration_time_ms": 9747.351, "sample_time_ms": 9651.02, "load_time_ms": 1.504, "load_throughput": 2393250.238, "learn_time_ms": 93.971, "learn_throughput": 38309.569, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 6269280, "num_env_steps_trained": 6269280, "num_agent_steps_sampled": 6269280, "num_agent_steps_trained": 6269280}, "done": false, "episodes_total": 1534, "training_iteration": 754, "trial_id": "ee88a_00000", "date": "2023-07-25_04-42-23", "timestamp": 1690249343, "time_this_iter_s": 19.379433393478394, "time_total_s": 13365.241498708725, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3240.4390211105347, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 20.900000000000002, "ram_util_percent": 76.90357142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4071044921875, "policy_loss": -189563323363.2857, "vf_loss": 45334071.78571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18564.5, "diff_num_grad_updates_vs_sampler_policy": 18563.5}}, "num_env_steps_sampled": 6276480, "num_env_steps_trained": 6276480, "num_agent_steps_sampled": 6276480, "num_agent_steps_trained": 6276480}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.45703919675, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8960146523692899, "mean_inference_ms": 0.37065191929277047, "mean_action_processing_ms": 0.09207714806380281, "mean_env_wait_ms": 1.323899296638159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473043441772461, "StateBufferConnector_ms": 0.0026764869689941406, "ViewRequirementAgentConnector_ms": 0.0665745735168457}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.45703919675, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35235.701896990744, -35034.08122417408, -35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8960146523692899, "mean_inference_ms": 0.37065191929277047, "mean_action_processing_ms": 0.09207714806380281, "mean_env_wait_ms": 1.323899296638159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473043441772461, "StateBufferConnector_ms": 0.0026764869689941406, "ViewRequirementAgentConnector_ms": 0.0665745735168457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6276480, "num_agent_steps_trained": 6276480, "num_env_steps_sampled": 6276480, "num_env_steps_trained": 6276480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.18663425085265, "num_env_steps_trained_throughput_per_sec": 368.18663425085265, "timesteps_total": 6276480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6276480, "timers": {"training_iteration_time_ms": 9737.583, "sample_time_ms": 9641.125, "load_time_ms": 1.43, "load_throughput": 2517043.858, "learn_time_ms": 94.175, "learn_throughput": 38226.82, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 6276480, "num_env_steps_trained": 6276480, "num_agent_steps_sampled": 6276480, "num_agent_steps_trained": 6276480}, "done": false, "episodes_total": 1536, "training_iteration": 755, "trial_id": "ee88a_00000", "date": "2023-07-25_04-42-43", "timestamp": 1690249363, "time_this_iter_s": 19.55835485458374, "time_total_s": 13384.799853563309, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3259.9973759651184, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 20.935714285714287, "ram_util_percent": 77.08214285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4045148577009, "policy_loss": -197574151280.74106, "vf_loss": 45536981.821428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18676.5, "diff_num_grad_updates_vs_sampler_policy": 18675.5}}, "num_env_steps_sampled": 6283680, "num_env_steps_trained": 6283680, "num_agent_steps_sampled": 6283680, "num_agent_steps_trained": 6283680}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35129.832448995796, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8960497005456518, "mean_inference_ms": 0.37065612595183667, "mean_action_processing_ms": 0.09207728821982204, "mean_env_wait_ms": 1.3237550297040803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003466367721557617, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06657791137695312}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35129.832448995796, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35090.89023844838, -35202.381625618575, -35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8960497005456518, "mean_inference_ms": 0.37065612595183667, "mean_action_processing_ms": 0.09207728821982204, "mean_env_wait_ms": 1.3237550297040803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003466367721557617, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06657791137695312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6283680, "num_agent_steps_trained": 6283680, "num_env_steps_sampled": 6283680, "num_env_steps_trained": 6283680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.7675602710974, "num_env_steps_trained_throughput_per_sec": 366.7675602710974, "timesteps_total": 6283680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6283680, "timers": {"training_iteration_time_ms": 9744.837, "sample_time_ms": 9648.325, "load_time_ms": 1.41, "load_throughput": 2552616.841, "learn_time_ms": 94.241, "learn_throughput": 38199.886, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 6283680, "num_env_steps_trained": 6283680, "num_agent_steps_sampled": 6283680, "num_agent_steps_trained": 6283680}, "done": false, "episodes_total": 1538, "training_iteration": 756, "trial_id": "ee88a_00000", "date": "2023-07-25_04-43-03", "timestamp": 1690249383, "time_this_iter_s": 19.63397192955017, "time_total_s": 13404.433825492859, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3279.6313478946686, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 20.862962962962964, "ram_util_percent": 76.94814814814815}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4041748046875, "policy_loss": -194181670565.14285, "vf_loss": 45795932.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18788.5, "diff_num_grad_updates_vs_sampler_policy": 18787.5}}, "num_env_steps_sampled": 6290880, "num_env_steps_trained": 6290880, "num_agent_steps_sampled": 6290880, "num_agent_steps_trained": 6290880}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35131.82241851505, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8960818083213417, "mean_inference_ms": 0.37065932707447347, "mean_action_processing_ms": 0.09207734618589987, "mean_env_wait_ms": 1.3236177161268932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034677982330322266, "StateBufferConnector_ms": 0.0026807785034179688, "ViewRequirementAgentConnector_ms": 0.06661176681518555}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35131.82241851505, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35175.22850888241, -35002.53969714517, -35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8960818083213417, "mean_inference_ms": 0.37065932707447347, "mean_action_processing_ms": 0.09207734618589987, "mean_env_wait_ms": 1.3236177161268932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034677982330322266, "StateBufferConnector_ms": 0.0026807785034179688, "ViewRequirementAgentConnector_ms": 0.06661176681518555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6290880, "num_agent_steps_trained": 6290880, "num_env_steps_sampled": 6290880, "num_env_steps_trained": 6290880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.20645846974907, "num_env_steps_trained_throughput_per_sec": 368.20645846974907, "timesteps_total": 6290880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6290880, "timers": {"training_iteration_time_ms": 9748.942, "sample_time_ms": 9652.464, "load_time_ms": 1.437, "load_throughput": 2504643.599, "learn_time_ms": 94.185, "learn_throughput": 38222.475, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 6290880, "num_env_steps_trained": 6290880, "num_agent_steps_sampled": 6290880, "num_agent_steps_trained": 6290880}, "done": false, "episodes_total": 1540, "training_iteration": 757, "trial_id": "ee88a_00000", "date": "2023-07-25_04-43-22", "timestamp": 1690249402, "time_this_iter_s": 19.557093858718872, "time_total_s": 13423.990919351578, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3299.1884417533875, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 20.660714285714285, "ram_util_percent": 76.82142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4041748046875, "policy_loss": -192606045231.54465, "vf_loss": 45860890.51785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18900.5, "diff_num_grad_updates_vs_sampler_policy": 18899.5}}, "num_env_steps_sampled": 6298080, "num_env_steps_trained": 6298080, "num_agent_steps_sampled": 6298080, "num_agent_steps_trained": 6298080}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.63116506082, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8961115044068058, "mean_inference_ms": 0.3706628681539361, "mean_action_processing_ms": 0.0920774382616941, "mean_env_wait_ms": 1.3234837178629746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003463268280029297, "StateBufferConnector_ms": 0.0026814937591552734, "ViewRequirementAgentConnector_ms": 0.0666046142578125}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.63116506082, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35073.37999625592, -35143.41028314474, -35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8961115044068058, "mean_inference_ms": 0.3706628681539361, "mean_action_processing_ms": 0.0920774382616941, "mean_env_wait_ms": 1.3234837178629746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003463268280029297, "StateBufferConnector_ms": 0.0026814937591552734, "ViewRequirementAgentConnector_ms": 0.0666046142578125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6298080, "num_agent_steps_trained": 6298080, "num_env_steps_sampled": 6298080, "num_env_steps_trained": 6298080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.4514115272786, "num_env_steps_trained_throughput_per_sec": 368.4514115272786, "timesteps_total": 6298080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6298080, "timers": {"training_iteration_time_ms": 9765.821, "sample_time_ms": 9669.128, "load_time_ms": 1.453, "load_throughput": 2477235.641, "learn_time_ms": 94.365, "learn_throughput": 38149.882, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 6298080, "num_env_steps_trained": 6298080, "num_agent_steps_sampled": 6298080, "num_agent_steps_trained": 6298080}, "done": false, "episodes_total": 1542, "training_iteration": 758, "trial_id": "ee88a_00000", "date": "2023-07-25_04-43-42", "timestamp": 1690249422, "time_this_iter_s": 19.544193029403687, "time_total_s": 13443.535112380981, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3318.732634782791, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 21.842857142857145, "ram_util_percent": 76.85714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4041748046875, "policy_loss": -191202413276.94644, "vf_loss": 45751411.46428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19012.5, "diff_num_grad_updates_vs_sampler_policy": 19011.5}}, "num_env_steps_sampled": 6305280, "num_env_steps_trained": 6305280, "num_agent_steps_sampled": 6305280, "num_agent_steps_trained": 6305280}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.29474650693, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8961413631720763, "mean_inference_ms": 0.3706663250269156, "mean_action_processing_ms": 0.09207752184012336, "mean_env_wait_ms": 1.3233510286456442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034646987915039062, "StateBufferConnector_ms": 0.002675294876098633, "ViewRequirementAgentConnector_ms": 0.06659126281738281}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.29474650693, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35082.5104234057, -34919.304553835704, -35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8961413631720763, "mean_inference_ms": 0.3706663250269156, "mean_action_processing_ms": 0.09207752184012336, "mean_env_wait_ms": 1.3233510286456442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034646987915039062, "StateBufferConnector_ms": 0.002675294876098633, "ViewRequirementAgentConnector_ms": 0.06659126281738281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6305280, "num_agent_steps_trained": 6305280, "num_env_steps_sampled": 6305280, "num_env_steps_trained": 6305280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.3877244984479, "num_env_steps_trained_throughput_per_sec": 367.3877244984479, "timesteps_total": 6305280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6305280, "timers": {"training_iteration_time_ms": 9787.941, "sample_time_ms": 9691.031, "load_time_ms": 1.501, "load_throughput": 2397658.537, "learn_time_ms": 94.526, "learn_throughput": 38084.566, "synch_weights_time_ms": 0.82}, "counters": {"num_env_steps_sampled": 6305280, "num_env_steps_trained": 6305280, "num_agent_steps_sampled": 6305280, "num_agent_steps_trained": 6305280}, "done": false, "episodes_total": 1544, "training_iteration": 759, "trial_id": "ee88a_00000", "date": "2023-07-25_04-44-01", "timestamp": 1690249441, "time_this_iter_s": 19.60074496269226, "time_total_s": 13463.135857343674, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3338.3333797454834, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 21.192857142857143, "ram_util_percent": 76.92857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4040342058454, "policy_loss": -179657188812.59375, "vf_loss": 45310932.178571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19124.5, "diff_num_grad_updates_vs_sampler_policy": 19123.5}}, "num_env_steps_sampled": 6312480, "num_env_steps_trained": 6312480, "num_agent_steps_sampled": 6312480, "num_agent_steps_trained": 6312480}, "sampler_results": {"episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.64388700416, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8961723055616408, "mean_inference_ms": 0.3706697860939059, "mean_action_processing_ms": 0.09207766283343112, "mean_env_wait_ms": 1.3232178661659701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003462076187133789, "StateBufferConnector_ms": 0.002675294876098633, "ViewRequirementAgentConnector_ms": 0.06657028198242188}}, "episode_reward_max": -34858.035278729076, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.64388700416, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35300.89862409074, -35004.15502406374, -35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8961723055616408, "mean_inference_ms": 0.3706697860939059, "mean_action_processing_ms": 0.09207766283343112, "mean_env_wait_ms": 1.3232178661659701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003462076187133789, "StateBufferConnector_ms": 0.002675294876098633, "ViewRequirementAgentConnector_ms": 0.06657028198242188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6312480, "num_agent_steps_trained": 6312480, "num_env_steps_sampled": 6312480, "num_env_steps_trained": 6312480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 363.7729953036659, "num_env_steps_trained_throughput_per_sec": 363.7729953036659, "timesteps_total": 6312480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6312480, "timers": {"training_iteration_time_ms": 9811.667, "sample_time_ms": 9714.454, "load_time_ms": 1.528, "load_throughput": 2355725.603, "learn_time_ms": 94.787, "learn_throughput": 37980.092, "synch_weights_time_ms": 0.837}, "counters": {"num_env_steps_sampled": 6312480, "num_env_steps_trained": 6312480, "num_agent_steps_sampled": 6312480, "num_agent_steps_trained": 6312480}, "done": false, "episodes_total": 1546, "training_iteration": 760, "trial_id": "ee88a_00000", "date": "2023-07-25_04-44-21", "timestamp": 1690249461, "time_this_iter_s": 19.795562982559204, "time_total_s": 13482.931420326233, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3358.1289427280426, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 24.389285714285712, "ram_util_percent": 76.99642857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4042358398438, "policy_loss": -195492420875.11383, "vf_loss": 45059044.60714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19236.5, "diff_num_grad_updates_vs_sampler_policy": 19235.5}}, "num_env_steps_sampled": 6319680, "num_env_steps_trained": 6319680, "num_agent_steps_sampled": 6319680, "num_agent_steps_trained": 6319680}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.58603952685, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8962004222885998, "mean_inference_ms": 0.3706725684909091, "mean_action_processing_ms": 0.09207770621477156, "mean_env_wait_ms": 1.3230884220765753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034613609313964844, "StateBufferConnector_ms": 0.0026764869689941406, "ViewRequirementAgentConnector_ms": 0.0665585994720459}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.58603952685, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35088.975026883374, -34935.311926653376, -35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8962004222885998, "mean_inference_ms": 0.3706725684909091, "mean_action_processing_ms": 0.09207770621477156, "mean_env_wait_ms": 1.3230884220765753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034613609313964844, "StateBufferConnector_ms": 0.0026764869689941406, "ViewRequirementAgentConnector_ms": 0.0665585994720459}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6319680, "num_agent_steps_trained": 6319680, "num_env_steps_sampled": 6319680, "num_env_steps_trained": 6319680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.54686231191846, "num_env_steps_trained_throughput_per_sec": 364.54686231191846, "timesteps_total": 6319680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6319680, "timers": {"training_iteration_time_ms": 9823.626, "sample_time_ms": 9725.707, "load_time_ms": 1.532, "load_throughput": 2349201.774, "learn_time_ms": 95.487, "learn_throughput": 37701.581, "synch_weights_time_ms": 0.832}, "counters": {"num_env_steps_sampled": 6319680, "num_env_steps_trained": 6319680, "num_agent_steps_sampled": 6319680, "num_agent_steps_trained": 6319680}, "done": false, "episodes_total": 1548, "training_iteration": 761, "trial_id": "ee88a_00000", "date": "2023-07-25_04-44-41", "timestamp": 1690249481, "time_this_iter_s": 19.753578186035156, "time_total_s": 13502.684998512268, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3377.8825209140778, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 22.232142857142854, "ram_util_percent": 77.11785714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4042358398438, "policy_loss": -187182227884.38394, "vf_loss": 45515688.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19348.5, "diff_num_grad_updates_vs_sampler_policy": 19347.5}}, "num_env_steps_sampled": 6326880, "num_env_steps_trained": 6326880, "num_agent_steps_sampled": 6326880, "num_agent_steps_trained": 6326880}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.68721135798, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8962285399427629, "mean_inference_ms": 0.3706749980967363, "mean_action_processing_ms": 0.0920776588353086, "mean_env_wait_ms": 1.3229593081865179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034554004669189453, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06653738021850586}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.68721135798, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35095.6710191669, -34936.7160111048, -35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8962285399427629, "mean_inference_ms": 0.3706749980967363, "mean_action_processing_ms": 0.0920776588353086, "mean_env_wait_ms": 1.3229593081865179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034554004669189453, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06653738021850586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6326880, "num_agent_steps_trained": 6326880, "num_env_steps_sampled": 6326880, "num_env_steps_trained": 6326880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.3603112211885, "num_env_steps_trained_throughput_per_sec": 369.3603112211885, "timesteps_total": 6326880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6326880, "timers": {"training_iteration_time_ms": 9817.517, "sample_time_ms": 9719.448, "load_time_ms": 1.514, "load_throughput": 2378247.661, "learn_time_ms": 95.642, "learn_throughput": 37640.332, "synch_weights_time_ms": 0.845}, "counters": {"num_env_steps_sampled": 6326880, "num_env_steps_trained": 6326880, "num_agent_steps_sampled": 6326880, "num_agent_steps_trained": 6326880}, "done": false, "episodes_total": 1550, "training_iteration": 762, "trial_id": "ee88a_00000", "date": "2023-07-25_04-45-01", "timestamp": 1690249501, "time_this_iter_s": 19.496000051498413, "time_total_s": 13522.180998563766, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3397.378520965576, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 21.400000000000002, "ram_util_percent": 77.07407407407408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4042358398438, "policy_loss": -196192871536.10715, "vf_loss": 45557628.928571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19460.5, "diff_num_grad_updates_vs_sampler_policy": 19459.5}}, "num_env_steps_sampled": 6334080, "num_env_steps_trained": 6334080, "num_agent_steps_sampled": 6334080, "num_agent_steps_trained": 6334080}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35136.8130107524, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8962562016231118, "mean_inference_ms": 0.3706773641134554, "mean_action_processing_ms": 0.09207762445519732, "mean_env_wait_ms": 1.3228285753454545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458738327026367, "StateBufferConnector_ms": 0.0026667118072509766, "ViewRequirementAgentConnector_ms": 0.06650543212890625}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35136.8130107524, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35099.63306569185, -35062.37825837109, -35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8962562016231118, "mean_inference_ms": 0.3706773641134554, "mean_action_processing_ms": 0.09207762445519732, "mean_env_wait_ms": 1.3228285753454545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458738327026367, "StateBufferConnector_ms": 0.0026667118072509766, "ViewRequirementAgentConnector_ms": 0.06650543212890625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6334080, "num_agent_steps_trained": 6334080, "num_env_steps_sampled": 6334080, "num_env_steps_trained": 6334080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.99520561825767, "num_env_steps_trained_throughput_per_sec": 366.99520561825767, "timesteps_total": 6334080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6334080, "timers": {"training_iteration_time_ms": 9825.27, "sample_time_ms": 9727.377, "load_time_ms": 1.489, "load_throughput": 2417698.53, "learn_time_ms": 95.483, "learn_throughput": 37703.172, "synch_weights_time_ms": 0.854}, "counters": {"num_env_steps_sampled": 6334080, "num_env_steps_trained": 6334080, "num_agent_steps_sampled": 6334080, "num_agent_steps_trained": 6334080}, "done": false, "episodes_total": 1552, "training_iteration": 763, "trial_id": "ee88a_00000", "date": "2023-07-25_04-45-20", "timestamp": 1690249520, "time_this_iter_s": 19.621769905090332, "time_total_s": 13541.802768468857, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3417.0002908706665, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 22.214285714285715, "ram_util_percent": 76.99285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4042358398438, "policy_loss": -194927675182.3828, "vf_loss": 45564591.26785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19572.5, "diff_num_grad_updates_vs_sampler_policy": 19571.5}}, "num_env_steps_sampled": 6341280, "num_env_steps_trained": 6341280, "num_agent_steps_sampled": 6341280, "num_agent_steps_trained": 6341280}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35135.96040206426, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8962859273628346, "mean_inference_ms": 0.370679947788388, "mean_action_processing_ms": 0.0920776237250788, "mean_env_wait_ms": 1.3226981251844803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003456592559814453, "StateBufferConnector_ms": 0.002665281295776367, "ViewRequirementAgentConnector_ms": 0.06650042533874512}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35135.96040206426, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35217.64994938116, -35386.00132312874, -35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8962859273628346, "mean_inference_ms": 0.370679947788388, "mean_action_processing_ms": 0.0920776237250788, "mean_env_wait_ms": 1.3226981251844803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003456592559814453, "StateBufferConnector_ms": 0.002665281295776367, "ViewRequirementAgentConnector_ms": 0.06650042533874512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6341280, "num_agent_steps_trained": 6341280, "num_env_steps_sampled": 6341280, "num_env_steps_trained": 6341280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 365.79154125976044, "num_env_steps_trained_throughput_per_sec": 365.79154125976044, "timesteps_total": 6341280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6341280, "timers": {"training_iteration_time_ms": 9833.822, "sample_time_ms": 9735.719, "load_time_ms": 1.457, "load_throughput": 2470507.436, "learn_time_ms": 95.729, "learn_throughput": 37606.302, "synch_weights_time_ms": 0.851}, "counters": {"num_env_steps_sampled": 6341280, "num_env_steps_trained": 6341280, "num_agent_steps_sampled": 6341280, "num_agent_steps_trained": 6341280}, "done": false, "episodes_total": 1554, "training_iteration": 764, "trial_id": "ee88a_00000", "date": "2023-07-25_04-45-40", "timestamp": 1690249540, "time_this_iter_s": 19.686427116394043, "time_total_s": 13561.48919558525, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3436.6867179870605, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 21.48214285714286, "ram_util_percent": 77.04999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4042358398438, "policy_loss": -195718854937.9107, "vf_loss": 45715827.53571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19684.5, "diff_num_grad_updates_vs_sampler_policy": 19683.5}}, "num_env_steps_sampled": 6348480, "num_env_steps_trained": 6348480, "num_agent_steps_sampled": 6348480, "num_agent_steps_trained": 6348480}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35131.49529590134, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8963196011624447, "mean_inference_ms": 0.3706826315534698, "mean_action_processing_ms": 0.09207767588629615, "mean_env_wait_ms": 1.3225674488031902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003453493118286133, "StateBufferConnector_ms": 0.0026688575744628906, "ViewRequirementAgentConnector_ms": 0.0664818286895752}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35131.49529590134, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35069.25937920495, -35001.911710960994, -35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8963196011624447, "mean_inference_ms": 0.3706826315534698, "mean_action_processing_ms": 0.09207767588629615, "mean_env_wait_ms": 1.3225674488031902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003453493118286133, "StateBufferConnector_ms": 0.0026688575744628906, "ViewRequirementAgentConnector_ms": 0.0664818286895752}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6348480, "num_agent_steps_trained": 6348480, "num_env_steps_sampled": 6348480, "num_env_steps_trained": 6348480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.425011952559, "num_env_steps_trained_throughput_per_sec": 368.425011952559, "timesteps_total": 6348480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6348480, "timers": {"training_iteration_time_ms": 9808.83, "sample_time_ms": 9710.569, "load_time_ms": 1.431, "load_throughput": 2515282.837, "learn_time_ms": 95.92, "learn_throughput": 37531.186, "synch_weights_time_ms": 0.844}, "counters": {"num_env_steps_sampled": 6348480, "num_env_steps_trained": 6348480, "num_agent_steps_sampled": 6348480, "num_agent_steps_trained": 6348480}, "done": false, "episodes_total": 1556, "training_iteration": 765, "trial_id": "ee88a_00000", "date": "2023-07-25_04-46-00", "timestamp": 1690249560, "time_this_iter_s": 19.545661211013794, "time_total_s": 13581.034856796265, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3456.2323791980743, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 21.889285714285716, "ram_util_percent": 77.09285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4008505684989, "policy_loss": -191380579432.4643, "vf_loss": 45751879.10714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19796.5, "diff_num_grad_updates_vs_sampler_policy": 19795.5}}, "num_env_steps_sampled": 6355680, "num_env_steps_trained": 6355680, "num_agent_steps_sampled": 6355680, "num_agent_steps_trained": 6355680}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.0748134593, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8963623592900987, "mean_inference_ms": 0.3706853507886851, "mean_action_processing_ms": 0.09207772632243234, "mean_env_wait_ms": 1.3224315317862698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034551620483398438, "StateBufferConnector_ms": 0.0026657581329345703, "ViewRequirementAgentConnector_ms": 0.06647896766662598}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.0748134593, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35152.085842569184, -35062.54326222569, -35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8963623592900987, "mean_inference_ms": 0.3706853507886851, "mean_action_processing_ms": 0.09207772632243234, "mean_env_wait_ms": 1.3224315317862698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034551620483398438, "StateBufferConnector_ms": 0.0026657581329345703, "ViewRequirementAgentConnector_ms": 0.06647896766662598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6355680, "num_agent_steps_trained": 6355680, "num_env_steps_sampled": 6355680, "num_env_steps_trained": 6355680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.82877468795357, "num_env_steps_trained_throughput_per_sec": 369.82877468795357, "timesteps_total": 6355680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6355680, "timers": {"training_iteration_time_ms": 9780.623, "sample_time_ms": 9682.55, "load_time_ms": 1.428, "load_throughput": 2521457.217, "learn_time_ms": 95.749, "learn_throughput": 37598.193, "synch_weights_time_ms": 0.836}, "counters": {"num_env_steps_sampled": 6355680, "num_env_steps_trained": 6355680, "num_agent_steps_sampled": 6355680, "num_agent_steps_trained": 6355680}, "done": false, "episodes_total": 1558, "training_iteration": 766, "trial_id": "ee88a_00000", "date": "2023-07-25_04-46-19", "timestamp": 1690249579, "time_this_iter_s": 19.47140598297119, "time_total_s": 13600.506262779236, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3475.7037851810455, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 23.818518518518516, "ram_util_percent": 77.08888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4008538382394, "policy_loss": -185971108157.82144, "vf_loss": 45375667.66071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19908.5, "diff_num_grad_updates_vs_sampler_policy": 19907.5}}, "num_env_steps_sampled": 6362880, "num_env_steps_trained": 6362880, "num_agent_steps_sampled": 6362880, "num_agent_steps_trained": 6362880}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.05869411736, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8964118745223993, "mean_inference_ms": 0.37068806058313497, "mean_action_processing_ms": 0.09207779563130551, "mean_env_wait_ms": 1.3222951988224958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034592151641845703, "StateBufferConnector_ms": 0.0026645660400390625, "ViewRequirementAgentConnector_ms": 0.06653976440429688}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.05869411736, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35184.35465942005, -35027.600718244554, -35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8964118745223993, "mean_inference_ms": 0.37068806058313497, "mean_action_processing_ms": 0.09207779563130551, "mean_env_wait_ms": 1.3222951988224958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034592151641845703, "StateBufferConnector_ms": 0.0026645660400390625, "ViewRequirementAgentConnector_ms": 0.06653976440429688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6362880, "num_agent_steps_trained": 6362880, "num_env_steps_sampled": 6362880, "num_env_steps_trained": 6362880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 365.8577837492936, "num_env_steps_trained_throughput_per_sec": 365.8577837492936, "timesteps_total": 6362880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6362880, "timers": {"training_iteration_time_ms": 9799.285, "sample_time_ms": 9701.376, "load_time_ms": 1.433, "load_throughput": 2512311.471, "learn_time_ms": 95.584, "learn_throughput": 37663.203, "synch_weights_time_ms": 0.832}, "counters": {"num_env_steps_sampled": 6362880, "num_env_steps_trained": 6362880, "num_agent_steps_sampled": 6362880, "num_agent_steps_trained": 6362880}, "done": false, "episodes_total": 1560, "training_iteration": 767, "trial_id": "ee88a_00000", "date": "2023-07-25_04-46-39", "timestamp": 1690249599, "time_this_iter_s": 19.68280029296875, "time_total_s": 13620.189063072205, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3495.3865854740143, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 21.685714285714287, "ram_util_percent": 77.03928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3973388671875, "policy_loss": -197719964222.0, "vf_loss": 45771968.821428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20020.5, "diff_num_grad_updates_vs_sampler_policy": 20019.5}}, "num_env_steps_sampled": 6370080, "num_env_steps_trained": 6370080, "num_agent_steps_sampled": 6370080, "num_agent_steps_trained": 6370080}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.62770930175, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8964666695630958, "mean_inference_ms": 0.37069127220683495, "mean_action_processing_ms": 0.09207787007864386, "mean_env_wait_ms": 1.3221538285407357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034618377685546875, "StateBufferConnector_ms": 0.002663135528564453, "ViewRequirementAgentConnector_ms": 0.06656074523925781}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.62770930175, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35126.13214555429, -35168.43015781978, -35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8964666695630958, "mean_inference_ms": 0.37069127220683495, "mean_action_processing_ms": 0.09207787007864386, "mean_env_wait_ms": 1.3221538285407357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034618377685546875, "StateBufferConnector_ms": 0.002663135528564453, "ViewRequirementAgentConnector_ms": 0.06656074523925781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6370080, "num_agent_steps_trained": 6370080, "num_env_steps_sampled": 6370080, "num_env_steps_trained": 6370080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.4825663845985, "num_env_steps_trained_throughput_per_sec": 369.4825663845985, "timesteps_total": 6370080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6370080, "timers": {"training_iteration_time_ms": 9786.079, "sample_time_ms": 9688.349, "load_time_ms": 1.45, "load_throughput": 2481959.071, "learn_time_ms": 95.411, "learn_throughput": 37731.38, "synch_weights_time_ms": 0.809}, "counters": {"num_env_steps_sampled": 6370080, "num_env_steps_trained": 6370080, "num_agent_steps_sampled": 6370080, "num_agent_steps_trained": 6370080}, "done": false, "episodes_total": 1562, "training_iteration": 768, "trial_id": "ee88a_00000", "date": "2023-07-25_04-46-58", "timestamp": 1690249618, "time_this_iter_s": 19.489657163619995, "time_total_s": 13639.678720235825, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3514.8762426376343, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 21.810714285714287, "ram_util_percent": 77.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3973388671875, "policy_loss": -191235966867.375, "vf_loss": 45576025.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20132.5, "diff_num_grad_updates_vs_sampler_policy": 20131.5}}, "num_env_steps_sampled": 6377280, "num_env_steps_trained": 6377280, "num_agent_steps_sampled": 6377280, "num_agent_steps_trained": 6377280}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.593821020586, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8965257431723527, "mean_inference_ms": 0.3706947027433586, "mean_action_processing_ms": 0.09207801363397834, "mean_env_wait_ms": 1.322014626819345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003468036651611328, "StateBufferConnector_ms": 0.0026624202728271484, "ViewRequirementAgentConnector_ms": 0.06654834747314453}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.593821020586, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35387.438868030134, -34961.41272960804, -35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8965257431723527, "mean_inference_ms": 0.3706947027433586, "mean_action_processing_ms": 0.09207801363397834, "mean_env_wait_ms": 1.322014626819345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003468036651611328, "StateBufferConnector_ms": 0.0026624202728271484, "ViewRequirementAgentConnector_ms": 0.06654834747314453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6377280, "num_agent_steps_trained": 6377280, "num_env_steps_sampled": 6377280, "num_env_steps_trained": 6377280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.84244089892167, "num_env_steps_trained_throughput_per_sec": 364.84244089892167, "timesteps_total": 6377280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6377280, "timers": {"training_iteration_time_ms": 9791.199, "sample_time_ms": 9693.621, "load_time_ms": 1.423, "load_throughput": 2529313.277, "learn_time_ms": 95.282, "learn_throughput": 37782.514, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 6377280, "num_env_steps_trained": 6377280, "num_agent_steps_sampled": 6377280, "num_agent_steps_trained": 6377280}, "done": false, "episodes_total": 1564, "training_iteration": 769, "trial_id": "ee88a_00000", "date": "2023-07-25_04-47-18", "timestamp": 1690249638, "time_this_iter_s": 19.737472772598267, "time_total_s": 13659.416193008423, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3534.6137154102325, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 21.567857142857147, "ram_util_percent": 77.15357142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3973388671875, "policy_loss": -196342730633.2857, "vf_loss": 45647460.14285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20244.5, "diff_num_grad_updates_vs_sampler_policy": 20243.5}}, "num_env_steps_sampled": 6384480, "num_env_steps_trained": 6384480, "num_agent_steps_sampled": 6384480, "num_agent_steps_trained": 6384480}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.627589988, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8965840625369327, "mean_inference_ms": 0.3706979690331494, "mean_action_processing_ms": 0.09207812430377242, "mean_env_wait_ms": 1.3218804969141724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034623146057128906, "StateBufferConnector_ms": 0.002659320831298828, "ViewRequirementAgentConnector_ms": 0.06646609306335449}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.627589988, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35009.77373656915, -34998.80728073036, -35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8965840625369327, "mean_inference_ms": 0.3706979690331494, "mean_action_processing_ms": 0.09207812430377242, "mean_env_wait_ms": 1.3218804969141724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034623146057128906, "StateBufferConnector_ms": 0.002659320831298828, "ViewRequirementAgentConnector_ms": 0.06646609306335449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6384480, "num_agent_steps_trained": 6384480, "num_env_steps_sampled": 6384480, "num_env_steps_trained": 6384480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 365.20074693067517, "num_env_steps_trained_throughput_per_sec": 365.20074693067517, "timesteps_total": 6384480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6384480, "timers": {"training_iteration_time_ms": 9808.453, "sample_time_ms": 9710.911, "load_time_ms": 1.432, "load_throughput": 2513356.925, "learn_time_ms": 95.246, "learn_throughput": 37796.842, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 6384480, "num_env_steps_trained": 6384480, "num_agent_steps_sampled": 6384480, "num_agent_steps_trained": 6384480}, "done": false, "episodes_total": 1566, "training_iteration": 770, "trial_id": "ee88a_00000", "date": "2023-07-25_04-47-38", "timestamp": 1690249658, "time_this_iter_s": 19.71803903579712, "time_total_s": 13679.13423204422, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3554.3317544460297, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 21.496428571428574, "ram_util_percent": 77.08928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3973388671875, "policy_loss": -192617750506.4018, "vf_loss": 45310015.73214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20356.5, "diff_num_grad_updates_vs_sampler_policy": 20355.5}}, "num_env_steps_sampled": 6391680, "num_env_steps_trained": 6391680, "num_agent_steps_sampled": 6391680, "num_agent_steps_trained": 6391680}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.62617563446, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8966391268650262, "mean_inference_ms": 0.37070145962092566, "mean_action_processing_ms": 0.09207814939963338, "mean_env_wait_ms": 1.3217515193004226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467082977294922, "StateBufferConnector_ms": 0.0026624202728271484, "ViewRequirementAgentConnector_ms": 0.06645822525024414}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.62617563446, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35000.75335666357, -35197.05026175311, -35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8966391268650262, "mean_inference_ms": 0.37070145962092566, "mean_action_processing_ms": 0.09207814939963338, "mean_env_wait_ms": 1.3217515193004226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467082977294922, "StateBufferConnector_ms": 0.0026624202728271484, "ViewRequirementAgentConnector_ms": 0.06645822525024414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6391680, "num_agent_steps_trained": 6391680, "num_env_steps_sampled": 6391680, "num_env_steps_trained": 6391680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.0868170499031, "num_env_steps_trained_throughput_per_sec": 366.0868170499031, "timesteps_total": 6391680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6391680, "timers": {"training_iteration_time_ms": 9828.352, "sample_time_ms": 9731.548, "load_time_ms": 1.465, "load_throughput": 2457480.006, "learn_time_ms": 94.471, "learn_throughput": 38106.855, "synch_weights_time_ms": 0.81}, "counters": {"num_env_steps_sampled": 6391680, "num_env_steps_trained": 6391680, "num_agent_steps_sampled": 6391680, "num_agent_steps_trained": 6391680}, "done": false, "episodes_total": 1568, "training_iteration": 771, "trial_id": "ee88a_00000", "date": "2023-07-25_04-47-57", "timestamp": 1690249677, "time_this_iter_s": 19.670329093933105, "time_total_s": 13698.804561138153, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3574.0020835399628, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 21.025000000000002, "ram_util_percent": 77.05357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4003295898438, "policy_loss": -196020981778.16965, "vf_loss": 45853958.26785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20468.5, "diff_num_grad_updates_vs_sampler_policy": 20467.5}}, "num_env_steps_sampled": 6398880, "num_env_steps_trained": 6398880, "num_agent_steps_sampled": 6398880, "num_agent_steps_trained": 6398880}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.235529136946, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8966859760003303, "mean_inference_ms": 0.3707053841666999, "mean_action_processing_ms": 0.09207815989949747, "mean_env_wait_ms": 1.3216298591341704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034651756286621094, "StateBufferConnector_ms": 0.002668142318725586, "ViewRequirementAgentConnector_ms": 0.06647634506225586}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35132.235529136946, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35179.333446990706, -35159.25580394735, -35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8966859760003303, "mean_inference_ms": 0.3707053841666999, "mean_action_processing_ms": 0.09207815989949747, "mean_env_wait_ms": 1.3216298591341704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034651756286621094, "StateBufferConnector_ms": 0.002668142318725586, "ViewRequirementAgentConnector_ms": 0.06647634506225586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6398880, "num_agent_steps_trained": 6398880, "num_env_steps_sampled": 6398880, "num_env_steps_trained": 6398880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 365.2225609593494, "num_env_steps_trained_throughput_per_sec": 365.2225609593494, "timesteps_total": 6398880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6398880, "timers": {"training_iteration_time_ms": 9831.776, "sample_time_ms": 9734.301, "load_time_ms": 1.488, "load_throughput": 2419790.769, "learn_time_ms": 95.118, "learn_throughput": 37847.613, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 6398880, "num_env_steps_trained": 6398880, "num_agent_steps_sampled": 6398880, "num_agent_steps_trained": 6398880}, "done": false, "episodes_total": 1570, "training_iteration": 772, "trial_id": "ee88a_00000", "date": "2023-07-25_04-48-17", "timestamp": 1690249697, "time_this_iter_s": 19.717115879058838, "time_total_s": 13718.521677017212, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3593.7191994190216, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 23.185714285714287, "ram_util_percent": 77.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4003295898438, "policy_loss": -196286560507.42856, "vf_loss": 46266262.89285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20580.5, "diff_num_grad_updates_vs_sampler_policy": 20579.5}}, "num_env_steps_sampled": 6406080, "num_env_steps_trained": 6406080, "num_agent_steps_sampled": 6406080, "num_agent_steps_trained": 6406080}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.411521281254, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8967219515346276, "mean_inference_ms": 0.37070945021674717, "mean_action_processing_ms": 0.09207812036531239, "mean_env_wait_ms": 1.321516433151726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476381301879883, "StateBufferConnector_ms": 0.0026738643646240234, "ViewRequirementAgentConnector_ms": 0.06668543815612793}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.411521281254, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35263.50033887962, -34887.76601992205, -35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8967219515346276, "mean_inference_ms": 0.37070945021674717, "mean_action_processing_ms": 0.09207812036531239, "mean_env_wait_ms": 1.321516433151726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476381301879883, "StateBufferConnector_ms": 0.0026738643646240234, "ViewRequirementAgentConnector_ms": 0.06668543815612793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6406080, "num_agent_steps_trained": 6406080, "num_env_steps_sampled": 6406080, "num_env_steps_trained": 6406080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 376.0687206658911, "num_env_steps_trained_throughput_per_sec": 376.0687206658911, "timesteps_total": 6406080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6406080, "timers": {"training_iteration_time_ms": 9797.648, "sample_time_ms": 9700.32, "load_time_ms": 1.477, "load_throughput": 2437525.329, "learn_time_ms": 94.991, "learn_throughput": 37898.359, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 6406080, "num_env_steps_trained": 6406080, "num_agent_steps_sampled": 6406080, "num_agent_steps_trained": 6406080}, "done": false, "episodes_total": 1572, "training_iteration": 773, "trial_id": "ee88a_00000", "date": "2023-07-25_04-48-36", "timestamp": 1690249716, "time_this_iter_s": 19.148432970046997, "time_total_s": 13737.670109987259, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3612.8676323890686, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 22.68518518518519, "ram_util_percent": 76.81851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.4003295898438, "policy_loss": -195216575388.7143, "vf_loss": 45828261.96428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20692.5, "diff_num_grad_updates_vs_sampler_policy": 20691.5}}, "num_env_steps_sampled": 6413280, "num_env_steps_trained": 6413280, "num_agent_steps_sampled": 6413280, "num_agent_steps_trained": 6413280}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35137.1933281065, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8967525959674251, "mean_inference_ms": 0.3707135339483552, "mean_action_processing_ms": 0.09207801668978423, "mean_env_wait_ms": 1.3214121699152233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473043441772461, "StateBufferConnector_ms": 0.0026748180389404297, "ViewRequirementAgentConnector_ms": 0.06665182113647461}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35137.1933281065, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35093.45620572282, -35311.517667275155, -35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8967525959674251, "mean_inference_ms": 0.3707135339483552, "mean_action_processing_ms": 0.09207801668978423, "mean_env_wait_ms": 1.3214121699152233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473043441772461, "StateBufferConnector_ms": 0.0026748180389404297, "ViewRequirementAgentConnector_ms": 0.06665182113647461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6413280, "num_agent_steps_trained": 6413280, "num_env_steps_sampled": 6413280, "num_env_steps_trained": 6413280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.3232821198263, "num_env_steps_trained_throughput_per_sec": 371.3232821198263, "timesteps_total": 6413280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6413280, "timers": {"training_iteration_time_ms": 9763.205, "sample_time_ms": 9666.289, "load_time_ms": 1.516, "load_throughput": 2374246.332, "learn_time_ms": 94.538, "learn_throughput": 38079.754, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 6413280, "num_env_steps_trained": 6413280, "num_agent_steps_sampled": 6413280, "num_agent_steps_trained": 6413280}, "done": false, "episodes_total": 1574, "training_iteration": 774, "trial_id": "ee88a_00000", "date": "2023-07-25_04-48-56", "timestamp": 1690249736, "time_this_iter_s": 19.393030881881714, "time_total_s": 13757.06314086914, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3632.2606632709503, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 19.8, "ram_util_percent": 76.9148148148148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3951285226004, "policy_loss": -190642134099.2009, "vf_loss": 45613907.01785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20804.5, "diff_num_grad_updates_vs_sampler_policy": 20803.5}}, "num_env_steps_sampled": 6420480, "num_env_steps_trained": 6420480, "num_agent_steps_sampled": 6420480, "num_agent_steps_trained": 6420480}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.96790914252, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8967774745105461, "mean_inference_ms": 0.3707179395730206, "mean_action_processing_ms": 0.09207791309057098, "mean_env_wait_ms": 1.3213096189763525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034694671630859375, "StateBufferConnector_ms": 0.002674579620361328, "ViewRequirementAgentConnector_ms": 0.06665992736816406}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.96790914252, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35046.1268673793, -35337.021797628186, -35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8967774745105461, "mean_inference_ms": 0.3707179395730206, "mean_action_processing_ms": 0.09207791309057098, "mean_env_wait_ms": 1.3213096189763525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034694671630859375, "StateBufferConnector_ms": 0.002674579620361328, "ViewRequirementAgentConnector_ms": 0.06665992736816406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6420480, "num_agent_steps_trained": 6420480, "num_env_steps_sampled": 6420480, "num_env_steps_trained": 6420480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 374.9431690659343, "num_env_steps_trained_throughput_per_sec": 374.9431690659343, "timesteps_total": 6420480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6420480, "timers": {"training_iteration_time_ms": 9711.977, "sample_time_ms": 9615.461, "load_time_ms": 1.516, "load_throughput": 2374657.063, "learn_time_ms": 94.128, "learn_throughput": 38245.875, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 6420480, "num_env_steps_trained": 6420480, "num_agent_steps_sampled": 6420480, "num_agent_steps_trained": 6420480}, "done": false, "episodes_total": 1576, "training_iteration": 775, "trial_id": "ee88a_00000", "date": "2023-07-25_04-49-15", "timestamp": 1690249755, "time_this_iter_s": 19.20578098297119, "time_total_s": 13776.268921852112, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3651.4664442539215, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 24.944444444444443, "ram_util_percent": 76.86296296296295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3916375296457, "policy_loss": -187286872039.61496, "vf_loss": 46002254.53571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20916.5, "diff_num_grad_updates_vs_sampler_policy": 20915.5}}, "num_env_steps_sampled": 6427680, "num_env_steps_trained": 6427680, "num_agent_steps_sampled": 6427680, "num_agent_steps_trained": 6427680}, "sampler_results": {"episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.779350353114, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8967990200123331, "mean_inference_ms": 0.37072264035073343, "mean_action_processing_ms": 0.09207785808741843, "mean_env_wait_ms": 1.3212103239894726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034723281860351562, "StateBufferConnector_ms": 0.0026733875274658203, "ViewRequirementAgentConnector_ms": 0.06668734550476074}}, "episode_reward_max": -34797.84891576755, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35134.779350353114, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35066.22720612793, -34865.65740556062, -35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8967990200123331, "mean_inference_ms": 0.37072264035073343, "mean_action_processing_ms": 0.09207785808741843, "mean_env_wait_ms": 1.3212103239894726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034723281860351562, "StateBufferConnector_ms": 0.0026733875274658203, "ViewRequirementAgentConnector_ms": 0.06668734550476074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6427680, "num_agent_steps_trained": 6427680, "num_env_steps_sampled": 6427680, "num_env_steps_trained": 6427680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.0056410225287, "num_env_steps_trained_throughput_per_sec": 371.0056410225287, "timesteps_total": 6427680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6427680, "timers": {"training_iteration_time_ms": 9685.902, "sample_time_ms": 9587.703, "load_time_ms": 1.537, "load_throughput": 2342823.026, "learn_time_ms": 95.783, "learn_throughput": 37585.034, "synch_weights_time_ms": 0.82}, "counters": {"num_env_steps_sampled": 6427680, "num_env_steps_trained": 6427680, "num_agent_steps_sampled": 6427680, "num_agent_steps_trained": 6427680}, "done": false, "episodes_total": 1578, "training_iteration": 776, "trial_id": "ee88a_00000", "date": "2023-07-25_04-49-34", "timestamp": 1690249774, "time_this_iter_s": 19.409525156021118, "time_total_s": 13795.678447008133, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3670.8759694099426, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 28.642857142857142, "ram_util_percent": 76.86785714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3916375296457, "policy_loss": -192394166049.07144, "vf_loss": 45500835.98214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21028.5, "diff_num_grad_updates_vs_sampler_policy": 21027.5}}, "num_env_steps_sampled": 6434880, "num_env_steps_trained": 6434880, "num_agent_steps_sampled": 6434880, "num_agent_steps_trained": 6434880}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.682800883566, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8968216313996318, "mean_inference_ms": 0.370727598830338, "mean_action_processing_ms": 0.09207777306152824, "mean_env_wait_ms": 1.3211102300520126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480672836303711, "StateBufferConnector_ms": 0.002675771713256836, "ViewRequirementAgentConnector_ms": 0.06678652763366699}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35133.682800883566, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35408.08771413533, -35305.053387129665, -35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8968216313996318, "mean_inference_ms": 0.370727598830338, "mean_action_processing_ms": 0.09207777306152824, "mean_env_wait_ms": 1.3211102300520126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480672836303711, "StateBufferConnector_ms": 0.002675771713256836, "ViewRequirementAgentConnector_ms": 0.06678652763366699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6434880, "num_agent_steps_trained": 6434880, "num_env_steps_sampled": 6434880, "num_env_steps_trained": 6434880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.12417809366303, "num_env_steps_trained_throughput_per_sec": 369.12417809366303, "timesteps_total": 6434880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6434880, "timers": {"training_iteration_time_ms": 9665.064, "sample_time_ms": 9567.564, "load_time_ms": 1.502, "load_throughput": 2397582.394, "learn_time_ms": 95.122, "learn_throughput": 37846.048, "synch_weights_time_ms": 0.817}, "counters": {"num_env_steps_sampled": 6434880, "num_env_steps_trained": 6434880, "num_agent_steps_sampled": 6434880, "num_agent_steps_trained": 6434880}, "done": false, "episodes_total": 1580, "training_iteration": 777, "trial_id": "ee88a_00000", "date": "2023-07-25_04-49-54", "timestamp": 1690249794, "time_this_iter_s": 19.508704900741577, "time_total_s": 13815.187151908875, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3690.384674310684, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 24.474999999999998, "ram_util_percent": 76.82500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3916375296457, "policy_loss": -189090712839.1518, "vf_loss": 45526969.875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21140.5, "diff_num_grad_updates_vs_sampler_policy": 21139.5}}, "num_env_steps_sampled": 6442080, "num_env_steps_trained": 6442080, "num_agent_steps_sampled": 6442080, "num_agent_steps_trained": 6442080}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.68241322555, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8968429759556098, "mean_inference_ms": 0.3707329142598782, "mean_action_processing_ms": 0.09207772800234469, "mean_env_wait_ms": 1.3210113330657807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034766197204589844, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06681966781616211}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35130.68241322555, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35180.68424710246, -35238.43813101193, -35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8968429759556098, "mean_inference_ms": 0.3707329142598782, "mean_action_processing_ms": 0.09207772800234469, "mean_env_wait_ms": 1.3210113330657807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034766197204589844, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06681966781616211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6442080, "num_agent_steps_trained": 6442080, "num_env_steps_sampled": 6442080, "num_env_steps_trained": 6442080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.9818227561482, "num_env_steps_trained_throughput_per_sec": 370.9818227561482, "timesteps_total": 6442080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6442080, "timers": {"training_iteration_time_ms": 9691.316, "sample_time_ms": 9593.534, "load_time_ms": 1.494, "load_throughput": 2408981.238, "learn_time_ms": 95.42, "learn_throughput": 37728.042, "synch_weights_time_ms": 0.809}, "counters": {"num_env_steps_sampled": 6442080, "num_env_steps_trained": 6442080, "num_agent_steps_sampled": 6442080, "num_agent_steps_trained": 6442080}, "done": false, "episodes_total": 1582, "training_iteration": 778, "trial_id": "ee88a_00000", "date": "2023-07-25_04-50-13", "timestamp": 1690249813, "time_this_iter_s": 19.410964965820312, "time_total_s": 13834.598116874695, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3709.7956392765045, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 23.770370370370365, "ram_util_percent": 77.05185185185185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3916407993862, "policy_loss": -192492649333.92856, "vf_loss": 45485044.446428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21252.5, "diff_num_grad_updates_vs_sampler_policy": 21251.5}}, "num_env_steps_sampled": 6449280, "num_env_steps_trained": 6449280, "num_agent_steps_sampled": 6449280, "num_agent_steps_trained": 6449280}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35125.88239131584, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8968635732303936, "mean_inference_ms": 0.3707385340505332, "mean_action_processing_ms": 0.09207776043512177, "mean_env_wait_ms": 1.3209111668068116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003479480743408203, "StateBufferConnector_ms": 0.0026750564575195312, "ViewRequirementAgentConnector_ms": 0.06680679321289062}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35125.88239131584, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35012.48799198758, -35021.85486070488, -35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8968635732303936, "mean_inference_ms": 0.3707385340505332, "mean_action_processing_ms": 0.09207776043512177, "mean_env_wait_ms": 1.3209111668068116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003479480743408203, "StateBufferConnector_ms": 0.0026750564575195312, "ViewRequirementAgentConnector_ms": 0.06680679321289062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6449280, "num_agent_steps_trained": 6449280, "num_env_steps_sampled": 6449280, "num_env_steps_trained": 6449280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.74931112294837, "num_env_steps_trained_throughput_per_sec": 369.74931112294837, "timesteps_total": 6449280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6449280, "timers": {"training_iteration_time_ms": 9699.569, "sample_time_ms": 9601.364, "load_time_ms": 1.64, "load_throughput": 2195108.727, "learn_time_ms": 95.672, "learn_throughput": 37628.588, "synch_weights_time_ms": 0.825}, "counters": {"num_env_steps_sampled": 6449280, "num_env_steps_trained": 6449280, "num_agent_steps_sampled": 6449280, "num_agent_steps_trained": 6449280}, "done": false, "episodes_total": 1584, "training_iteration": 779, "trial_id": "ee88a_00000", "date": "2023-07-25_04-50-33", "timestamp": 1690249833, "time_this_iter_s": 19.4758620262146, "time_total_s": 13854.07397890091, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3729.271501302719, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 23.439285714285713, "ram_util_percent": 77.11785714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3936451503208, "policy_loss": -190957831714.86606, "vf_loss": 45588749.26785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21364.5, "diff_num_grad_updates_vs_sampler_policy": 21363.5}}, "num_env_steps_sampled": 6456480, "num_env_steps_trained": 6456480, "num_agent_steps_sampled": 6456480, "num_agent_steps_trained": 6456480}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35127.52545488235, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8968850432993976, "mean_inference_ms": 0.37074428658162867, "mean_action_processing_ms": 0.09207780341998632, "mean_env_wait_ms": 1.320807565009806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034842491149902344, "StateBufferConnector_ms": 0.0026764869689941406, "ViewRequirementAgentConnector_ms": 0.06684327125549316}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35127.52545488235, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35180.8348331379, -35349.45977608954, -35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8968850432993976, "mean_inference_ms": 0.37074428658162867, "mean_action_processing_ms": 0.09207780341998632, "mean_env_wait_ms": 1.320807565009806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034842491149902344, "StateBufferConnector_ms": 0.0026764869689941406, "ViewRequirementAgentConnector_ms": 0.06684327125549316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6456480, "num_agent_steps_trained": 6456480, "num_env_steps_sampled": 6456480, "num_env_steps_trained": 6456480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.1360017339125, "num_env_steps_trained_throughput_per_sec": 367.1360017339125, "timesteps_total": 6456480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6456480, "timers": {"training_iteration_time_ms": 9740.404, "sample_time_ms": 9642.008, "load_time_ms": 1.787, "load_throughput": 2015039.154, "learn_time_ms": 95.719, "learn_throughput": 37610.171, "synch_weights_time_ms": 0.824}, "counters": {"num_env_steps_sampled": 6456480, "num_env_steps_trained": 6456480, "num_agent_steps_sampled": 6456480, "num_agent_steps_trained": 6456480}, "done": false, "episodes_total": 1586, "training_iteration": 780, "trial_id": "ee88a_00000", "date": "2023-07-25_04-50-53", "timestamp": 1690249853, "time_this_iter_s": 19.61419105529785, "time_total_s": 13873.688169956207, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3748.885692358017, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 21.770370370370372, "ram_util_percent": 77.35185185185185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3941040039062, "policy_loss": -194339827933.98215, "vf_loss": 45305715.14285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21476.5, "diff_num_grad_updates_vs_sampler_policy": 21475.5}}, "num_env_steps_sampled": 6463680, "num_env_steps_trained": 6463680, "num_agent_steps_sampled": 6463680, "num_agent_steps_trained": 6463680}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35123.63898510418, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8969096859973829, "mean_inference_ms": 0.3707496386642397, "mean_action_processing_ms": 0.09207785581401967, "mean_env_wait_ms": 1.320700514644642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034804344177246094, "StateBufferConnector_ms": 0.0026743412017822266, "ViewRequirementAgentConnector_ms": 0.06681299209594727}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35123.63898510418, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35274.15119461841, -35255.9239316038, -34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8969096859973829, "mean_inference_ms": 0.3707496386642397, "mean_action_processing_ms": 0.09207785581401967, "mean_env_wait_ms": 1.320700514644642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034804344177246094, "StateBufferConnector_ms": 0.0026743412017822266, "ViewRequirementAgentConnector_ms": 0.06681299209594727}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6463680, "num_agent_steps_trained": 6463680, "num_env_steps_sampled": 6463680, "num_env_steps_trained": 6463680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.8242095035625, "num_env_steps_trained_throughput_per_sec": 368.8242095035625, "timesteps_total": 6463680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6463680, "timers": {"training_iteration_time_ms": 9751.882, "sample_time_ms": 9654.614, "load_time_ms": 1.843, "load_throughput": 1953817.758, "learn_time_ms": 94.546, "learn_throughput": 38076.739, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 6463680, "num_env_steps_trained": 6463680, "num_agent_steps_sampled": 6463680, "num_agent_steps_trained": 6463680}, "done": false, "episodes_total": 1588, "training_iteration": 781, "trial_id": "ee88a_00000", "date": "2023-07-25_04-51-12", "timestamp": 1690249872, "time_this_iter_s": 19.524473905563354, "time_total_s": 13893.21264386177, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3768.4101662635803, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 22.49285714285714, "ram_util_percent": 77.56071428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3941040039062, "policy_loss": -195636953662.25894, "vf_loss": 45706239.41071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21588.5, "diff_num_grad_updates_vs_sampler_policy": 21587.5}}, "num_env_steps_sampled": 6470880, "num_env_steps_trained": 6470880, "num_agent_steps_sampled": 6470880, "num_agent_steps_trained": 6470880}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35120.537905827536, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8969380062110326, "mean_inference_ms": 0.37075424256424144, "mean_action_processing_ms": 0.0920778390374328, "mean_env_wait_ms": 1.3205896566556439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034859180450439453, "StateBufferConnector_ms": 0.002674579620361328, "ViewRequirementAgentConnector_ms": 0.06682658195495605}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35120.537905827536, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34882.64931382212, -35063.47081822638, -35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8969380062110326, "mean_inference_ms": 0.37075424256424144, "mean_action_processing_ms": 0.0920778390374328, "mean_env_wait_ms": 1.3205896566556439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034859180450439453, "StateBufferConnector_ms": 0.002674579620361328, "ViewRequirementAgentConnector_ms": 0.06682658195495605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6470880, "num_agent_steps_trained": 6470880, "num_env_steps_sampled": 6470880, "num_env_steps_trained": 6470880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.7998745078396, "num_env_steps_trained_throughput_per_sec": 367.7998745078396, "timesteps_total": 6470880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6470880, "timers": {"training_iteration_time_ms": 9758.905, "sample_time_ms": 9661.589, "load_time_ms": 1.881, "load_throughput": 1914284.642, "learn_time_ms": 94.541, "learn_throughput": 38078.832, "synch_weights_time_ms": 0.827}, "counters": {"num_env_steps_sampled": 6470880, "num_env_steps_trained": 6470880, "num_agent_steps_sampled": 6470880, "num_agent_steps_trained": 6470880}, "done": false, "episodes_total": 1590, "training_iteration": 782, "trial_id": "ee88a_00000", "date": "2023-07-25_04-51-32", "timestamp": 1690249892, "time_this_iter_s": 19.57871174812317, "time_total_s": 13912.791355609894, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3787.9888780117035, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 21.096428571428568, "ram_util_percent": 77.39285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3941040039062, "policy_loss": -193948503279.67856, "vf_loss": 45598055.14285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21700.5, "diff_num_grad_updates_vs_sampler_policy": 21699.5}}, "num_env_steps_sampled": 6478080, "num_env_steps_trained": 6478080, "num_agent_steps_sampled": 6478080, "num_agent_steps_trained": 6478080}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35123.14464087366, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8969716977072762, "mean_inference_ms": 0.37075924315600517, "mean_action_processing_ms": 0.09207789927403275, "mean_env_wait_ms": 1.320473593682833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034859180450439453, "StateBufferConnector_ms": 0.0026750564575195312, "ViewRequirementAgentConnector_ms": 0.06681561470031738}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35123.14464087366, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35195.26005291352, -35301.26764705103, -35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8969716977072762, "mean_inference_ms": 0.37075924315600517, "mean_action_processing_ms": 0.09207789927403275, "mean_env_wait_ms": 1.320473593682833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034859180450439453, "StateBufferConnector_ms": 0.0026750564575195312, "ViewRequirementAgentConnector_ms": 0.06681561470031738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6478080, "num_agent_steps_trained": 6478080, "num_env_steps_sampled": 6478080, "num_env_steps_trained": 6478080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.6021789947078, "num_env_steps_trained_throughput_per_sec": 367.6021789947078, "timesteps_total": 6478080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6478080, "timers": {"training_iteration_time_ms": 9776.748, "sample_time_ms": 9679.645, "load_time_ms": 1.944, "load_throughput": 1852289.605, "learn_time_ms": 94.254, "learn_throughput": 38194.562, "synch_weights_time_ms": 0.837}, "counters": {"num_env_steps_sampled": 6478080, "num_env_steps_trained": 6478080, "num_agent_steps_sampled": 6478080, "num_agent_steps_trained": 6478080}, "done": false, "episodes_total": 1592, "training_iteration": 783, "trial_id": "ee88a_00000", "date": "2023-07-25_04-51-51", "timestamp": 1690249911, "time_this_iter_s": 19.589290142059326, "time_total_s": 13932.380645751953, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3807.578168153763, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 22.50714285714286, "ram_util_percent": 77.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3941040039062, "policy_loss": -184008628028.10715, "vf_loss": 45608763.51785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21812.5, "diff_num_grad_updates_vs_sampler_policy": 21811.5}}, "num_env_steps_sampled": 6485280, "num_env_steps_trained": 6485280, "num_agent_steps_sampled": 6485280, "num_agent_steps_trained": 6485280}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35121.24848496043, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8970134375854626, "mean_inference_ms": 0.37076481974387493, "mean_action_processing_ms": 0.09207804208037508, "mean_env_wait_ms": 1.3203559616704614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484487533569336, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06684446334838867}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35569.139405115275, "episode_reward_mean": -35121.24848496043, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35569.139405115275, -35067.885392694494, -35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8970134375854626, "mean_inference_ms": 0.37076481974387493, "mean_action_processing_ms": 0.09207804208037508, "mean_env_wait_ms": 1.3203559616704614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484487533569336, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06684446334838867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6485280, "num_agent_steps_trained": 6485280, "num_env_steps_sampled": 6485280, "num_env_steps_trained": 6485280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.05837243470705, "num_env_steps_trained_throughput_per_sec": 366.05837243470705, "timesteps_total": 6485280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6485280, "timers": {"training_iteration_time_ms": 9796.384, "sample_time_ms": 9699.377, "load_time_ms": 1.827, "load_throughput": 1970235.966, "learn_time_ms": 94.308, "learn_throughput": 38172.682, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 6485280, "num_env_steps_trained": 6485280, "num_agent_steps_sampled": 6485280, "num_agent_steps_trained": 6485280}, "done": false, "episodes_total": 1594, "training_iteration": 784, "trial_id": "ee88a_00000", "date": "2023-07-25_04-52-11", "timestamp": 1690249931, "time_this_iter_s": 19.672123908996582, "time_total_s": 13952.05276966095, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3827.2502920627594, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 22.27037037037037, "ram_util_percent": 77.47037037037038}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3941040039062, "policy_loss": -198842826211.42856, "vf_loss": 46050972.21428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21924.5, "diff_num_grad_updates_vs_sampler_policy": 21923.5}}, "num_env_steps_sampled": 6492480, "num_env_steps_trained": 6492480, "num_agent_steps_sampled": 6492480, "num_agent_steps_trained": 6492480}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35119.686520742565, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8970604421788709, "mean_inference_ms": 0.370770450499497, "mean_action_processing_ms": 0.09207819867766026, "mean_env_wait_ms": 1.320237912242945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034825801849365234, "StateBufferConnector_ms": 0.0026831626892089844, "ViewRequirementAgentConnector_ms": 0.0668487548828125}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35119.686520742565, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35045.96519447897, -34858.035278729076, -35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8970604421788709, "mean_inference_ms": 0.370770450499497, "mean_action_processing_ms": 0.09207819867766026, "mean_env_wait_ms": 1.320237912242945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034825801849365234, "StateBufferConnector_ms": 0.0026831626892089844, "ViewRequirementAgentConnector_ms": 0.0668487548828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6492480, "num_agent_steps_trained": 6492480, "num_env_steps_sampled": 6492480, "num_env_steps_trained": 6492480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.0202676958033, "num_env_steps_trained_throughput_per_sec": 367.0202676958033, "timesteps_total": 6492480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6492480, "timers": {"training_iteration_time_ms": 9797.003, "sample_time_ms": 9700.066, "load_time_ms": 1.671, "load_throughput": 2154915.713, "learn_time_ms": 94.398, "learn_throughput": 38136.45, "synch_weights_time_ms": 0.808}, "counters": {"num_env_steps_sampled": 6492480, "num_env_steps_trained": 6492480, "num_agent_steps_sampled": 6492480, "num_agent_steps_trained": 6492480}, "done": false, "episodes_total": 1596, "training_iteration": 785, "trial_id": "ee88a_00000", "date": "2023-07-25_04-52-31", "timestamp": 1690249951, "time_this_iter_s": 19.62045192718506, "time_total_s": 13971.673221588135, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3846.8707439899445, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 21.471428571428568, "ram_util_percent": 77.53214285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3941040039062, "policy_loss": -192140391389.14285, "vf_loss": 45778356.66071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22036.5, "diff_num_grad_updates_vs_sampler_policy": 22035.5}}, "num_env_steps_sampled": 6499680, "num_env_steps_trained": 6499680, "num_agent_steps_sampled": 6499680, "num_agent_steps_trained": 6499680}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35122.61898555135, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8971145391637181, "mean_inference_ms": 0.37077635972676604, "mean_action_processing_ms": 0.09207842317795337, "mean_env_wait_ms": 1.320116504059858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.002684354782104492, "ViewRequirementAgentConnector_ms": 0.06685757637023926}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35122.61898555135, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35352.37009727355, -35157.14946126209, -35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8971145391637181, "mean_inference_ms": 0.37077635972676604, "mean_action_processing_ms": 0.09207842317795337, "mean_env_wait_ms": 1.320116504059858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.002684354782104492, "ViewRequirementAgentConnector_ms": 0.06685757637023926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6499680, "num_agent_steps_trained": 6499680, "num_env_steps_sampled": 6499680, "num_env_steps_trained": 6499680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 365.44834050160455, "num_env_steps_trained_throughput_per_sec": 365.44834050160455, "timesteps_total": 6499680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6499680, "timers": {"training_iteration_time_ms": 9815.036, "sample_time_ms": 9718.421, "load_time_ms": 1.562, "load_throughput": 2304070.315, "learn_time_ms": 94.183, "learn_throughput": 38223.597, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 6499680, "num_env_steps_trained": 6499680, "num_agent_steps_sampled": 6499680, "num_agent_steps_trained": 6499680}, "done": false, "episodes_total": 1598, "training_iteration": 786, "trial_id": "ee88a_00000", "date": "2023-07-25_04-52-50", "timestamp": 1690249970, "time_this_iter_s": 19.704711198806763, "time_total_s": 13991.377932786942, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3866.575455188751, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 21.507142857142856, "ram_util_percent": 77.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3941040039062, "policy_loss": -189512435835.9107, "vf_loss": 45930692.571428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22148.5, "diff_num_grad_updates_vs_sampler_policy": 22147.5}}, "num_env_steps_sampled": 6506880, "num_env_steps_trained": 6506880, "num_agent_steps_sampled": 6506880, "num_agent_steps_trained": 6506880}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35123.81700814604, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8971691591861739, "mean_inference_ms": 0.37078241104135595, "mean_action_processing_ms": 0.09207866046517087, "mean_env_wait_ms": 1.3199970512190964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484010696411133, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06684517860412598}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35123.81700814604, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35066.11939561969, -35238.782420931675, -35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8971691591861739, "mean_inference_ms": 0.37078241104135595, "mean_action_processing_ms": 0.09207866046517087, "mean_env_wait_ms": 1.3199970512190964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484010696411133, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06684517860412598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6506880, "num_agent_steps_trained": 6506880, "num_env_steps_sampled": 6506880, "num_env_steps_trained": 6506880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.7526127658293, "num_env_steps_trained_throughput_per_sec": 367.7526127658293, "timesteps_total": 6506880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6506880, "timers": {"training_iteration_time_ms": 9815.288, "sample_time_ms": 9718.958, "load_time_ms": 1.544, "load_throughput": 2331464.147, "learn_time_ms": 93.944, "learn_throughput": 38320.555, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 6506880, "num_env_steps_trained": 6506880, "num_agent_steps_sampled": 6506880, "num_agent_steps_trained": 6506880}, "done": false, "episodes_total": 1600, "training_iteration": 787, "trial_id": "ee88a_00000", "date": "2023-07-25_04-53-10", "timestamp": 1690249990, "time_this_iter_s": 19.58123517036438, "time_total_s": 14010.959167957306, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3886.1566903591156, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 22.425, "ram_util_percent": 77.42499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3941040039062, "policy_loss": -187898476111.89285, "vf_loss": 46274596.73214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22260.5, "diff_num_grad_updates_vs_sampler_policy": 22259.5}}, "num_env_steps_sampled": 6514080, "num_env_steps_trained": 6514080, "num_agent_steps_sampled": 6514080, "num_agent_steps_trained": 6514080}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35126.155181246, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8972210791253883, "mean_inference_ms": 0.3707885391475121, "mean_action_processing_ms": 0.09207891448726419, "mean_env_wait_ms": 1.319880240590285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003486156463623047, "StateBufferConnector_ms": 0.0026772022247314453, "ViewRequirementAgentConnector_ms": 0.06683874130249023}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35126.155181246, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35157.18416220998, -35344.13987652394, -35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8972210791253883, "mean_inference_ms": 0.3707885391475121, "mean_action_processing_ms": 0.09207891448726419, "mean_env_wait_ms": 1.319880240590285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003486156463623047, "StateBufferConnector_ms": 0.0026772022247314453, "ViewRequirementAgentConnector_ms": 0.06683874130249023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6514080, "num_agent_steps_trained": 6514080, "num_env_steps_sampled": 6514080, "num_env_steps_trained": 6514080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.2429856950722, "num_env_steps_trained_throughput_per_sec": 369.2429856950722, "timesteps_total": 6514080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6514080, "timers": {"training_iteration_time_ms": 9806.584, "sample_time_ms": 9710.651, "load_time_ms": 1.483, "load_throughput": 2428274.163, "learn_time_ms": 93.599, "learn_throughput": 38461.838, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 6514080, "num_env_steps_trained": 6514080, "num_agent_steps_sampled": 6514080, "num_agent_steps_trained": 6514080}, "done": false, "episodes_total": 1602, "training_iteration": 788, "trial_id": "ee88a_00000", "date": "2023-07-25_04-53-30", "timestamp": 1690250010, "time_this_iter_s": 19.502296686172485, "time_total_s": 14030.461464643478, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3905.658987045288, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 20.16785714285714, "ram_util_percent": 77.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3906239100864, "policy_loss": -192462009662.92856, "vf_loss": 45729313.821428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22372.5, "diff_num_grad_updates_vs_sampler_policy": 22371.5}}, "num_env_steps_sampled": 6521280, "num_env_steps_trained": 6521280, "num_agent_steps_sampled": 6521280, "num_agent_steps_trained": 6521280}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35123.79963190034, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8972687299869193, "mean_inference_ms": 0.3707946804479668, "mean_action_processing_ms": 0.09207920661517686, "mean_env_wait_ms": 1.319764939317803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034863948822021484, "StateBufferConnector_ms": 0.0026776790618896484, "ViewRequirementAgentConnector_ms": 0.06682038307189941}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35123.79963190034, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35041.88747208494, -34888.84255459702, -35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8972687299869193, "mean_inference_ms": 0.3707946804479668, "mean_action_processing_ms": 0.09207920661517686, "mean_env_wait_ms": 1.319764939317803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034863948822021484, "StateBufferConnector_ms": 0.0026776790618896484, "ViewRequirementAgentConnector_ms": 0.06682038307189941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6521280, "num_agent_steps_trained": 6521280, "num_env_steps_sampled": 6521280, "num_env_steps_trained": 6521280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 373.16966107658334, "num_env_steps_trained_throughput_per_sec": 373.16966107658334, "timesteps_total": 6521280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6521280, "timers": {"training_iteration_time_ms": 9769.102, "sample_time_ms": 9673.19, "load_time_ms": 1.412, "load_throughput": 2549599.716, "learn_time_ms": 93.64, "learn_throughput": 38444.926, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 6521280, "num_env_steps_trained": 6521280, "num_agent_steps_sampled": 6521280, "num_agent_steps_trained": 6521280}, "done": false, "episodes_total": 1604, "training_iteration": 789, "trial_id": "ee88a_00000", "date": "2023-07-25_04-53-49", "timestamp": 1690250029, "time_this_iter_s": 19.297117948532104, "time_total_s": 14049.75858259201, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3924.95610499382, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 23.78518518518519, "ram_util_percent": 77.18888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3906217302595, "policy_loss": -198110403119.92856, "vf_loss": 45797079.51785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22484.5, "diff_num_grad_updates_vs_sampler_policy": 22483.5}}, "num_env_steps_sampled": 6528480, "num_env_steps_trained": 6528480, "num_agent_steps_sampled": 6528480, "num_agent_steps_trained": 6528480}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35128.22181481774, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8973081709166755, "mean_inference_ms": 0.3708003432062281, "mean_action_processing_ms": 0.09207945401991427, "mean_env_wait_ms": 1.319654986352771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034911632537841797, "StateBufferConnector_ms": 0.002671957015991211, "ViewRequirementAgentConnector_ms": 0.0668177604675293}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35459.20719031498, "episode_reward_mean": -35128.22181481774, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35188.84003959398, -35014.836582520176, -35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8973081709166755, "mean_inference_ms": 0.3708003432062281, "mean_action_processing_ms": 0.09207945401991427, "mean_env_wait_ms": 1.319654986352771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034911632537841797, "StateBufferConnector_ms": 0.002671957015991211, "ViewRequirementAgentConnector_ms": 0.0668177604675293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6528480, "num_agent_steps_trained": 6528480, "num_env_steps_sampled": 6528480, "num_env_steps_trained": 6528480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.5362553752953, "num_env_steps_trained_throughput_per_sec": 372.5362553752953, "timesteps_total": 6528480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6528480, "timers": {"training_iteration_time_ms": 9740.055, "sample_time_ms": 9644.319, "load_time_ms": 1.501, "load_throughput": 2398229.761, "learn_time_ms": 93.387, "learn_throughput": 38549.466, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 6528480, "num_env_steps_trained": 6528480, "num_agent_steps_sampled": 6528480, "num_agent_steps_trained": 6528480}, "done": false, "episodes_total": 1606, "training_iteration": 790, "trial_id": "ee88a_00000", "date": "2023-07-25_04-54-08", "timestamp": 1690250048, "time_this_iter_s": 19.329952001571655, "time_total_s": 14069.088534593582, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3944.286056995392, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 21.21111111111111, "ram_util_percent": 77.38148148148147}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3900833129883, "policy_loss": -194003567636.4866, "vf_loss": 46428757.98214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22596.5, "diff_num_grad_updates_vs_sampler_policy": 22595.5}}, "num_env_steps_sampled": 6535680, "num_env_steps_trained": 6535680, "num_agent_steps_sampled": 6535680, "num_agent_steps_trained": 6535680}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35131.53798840674, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8973396854090339, "mean_inference_ms": 0.37080534983597274, "mean_action_processing_ms": 0.0920795928615109, "mean_env_wait_ms": 1.3195519597860266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034837722778320312, "StateBufferConnector_ms": 0.002672910690307617, "ViewRequirementAgentConnector_ms": 0.06674957275390625}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35131.53798840674, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35269.69578272776, -35138.110506544945, -35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8973396854090339, "mean_inference_ms": 0.37080534983597274, "mean_action_processing_ms": 0.0920795928615109, "mean_env_wait_ms": 1.3195519597860266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034837722778320312, "StateBufferConnector_ms": 0.002672910690307617, "ViewRequirementAgentConnector_ms": 0.06674957275390625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6535680, "num_agent_steps_trained": 6535680, "num_env_steps_sampled": 6535680, "num_env_steps_trained": 6535680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.9576863360845, "num_env_steps_trained_throughput_per_sec": 372.9576863360845, "timesteps_total": 6535680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6535680, "timers": {"training_iteration_time_ms": 9700.386, "sample_time_ms": 9604.694, "load_time_ms": 1.494, "load_throughput": 2408942.806, "learn_time_ms": 93.357, "learn_throughput": 38561.841, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 6535680, "num_env_steps_trained": 6535680, "num_agent_steps_sampled": 6535680, "num_agent_steps_trained": 6535680}, "done": false, "episodes_total": 1608, "training_iteration": 791, "trial_id": "ee88a_00000", "date": "2023-07-25_04-54-28", "timestamp": 1690250068, "time_this_iter_s": 19.30799412727356, "time_total_s": 14088.396528720856, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3963.5940511226654, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 22.075, "ram_util_percent": 77.55714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901955740793, "policy_loss": -195481833023.39285, "vf_loss": 45762691.48214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22708.5, "diff_num_grad_updates_vs_sampler_policy": 22707.5}}, "num_env_steps_sampled": 6542880, "num_env_steps_trained": 6542880, "num_agent_steps_sampled": 6542880, "num_agent_steps_trained": 6542880}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35131.56422219054, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8973667970660244, "mean_inference_ms": 0.37081055851977324, "mean_action_processing_ms": 0.09207977828133625, "mean_env_wait_ms": 1.3194523059707493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482818603515625, "StateBufferConnector_ms": 0.0026750564575195312, "ViewRequirementAgentConnector_ms": 0.06675481796264648}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35131.56422219054, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35046.10295661024, -35104.97260556808, -35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8973667970660244, "mean_inference_ms": 0.37081055851977324, "mean_action_processing_ms": 0.09207977828133625, "mean_env_wait_ms": 1.3194523059707493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482818603515625, "StateBufferConnector_ms": 0.0026750564575195312, "ViewRequirementAgentConnector_ms": 0.06675481796264648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6542880, "num_agent_steps_trained": 6542880, "num_env_steps_sampled": 6542880, "num_env_steps_trained": 6542880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.3909134192591, "num_env_steps_trained_throughput_per_sec": 368.3909134192591, "timesteps_total": 6542880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6542880, "timers": {"training_iteration_time_ms": 9696.994, "sample_time_ms": 9601.411, "load_time_ms": 1.604, "load_throughput": 2244910.78, "learn_time_ms": 93.115, "learn_throughput": 38661.802, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 6542880, "num_env_steps_trained": 6542880, "num_agent_steps_sampled": 6542880, "num_agent_steps_trained": 6542880}, "done": false, "episodes_total": 1610, "training_iteration": 792, "trial_id": "ee88a_00000", "date": "2023-07-25_04-54-47", "timestamp": 1690250087, "time_this_iter_s": 19.547823190689087, "time_total_s": 14107.944351911545, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3983.1418743133545, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 20.962962962962962, "ram_util_percent": 77.5851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901977539062, "policy_loss": -196879722298.83035, "vf_loss": 45873528.64285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22820.5, "diff_num_grad_updates_vs_sampler_policy": 22819.5}}, "num_env_steps_sampled": 6550080, "num_env_steps_trained": 6550080, "num_agent_steps_sampled": 6550080, "num_agent_steps_trained": 6550080}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35134.05866951077, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8973909773104709, "mean_inference_ms": 0.37081538427951005, "mean_action_processing_ms": 0.0920799094411273, "mean_env_wait_ms": 1.3193550900979252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482341766357422, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06677412986755371}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35134.05866951077, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35378.30008051353, -35354.75076781531, -34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8973909773104709, "mean_inference_ms": 0.37081538427951005, "mean_action_processing_ms": 0.0920799094411273, "mean_env_wait_ms": 1.3193550900979252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482341766357422, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06677412986755371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6550080, "num_agent_steps_trained": 6550080, "num_env_steps_sampled": 6550080, "num_env_steps_trained": 6550080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.2851838397294, "num_env_steps_trained_throughput_per_sec": 368.2851838397294, "timesteps_total": 6550080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6550080, "timers": {"training_iteration_time_ms": 9702.064, "sample_time_ms": 9605.933, "load_time_ms": 1.606, "load_throughput": 2241212.136, "learn_time_ms": 93.671, "learn_throughput": 38432.322, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 6550080, "num_env_steps_trained": 6550080, "num_agent_steps_sampled": 6550080, "num_agent_steps_trained": 6550080}, "done": false, "episodes_total": 1612, "training_iteration": 793, "trial_id": "ee88a_00000", "date": "2023-07-25_04-55-07", "timestamp": 1690250107, "time_this_iter_s": 19.553303241729736, "time_total_s": 14127.497655153275, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4002.6951775550842, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 21.45357142857143, "ram_util_percent": 77.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901977539062, "policy_loss": -190961273423.17856, "vf_loss": 46188694.60714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22932.5, "diff_num_grad_updates_vs_sampler_policy": 22931.5}}, "num_env_steps_sampled": 6557280, "num_env_steps_trained": 6557280, "num_agent_steps_sampled": 6557280, "num_agent_steps_trained": 6557280}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35131.84056349032, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8974147159210076, "mean_inference_ms": 0.3708198385922853, "mean_action_processing_ms": 0.09208000428599306, "mean_env_wait_ms": 1.319261568775052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480672836303711, "StateBufferConnector_ms": 0.0026786327362060547, "ViewRequirementAgentConnector_ms": 0.06673049926757812}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35131.84056349032, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34956.85330657337, -35302.26073737168, -35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8974147159210076, "mean_inference_ms": 0.3708198385922853, "mean_action_processing_ms": 0.09208000428599306, "mean_env_wait_ms": 1.319261568775052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480672836303711, "StateBufferConnector_ms": 0.0026786327362060547, "ViewRequirementAgentConnector_ms": 0.06673049926757812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6557280, "num_agent_steps_trained": 6557280, "num_env_steps_sampled": 6557280, "num_env_steps_trained": 6557280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.9080212243556, "num_env_steps_trained_throughput_per_sec": 368.9080212243556, "timesteps_total": 6557280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6557280, "timers": {"training_iteration_time_ms": 9724.353, "sample_time_ms": 9628.01, "load_time_ms": 1.606, "load_throughput": 2240912.78, "learn_time_ms": 93.878, "learn_throughput": 38347.572, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 6557280, "num_env_steps_trained": 6557280, "num_agent_steps_sampled": 6557280, "num_agent_steps_trained": 6557280}, "done": false, "episodes_total": 1614, "training_iteration": 794, "trial_id": "ee88a_00000", "date": "2023-07-25_04-55-26", "timestamp": 1690250126, "time_this_iter_s": 19.52004909515381, "time_total_s": 14147.017704248428, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4022.215226650238, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 21.189285714285713, "ram_util_percent": 77.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901977539062, "policy_loss": -190179388734.57144, "vf_loss": 45752286.53571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23044.5, "diff_num_grad_updates_vs_sampler_policy": 23043.5}}, "num_env_steps_sampled": 6564480, "num_env_steps_trained": 6564480, "num_agent_steps_sampled": 6564480, "num_agent_steps_trained": 6564480}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35132.49242704316, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.897436896520993, "mean_inference_ms": 0.3708244546947016, "mean_action_processing_ms": 0.09208012556739854, "mean_env_wait_ms": 1.3191670999196647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034813880920410156, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06678223609924316}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35132.49242704316, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35000.03183070548, -35153.11641214432, -34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.897436896520993, "mean_inference_ms": 0.3708244546947016, "mean_action_processing_ms": 0.09208012556739854, "mean_env_wait_ms": 1.3191670999196647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034813880920410156, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06678223609924316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6564480, "num_agent_steps_trained": 6564480, "num_env_steps_sampled": 6564480, "num_env_steps_trained": 6564480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.03926697060064, "num_env_steps_trained_throughput_per_sec": 369.03926697060064, "timesteps_total": 6564480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6564480, "timers": {"training_iteration_time_ms": 9742.667, "sample_time_ms": 9646.4, "load_time_ms": 1.537, "load_throughput": 2341733.002, "learn_time_ms": 93.865, "learn_throughput": 38353.114, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 6564480, "num_env_steps_trained": 6564480, "num_agent_steps_sampled": 6564480, "num_agent_steps_trained": 6564480}, "done": false, "episodes_total": 1616, "training_iteration": 795, "trial_id": "ee88a_00000", "date": "2023-07-25_04-55-46", "timestamp": 1690250146, "time_this_iter_s": 19.512892961502075, "time_total_s": 14166.53059720993, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4041.72811961174, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 22.222222222222225, "ram_util_percent": 77.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901966639927, "policy_loss": -197621621982.5, "vf_loss": 45950122.08928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23156.5, "diff_num_grad_updates_vs_sampler_policy": 23155.5}}, "num_env_steps_sampled": 6571680, "num_env_steps_trained": 6571680, "num_agent_steps_sampled": 6571680, "num_agent_steps_trained": 6571680}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35134.271606083305, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8974574285860478, "mean_inference_ms": 0.3708287994958292, "mean_action_processing_ms": 0.09208018934731292, "mean_env_wait_ms": 1.3190731365364727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034787654876708984, "StateBufferConnector_ms": 0.0026819705963134766, "ViewRequirementAgentConnector_ms": 0.06674814224243164}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35134.271606083305, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34912.78304901715, -35190.5545599691, -35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8974574285860478, "mean_inference_ms": 0.3708287994958292, "mean_action_processing_ms": 0.09208018934731292, "mean_env_wait_ms": 1.3190731365364727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034787654876708984, "StateBufferConnector_ms": 0.0026819705963134766, "ViewRequirementAgentConnector_ms": 0.06674814224243164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6571680, "num_agent_steps_trained": 6571680, "num_env_steps_sampled": 6571680, "num_env_steps_trained": 6571680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.53105767779755, "num_env_steps_trained_throughput_per_sec": 371.53105767779755, "timesteps_total": 6571680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6571680, "timers": {"training_iteration_time_ms": 9750.08, "sample_time_ms": 9654.154, "load_time_ms": 1.533, "load_throughput": 2349055.586, "learn_time_ms": 93.525, "learn_throughput": 38492.272, "synch_weights_time_ms": 0.81}, "counters": {"num_env_steps_sampled": 6571680, "num_env_steps_trained": 6571680, "num_agent_steps_sampled": 6571680, "num_agent_steps_trained": 6571680}, "done": false, "episodes_total": 1618, "training_iteration": 796, "trial_id": "ee88a_00000", "date": "2023-07-25_04-56-05", "timestamp": 1690250165, "time_this_iter_s": 19.382359266281128, "time_total_s": 14185.912956476212, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4061.1104788780212, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 22.189285714285713, "ram_util_percent": 77.48928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901966639927, "policy_loss": -190236185012.25, "vf_loss": 45816571.46428572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23268.5, "diff_num_grad_updates_vs_sampler_policy": 23267.5}}, "num_env_steps_sampled": 6578880, "num_env_steps_trained": 6578880, "num_agent_steps_sampled": 6578880, "num_agent_steps_trained": 6578880}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35137.28133819122, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8974775211945194, "mean_inference_ms": 0.37083292397566353, "mean_action_processing_ms": 0.09208024060754555, "mean_env_wait_ms": 1.3189763253747266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003481626510620117, "StateBufferConnector_ms": 0.0026781558990478516, "ViewRequirementAgentConnector_ms": 0.0667269229888916}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35137.28133819122, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35001.59024636261, -35197.40632779663, -35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8974775211945194, "mean_inference_ms": 0.37083292397566353, "mean_action_processing_ms": 0.09208024060754555, "mean_env_wait_ms": 1.3189763253747266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003481626510620117, "StateBufferConnector_ms": 0.0026781558990478516, "ViewRequirementAgentConnector_ms": 0.0667269229888916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6578880, "num_agent_steps_trained": 6578880, "num_env_steps_sampled": 6578880, "num_env_steps_trained": 6578880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.48658397090213, "num_env_steps_trained_throughput_per_sec": 371.48658397090213, "timesteps_total": 6578880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6578880, "timers": {"training_iteration_time_ms": 9733.793, "sample_time_ms": 9637.581, "load_time_ms": 1.408, "load_throughput": 2556073.739, "learn_time_ms": 93.931, "learn_throughput": 38326.168, "synch_weights_time_ms": 0.816}, "counters": {"num_env_steps_sampled": 6578880, "num_env_steps_trained": 6578880, "num_agent_steps_sampled": 6578880, "num_agent_steps_trained": 6578880}, "done": false, "episodes_total": 1620, "training_iteration": 797, "trial_id": "ee88a_00000", "date": "2023-07-25_04-56-25", "timestamp": 1690250185, "time_this_iter_s": 19.384669065475464, "time_total_s": 14205.297625541687, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4080.4951479434967, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 23.066666666666666, "ram_util_percent": 77.27407407407408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901977539062, "policy_loss": -189601809536.42856, "vf_loss": 45854801.39285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23380.5, "diff_num_grad_updates_vs_sampler_policy": 23379.5}}, "num_env_steps_sampled": 6586080, "num_env_steps_trained": 6586080, "num_agent_steps_sampled": 6586080, "num_agent_steps_trained": 6586080}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35136.74796948275, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8974961910104606, "mean_inference_ms": 0.37083760831486307, "mean_action_processing_ms": 0.092080381689463, "mean_env_wait_ms": 1.3188797669075891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034821033477783203, "StateBufferConnector_ms": 0.002680540084838867, "ViewRequirementAgentConnector_ms": 0.06673049926757812}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35136.74796948275, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35127.806690366735, -35244.391092273436, -35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8974961910104606, "mean_inference_ms": 0.37083760831486307, "mean_action_processing_ms": 0.092080381689463, "mean_env_wait_ms": 1.3188797669075891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034821033477783203, "StateBufferConnector_ms": 0.002680540084838867, "ViewRequirementAgentConnector_ms": 0.06673049926757812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6586080, "num_agent_steps_trained": 6586080, "num_env_steps_sampled": 6586080, "num_env_steps_trained": 6586080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.7191579718874, "num_env_steps_trained_throughput_per_sec": 367.7191579718874, "timesteps_total": 6586080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6586080, "timers": {"training_iteration_time_ms": 9736.803, "sample_time_ms": 9640.851, "load_time_ms": 1.403, "load_throughput": 2566326.359, "learn_time_ms": 93.673, "learn_throughput": 38431.383, "synch_weights_time_ms": 0.82}, "counters": {"num_env_steps_sampled": 6586080, "num_env_steps_trained": 6586080, "num_agent_steps_sampled": 6586080, "num_agent_steps_trained": 6586080}, "done": false, "episodes_total": 1622, "training_iteration": 798, "trial_id": "ee88a_00000", "date": "2023-07-25_04-56-44", "timestamp": 1690250204, "time_this_iter_s": 19.58314800262451, "time_total_s": 14224.880773544312, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4100.078295946121, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 22.20357142857143, "ram_util_percent": 77.28214285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901955740793, "policy_loss": -194118658932.10715, "vf_loss": 45718351.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23492.5, "diff_num_grad_updates_vs_sampler_policy": 23491.5}}, "num_env_steps_sampled": 6593280, "num_env_steps_trained": 6593280, "num_agent_steps_sampled": 6593280, "num_agent_steps_trained": 6593280}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35137.173332137216, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8975143639966356, "mean_inference_ms": 0.370842139160752, "mean_action_processing_ms": 0.09208050527816186, "mean_env_wait_ms": 1.3187818155673148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003481149673461914, "StateBufferConnector_ms": 0.0026810169219970703, "ViewRequirementAgentConnector_ms": 0.06673455238342285}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35137.173332137216, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35012.29390108632, -35078.016722996785, -34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8975143639966356, "mean_inference_ms": 0.370842139160752, "mean_action_processing_ms": 0.09208050527816186, "mean_env_wait_ms": 1.3187818155673148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003481149673461914, "StateBufferConnector_ms": 0.0026810169219970703, "ViewRequirementAgentConnector_ms": 0.06673455238342285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6593280, "num_agent_steps_trained": 6593280, "num_env_steps_sampled": 6593280, "num_env_steps_trained": 6593280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.4207870817239, "num_env_steps_trained_throughput_per_sec": 370.4207870817239, "timesteps_total": 6593280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6593280, "timers": {"training_iteration_time_ms": 9728.833, "sample_time_ms": 9632.999, "load_time_ms": 1.414, "load_throughput": 2545602.266, "learn_time_ms": 93.547, "learn_throughput": 38483.364, "synch_weights_time_ms": 0.816}, "counters": {"num_env_steps_sampled": 6593280, "num_env_steps_trained": 6593280, "num_agent_steps_sampled": 6593280, "num_agent_steps_trained": 6593280}, "done": false, "episodes_total": 1624, "training_iteration": 799, "trial_id": "ee88a_00000", "date": "2023-07-25_04-57-04", "timestamp": 1690250224, "time_this_iter_s": 19.44019603729248, "time_total_s": 14244.320969581604, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4119.518491983414, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 20.728571428571424, "ram_util_percent": 76.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901977539062, "policy_loss": -191884703658.67856, "vf_loss": 45959032.26785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23604.5, "diff_num_grad_updates_vs_sampler_policy": 23603.5}}, "num_env_steps_sampled": 6600480, "num_env_steps_trained": 6600480, "num_agent_steps_sampled": 6600480, "num_agent_steps_trained": 6600480}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35139.45005432539, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8975341409190665, "mean_inference_ms": 0.3708467776376295, "mean_action_processing_ms": 0.09208066115300614, "mean_env_wait_ms": 1.3186815132068748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034868717193603516, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06668353080749512}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35139.45005432539, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34978.05053937594, -35182.90717864394, -35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8975341409190665, "mean_inference_ms": 0.3708467776376295, "mean_action_processing_ms": 0.09208066115300614, "mean_env_wait_ms": 1.3186815132068748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034868717193603516, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06668353080749512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6600480, "num_agent_steps_trained": 6600480, "num_env_steps_sampled": 6600480, "num_env_steps_trained": 6600480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.6129901836011, "num_env_steps_trained_throughput_per_sec": 367.6129901836011, "timesteps_total": 6600480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6600480, "timers": {"training_iteration_time_ms": 9736.403, "sample_time_ms": 9640.315, "load_time_ms": 1.454, "load_throughput": 2476301.233, "learn_time_ms": 93.755, "learn_throughput": 38397.774, "synch_weights_time_ms": 0.822}, "counters": {"num_env_steps_sampled": 6600480, "num_env_steps_trained": 6600480, "num_agent_steps_sampled": 6600480, "num_agent_steps_trained": 6600480}, "done": false, "episodes_total": 1626, "training_iteration": 800, "trial_id": "ee88a_00000", "date": "2023-07-25_04-57-23", "timestamp": 1690250243, "time_this_iter_s": 19.588849306106567, "time_total_s": 14263.90981888771, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4139.10734128952, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 21.4, "ram_util_percent": 76.83703703703705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901966639927, "policy_loss": -186832319031.4643, "vf_loss": 45928667.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23716.5, "diff_num_grad_updates_vs_sampler_policy": 23715.5}}, "num_env_steps_sampled": 6607680, "num_env_steps_trained": 6607680, "num_agent_steps_sampled": 6607680, "num_agent_steps_trained": 6607680}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35141.59329695539, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8975555513208991, "mean_inference_ms": 0.37085171707038034, "mean_action_processing_ms": 0.09208089273013041, "mean_env_wait_ms": 1.3185805300417874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034875869750976562, "StateBufferConnector_ms": 0.00267791748046875, "ViewRequirementAgentConnector_ms": 0.06668567657470703}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35141.59329695539, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35182.56154878835, -35459.20719031498, -35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8975555513208991, "mean_inference_ms": 0.37085171707038034, "mean_action_processing_ms": 0.09208089273013041, "mean_env_wait_ms": 1.3185805300417874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034875869750976562, "StateBufferConnector_ms": 0.00267791748046875, "ViewRequirementAgentConnector_ms": 0.06668567657470703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6607680, "num_agent_steps_trained": 6607680, "num_env_steps_sampled": 6607680, "num_env_steps_trained": 6607680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.21014858865834, "num_env_steps_trained_throughput_per_sec": 367.21014858865834, "timesteps_total": 6607680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6607680, "timers": {"training_iteration_time_ms": 9759.206, "sample_time_ms": 9663.062, "load_time_ms": 1.466, "load_throughput": 2456280.709, "learn_time_ms": 93.805, "learn_throughput": 38377.64, "synch_weights_time_ms": 0.816}, "counters": {"num_env_steps_sampled": 6607680, "num_env_steps_trained": 6607680, "num_agent_steps_sampled": 6607680, "num_agent_steps_trained": 6607680}, "done": false, "episodes_total": 1628, "training_iteration": 801, "trial_id": "ee88a_00000", "date": "2023-07-25_04-57-43", "timestamp": 1690250263, "time_this_iter_s": 19.61020302772522, "time_total_s": 14283.520021915436, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4158.7175443172455, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 22.32857142857143, "ram_util_percent": 77.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901977539062, "policy_loss": -194295579981.85715, "vf_loss": 45620371.39285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23828.5, "diff_num_grad_updates_vs_sampler_policy": 23827.5}}, "num_env_steps_sampled": 6614880, "num_env_steps_trained": 6614880, "num_agent_steps_sampled": 6614880, "num_agent_steps_trained": 6614880}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35136.73160653995, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8975793166004888, "mean_inference_ms": 0.37085649553436534, "mean_action_processing_ms": 0.0920811032549704, "mean_env_wait_ms": 1.3184773993590877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034818649291992188, "StateBufferConnector_ms": 0.0026798248291015625, "ViewRequirementAgentConnector_ms": 0.06670522689819336}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35136.73160653995, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35312.0857997655, -34905.404714798686, -35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8975793166004888, "mean_inference_ms": 0.37085649553436534, "mean_action_processing_ms": 0.0920811032549704, "mean_env_wait_ms": 1.3184773993590877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034818649291992188, "StateBufferConnector_ms": 0.0026798248291015625, "ViewRequirementAgentConnector_ms": 0.06670522689819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6614880, "num_agent_steps_trained": 6614880, "num_env_steps_sampled": 6614880, "num_env_steps_trained": 6614880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 370.24818873609183, "num_env_steps_trained_throughput_per_sec": 370.24818873609183, "timesteps_total": 6614880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6614880, "timers": {"training_iteration_time_ms": 9765.688, "sample_time_ms": 9669.805, "load_time_ms": 1.491, "load_throughput": 2414412.511, "learn_time_ms": 93.511, "learn_throughput": 38498.111, "synch_weights_time_ms": 0.823}, "counters": {"num_env_steps_sampled": 6614880, "num_env_steps_trained": 6614880, "num_agent_steps_sampled": 6614880, "num_agent_steps_trained": 6614880}, "done": false, "episodes_total": 1630, "training_iteration": 802, "trial_id": "ee88a_00000", "date": "2023-07-25_04-58-02", "timestamp": 1690250282, "time_this_iter_s": 19.44946002960205, "time_total_s": 14302.969481945038, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4178.1670043468475, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 21.16071428571429, "ram_util_percent": 77.28214285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901966639927, "policy_loss": -190128998827.4643, "vf_loss": 45175675.571428575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23940.5, "diff_num_grad_updates_vs_sampler_policy": 23939.5}}, "num_env_steps_sampled": 6622080, "num_env_steps_trained": 6622080, "num_agent_steps_sampled": 6622080, "num_agent_steps_trained": 6622080}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35132.07016712343, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8976112563870019, "mean_inference_ms": 0.37086138023407, "mean_action_processing_ms": 0.09208139635904913, "mean_env_wait_ms": 1.3183722287669815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034813880920410156, "StateBufferConnector_ms": 0.0026781558990478516, "ViewRequirementAgentConnector_ms": 0.06667232513427734}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35132.07016712343, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35357.28925873221, -35225.21561139377, -34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8976112563870019, "mean_inference_ms": 0.37086138023407, "mean_action_processing_ms": 0.09208139635904913, "mean_env_wait_ms": 1.3183722287669815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034813880920410156, "StateBufferConnector_ms": 0.0026781558990478516, "ViewRequirementAgentConnector_ms": 0.06667232513427734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6622080, "num_agent_steps_trained": 6622080, "num_env_steps_sampled": 6622080, "num_env_steps_trained": 6622080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 364.6642031205119, "num_env_steps_trained_throughput_per_sec": 364.6642031205119, "timesteps_total": 6622080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6622080, "timers": {"training_iteration_time_ms": 9782.091, "sample_time_ms": 9686.385, "load_time_ms": 1.688, "load_throughput": 2133148.887, "learn_time_ms": 93.124, "learn_throughput": 38658.209, "synch_weights_time_ms": 0.83}, "counters": {"num_env_steps_sampled": 6622080, "num_env_steps_trained": 6622080, "num_agent_steps_sampled": 6622080, "num_agent_steps_trained": 6622080}, "done": false, "episodes_total": 1632, "training_iteration": 803, "trial_id": "ee88a_00000", "date": "2023-07-25_04-58-22", "timestamp": 1690250302, "time_this_iter_s": 19.747141122817993, "time_total_s": 14322.716623067856, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4197.9141454696655, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 22.03928571428571, "ram_util_percent": 77.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901977539062, "policy_loss": -198327597062.57144, "vf_loss": 45604035.01785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24052.5, "diff_num_grad_updates_vs_sampler_policy": 24051.5}}, "num_env_steps_sampled": 6629280, "num_env_steps_trained": 6629280, "num_agent_steps_sampled": 6629280, "num_agent_steps_trained": 6629280}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35126.173198456956, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8976486981448403, "mean_inference_ms": 0.37086659617877027, "mean_action_processing_ms": 0.09208175139291232, "mean_env_wait_ms": 1.3182652233035466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482341766357422, "StateBufferConnector_ms": 0.002679109573364258, "ViewRequirementAgentConnector_ms": 0.06665730476379395}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35126.173198456956, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34916.27708151894, -34952.630641505864, -34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8976486981448403, "mean_inference_ms": 0.37086659617877027, "mean_action_processing_ms": 0.09208175139291232, "mean_env_wait_ms": 1.3182652233035466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482341766357422, "StateBufferConnector_ms": 0.002679109573364258, "ViewRequirementAgentConnector_ms": 0.06665730476379395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6629280, "num_agent_steps_trained": 6629280, "num_env_steps_sampled": 6629280, "num_env_steps_trained": 6629280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 367.5608374328896, "num_env_steps_trained_throughput_per_sec": 367.5608374328896, "timesteps_total": 6629280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6629280, "timers": {"training_iteration_time_ms": 9797.215, "sample_time_ms": 9701.998, "load_time_ms": 1.746, "load_throughput": 2061842.94, "learn_time_ms": 92.586, "learn_throughput": 38882.641, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 6629280, "num_env_steps_trained": 6629280, "num_agent_steps_sampled": 6629280, "num_agent_steps_trained": 6629280}, "done": false, "episodes_total": 1634, "training_iteration": 804, "trial_id": "ee88a_00000", "date": "2023-07-25_04-58-42", "timestamp": 1690250322, "time_this_iter_s": 19.591520071029663, "time_total_s": 14342.308143138885, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4217.505665540695, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 21.98148148148148, "ram_util_percent": 76.48148148148148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901977539062, "policy_loss": -191222485938.89285, "vf_loss": 45564661.91071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24164.5, "diff_num_grad_updates_vs_sampler_policy": 24163.5}}, "num_env_steps_sampled": 6636480, "num_env_steps_trained": 6636480, "num_agent_steps_sampled": 6636480, "num_agent_steps_trained": 6636480}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35129.465148137686, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8976893470815539, "mean_inference_ms": 0.3708717641787602, "mean_action_processing_ms": 0.09208212543534529, "mean_env_wait_ms": 1.318155320068574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034780502319335938, "StateBufferConnector_ms": 0.0026776790618896484, "ViewRequirementAgentConnector_ms": 0.06666016578674316}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35129.465148137686, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34953.21756042265, -35054.106540646026, -35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8976893470815539, "mean_inference_ms": 0.3708717641787602, "mean_action_processing_ms": 0.09208212543534529, "mean_env_wait_ms": 1.318155320068574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034780502319335938, "StateBufferConnector_ms": 0.0026776790618896484, "ViewRequirementAgentConnector_ms": 0.06666016578674316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6636480, "num_agent_steps_trained": 6636480, "num_env_steps_sampled": 6636480, "num_env_steps_trained": 6636480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.5991220334024, "num_env_steps_trained_throughput_per_sec": 368.5991220334024, "timesteps_total": 6636480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6636480, "timers": {"training_iteration_time_ms": 9791.975, "sample_time_ms": 9697.073, "load_time_ms": 1.745, "load_throughput": 2062969.738, "learn_time_ms": 92.276, "learn_throughput": 39013.324, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 6636480, "num_env_steps_trained": 6636480, "num_agent_steps_sampled": 6636480, "num_agent_steps_trained": 6636480}, "done": false, "episodes_total": 1636, "training_iteration": 805, "trial_id": "ee88a_00000", "date": "2023-07-25_04-59-01", "timestamp": 1690250341, "time_this_iter_s": 19.53653383255005, "time_total_s": 14361.844676971436, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4237.042199373245, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 21.98928571428571, "ram_util_percent": 76.70357142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901966639927, "policy_loss": -191805982204.5357, "vf_loss": 45798990.14285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24276.5, "diff_num_grad_updates_vs_sampler_policy": 24275.5}}, "num_env_steps_sampled": 6643680, "num_env_steps_trained": 6643680, "num_agent_steps_sampled": 6643680, "num_agent_steps_trained": 6643680}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35134.94025110785, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8977280336035932, "mean_inference_ms": 0.3708770920537331, "mean_action_processing_ms": 0.09208257396402107, "mean_env_wait_ms": 1.3180441370349891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487110137939453, "StateBufferConnector_ms": 0.00267791748046875, "ViewRequirementAgentConnector_ms": 0.06674909591674805}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35134.94025110785, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35327.43988597648, -35164.82893001549, -35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8977280336035932, "mean_inference_ms": 0.3708770920537331, "mean_action_processing_ms": 0.09208257396402107, "mean_env_wait_ms": 1.3180441370349891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487110137939453, "StateBufferConnector_ms": 0.00267791748046875, "ViewRequirementAgentConnector_ms": 0.06674909591674805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6643680, "num_agent_steps_trained": 6643680, "num_env_steps_sampled": 6643680, "num_env_steps_trained": 6643680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.67800948192195, "num_env_steps_trained_throughput_per_sec": 371.67800948192195, "timesteps_total": 6643680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6643680, "timers": {"training_iteration_time_ms": 9768.405, "sample_time_ms": 9673.268, "load_time_ms": 1.821, "load_throughput": 1977046.429, "learn_time_ms": 92.431, "learn_throughput": 38947.803, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 6643680, "num_env_steps_trained": 6643680, "num_agent_steps_sampled": 6643680, "num_agent_steps_trained": 6643680}, "done": false, "episodes_total": 1638, "training_iteration": 806, "trial_id": "ee88a_00000", "date": "2023-07-25_04-59-21", "timestamp": 1690250361, "time_this_iter_s": 19.374528884887695, "time_total_s": 14381.219205856323, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4256.416728258133, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 22.24642857142857, "ram_util_percent": 76.97857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901977539062, "policy_loss": -195658260145.95535, "vf_loss": 46122231.60714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24388.5, "diff_num_grad_updates_vs_sampler_policy": 24387.5}}, "num_env_steps_sampled": 6650880, "num_env_steps_trained": 6650880, "num_agent_steps_sampled": 6650880, "num_agent_steps_trained": 6650880}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35135.53780788413, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8977616766967634, "mean_inference_ms": 0.3708826819894675, "mean_action_processing_ms": 0.09208310364926692, "mean_env_wait_ms": 1.3179354712208735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487825393676758, "StateBufferConnector_ms": 0.002676248550415039, "ViewRequirementAgentConnector_ms": 0.06671357154846191}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35135.53780788413, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35168.71298178617, -35189.92987881898, -34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8977616766967634, "mean_inference_ms": 0.3708826819894675, "mean_action_processing_ms": 0.09208310364926692, "mean_env_wait_ms": 1.3179354712208735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487825393676758, "StateBufferConnector_ms": 0.002676248550415039, "ViewRequirementAgentConnector_ms": 0.06671357154846191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6650880, "num_agent_steps_trained": 6650880, "num_env_steps_sampled": 6650880, "num_env_steps_trained": 6650880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 372.41062576366005, "num_env_steps_trained_throughput_per_sec": 372.41062576366005, "timesteps_total": 6650880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6650880, "timers": {"training_iteration_time_ms": 9757.114, "sample_time_ms": 9662.014, "load_time_ms": 1.801, "load_throughput": 1999403.39, "learn_time_ms": 92.442, "learn_throughput": 38943.302, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 6650880, "num_env_steps_trained": 6650880, "num_agent_steps_sampled": 6650880, "num_agent_steps_trained": 6650880}, "done": false, "episodes_total": 1640, "training_iteration": 807, "trial_id": "ee88a_00000", "date": "2023-07-25_04-59-40", "timestamp": 1690250380, "time_this_iter_s": 19.336353063583374, "time_total_s": 14400.555558919907, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4275.753081321716, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 21.1, "ram_util_percent": 76.9222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3901966639927, "policy_loss": -195338996496.64285, "vf_loss": 45650099.01785714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24500.5, "diff_num_grad_updates_vs_sampler_policy": 24499.5}}, "num_env_steps_sampled": 6658080, "num_env_steps_trained": 6658080, "num_agent_steps_sampled": 6658080, "num_agent_steps_trained": 6658080}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35134.51199362548, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8977918255692997, "mean_inference_ms": 0.3708877296317851, "mean_action_processing_ms": 0.09208361873336411, "mean_env_wait_ms": 1.317832711765813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003490447998046875, "StateBufferConnector_ms": 0.0026798248291015625, "ViewRequirementAgentConnector_ms": 0.06672525405883789}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35134.51199362548, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34924.98728990658, -35158.16113410554, -35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8977918255692997, "mean_inference_ms": 0.3708877296317851, "mean_action_processing_ms": 0.09208361873336411, "mean_env_wait_ms": 1.317832711765813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003490447998046875, "StateBufferConnector_ms": 0.0026798248291015625, "ViewRequirementAgentConnector_ms": 0.06672525405883789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6658080, "num_agent_steps_trained": 6658080, "num_env_steps_sampled": 6658080, "num_env_steps_trained": 6658080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.8707933650969, "num_env_steps_trained_throughput_per_sec": 366.8707933650969, "timesteps_total": 6658080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6658080, "timers": {"training_iteration_time_ms": 9745.238, "sample_time_ms": 9650.226, "load_time_ms": 1.652, "load_throughput": 2179771.391, "learn_time_ms": 92.503, "learn_throughput": 38917.697, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 6658080, "num_env_steps_trained": 6658080, "num_agent_steps_sampled": 6658080, "num_agent_steps_trained": 6658080}, "done": false, "episodes_total": 1642, "training_iteration": 808, "trial_id": "ee88a_00000", "date": "2023-07-25_05-00-00", "timestamp": 1690250400, "time_this_iter_s": 19.628385066986084, "time_total_s": 14420.183943986893, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4295.381466388702, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 20.875000000000004, "ram_util_percent": 77.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3866729736328, "policy_loss": -196707637709.90848, "vf_loss": 45767542.35714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24612.5, "diff_num_grad_updates_vs_sampler_policy": 24611.5}}, "num_env_steps_sampled": 6665280, "num_env_steps_trained": 6665280, "num_agent_steps_sampled": 6665280, "num_agent_steps_trained": 6665280}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35136.27992294234, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8978184788873318, "mean_inference_ms": 0.37089255995945225, "mean_action_processing_ms": 0.09208408760464301, "mean_env_wait_ms": 1.3177326982093667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003490924835205078, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06675291061401367}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35136.27992294234, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35216.140836484214, -34920.58819047938, -35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8978184788873318, "mean_inference_ms": 0.37089255995945225, "mean_action_processing_ms": 0.09208408760464301, "mean_env_wait_ms": 1.3177326982093667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003490924835205078, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06675291061401367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6665280, "num_agent_steps_trained": 6665280, "num_env_steps_sampled": 6665280, "num_env_steps_trained": 6665280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.7385097217304, "num_env_steps_trained_throughput_per_sec": 369.7385097217304, "timesteps_total": 6665280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6665280, "timers": {"training_iteration_time_ms": 9733.701, "sample_time_ms": 9638.904, "load_time_ms": 1.581, "load_throughput": 2277244.05, "learn_time_ms": 92.336, "learn_throughput": 38987.868, "synch_weights_time_ms": 0.82}, "counters": {"num_env_steps_sampled": 6665280, "num_env_steps_trained": 6665280, "num_agent_steps_sampled": 6665280, "num_agent_steps_trained": 6665280}, "done": false, "episodes_total": 1644, "training_iteration": 809, "trial_id": "ee88a_00000", "date": "2023-07-25_05-00-19", "timestamp": 1690250419, "time_this_iter_s": 19.476327180862427, "time_total_s": 14439.660271167755, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4314.857793569565, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 22.04074074074074, "ram_util_percent": 76.93703703703704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3822937011719, "policy_loss": -197328248528.2143, "vf_loss": 45780098.73214286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24724.5, "diff_num_grad_updates_vs_sampler_policy": 24723.5}}, "num_env_steps_sampled": 6672480, "num_env_steps_trained": 6672480, "num_agent_steps_sampled": 6672480, "num_agent_steps_trained": 6672480}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35135.919562960036, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8978403535390445, "mean_inference_ms": 0.3708967946228746, "mean_action_processing_ms": 0.09208448104915476, "mean_env_wait_ms": 1.3176344030020173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034928321838378906, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06675124168395996}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35135.919562960036, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35201.419984656095, -34797.84891576755, -35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8978403535390445, "mean_inference_ms": 0.3708967946228746, "mean_action_processing_ms": 0.09208448104915476, "mean_env_wait_ms": 1.3176344030020173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034928321838378906, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06675124168395996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6672480, "num_agent_steps_trained": 6672480, "num_env_steps_sampled": 6672480, "num_env_steps_trained": 6672480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.00320149099883, "num_env_steps_trained_throughput_per_sec": 369.00320149099883, "timesteps_total": 6672480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6672480, "timers": {"training_iteration_time_ms": 9731.562, "sample_time_ms": 9636.532, "load_time_ms": 1.54, "load_throughput": 2337202.136, "learn_time_ms": 92.612, "learn_throughput": 38871.801, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 6672480, "num_env_steps_trained": 6672480, "num_agent_steps_sampled": 6672480, "num_agent_steps_trained": 6672480}, "done": false, "episodes_total": 1646, "training_iteration": 810, "trial_id": "ee88a_00000", "date": "2023-07-25_05-00-39", "timestamp": 1690250439, "time_this_iter_s": 19.51477599143982, "time_total_s": 14459.175047159195, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4334.372569561005, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 21.49285714285714, "ram_util_percent": 76.87142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3823002406529, "policy_loss": -195935470076.42856, "vf_loss": 46042371.928571425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24836.5, "diff_num_grad_updates_vs_sampler_policy": 24835.5}}, "num_env_steps_sampled": 6679680, "num_env_steps_trained": 6679680, "num_agent_steps_sampled": 6679680, "num_agent_steps_trained": 6679680}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35141.433411532336, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8978603904210984, "mean_inference_ms": 0.3709006893323054, "mean_action_processing_ms": 0.0920848414704361, "mean_env_wait_ms": 1.3175334996691241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034949779510498047, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06674361228942871}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35141.433411532336, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35308.15660065405, -35026.24753599622, -35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8978603904210984, "mean_inference_ms": 0.3709006893323054, "mean_action_processing_ms": 0.0920848414704361, "mean_env_wait_ms": 1.3175334996691241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034949779510498047, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06674361228942871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6679680, "num_agent_steps_trained": 6679680, "num_env_steps_sampled": 6679680, "num_env_steps_trained": 6679680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 371.7281525003033, "num_env_steps_trained_throughput_per_sec": 371.7281525003033, "timesteps_total": 6679680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6679680, "timers": {"training_iteration_time_ms": 9731.301, "sample_time_ms": 9635.674, "load_time_ms": 1.515, "load_throughput": 2376750.26, "learn_time_ms": 93.226, "learn_throughput": 38615.677, "synch_weights_time_ms": 0.826}, "counters": {"num_env_steps_sampled": 6679680, "num_env_steps_trained": 6679680, "num_agent_steps_sampled": 6679680, "num_agent_steps_trained": 6679680}, "done": false, "episodes_total": 1648, "training_iteration": 811, "trial_id": "ee88a_00000", "date": "2023-07-25_05-00-58", "timestamp": 1690250458, "time_this_iter_s": 19.371922969818115, "time_total_s": 14478.546970129013, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4353.744492530823, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 23.092857142857138, "ram_util_percent": 76.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.3823002406529, "policy_loss": -186425241302.92856, "vf_loss": 45935138.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24948.5, "diff_num_grad_updates_vs_sampler_policy": 24947.5}}, "num_env_steps_sampled": 6686880, "num_env_steps_trained": 6686880, "num_agent_steps_sampled": 6686880, "num_agent_steps_trained": 6686880}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35143.038871167395, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186, -35250.82694611472, -35244.12315404159], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8978810102889642, "mean_inference_ms": 0.37090461503399214, "mean_action_processing_ms": 0.09208520184368661, "mean_env_wait_ms": 1.3174329462774643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498554229736328, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06674337387084961}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35143.038871167395, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35277.80266731658, -35067.16430239624, -35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186, -35250.82694611472, -35244.12315404159], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8978810102889642, "mean_inference_ms": 0.37090461503399214, "mean_action_processing_ms": 0.09208520184368661, "mean_env_wait_ms": 1.3174329462774643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498554229736328, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06674337387084961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6686880, "num_agent_steps_trained": 6686880, "num_env_steps_sampled": 6686880, "num_env_steps_trained": 6686880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 369.2549681862743, "num_env_steps_trained_throughput_per_sec": 369.2549681862743, "timesteps_total": 6686880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6686880, "timers": {"training_iteration_time_ms": 9747.823, "sample_time_ms": 9651.828, "load_time_ms": 1.532, "load_throughput": 2349238.323, "learn_time_ms": 93.572, "learn_throughput": 38473.029, "synch_weights_time_ms": 0.83}, "counters": {"num_env_steps_sampled": 6686880, "num_env_steps_trained": 6686880, "num_agent_steps_sampled": 6686880, "num_agent_steps_trained": 6686880}, "done": false, "episodes_total": 1650, "training_iteration": 812, "trial_id": "ee88a_00000", "date": "2023-07-25_05-01-18", "timestamp": 1690250478, "time_this_iter_s": 19.501779317855835, "time_total_s": 14498.048749446869, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4373.246271848679, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 22.355555555555558, "ram_util_percent": 76.94074074074075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.38230242048, "policy_loss": -198038448472.0, "vf_loss": 45273711.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25060.5, "diff_num_grad_updates_vs_sampler_policy": 25059.5}}, "num_env_steps_sampled": 6694080, "num_env_steps_trained": 6694080, "num_agent_steps_sampled": 6694080, "num_agent_steps_trained": 6694080}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35139.70960261483, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186, -35250.82694611472, -35244.12315404159, -35102.54461963956, -34909.49549481658], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8979019701913734, "mean_inference_ms": 0.37090827477947996, "mean_action_processing_ms": 0.0920855199060441, "mean_env_wait_ms": 1.317332985116465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034933090209960938, "StateBufferConnector_ms": 0.0026819705963134766, "ViewRequirementAgentConnector_ms": 0.06676530838012695}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35139.70960261483, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35018.40731344911, -35058.34314179974, -35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186, -35250.82694611472, -35244.12315404159, -35102.54461963956, -34909.49549481658], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8979019701913734, "mean_inference_ms": 0.37090827477947996, "mean_action_processing_ms": 0.0920855199060441, "mean_env_wait_ms": 1.317332985116465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034933090209960938, "StateBufferConnector_ms": 0.0026819705963134766, "ViewRequirementAgentConnector_ms": 0.06676530838012695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6694080, "num_agent_steps_trained": 6694080, "num_env_steps_sampled": 6694080, "num_env_steps_trained": 6694080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.8402125970952, "num_env_steps_trained_throughput_per_sec": 366.8402125970952, "timesteps_total": 6694080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6694080, "timers": {"training_iteration_time_ms": 9747.988, "sample_time_ms": 9652.116, "load_time_ms": 1.521, "load_throughput": 2367434.055, "learn_time_ms": 93.478, "learn_throughput": 38511.662, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 6694080, "num_env_steps_trained": 6694080, "num_agent_steps_sampled": 6694080, "num_agent_steps_trained": 6694080}, "done": false, "episodes_total": 1652, "training_iteration": 813, "trial_id": "ee88a_00000", "date": "2023-07-25_05-01-37", "timestamp": 1690250497, "time_this_iter_s": 19.630083084106445, "time_total_s": 14517.678832530975, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4392.876354932785, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 21.75, "ram_util_percent": 76.91071428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.37890625, "policy_loss": -195206797946.75, "vf_loss": 46142795.53571428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25172.5, "diff_num_grad_updates_vs_sampler_policy": 25171.5}}, "num_env_steps_sampled": 6701280, "num_env_steps_trained": 6701280, "num_agent_steps_sampled": 6701280, "num_agent_steps_trained": 6701280}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35141.77556800618, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186, -35250.82694611472, -35244.12315404159, -35102.54461963956, -34909.49549481658, -34941.34928782492, -35341.99770655939], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.89792273928822, "mean_inference_ms": 0.3709114368932859, "mean_action_processing_ms": 0.09208576888904572, "mean_env_wait_ms": 1.3172323320459218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495454788208008, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.06675314903259277}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35141.77556800618, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35038.971865176514, -35118.16879104124, -35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186, -35250.82694611472, -35244.12315404159, -35102.54461963956, -34909.49549481658, -34941.34928782492, -35341.99770655939], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.89792273928822, "mean_inference_ms": 0.3709114368932859, "mean_action_processing_ms": 0.09208576888904572, "mean_env_wait_ms": 1.3172323320459218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495454788208008, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.06675314903259277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6701280, "num_agent_steps_trained": 6701280, "num_env_steps_sampled": 6701280, "num_env_steps_trained": 6701280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 368.43897767887773, "num_env_steps_trained_throughput_per_sec": 368.43897767887773, "timesteps_total": 6701280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6701280, "timers": {"training_iteration_time_ms": 9754.856, "sample_time_ms": 9658.89, "load_time_ms": 1.532, "load_throughput": 2350591.466, "learn_time_ms": 93.564, "learn_throughput": 38476.235, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 6701280, "num_env_steps_trained": 6701280, "num_agent_steps_sampled": 6701280, "num_agent_steps_trained": 6701280}, "done": false, "episodes_total": 1654, "training_iteration": 814, "trial_id": "ee88a_00000", "date": "2023-07-25_05-01-57", "timestamp": 1690250517, "time_this_iter_s": 19.54503083229065, "time_total_s": 14537.223863363266, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4412.421385765076, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 21.314285714285713, "ram_util_percent": 76.80714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.09999999999999999, "policy_entropy": -941.37890625, "policy_loss": -196683240847.32144, "vf_loss": 45940152.10714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25284.5, "diff_num_grad_updates_vs_sampler_policy": 25283.5}}, "num_env_steps_sampled": 6708480, "num_env_steps_trained": 6708480, "num_agent_steps_sampled": 6708480, "num_agent_steps_trained": 6708480}, "sampler_results": {"episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35143.90869571549, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186, -35250.82694611472, -35244.12315404159, -35102.54461963956, -34909.49549481658, -34941.34928782492, -35341.99770655939, -35136.05613014156, -35234.397297006966], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8979441560961777, "mean_inference_ms": 0.3709145233676183, "mean_action_processing_ms": 0.09208601794743376, "mean_env_wait_ms": 1.3171332425842255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035047531127929688, "StateBufferConnector_ms": 0.0026862621307373047, "ViewRequirementAgentConnector_ms": 0.0668795108795166}}, "episode_reward_max": -34780.36831200036, "episode_reward_min": -35468.92122384573, "episode_reward_mean": -35143.90869571549, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35213.580927206924, -35115.54191875566, -35092.86242121363, -35020.15474938687, -35229.625097088065, -35139.23179901569, -34844.646509485254, -35046.52696577212, -35261.798532915884, -35090.429961464004, -35087.972956465885, -34920.46662547948, -35143.49186024505, -35215.24710842098, -35176.38350849253, -35379.80495687557, -35258.546862200354, -35170.900179125696, -35055.34649906607, -35127.08547753458, -35062.7077305225, -35301.58505554427, -34780.36831200036, -35041.86135273322, -35349.850152539744, -35063.25218292345, -34948.273309514785, -34990.846877628865, -35091.64872391889, -35107.000485424374, -35214.28877425612, -34927.358857154126, -35104.070840751294, -35115.89635780729, -35114.46656429708, -35092.327072363136, -35212.31220960415, -35094.59989903734, -35193.6779991498, -35287.15037687312, -35059.51788419403, -35137.729069893336, -35374.32527230849, -35254.996545695954, -35150.732656638495, -35387.98646990847, -35124.77915310068, -35140.9899510679, -35179.90016998334, -35193.04814843798, -35066.372757168625, -35468.92122384573, -35245.903775198756, -35164.52589245382, -35223.92129635142, -35176.59899785031, -35162.86271058066, -35348.37753570233, -35174.13570961702, -35150.16468961282, -35105.020898985065, -35226.04524787867, -35186.166113573025, -35218.144706205, -34924.06297833146, -35221.596724981144, -35293.24256542477, -35121.49148266306, -35057.332736411525, -35260.650106487665, -35152.67035423868, -35222.61162678141, -35089.52730909875, -35066.072388460845, -34903.54282938486, -34847.80374352668, -34925.367868416746, -35067.44013506187, -35114.33012884215, -35083.772562255865, -35367.6444354696, -35187.18996261564, -35224.93558811719, -35327.088905502875, -35136.031345272335, -35120.0300894673, -35126.02189475086, -35133.919460947574, -34920.62568016598, -35180.06734856754, -35237.64254711135, -35313.01121054186, -35250.82694611472, -35244.12315404159, -35102.54461963956, -34909.49549481658, -34941.34928782492, -35341.99770655939, -35136.05613014156, -35234.397297006966], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8979441560961777, "mean_inference_ms": 0.3709145233676183, "mean_action_processing_ms": 0.09208601794743376, "mean_env_wait_ms": 1.3171332425842255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035047531127929688, "StateBufferConnector_ms": 0.0026862621307373047, "ViewRequirementAgentConnector_ms": 0.0668795108795166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6708480, "num_agent_steps_trained": 6708480, "num_env_steps_sampled": 6708480, "num_env_steps_trained": 6708480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 366.2876570268333, "num_env_steps_trained_throughput_per_sec": 366.2876570268333, "timesteps_total": 6708480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 6708480, "timers": {"training_iteration_time_ms": 9769.322, "sample_time_ms": 9673.5, "load_time_ms": 1.517, "load_throughput": 2373014.993, "learn_time_ms": 93.432, "learn_throughput": 38530.746, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 6708480, "num_env_steps_trained": 6708480, "num_agent_steps_sampled": 6708480, "num_agent_steps_trained": 6708480}, "done": true, "episodes_total": 1656, "training_iteration": 815, "trial_id": "ee88a_00000", "date": "2023-07-25_05-02-17", "timestamp": 1690250537, "time_this_iter_s": 19.659607887268066, "time_total_s": 14556.883471250534, "pid": 57459, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5080000, 0.0001], [5134000, 8.5e-05], [5188000, 7.5e-05], [5242000, 5e-05], [5296000, 2.5e-05], [5350000, 1e-05], [5404000, 7.5e-06], [5458000, 5e-06], [5512000, 2.5e-06], [5566000, 1e-06], [5620000, 7.5e-07], [5674000, 5e-07], [5728000, 2.5e-07], [5782000, 1e-07], [5836000, 5e-08], [5890000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306731550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4432.080993652344, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 23.660714285714285, "ram_util_percent": 76.91428571428571}}
