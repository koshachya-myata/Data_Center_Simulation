{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0026, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.9858805338542, "policy_loss": -1.8778270579207088e+20, "vf_loss": 2468578794.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 136080, "num_env_steps_trained": 136080, "num_agent_steps_sampled": 136080, "num_agent_steps_trained": 136080}, "sampler_results": {"episode_reward_max": -29734.78099841184, "episode_reward_min": -29969.978027820274, "episode_reward_mean": -29854.5819197997, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.435601456143805, "mean_inference_ms": 0.25465734959641406, "mean_action_processing_ms": 0.059815432610071675, "mean_env_wait_ms": 2.7225444417790685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023305416107177734, "StateBufferConnector_ms": 0.0016689300537109375, "ViewRequirementAgentConnector_ms": 0.04576444625854492}}, "episode_reward_max": -29734.78099841184, "episode_reward_min": -29969.978027820274, "episode_reward_mean": -29854.5819197997, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.435601456143805, "mean_inference_ms": 0.25465734959641406, "mean_action_processing_ms": 0.059815432610071675, "mean_env_wait_ms": 2.7225444417790685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023305416107177734, "StateBufferConnector_ms": 0.0016689300537109375, "ViewRequirementAgentConnector_ms": 0.04576444625854492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136080, "num_agent_steps_trained": 136080, "num_env_steps_sampled": 136080, "num_env_steps_trained": 136080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 132.8484501675596, "num_env_steps_trained_throughput_per_sec": 132.8484501675596, "timesteps_total": 136080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 136080, "timers": {"training_iteration_time_ms": 2709.844, "sample_time_ms": 2699.283, "load_time_ms": 0.285, "load_throughput": 1264084.923, "learn_time_ms": 9.684, "learn_throughput": 37174.163, "synch_weights_time_ms": 0.56}, "counters": {"num_env_steps_sampled": 136080, "num_env_steps_trained": 136080, "num_agent_steps_sampled": 136080, "num_agent_steps_trained": 136080}, "done": false, "episodes_total": 378, "training_iteration": 76, "trial_id": "a960d_00000", "date": "2023-07-25_16-03-49", "timestamp": 1690290229, "time_this_iter_s": 10.84126901626587, "time_total_s": 850.7205209732056, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.84126901626587, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.687500000000004, "ram_util_percent": 80.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0019333333333333331, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1860.0818277994792, "policy_loss": -4.4321977310482924e+18, "vf_loss": 2510750613.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 137880, "num_env_steps_trained": 137880, "num_agent_steps_sampled": 137880, "num_agent_steps_trained": 137880}, "sampler_results": {"episode_reward_max": -29734.78099841184, "episode_reward_min": -30093.034165901066, "episode_reward_mean": -29906.053603358974, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.433542964654965, "mean_inference_ms": 0.2526693587716897, "mean_action_processing_ms": 0.059563870935443575, "mean_env_wait_ms": 2.3298982353318043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025510787963867188, "StateBufferConnector_ms": 0.0016371409098307292, "ViewRequirementAgentConnector_ms": 0.04516707526312934}}, "episode_reward_max": -29734.78099841184, "episode_reward_min": -30093.034165901066, "episode_reward_mean": -29906.053603358974, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.433542964654965, "mean_inference_ms": 0.2526693587716897, "mean_action_processing_ms": 0.059563870935443575, "mean_env_wait_ms": 2.3298982353318043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025510787963867188, "StateBufferConnector_ms": 0.0016371409098307292, "ViewRequirementAgentConnector_ms": 0.04516707526312934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137880, "num_agent_steps_trained": 137880, "num_env_steps_sampled": 137880, "num_env_steps_trained": 137880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.76086427423493, "num_env_steps_trained_throughput_per_sec": 160.76086427423493, "timesteps_total": 137880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 137880, "timers": {"training_iteration_time_ms": 2448.454, "sample_time_ms": 2440.859, "load_time_ms": 0.238, "load_throughput": 1515506.296, "learn_time_ms": 6.802, "learn_throughput": 52924.765, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 137880, "num_env_steps_trained": 137880, "num_agent_steps_sampled": 137880, "num_agent_steps_trained": 137880}, "done": false, "episodes_total": 383, "training_iteration": 77, "trial_id": "a960d_00000", "date": "2023-07-25_16-04-00", "timestamp": 1690290240, "time_this_iter_s": 11.198605060577393, "time_total_s": 861.919126033783, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.03987407684326, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.33125, "ram_util_percent": 79.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0012666666666666666, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1860.1082356770833, "policy_loss": -2.8877855303301857e+18, "vf_loss": 2450771626.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 139680, "num_env_steps_trained": 139680, "num_agent_steps_sampled": 139680, "num_agent_steps_trained": 139680}, "sampler_results": {"episode_reward_max": -29634.566773788214, "episode_reward_min": -30093.034165901066, "episode_reward_mean": -29888.250463446417, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.429016669300856, "mean_inference_ms": 0.25226811789279524, "mean_action_processing_ms": 0.059490074164670524, "mean_env_wait_ms": 2.1480187537178437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002663476126534598, "StateBufferConnector_ms": 0.001685959952218192, "ViewRequirementAgentConnector_ms": 0.04585811070033482}}, "episode_reward_max": -29634.566773788214, "episode_reward_min": -30093.034165901066, "episode_reward_mean": -29888.250463446417, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.429016669300856, "mean_inference_ms": 0.25226811789279524, "mean_action_processing_ms": 0.059490074164670524, "mean_env_wait_ms": 2.1480187537178437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002663476126534598, "StateBufferConnector_ms": 0.001685959952218192, "ViewRequirementAgentConnector_ms": 0.04585811070033482}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139680, "num_agent_steps_trained": 139680, "num_env_steps_sampled": 139680, "num_env_steps_trained": 139680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.8587580001148, "num_env_steps_trained_throughput_per_sec": 160.8587580001148, "timesteps_total": 139680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 139680, "timers": {"training_iteration_time_ms": 2238.661, "sample_time_ms": 2233.42, "load_time_ms": 0.209, "load_throughput": 1721132.383, "learn_time_ms": 4.496, "learn_throughput": 80065.191, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 139680, "num_env_steps_trained": 139680, "num_agent_steps_sampled": 139680, "num_agent_steps_trained": 139680}, "done": false, "episodes_total": 388, "training_iteration": 78, "trial_id": "a960d_00000", "date": "2023-07-25_16-04-11", "timestamp": 1690290251, "time_this_iter_s": 11.191851139068604, "time_total_s": 873.1109771728516, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.231725215911865, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.35, "ram_util_percent": 79.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00095, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1860.117919921875, "policy_loss": -7.32226760256471e+18, "vf_loss": 2535903957.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 141480, "num_env_steps_trained": 141480, "num_agent_steps_sampled": 141480, "num_agent_steps_trained": 141480}, "sampler_results": {"episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29906.771536704735, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426377671977343, "mean_inference_ms": 0.2517095958550454, "mean_action_processing_ms": 0.05940064726161735, "mean_env_wait_ms": 2.0346350626739036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00251845309608861, "StateBufferConnector_ms": 0.0016814783999794408, "ViewRequirementAgentConnector_ms": 0.04545387468839947}}, "episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29906.771536704735, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426377671977343, "mean_inference_ms": 0.2517095958550454, "mean_action_processing_ms": 0.05940064726161735, "mean_env_wait_ms": 2.0346350626739036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00251845309608861, "StateBufferConnector_ms": 0.0016814783999794408, "ViewRequirementAgentConnector_ms": 0.04545387468839947}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141480, "num_agent_steps_trained": 141480, "num_env_steps_sampled": 141480, "num_env_steps_trained": 141480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.80506949899743, "num_env_steps_trained_throughput_per_sec": 161.80506949899743, "timesteps_total": 141480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 141480, "timers": {"training_iteration_time_ms": 2231.435, "sample_time_ms": 2226.173, "load_time_ms": 0.217, "load_throughput": 1658738.262, "learn_time_ms": 4.495, "learn_throughput": 80096.62, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 141480, "num_env_steps_trained": 141480, "num_agent_steps_sampled": 141480, "num_agent_steps_trained": 141480}, "done": false, "episodes_total": 393, "training_iteration": 79, "trial_id": "a960d_00000", "date": "2023-07-25_16-04-22", "timestamp": 1690290262, "time_this_iter_s": 11.126375198364258, "time_total_s": 884.2373523712158, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 44.35810041427612, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.700000000000003, "ram_util_percent": 79.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0008666666666666666, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1860.1243896484375, "policy_loss": -1.9910797624896827e+18, "vf_loss": 2474569898.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 143280, "num_env_steps_trained": 143280, "num_agent_steps_sampled": 143280, "num_agent_steps_trained": 143280}, "sampler_results": {"episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29900.004742214864, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424777274375779, "mean_inference_ms": 0.25142658090586384, "mean_action_processing_ms": 0.05936609734171605, "mean_env_wait_ms": 1.9574402725749456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002559026082356771, "StateBufferConnector_ms": 0.0016748905181884766, "ViewRequirementAgentConnector_ms": 0.04535516103108724}}, "episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29900.004742214864, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424777274375779, "mean_inference_ms": 0.25142658090586384, "mean_action_processing_ms": 0.05936609734171605, "mean_env_wait_ms": 1.9574402725749456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002559026082356771, "StateBufferConnector_ms": 0.0016748905181884766, "ViewRequirementAgentConnector_ms": 0.04535516103108724}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143280, "num_agent_steps_trained": 143280, "num_env_steps_sampled": 143280, "num_env_steps_trained": 143280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.42101323009834, "num_env_steps_trained_throughput_per_sec": 160.42101323009834, "timesteps_total": 143280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 143280, "timers": {"training_iteration_time_ms": 2234.488, "sample_time_ms": 2229.167, "load_time_ms": 0.219, "load_throughput": 1646618.8, "learn_time_ms": 4.554, "learn_throughput": 79058.256, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 143280, "num_env_steps_trained": 143280, "num_agent_steps_sampled": 143280, "num_agent_steps_trained": 143280}, "done": false, "episodes_total": 398, "training_iteration": 80, "trial_id": "a960d_00000", "date": "2023-07-25_16-04-34", "timestamp": 1690290274, "time_this_iter_s": 11.222293138504028, "time_total_s": 895.4596455097198, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 55.58039355278015, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.475, "ram_util_percent": 79.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007833333333333334, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1860.1309814453125, "policy_loss": -1.1340637638459535e+19, "vf_loss": 2485090218.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 145080, "num_env_steps_trained": 145080, "num_agent_steps_sampled": 145080, "num_agent_steps_trained": 145080}, "sampler_results": {"episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29891.955198071388, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425951706015545, "mean_inference_ms": 0.2514050890457674, "mean_action_processing_ms": 0.05937887950991676, "mean_env_wait_ms": 1.9009333686896885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026086281085836477, "StateBufferConnector_ms": 0.0016952383107152478, "ViewRequirementAgentConnector_ms": 0.04536201213968211}}, "episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29891.955198071388, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425951706015545, "mean_inference_ms": 0.2514050890457674, "mean_action_processing_ms": 0.05937887950991676, "mean_env_wait_ms": 1.9009333686896885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026086281085836477, "StateBufferConnector_ms": 0.0016952383107152478, "ViewRequirementAgentConnector_ms": 0.04536201213968211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145080, "num_agent_steps_trained": 145080, "num_env_steps_sampled": 145080, "num_env_steps_trained": 145080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.43986200034527, "num_env_steps_trained_throughput_per_sec": 158.43986200034527, "timesteps_total": 145080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 145080, "timers": {"training_iteration_time_ms": 2258.115, "sample_time_ms": 2252.739, "load_time_ms": 0.223, "load_throughput": 1616648.223, "learn_time_ms": 4.597, "learn_throughput": 78312.818, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 145080, "num_env_steps_trained": 145080, "num_agent_steps_sampled": 145080, "num_agent_steps_trained": 145080}, "done": false, "episodes_total": 403, "training_iteration": 81, "trial_id": "a960d_00000", "date": "2023-07-25_16-04-45", "timestamp": 1690290285, "time_this_iter_s": 11.36390495300293, "time_total_s": 906.8235504627228, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 66.94429850578308, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.0375, "ram_util_percent": 79.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1860.305419921875, "policy_loss": -1.9178228601718484e+18, "vf_loss": 2496387093.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 146880, "num_env_steps_trained": 146880, "num_agent_steps_sampled": 146880, "num_agent_steps_trained": 146880}, "sampler_results": {"episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29888.777863637424, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425437345786863, "mean_inference_ms": 0.25136350105802846, "mean_action_processing_ms": 0.05938289335074125, "mean_env_wait_ms": 1.857661309539545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025608960319967833, "StateBufferConnector_ms": 0.0017032903783461627, "ViewRequirementAgentConnector_ms": 0.04528199925142176}}, "episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29888.777863637424, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425437345786863, "mean_inference_ms": 0.25136350105802846, "mean_action_processing_ms": 0.05938289335074125, "mean_env_wait_ms": 1.857661309539545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025608960319967833, "StateBufferConnector_ms": 0.0017032903783461627, "ViewRequirementAgentConnector_ms": 0.04528199925142176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146880, "num_agent_steps_trained": 146880, "num_env_steps_sampled": 146880, "num_env_steps_trained": 146880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.64613431522125, "num_env_steps_trained_throughput_per_sec": 161.64613431522125, "timesteps_total": 146880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 146880, "timers": {"training_iteration_time_ms": 2249.61, "sample_time_ms": 2244.308, "load_time_ms": 0.219, "load_throughput": 1641071.014, "learn_time_ms": 4.53, "learn_throughput": 79466.422, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 146880, "num_env_steps_trained": 146880, "num_agent_steps_sampled": 146880, "num_agent_steps_trained": 146880}, "done": false, "episodes_total": 408, "training_iteration": 82, "trial_id": "a960d_00000", "date": "2023-07-25_16-04-56", "timestamp": 1690290296, "time_this_iter_s": 11.137304782867432, "time_total_s": 917.9608552455902, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 78.08160328865051, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.19375, "ram_util_percent": 79.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0006166666666666666, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1863.7841389973958, "policy_loss": -1.1785103531702682e+18, "vf_loss": 2499528533.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 116.0, "diff_num_grad_updates_vs_sampler_policy": 115.0}}, "num_env_steps_sampled": 148680, "num_env_steps_trained": 148680, "num_agent_steps_sampled": 148680, "num_agent_steps_trained": 148680}, "sampler_results": {"episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29885.971701065937, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42474428994982, "mean_inference_ms": 0.251303680300002, "mean_action_processing_ms": 0.05938091762999663, "mean_env_wait_ms": 1.8229862830778154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025052290696364185, "StateBufferConnector_ms": 0.0016799339881310095, "ViewRequirementAgentConnector_ms": 0.04508006267058544}}, "episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29885.971701065937, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42474428994982, "mean_inference_ms": 0.251303680300002, "mean_action_processing_ms": 0.05938091762999663, "mean_env_wait_ms": 1.8229862830778154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025052290696364185, "StateBufferConnector_ms": 0.0016799339881310095, "ViewRequirementAgentConnector_ms": 0.04508006267058544}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148680, "num_agent_steps_trained": 148680, "num_env_steps_sampled": 148680, "num_env_steps_trained": 148680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.26669726920414, "num_env_steps_trained_throughput_per_sec": 161.26669726920414, "timesteps_total": 148680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 148680, "timers": {"training_iteration_time_ms": 2229.697, "sample_time_ms": 2224.474, "load_time_ms": 0.215, "load_throughput": 1671592.428, "learn_time_ms": 4.485, "learn_throughput": 80269.92, "synch_weights_time_ms": 0.491}, "counters": {"num_env_steps_sampled": 148680, "num_env_steps_trained": 148680, "num_agent_steps_sampled": 148680, "num_agent_steps_trained": 148680}, "done": false, "episodes_total": 413, "training_iteration": 83, "trial_id": "a960d_00000", "date": "2023-07-25_16-05-07", "timestamp": 1690290307, "time_this_iter_s": 11.163960933685303, "time_total_s": 929.1248161792755, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 89.24556422233582, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.066666666666666, "ram_util_percent": 79.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0005333333333333334, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1864.8927001953125, "policy_loss": -5.83238402538384e+17, "vf_loss": 2457549184.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 150480, "num_env_steps_trained": 150480, "num_agent_steps_sampled": 150480, "num_agent_steps_trained": 150480}, "sampler_results": {"episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29882.6034604177, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424794946109466, "mean_inference_ms": 0.2512404715139756, "mean_action_processing_ms": 0.05937859994141203, "mean_env_wait_ms": 1.794694097153975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026226043701171875, "StateBufferConnector_ms": 0.0016813928430730646, "ViewRequirementAgentConnector_ms": 0.04526322538202459}}, "episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29882.6034604177, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424794946109466, "mean_inference_ms": 0.2512404715139756, "mean_action_processing_ms": 0.05937859994141203, "mean_env_wait_ms": 1.794694097153975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026226043701171875, "StateBufferConnector_ms": 0.0016813928430730646, "ViewRequirementAgentConnector_ms": 0.04526322538202459}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150480, "num_agent_steps_trained": 150480, "num_env_steps_sampled": 150480, "num_env_steps_trained": 150480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.23072323645277, "num_env_steps_trained_throughput_per_sec": 159.23072323645277, "timesteps_total": 150480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 150480, "timers": {"training_iteration_time_ms": 2246.589, "sample_time_ms": 2241.31, "load_time_ms": 0.216, "load_throughput": 1664589.836, "learn_time_ms": 4.535, "learn_throughput": 79374.938, "synch_weights_time_ms": 0.497}, "counters": {"num_env_steps_sampled": 150480, "num_env_steps_trained": 150480, "num_agent_steps_sampled": 150480, "num_agent_steps_trained": 150480}, "done": false, "episodes_total": 418, "training_iteration": 84, "trial_id": "a960d_00000", "date": "2023-07-25_16-05-19", "timestamp": 1690290319, "time_this_iter_s": 11.306199073791504, "time_total_s": 940.431015253067, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 100.55176329612732, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.88235294117647, "ram_util_percent": 79.79411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00045000000000000004, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1865.3462727864583, "policy_loss": -1.2028641171535299e+18, "vf_loss": 2493829205.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 146.0, "diff_num_grad_updates_vs_sampler_policy": 145.0}}, "num_env_steps_sampled": 152280, "num_env_steps_trained": 152280, "num_agent_steps_sampled": 152280, "num_agent_steps_trained": 152280}, "sampler_results": {"episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29888.74118437643, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424538455962872, "mean_inference_ms": 0.2512477202113985, "mean_action_processing_ms": 0.05938409069025976, "mean_env_wait_ms": 1.7709187697271132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026308760351064255, "StateBufferConnector_ms": 0.0016835271095742984, "ViewRequirementAgentConnector_ms": 0.04529758375518176}}, "episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29888.74118437643, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424538455962872, "mean_inference_ms": 0.2512477202113985, "mean_action_processing_ms": 0.05938409069025976, "mean_env_wait_ms": 1.7709187697271132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026308760351064255, "StateBufferConnector_ms": 0.0016835271095742984, "ViewRequirementAgentConnector_ms": 0.04529758375518176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152280, "num_agent_steps_trained": 152280, "num_env_steps_sampled": 152280, "num_env_steps_trained": 152280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.26990438980485, "num_env_steps_trained_throughput_per_sec": 161.26990438980485, "timesteps_total": 152280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 152280, "timers": {"training_iteration_time_ms": 2246.567, "sample_time_ms": 2241.287, "load_time_ms": 0.216, "load_throughput": 1663856.132, "learn_time_ms": 4.527, "learn_throughput": 79519.572, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 152280, "num_env_steps_trained": 152280, "num_agent_steps_sampled": 152280, "num_agent_steps_trained": 152280}, "done": false, "episodes_total": 423, "training_iteration": 85, "trial_id": "a960d_00000", "date": "2023-07-25_16-05-30", "timestamp": 1690290330, "time_this_iter_s": 11.163294315338135, "time_total_s": 951.5943095684052, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 111.71505761146545, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.48666666666666, "ram_util_percent": 79.41333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00036666666666666667, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1867.3201904296875, "policy_loss": -7.724336292721678e+17, "vf_loss": 2475630485.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 161.0, "diff_num_grad_updates_vs_sampler_policy": 160.0}}, "num_env_steps_sampled": 154080, "num_env_steps_trained": 154080, "num_agent_steps_sampled": 154080, "num_agent_steps_trained": 154080}, "sampler_results": {"episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29887.91903773821, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424407596037797, "mean_inference_ms": 0.2512773189350522, "mean_action_processing_ms": 0.05939205903232808, "mean_env_wait_ms": 1.7506646113892173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026022946393048324, "StateBufferConnector_ms": 0.0017033682929144965, "ViewRequirementAgentConnector_ms": 0.045340149490921584}}, "episode_reward_max": -29634.566773788214, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29887.91903773821, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424407596037797, "mean_inference_ms": 0.2512773189350522, "mean_action_processing_ms": 0.05939205903232808, "mean_env_wait_ms": 1.7506646113892173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026022946393048324, "StateBufferConnector_ms": 0.0017033682929144965, "ViewRequirementAgentConnector_ms": 0.045340149490921584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154080, "num_agent_steps_trained": 154080, "num_env_steps_sampled": 154080, "num_env_steps_trained": 154080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.2901437920797, "num_env_steps_trained_throughput_per_sec": 160.2901437920797, "timesteps_total": 154080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 154080, "timers": {"training_iteration_time_ms": 2239.096, "sample_time_ms": 2233.845, "load_time_ms": 0.215, "load_throughput": 1676603.864, "learn_time_ms": 4.491, "learn_throughput": 80167.212, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 154080, "num_env_steps_trained": 154080, "num_agent_steps_sampled": 154080, "num_agent_steps_trained": 154080}, "done": false, "episodes_total": 428, "training_iteration": 86, "trial_id": "a960d_00000", "date": "2023-07-25_16-05-41", "timestamp": 1690290341, "time_this_iter_s": 11.231974124908447, "time_total_s": 962.8262836933136, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 122.9470317363739, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.69375, "ram_util_percent": 79.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00028333333333333335, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1868.8689778645833, "policy_loss": -2.5949286897672876e+16, "vf_loss": 2523615701.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 175.0}}, "num_env_steps_sampled": 155880, "num_env_steps_trained": 155880, "num_agent_steps_sampled": 155880, "num_agent_steps_trained": 155880}, "sampler_results": {"episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29882.08364674595, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424199170471534, "mean_inference_ms": 0.2513229370976883, "mean_action_processing_ms": 0.05940067667300727, "mean_env_wait_ms": 1.733388923857709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025773452500165517, "StateBufferConnector_ms": 0.0017125727766651219, "ViewRequirementAgentConnector_ms": 0.04537307609946041}}, "episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29882.08364674595, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424199170471534, "mean_inference_ms": 0.2513229370976883, "mean_action_processing_ms": 0.05940067667300727, "mean_env_wait_ms": 1.733388923857709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025773452500165517, "StateBufferConnector_ms": 0.0017125727766651219, "ViewRequirementAgentConnector_ms": 0.04537307609946041}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155880, "num_agent_steps_trained": 155880, "num_env_steps_sampled": 155880, "num_env_steps_trained": 155880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.94253231275707, "num_env_steps_trained_throughput_per_sec": 159.94253231275707, "timesteps_total": 155880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 155880, "timers": {"training_iteration_time_ms": 2248.357, "sample_time_ms": 2242.658, "load_time_ms": 0.242, "load_throughput": 1490130.702, "learn_time_ms": 4.826, "learn_throughput": 74588.241, "synch_weights_time_ms": 0.596}, "counters": {"num_env_steps_sampled": 155880, "num_env_steps_trained": 155880, "num_agent_steps_sampled": 155880, "num_agent_steps_trained": 155880}, "done": false, "episodes_total": 433, "training_iteration": 87, "trial_id": "a960d_00000", "date": "2023-07-25_16-05-52", "timestamp": 1690290352, "time_this_iter_s": 11.256183862686157, "time_total_s": 974.0824675559998, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 134.20321559906006, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 26.049999999999997, "ram_util_percent": 79.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00022, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1869.4171956380208, "policy_loss": -1.2741541993540608e+18, "vf_loss": 2470720618.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 157680, "num_env_steps_trained": 157680, "num_agent_steps_sampled": 157680, "num_agent_steps_trained": 157680}, "sampler_results": {"episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29880.003179392435, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4239621912811575, "mean_inference_ms": 0.2513449147703509, "mean_action_processing_ms": 0.059404369201018145, "mean_env_wait_ms": 1.7183470776258665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025872141122817993, "StateBufferConnector_ms": 0.0017177313566207886, "ViewRequirementAgentConnector_ms": 0.04538893699645996}}, "episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29880.003179392435, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4239621912811575, "mean_inference_ms": 0.2513449147703509, "mean_action_processing_ms": 0.059404369201018145, "mean_env_wait_ms": 1.7183470776258665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025872141122817993, "StateBufferConnector_ms": 0.0017177313566207886, "ViewRequirementAgentConnector_ms": 0.04538893699645996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157680, "num_agent_steps_trained": 157680, "num_env_steps_sampled": 157680, "num_env_steps_trained": 157680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.61931776841024, "num_env_steps_trained_throughput_per_sec": 160.61931776841024, "timesteps_total": 157680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 157680, "timers": {"training_iteration_time_ms": 2246.056, "sample_time_ms": 2240.3, "load_time_ms": 0.246, "load_throughput": 1463838.526, "learn_time_ms": 4.872, "learn_throughput": 73886.741, "synch_weights_time_ms": 0.601}, "counters": {"num_env_steps_sampled": 157680, "num_env_steps_trained": 157680, "num_agent_steps_sampled": 157680, "num_agent_steps_trained": 157680}, "done": false, "episodes_total": 438, "training_iteration": 88, "trial_id": "a960d_00000", "date": "2023-07-25_16-06-04", "timestamp": 1690290364, "time_this_iter_s": 11.208647012710571, "time_total_s": 985.2911145687103, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 145.41186261177063, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.450000000000003, "ram_util_percent": 79.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00017, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1869.5091145833333, "policy_loss": -2.5840385550555546e+17, "vf_loss": 2542839360.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 206.0, "diff_num_grad_updates_vs_sampler_policy": 205.0}}, "num_env_steps_sampled": 159480, "num_env_steps_trained": 159480, "num_agent_steps_sampled": 159480, "num_agent_steps_trained": 159480}, "sampler_results": {"episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29888.46804372634, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4237479259173735, "mean_inference_ms": 0.25136460898370533, "mean_action_processing_ms": 0.05940836539422256, "mean_env_wait_ms": 1.7049725894412637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026056731956592503, "StateBufferConnector_ms": 0.0017214512479478035, "ViewRequirementAgentConnector_ms": 0.04537692968396173}}, "episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29888.46804372634, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4237479259173735, "mean_inference_ms": 0.25136460898370533, "mean_action_processing_ms": 0.05940836539422256, "mean_env_wait_ms": 1.7049725894412637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026056731956592503, "StateBufferConnector_ms": 0.0017214512479478035, "ViewRequirementAgentConnector_ms": 0.04537692968396173}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159480, "num_agent_steps_trained": 159480, "num_env_steps_sampled": 159480, "num_env_steps_trained": 159480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.07298768672052, "num_env_steps_trained_throughput_per_sec": 161.07298768672052, "timesteps_total": 159480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 159480, "timers": {"training_iteration_time_ms": 2238.158, "sample_time_ms": 2232.814, "load_time_ms": 0.221, "load_throughput": 1626574.857, "learn_time_ms": 4.558, "learn_throughput": 78978.447, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 159480, "num_env_steps_trained": 159480, "num_agent_steps_sampled": 159480, "num_agent_steps_trained": 159480}, "done": false, "episodes_total": 443, "training_iteration": 89, "trial_id": "a960d_00000", "date": "2023-07-25_16-06-15", "timestamp": 1690290375, "time_this_iter_s": 11.177079916000366, "time_total_s": 996.4681944847107, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 156.588942527771, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.74375, "ram_util_percent": 79.45625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00011999999999999999, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1869.5230305989583, "policy_loss": -1.1604222669890082e+17, "vf_loss": 2472962112.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 220.0}}, "num_env_steps_sampled": 161280, "num_env_steps_trained": 161280, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 161280}, "sampler_results": {"episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29891.409493480223, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423497151365082, "mean_inference_ms": 0.2513654390674271, "mean_action_processing_ms": 0.05940847988912396, "mean_env_wait_ms": 1.6929791944941999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025762094033730996, "StateBufferConnector_ms": 0.0017237018894504857, "ViewRequirementAgentConnector_ms": 0.045283420665844065}}, "episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29891.409493480223, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423497151365082, "mean_inference_ms": 0.2513654390674271, "mean_action_processing_ms": 0.05940847988912396, "mean_env_wait_ms": 1.6929791944941999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025762094033730996, "StateBufferConnector_ms": 0.0017237018894504857, "ViewRequirementAgentConnector_ms": 0.045283420665844065}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 161280, "num_env_steps_sampled": 161280, "num_env_steps_trained": 161280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.5680717103773, "num_env_steps_trained_throughput_per_sec": 161.5680717103773, "timesteps_total": 161280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 161280, "timers": {"training_iteration_time_ms": 2231.577, "sample_time_ms": 2226.183, "load_time_ms": 0.221, "load_throughput": 1632201.319, "learn_time_ms": 4.622, "learn_throughput": 77885.44, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 161280, "num_env_steps_trained": 161280, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 161280}, "done": false, "episodes_total": 448, "training_iteration": 90, "trial_id": "a960d_00000", "date": "2023-07-25_16-06-26", "timestamp": 1690290386, "time_this_iter_s": 11.14281702041626, "time_total_s": 1007.611011505127, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 167.73175954818726, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.9125, "ram_util_percent": 79.38125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.499999999999999e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1869.946044921875, "policy_loss": -6.904308561527876e+16, "vf_loss": 2484658432.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 236.0, "diff_num_grad_updates_vs_sampler_policy": 235.0}}, "num_env_steps_sampled": 163080, "num_env_steps_trained": 163080, "num_agent_steps_sampled": 163080, "num_agent_steps_trained": 163080}, "sampler_results": {"episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29892.370903371244, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423295459853105, "mean_inference_ms": 0.25136329902748417, "mean_action_processing_ms": 0.059407553814626, "mean_env_wait_ms": 1.6822445350571804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025459482700009887, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.045175492009030115}}, "episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29892.370903371244, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423295459853105, "mean_inference_ms": 0.25136329902748417, "mean_action_processing_ms": 0.059407553814626, "mean_env_wait_ms": 1.6822445350571804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025459482700009887, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.045175492009030115}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163080, "num_agent_steps_trained": 163080, "num_env_steps_sampled": 163080, "num_env_steps_trained": 163080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.4350003881382, "num_env_steps_trained_throughput_per_sec": 160.4350003881382, "timesteps_total": 163080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 163080, "timers": {"training_iteration_time_ms": 2236.021, "sample_time_ms": 2230.559, "load_time_ms": 0.221, "load_throughput": 1626925.374, "learn_time_ms": 4.676, "learn_throughput": 76982.856, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 163080, "num_env_steps_trained": 163080, "num_agent_steps_sampled": 163080, "num_agent_steps_trained": 163080}, "done": false, "episodes_total": 453, "training_iteration": 91, "trial_id": "a960d_00000", "date": "2023-07-25_16-06-37", "timestamp": 1690290397, "time_this_iter_s": 11.221618890762329, "time_total_s": 1018.8326303958893, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 178.95337843894958, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 27.587500000000002, "ram_util_percent": 79.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666668e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1870.0511474609375, "policy_loss": -2.408744898002944e+17, "vf_loss": 2493793365.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 250.0}}, "num_env_steps_sampled": 164880, "num_env_steps_trained": 164880, "num_agent_steps_sampled": 164880, "num_agent_steps_trained": 164880}, "sampler_results": {"episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29894.234191219897, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423065083345318, "mean_inference_ms": 0.25134939624545055, "mean_action_processing_ms": 0.05940483385465572, "mean_env_wait_ms": 1.672517160707646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025510787963867188, "StateBufferConnector_ms": 0.001714626948038737, "ViewRequirementAgentConnector_ms": 0.0451527890704927}}, "episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29894.234191219897, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423065083345318, "mean_inference_ms": 0.25134939624545055, "mean_action_processing_ms": 0.05940483385465572, "mean_env_wait_ms": 1.672517160707646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025510787963867188, "StateBufferConnector_ms": 0.001714626948038737, "ViewRequirementAgentConnector_ms": 0.0451527890704927}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164880, "num_agent_steps_trained": 164880, "num_env_steps_sampled": 164880, "num_env_steps_trained": 164880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.39935661710672, "num_env_steps_trained_throughput_per_sec": 161.39935661710672, "timesteps_total": 164880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 164880, "timers": {"training_iteration_time_ms": 2237.186, "sample_time_ms": 2231.713, "load_time_ms": 0.223, "load_throughput": 1612504.742, "learn_time_ms": 4.662, "learn_throughput": 77227.76, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 164880, "num_env_steps_trained": 164880, "num_agent_steps_sampled": 164880, "num_agent_steps_trained": 164880}, "done": false, "episodes_total": 458, "training_iteration": 92, "trial_id": "a960d_00000", "date": "2023-07-25_16-06-48", "timestamp": 1690290408, "time_this_iter_s": 11.154513835906982, "time_total_s": 1029.9871442317963, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 190.10789227485657, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.00625, "ram_util_percent": 79.38125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.833333333333333e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1870.3744303385417, "policy_loss": -9517413467323050.0, "vf_loss": 2503743957.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 266.0, "diff_num_grad_updates_vs_sampler_policy": 265.0}}, "num_env_steps_sampled": 166680, "num_env_steps_trained": 166680, "num_agent_steps_sampled": 166680, "num_agent_steps_trained": 166680}, "sampler_results": {"episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29896.707499067947, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422812129916608, "mean_inference_ms": 0.251325460502793, "mean_action_processing_ms": 0.059400399128151087, "mean_env_wait_ms": 1.6636563876419272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002560722693968355, "StateBufferConnector_ms": 0.0017233109206296086, "ViewRequirementAgentConnector_ms": 0.045322300343031294}}, "episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29896.707499067947, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422812129916608, "mean_inference_ms": 0.251325460502793, "mean_action_processing_ms": 0.059400399128151087, "mean_env_wait_ms": 1.6636563876419272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002560722693968355, "StateBufferConnector_ms": 0.0017233109206296086, "ViewRequirementAgentConnector_ms": 0.045322300343031294}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166680, "num_agent_steps_trained": 166680, "num_env_steps_sampled": 166680, "num_env_steps_trained": 166680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.49754954022995, "num_env_steps_trained_throughput_per_sec": 161.49754954022995, "timesteps_total": 166680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 166680, "timers": {"training_iteration_time_ms": 2229.804, "sample_time_ms": 2224.385, "load_time_ms": 0.221, "load_throughput": 1631319.62, "learn_time_ms": 4.638, "learn_throughput": 77625.976, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 166680, "num_env_steps_trained": 166680, "num_agent_steps_sampled": 166680, "num_agent_steps_trained": 166680}, "done": false, "episodes_total": 463, "training_iteration": 93, "trial_id": "a960d_00000", "date": "2023-07-25_16-07-00", "timestamp": 1690290420, "time_this_iter_s": 11.147701978683472, "time_total_s": 1041.1348462104797, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 201.25559425354004, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.9375, "ram_util_percent": 79.41875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1870.6026611328125, "policy_loss": -1.0295899965487446e+16, "vf_loss": 2518522538.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 281.0, "diff_num_grad_updates_vs_sampler_policy": 280.0}}, "num_env_steps_sampled": 168480, "num_env_steps_trained": 168480, "num_agent_steps_sampled": 168480, "num_agent_steps_trained": 168480}, "sampler_results": {"episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29895.03202372644, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422585208035072, "mean_inference_ms": 0.251299670533693, "mean_action_processing_ms": 0.05939596905229878, "mean_env_wait_ms": 1.655573771963903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025371287731414146, "StateBufferConnector_ms": 0.0017204183213254238, "ViewRequirementAgentConnector_ms": 0.045230540823429186}}, "episode_reward_max": -29625.052467631765, "episode_reward_min": -30182.797874843713, "episode_reward_mean": -29895.03202372644, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422585208035072, "mean_inference_ms": 0.251299670533693, "mean_action_processing_ms": 0.05939596905229878, "mean_env_wait_ms": 1.655573771963903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025371287731414146, "StateBufferConnector_ms": 0.0017204183213254238, "ViewRequirementAgentConnector_ms": 0.045230540823429186}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168480, "num_agent_steps_trained": 168480, "num_env_steps_sampled": 168480, "num_env_steps_trained": 168480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.82847288443403, "num_env_steps_trained_throughput_per_sec": 160.82847288443403, "timesteps_total": 168480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 168480, "timers": {"training_iteration_time_ms": 2233.763, "sample_time_ms": 2228.491, "load_time_ms": 0.217, "load_throughput": 1660562.455, "learn_time_ms": 4.515, "learn_throughput": 79728.673, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 168480, "num_env_steps_trained": 168480, "num_agent_steps_sampled": 168480, "num_agent_steps_trained": 168480}, "done": false, "episodes_total": 468, "training_iteration": 94, "trial_id": "a960d_00000", "date": "2023-07-25_16-07-11", "timestamp": 1690290431, "time_this_iter_s": 11.194794178009033, "time_total_s": 1052.3296403884888, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.45038843154907, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 26.18125, "ram_util_percent": 79.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1871.913330078125, "policy_loss": -6.181511677852604e+16, "vf_loss": 2544182400.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 296.0, "diff_num_grad_updates_vs_sampler_policy": 295.0}}, "num_env_steps_sampled": 170280, "num_env_steps_trained": 170280, "num_agent_steps_sampled": 170280, "num_agent_steps_trained": 170280}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30188.276287547124, "episode_reward_mean": -29893.551619186994, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422386529963314, "mean_inference_ms": 0.25126728249177804, "mean_action_processing_ms": 0.05939079107053441, "mean_env_wait_ms": 1.6481479516030486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002533980090208728, "StateBufferConnector_ms": 0.001726006016586766, "ViewRequirementAgentConnector_ms": 0.045358291780105746}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30188.276287547124, "episode_reward_mean": -29893.551619186994, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.72675303602, -29969.978027820274, -29734.78099841184, -29749.841899930678, -29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422386529963314, "mean_inference_ms": 0.25126728249177804, "mean_action_processing_ms": 0.05939079107053441, "mean_env_wait_ms": 1.6481479516030486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002533980090208728, "StateBufferConnector_ms": 0.001726006016586766, "ViewRequirementAgentConnector_ms": 0.045358291780105746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170280, "num_agent_steps_trained": 170280, "num_env_steps_sampled": 170280, "num_env_steps_trained": 170280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.02255604844328, "num_env_steps_trained_throughput_per_sec": 161.02255604844328, "timesteps_total": 170280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 170280, "timers": {"training_iteration_time_ms": 2237.051, "sample_time_ms": 2231.828, "load_time_ms": 0.215, "load_throughput": 1677535.207, "learn_time_ms": 4.465, "learn_throughput": 80631.265, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 170280, "num_env_steps_trained": 170280, "num_agent_steps_sampled": 170280, "num_agent_steps_trained": 170280}, "done": false, "episodes_total": 473, "training_iteration": 95, "trial_id": "a960d_00000", "date": "2023-07-25_16-07-22", "timestamp": 1690290442, "time_this_iter_s": 11.180725812911987, "time_total_s": 1063.5103662014008, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 223.63111424446106, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.28125, "ram_util_percent": 79.41874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.3333333333333326e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1872.7152099609375, "policy_loss": -2.2923815744263508e+16, "vf_loss": 2497148864.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 172080, "num_env_steps_trained": 172080, "num_agent_steps_sampled": 172080, "num_agent_steps_trained": 172080}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30188.276287547124, "episode_reward_mean": -29895.387786506315, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.421656841535498, "mean_inference_ms": 0.2511026001689723, "mean_action_processing_ms": 0.05936925728793464, "mean_env_wait_ms": 1.5980605862906012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025293827056884766, "StateBufferConnector_ms": 0.0017321109771728516, "ViewRequirementAgentConnector_ms": 0.045314788818359375}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30188.276287547124, "episode_reward_mean": -29895.387786506315, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29774.547633146816, -30062.03465983193, -29785.89651757183, -30020.641774580312, -30093.034165901066, -29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.421656841535498, "mean_inference_ms": 0.2511026001689723, "mean_action_processing_ms": 0.05936925728793464, "mean_env_wait_ms": 1.5980605862906012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025293827056884766, "StateBufferConnector_ms": 0.0017321109771728516, "ViewRequirementAgentConnector_ms": 0.045314788818359375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172080, "num_agent_steps_trained": 172080, "num_env_steps_sampled": 172080, "num_env_steps_trained": 172080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.98563181779653, "num_env_steps_trained_throughput_per_sec": 160.98563181779653, "timesteps_total": 172080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 172080, "timers": {"training_iteration_time_ms": 2235.959, "sample_time_ms": 2230.713, "load_time_ms": 0.212, "load_throughput": 1697716.933, "learn_time_ms": 4.506, "learn_throughput": 79900.383, "synch_weights_time_ms": 0.496}, "counters": {"num_env_steps_sampled": 172080, "num_env_steps_trained": 172080, "num_agent_steps_sampled": 172080, "num_agent_steps_trained": 172080}, "done": false, "episodes_total": 478, "training_iteration": 96, "trial_id": "a960d_00000", "date": "2023-07-25_16-07-33", "timestamp": 1690290453, "time_this_iter_s": 11.183138132095337, "time_total_s": 1074.693504333496, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 234.8142523765564, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.3125, "ram_util_percent": 79.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1872.9579264322917, "policy_loss": -2.4011379426129236e+16, "vf_loss": 2509223872.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 326.0, "diff_num_grad_updates_vs_sampler_policy": 325.0}}, "num_env_steps_sampled": 173880, "num_env_steps_trained": 173880, "num_agent_steps_sampled": 173880, "num_agent_steps_trained": 173880}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30188.276287547124, "episode_reward_mean": -29891.428395507213, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4209935595343595, "mean_inference_ms": 0.2510753594055529, "mean_action_processing_ms": 0.05936553840419993, "mean_env_wait_ms": 1.5724512684643708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025315284729003906, "StateBufferConnector_ms": 0.0017352104187011719, "ViewRequirementAgentConnector_ms": 0.04534316062927246}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30188.276287547124, "episode_reward_mean": -29891.428395507213, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29914.74453672997, -30000.652345362443, -29738.561204371104, -29992.49919776729, -29634.566773788214, -29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4209935595343595, "mean_inference_ms": 0.2510753594055529, "mean_action_processing_ms": 0.05936553840419993, "mean_env_wait_ms": 1.5724512684643708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025315284729003906, "StateBufferConnector_ms": 0.0017352104187011719, "ViewRequirementAgentConnector_ms": 0.04534316062927246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173880, "num_agent_steps_trained": 173880, "num_env_steps_sampled": 173880, "num_env_steps_trained": 173880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.62712973706863, "num_env_steps_trained_throughput_per_sec": 160.62712973706863, "timesteps_total": 173880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 173880, "timers": {"training_iteration_time_ms": 2238.707, "sample_time_ms": 2232.904, "load_time_ms": 0.217, "load_throughput": 1660014.776, "learn_time_ms": 4.988, "learn_throughput": 72173.865, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 173880, "num_env_steps_trained": 173880, "num_agent_steps_sampled": 173880, "num_agent_steps_trained": 173880}, "done": false, "episodes_total": 483, "training_iteration": 97, "trial_id": "a960d_00000", "date": "2023-07-25_16-07-44", "timestamp": 1690290464, "time_this_iter_s": 11.208175897598267, "time_total_s": 1085.9016802310944, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 246.02242827415466, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.275, "ram_util_percent": 79.23125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666667e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.10888671875, "policy_loss": -278492449513472.0, "vf_loss": 2479505450.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 341.0, "diff_num_grad_updates_vs_sampler_policy": 340.0}}, "num_env_steps_sampled": 175680, "num_env_steps_trained": 175680, "num_agent_steps_sampled": 175680, "num_agent_steps_trained": 175680}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30188.276287547124, "episode_reward_mean": -29895.282040749098, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420845340432316, "mean_inference_ms": 0.25101533628509687, "mean_action_processing_ms": 0.0593605940909754, "mean_env_wait_ms": 1.556446347475443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025277137756347656, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.04526495933532715}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30188.276287547124, "episode_reward_mean": -29895.282040749098, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29845.39594639824, -29799.2745999027, -30067.228551702738, -29898.455736292803, -30182.797874843713, -29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420845340432316, "mean_inference_ms": 0.25101533628509687, "mean_action_processing_ms": 0.0593605940909754, "mean_env_wait_ms": 1.556446347475443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025277137756347656, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.04526495933532715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175680, "num_agent_steps_trained": 175680, "num_env_steps_sampled": 175680, "num_env_steps_trained": 175680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.93250675924625, "num_env_steps_trained_throughput_per_sec": 161.93250675924625, "timesteps_total": 175680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 175680, "timers": {"training_iteration_time_ms": 2232.169, "sample_time_ms": 2226.362, "load_time_ms": 0.218, "load_throughput": 1651120.219, "learn_time_ms": 4.966, "learn_throughput": 72497.873, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 175680, "num_env_steps_trained": 175680, "num_agent_steps_sampled": 175680, "num_agent_steps_trained": 175680}, "done": false, "episodes_total": 488, "training_iteration": 98, "trial_id": "a960d_00000", "date": "2023-07-25_16-07-56", "timestamp": 1690290476, "time_this_iter_s": 11.118004083633423, "time_total_s": 1097.0196843147278, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 257.1404323577881, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.253333333333334, "ram_util_percent": 79.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8333333333333335e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.2018636067708, "policy_loss": -1325332824566442.8, "vf_loss": 2493470570.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 356.0, "diff_num_grad_updates_vs_sampler_policy": 355.0}}, "num_env_steps_sampled": 177480, "num_env_steps_trained": 177480, "num_agent_steps_sampled": 177480, "num_agent_steps_trained": 177480}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29895.54381837169, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4207742433802535, "mean_inference_ms": 0.25101882145603105, "mean_action_processing_ms": 0.059364943854544626, "mean_env_wait_ms": 1.5455035897389615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002535104751586914, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.04526019096374512}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29895.54381837169, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29936.646742012286, -29888.845569560683, -29939.765350639464, -29829.387670661617, -29776.809282892646, -29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4207742433802535, "mean_inference_ms": 0.25101882145603105, "mean_action_processing_ms": 0.059364943854544626, "mean_env_wait_ms": 1.5455035897389615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002535104751586914, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.04526019096374512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177480, "num_agent_steps_trained": 177480, "num_env_steps_sampled": 177480, "num_env_steps_trained": 177480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.34035886203668, "num_env_steps_trained_throughput_per_sec": 161.34035886203668, "timesteps_total": 177480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 177480, "timers": {"training_iteration_time_ms": 2227.219, "sample_time_ms": 2221.946, "load_time_ms": 0.218, "load_throughput": 1650217.967, "learn_time_ms": 4.481, "learn_throughput": 80341.246, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 177480, "num_env_steps_trained": 177480, "num_agent_steps_sampled": 177480, "num_agent_steps_trained": 177480}, "done": false, "episodes_total": 493, "training_iteration": 99, "trial_id": "a960d_00000", "date": "2023-07-25_16-08-07", "timestamp": 1690290487, "time_this_iter_s": 11.159007787704468, "time_total_s": 1108.1786921024323, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 268.29944014549255, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 25.64375, "ram_util_percent": 79.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2000000000000003e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.3052978515625, "policy_loss": -3341072336756736.0, "vf_loss": 2464432213.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 371.0, "diff_num_grad_updates_vs_sampler_policy": 370.0}}, "num_env_steps_sampled": 179280, "num_env_steps_trained": 179280, "num_agent_steps_sampled": 179280, "num_agent_steps_trained": 179280}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29894.660786428674, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420724060341395, "mean_inference_ms": 0.2510150951907268, "mean_action_processing_ms": 0.059365494634155434, "mean_env_wait_ms": 1.5371394837671521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025305747985839844, "StateBufferConnector_ms": 0.0017485618591308594, "ViewRequirementAgentConnector_ms": 0.04522347450256348}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29894.660786428674, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29805.444478490946, -29970.73162050953, -29966.280426334866, -29690.30723922866, -29833.823166349506, -30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420724060341395, "mean_inference_ms": 0.2510150951907268, "mean_action_processing_ms": 0.059365494634155434, "mean_env_wait_ms": 1.5371394837671521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025305747985839844, "StateBufferConnector_ms": 0.0017485618591308594, "ViewRequirementAgentConnector_ms": 0.04522347450256348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179280, "num_agent_steps_trained": 179280, "num_env_steps_sampled": 179280, "num_env_steps_trained": 179280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.57799464166257, "num_env_steps_trained_throughput_per_sec": 160.57799464166257, "timesteps_total": 179280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 179280, "timers": {"training_iteration_time_ms": 2236.595, "sample_time_ms": 2231.377, "load_time_ms": 0.218, "load_throughput": 1654920.473, "learn_time_ms": 4.437, "learn_throughput": 81139.944, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 179280, "num_env_steps_trained": 179280, "num_agent_steps_sampled": 179280, "num_agent_steps_trained": 179280}, "done": false, "episodes_total": 498, "training_iteration": 100, "trial_id": "a960d_00000", "date": "2023-07-25_16-08-18", "timestamp": 1690290498, "time_this_iter_s": 11.211517095565796, "time_total_s": 1119.390209197998, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 279.51095724105835, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 26.025, "ram_util_percent": 79.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.3861490885417, "policy_loss": -2107859782778197.2, "vf_loss": 2522071402.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 386.0, "diff_num_grad_updates_vs_sampler_policy": 385.0}}, "num_env_steps_sampled": 181080, "num_env_steps_trained": 181080, "num_agent_steps_sampled": 181080, "num_agent_steps_trained": 181080}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29901.259775179882, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419997480851794, "mean_inference_ms": 0.2509670370766838, "mean_action_processing_ms": 0.05935683962243694, "mean_env_wait_ms": 1.5303856780224283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536296844482422, "StateBufferConnector_ms": 0.0017566680908203125, "ViewRequirementAgentConnector_ms": 0.04521346092224121}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29901.259775179882, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30032.404721281833, -29782.8868577858, -29937.01100982707, -29733.84076725571, -29865.603263451885, -29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419997480851794, "mean_inference_ms": 0.2509670370766838, "mean_action_processing_ms": 0.05935683962243694, "mean_env_wait_ms": 1.5303856780224283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536296844482422, "StateBufferConnector_ms": 0.0017566680908203125, "ViewRequirementAgentConnector_ms": 0.04521346092224121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181080, "num_agent_steps_trained": 181080, "num_env_steps_sampled": 181080, "num_env_steps_trained": 181080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.61369420303734, "num_env_steps_trained_throughput_per_sec": 161.61369420303734, "timesteps_total": 181080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 181080, "timers": {"training_iteration_time_ms": 2234.708, "sample_time_ms": 2229.532, "load_time_ms": 0.214, "load_throughput": 1681832.747, "learn_time_ms": 4.424, "learn_throughput": 81379.15, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 181080, "num_env_steps_trained": 181080, "num_agent_steps_sampled": 181080, "num_agent_steps_trained": 181080}, "done": false, "episodes_total": 503, "training_iteration": 101, "trial_id": "a960d_00000", "date": "2023-07-25_16-08-29", "timestamp": 1690290509, "time_this_iter_s": 11.139713048934937, "time_total_s": 1130.529922246933, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 290.6506702899933, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.506249999999998, "ram_util_percent": 79.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.4106852213542, "policy_loss": -7949163440505515.0, "vf_loss": 2509365269.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 400.0}}, "num_env_steps_sampled": 182880, "num_env_steps_trained": 182880, "num_agent_steps_sampled": 182880, "num_agent_steps_trained": 182880}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29902.293330638913, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419736216375437, "mean_inference_ms": 0.25092808698372215, "mean_action_processing_ms": 0.05934999416096895, "mean_env_wait_ms": 1.5247387067333815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002546548843383789, "StateBufferConnector_ms": 0.0017554759979248047, "ViewRequirementAgentConnector_ms": 0.045471906661987305}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29902.293330638913, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29810.239431451715, -29894.646803133353, -29844.891636907585, -29872.12441390017, -29912.54669250636, -29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419736216375437, "mean_inference_ms": 0.25092808698372215, "mean_action_processing_ms": 0.05934999416096895, "mean_env_wait_ms": 1.5247387067333815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002546548843383789, "StateBufferConnector_ms": 0.0017554759979248047, "ViewRequirementAgentConnector_ms": 0.045471906661987305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182880, "num_agent_steps_trained": 182880, "num_env_steps_sampled": 182880, "num_env_steps_trained": 182880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.33800978867657, "num_env_steps_trained_throughput_per_sec": 160.33800978867657, "timesteps_total": 182880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 182880, "timers": {"training_iteration_time_ms": 2236.386, "sample_time_ms": 2231.218, "load_time_ms": 0.214, "load_throughput": 1680335.455, "learn_time_ms": 4.421, "learn_throughput": 81428.742, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 182880, "num_env_steps_trained": 182880, "num_agent_steps_sampled": 182880, "num_agent_steps_trained": 182880}, "done": false, "episodes_total": 508, "training_iteration": 102, "trial_id": "a960d_00000", "date": "2023-07-25_16-08-40", "timestamp": 1690290520, "time_this_iter_s": 11.228397130966187, "time_total_s": 1141.7583193778992, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 301.8790674209595, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.51875, "ram_util_percent": 79.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.4311116536458, "policy_loss": -2659166805382485.5, "vf_loss": 2490031616.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 416.0, "diff_num_grad_updates_vs_sampler_policy": 415.0}}, "num_env_steps_sampled": 184680, "num_env_steps_trained": 184680, "num_agent_steps_sampled": 184680, "num_agent_steps_trained": 184680}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29902.336703202327, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419576704628981, "mean_inference_ms": 0.25090072722700824, "mean_action_processing_ms": 0.05934510040533294, "mean_env_wait_ms": 1.5200294379287687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025565624237060547, "StateBufferConnector_ms": 0.001760721206665039, "ViewRequirementAgentConnector_ms": 0.04548954963684082}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29902.336703202327, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29962.749397619013, -29848.99129857425, -30093.730595716344, -29642.140603821532, -29734.044021075973, -29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419576704628981, "mean_inference_ms": 0.25090072722700824, "mean_action_processing_ms": 0.05934510040533294, "mean_env_wait_ms": 1.5200294379287687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025565624237060547, "StateBufferConnector_ms": 0.001760721206665039, "ViewRequirementAgentConnector_ms": 0.04548954963684082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184680, "num_agent_steps_trained": 184680, "num_env_steps_sampled": 184680, "num_env_steps_trained": 184680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.6622553931018, "num_env_steps_trained_throughput_per_sec": 160.6622553931018, "timesteps_total": 184680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 184680, "timers": {"training_iteration_time_ms": 2242.982, "sample_time_ms": 2237.779, "load_time_ms": 0.215, "load_throughput": 1671777.502, "learn_time_ms": 4.429, "learn_throughput": 81287.587, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 184680, "num_env_steps_trained": 184680, "num_agent_steps_sampled": 184680, "num_agent_steps_trained": 184680}, "done": false, "episodes_total": 513, "training_iteration": 103, "trial_id": "a960d_00000", "date": "2023-07-25_16-08-52", "timestamp": 1690290532, "time_this_iter_s": 11.205562114715576, "time_total_s": 1152.9638814926147, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 313.08462953567505, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.181250000000002, "ram_util_percent": 79.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666668e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.4495035807292, "policy_loss": -263170593250645.34, "vf_loss": 2490789482.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 431.0, "diff_num_grad_updates_vs_sampler_policy": 430.0}}, "num_env_steps_sampled": 186480, "num_env_steps_trained": 186480, "num_agent_steps_sampled": 186480, "num_agent_steps_trained": 186480}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29897.6249211751, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419245667478449, "mean_inference_ms": 0.2508762743616772, "mean_action_processing_ms": 0.0593399596750028, "mean_env_wait_ms": 1.5158900582425554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025527477264404297, "StateBufferConnector_ms": 0.0017740726470947266, "ViewRequirementAgentConnector_ms": 0.04540514945983887}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29897.6249211751, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29944.097669693543, -29989.782530485652, -29926.715701879315, -29879.859033186065, -29973.310840821825, -29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419245667478449, "mean_inference_ms": 0.2508762743616772, "mean_action_processing_ms": 0.0593399596750028, "mean_env_wait_ms": 1.5158900582425554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025527477264404297, "StateBufferConnector_ms": 0.0017740726470947266, "ViewRequirementAgentConnector_ms": 0.04540514945983887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186480, "num_agent_steps_trained": 186480, "num_env_steps_sampled": 186480, "num_env_steps_trained": 186480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.00273306534768, "num_env_steps_trained_throughput_per_sec": 160.00273306534768, "timesteps_total": 186480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 186480, "timers": {"training_iteration_time_ms": 2245.334, "sample_time_ms": 2239.977, "load_time_ms": 0.218, "load_throughput": 1650578.749, "learn_time_ms": 4.557, "learn_throughput": 79000.761, "synch_weights_time_ms": 0.55}, "counters": {"num_env_steps_sampled": 186480, "num_env_steps_trained": 186480, "num_agent_steps_sampled": 186480, "num_agent_steps_trained": 186480}, "done": false, "episodes_total": 518, "training_iteration": 104, "trial_id": "a960d_00000", "date": "2023-07-25_16-09-03", "timestamp": 1690290543, "time_this_iter_s": 11.251918077468872, "time_total_s": 1164.2157995700836, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 324.3365476131439, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.66875, "ram_util_percent": 78.97500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.833333333333333e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.4652099609375, "policy_loss": -4458205156125354.5, "vf_loss": 2512420522.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 446.0, "diff_num_grad_updates_vs_sampler_policy": 445.0}}, "num_env_steps_sampled": 188280, "num_env_steps_trained": 188280, "num_agent_steps_sampled": 188280, "num_agent_steps_trained": 188280}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29899.65679623868, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419040026467204, "mean_inference_ms": 0.25082235112259793, "mean_action_processing_ms": 0.05933098662947163, "mean_env_wait_ms": 1.512280343527204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025482177734375, "StateBufferConnector_ms": 0.0017750263214111328, "ViewRequirementAgentConnector_ms": 0.04537558555603027}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29899.65679623868, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29957.855626856555, -30042.965066861518, -29919.351900139904, -29661.769908868922, -29817.367500691387, -29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419040026467204, "mean_inference_ms": 0.25082235112259793, "mean_action_processing_ms": 0.05933098662947163, "mean_env_wait_ms": 1.512280343527204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025482177734375, "StateBufferConnector_ms": 0.0017750263214111328, "ViewRequirementAgentConnector_ms": 0.04537558555603027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188280, "num_agent_steps_trained": 188280, "num_env_steps_sampled": 188280, "num_env_steps_trained": 188280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.36655330019545, "num_env_steps_trained_throughput_per_sec": 161.36655330019545, "timesteps_total": 188280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 188280, "timers": {"training_iteration_time_ms": 2240.444, "sample_time_ms": 2234.624, "load_time_ms": 0.226, "load_throughput": 1595803.678, "learn_time_ms": 4.702, "learn_throughput": 76555.857, "synch_weights_time_ms": 0.857}, "counters": {"num_env_steps_sampled": 188280, "num_env_steps_trained": 188280, "num_agent_steps_sampled": 188280, "num_agent_steps_trained": 188280}, "done": false, "episodes_total": 523, "training_iteration": 105, "trial_id": "a960d_00000", "date": "2023-07-25_16-09-14", "timestamp": 1690290554, "time_this_iter_s": 11.156920909881592, "time_total_s": 1175.3727204799652, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 335.4934685230255, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 26.7875, "ram_util_percent": 78.53125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.4974772135417, "policy_loss": -1180307146111658.8, "vf_loss": 2507587584.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 461.0, "diff_num_grad_updates_vs_sampler_policy": 460.0}}, "num_env_steps_sampled": 190080, "num_env_steps_trained": 190080, "num_agent_steps_sampled": 190080, "num_agent_steps_trained": 190080}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29899.173804142116, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418766180067338, "mean_inference_ms": 0.25075043648597506, "mean_action_processing_ms": 0.05931943988162059, "mean_env_wait_ms": 1.5090895257658337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025467872619628906, "StateBufferConnector_ms": 0.001764535903930664, "ViewRequirementAgentConnector_ms": 0.045318603515625}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29899.173804142116, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29806.0908105197, -29753.16686648573, -29625.052467631765, -29840.672381086668, -30070.3245944234, -29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418766180067338, "mean_inference_ms": 0.25075043648597506, "mean_action_processing_ms": 0.05931943988162059, "mean_env_wait_ms": 1.5090895257658337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025467872619628906, "StateBufferConnector_ms": 0.001764535903930664, "ViewRequirementAgentConnector_ms": 0.045318603515625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190080, "num_agent_steps_trained": 190080, "num_env_steps_sampled": 190080, "num_env_steps_trained": 190080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.30313022303136, "num_env_steps_trained_throughput_per_sec": 161.30313022303136, "timesteps_total": 190080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 190080, "timers": {"training_iteration_time_ms": 2231.374, "sample_time_ms": 2225.392, "load_time_ms": 0.226, "load_throughput": 1594792.395, "learn_time_ms": 4.86, "learn_throughput": 74081.042, "synch_weights_time_ms": 0.862}, "counters": {"num_env_steps_sampled": 190080, "num_env_steps_trained": 190080, "num_agent_steps_sampled": 190080, "num_agent_steps_trained": 190080}, "done": false, "episodes_total": 528, "training_iteration": 106, "trial_id": "a960d_00000", "date": "2023-07-25_16-09-25", "timestamp": 1690290565, "time_this_iter_s": 11.161794662475586, "time_total_s": 1186.5345151424408, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 346.6552631855011, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.36, "ram_util_percent": 79.48666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.509765625, "policy_loss": -1283991508353024.0, "vf_loss": 2507685696.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 476.0, "diff_num_grad_updates_vs_sampler_policy": 475.0}}, "num_env_steps_sampled": 191880, "num_env_steps_trained": 191880, "num_agent_steps_sampled": 191880, "num_agent_steps_trained": 191880}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29905.628745587364, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418497299099098, "mean_inference_ms": 0.25065740875158815, "mean_action_processing_ms": 0.05930522560392038, "mean_env_wait_ms": 1.5060944204084716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002539396286010742, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.045274972915649414}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29905.628745587364, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29876.94432967646, -29885.12110104949, -29745.91824317832, -29967.874761956387, -29801.409887244507, -29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418497299099098, "mean_inference_ms": 0.25065740875158815, "mean_action_processing_ms": 0.05930522560392038, "mean_env_wait_ms": 1.5060944204084716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002539396286010742, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.045274972915649414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191880, "num_agent_steps_trained": 191880, "num_env_steps_sampled": 191880, "num_env_steps_trained": 191880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.2482419330804, "num_env_steps_trained_throughput_per_sec": 162.2482419330804, "timesteps_total": 191880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 191880, "timers": {"training_iteration_time_ms": 2225.313, "sample_time_ms": 2219.719, "load_time_ms": 0.217, "load_throughput": 1655464.796, "learn_time_ms": 4.791, "learn_throughput": 75142.798, "synch_weights_time_ms": 0.552}, "counters": {"num_env_steps_sampled": 191880, "num_env_steps_trained": 191880, "num_agent_steps_sampled": 191880, "num_agent_steps_trained": 191880}, "done": false, "episodes_total": 533, "training_iteration": 107, "trial_id": "a960d_00000", "date": "2023-07-25_16-09-36", "timestamp": 1690290576, "time_this_iter_s": 11.09629487991333, "time_total_s": 1197.6308100223541, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 357.75155806541443, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 23.99375, "ram_util_percent": 79.54374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.3333333333333345e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5148111979167, "policy_loss": -160258354304341.34, "vf_loss": 2507852138.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 490.0}}, "num_env_steps_sampled": 193680, "num_env_steps_trained": 193680, "num_agent_steps_sampled": 193680, "num_agent_steps_trained": 193680}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29904.943490225523, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418206265179293, "mean_inference_ms": 0.2505726157485947, "mean_action_processing_ms": 0.05929301846303894, "mean_env_wait_ms": 1.5033600306417594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025320053100585938, "StateBufferConnector_ms": 0.0017552375793457031, "ViewRequirementAgentConnector_ms": 0.045215606689453125}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29904.943490225523, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29838.05169650824, -30104.144716839404, -29847.426444698856, -30032.104774086358, -30162.363903869216, -29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418206265179293, "mean_inference_ms": 0.2505726157485947, "mean_action_processing_ms": 0.05929301846303894, "mean_env_wait_ms": 1.5033600306417594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025320053100585938, "StateBufferConnector_ms": 0.0017552375793457031, "ViewRequirementAgentConnector_ms": 0.045215606689453125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193680, "num_agent_steps_trained": 193680, "num_env_steps_sampled": 193680, "num_env_steps_trained": 193680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.78149201473389, "num_env_steps_trained_throughput_per_sec": 161.78149201473389, "timesteps_total": 193680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 193680, "timers": {"training_iteration_time_ms": 2222.014, "sample_time_ms": 2216.634, "load_time_ms": 0.222, "load_throughput": 1624999.397, "learn_time_ms": 4.582, "learn_throughput": 78560.139, "synch_weights_time_ms": 0.543}, "counters": {"num_env_steps_sampled": 193680, "num_env_steps_trained": 193680, "num_agent_steps_sampled": 193680, "num_agent_steps_trained": 193680}, "done": false, "episodes_total": 538, "training_iteration": 108, "trial_id": "a960d_00000", "date": "2023-07-25_16-09-47", "timestamp": 1690290587, "time_this_iter_s": 11.1281578540802, "time_total_s": 1208.7589678764343, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 368.87971591949463, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.625, "ram_util_percent": 79.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5167643229167, "policy_loss": -1047904226290346.6, "vf_loss": 2472265109.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 506.0, "diff_num_grad_updates_vs_sampler_policy": 505.0}}, "num_env_steps_sampled": 195480, "num_env_steps_trained": 195480, "num_agent_steps_sampled": 195480, "num_agent_steps_trained": 195480}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29898.492307254724, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417914335731571, "mean_inference_ms": 0.25048751402781355, "mean_action_processing_ms": 0.05928034094972227, "mean_env_wait_ms": 1.500953812370617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025377273559570312, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.045273542404174805}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29898.492307254724, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29999.74012662123, -29929.482341884628, -30005.408405846414, -29930.520579409233, -29794.856046657165, -29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417914335731571, "mean_inference_ms": 0.25048751402781355, "mean_action_processing_ms": 0.05928034094972227, "mean_env_wait_ms": 1.500953812370617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025377273559570312, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.045273542404174805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195480, "num_agent_steps_trained": 195480, "num_env_steps_sampled": 195480, "num_env_steps_trained": 195480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.7080142427404, "num_env_steps_trained_throughput_per_sec": 160.7080142427404, "timesteps_total": 195480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 195480, "timers": {"training_iteration_time_ms": 2232.646, "sample_time_ms": 2227.361, "load_time_ms": 0.224, "load_throughput": 1609411.042, "learn_time_ms": 4.511, "learn_throughput": 79804.522, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 195480, "num_env_steps_trained": 195480, "num_agent_steps_sampled": 195480, "num_agent_steps_trained": 195480}, "done": false, "episodes_total": 543, "training_iteration": 109, "trial_id": "a960d_00000", "date": "2023-07-25_16-09-59", "timestamp": 1690290599, "time_this_iter_s": 11.202473878860474, "time_total_s": 1219.9614417552948, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 380.0821897983551, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.2125, "ram_util_percent": 79.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666667e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5211588541667, "policy_loss": -755508881391616.0, "vf_loss": 2519653333.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 521.0, "diff_num_grad_updates_vs_sampler_policy": 520.0}}, "num_env_steps_sampled": 197280, "num_env_steps_trained": 197280, "num_agent_steps_sampled": 197280, "num_agent_steps_trained": 197280}, "sampler_results": {"episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29896.166143277977, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41762102140124, "mean_inference_ms": 0.25040988781700735, "mean_action_processing_ms": 0.05926945496497238, "mean_env_wait_ms": 1.498837379788518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002545595169067383, "StateBufferConnector_ms": 0.0017547607421875, "ViewRequirementAgentConnector_ms": 0.04537343978881836}}, "episode_reward_max": -29600.4427986055, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29896.166143277977, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29840.301014915894, -29792.362495152996, -29851.168749290315, -30156.555416874664, -29892.61117255716, -29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41762102140124, "mean_inference_ms": 0.25040988781700735, "mean_action_processing_ms": 0.05926945496497238, "mean_env_wait_ms": 1.498837379788518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002545595169067383, "StateBufferConnector_ms": 0.0017547607421875, "ViewRequirementAgentConnector_ms": 0.04537343978881836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197280, "num_agent_steps_trained": 197280, "num_env_steps_sampled": 197280, "num_env_steps_trained": 197280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.5973285675865, "num_env_steps_trained_throughput_per_sec": 161.5973285675865, "timesteps_total": 197280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 197280, "timers": {"training_iteration_time_ms": 2233.914, "sample_time_ms": 2228.688, "load_time_ms": 0.218, "load_throughput": 1655101.874, "learn_time_ms": 4.476, "learn_throughput": 80419.979, "synch_weights_time_ms": 0.501}, "counters": {"num_env_steps_sampled": 197280, "num_env_steps_trained": 197280, "num_agent_steps_sampled": 197280, "num_agent_steps_trained": 197280}, "done": false, "episodes_total": 548, "training_iteration": 110, "trial_id": "a960d_00000", "date": "2023-07-25_16-10-10", "timestamp": 1690290610, "time_this_iter_s": 11.140872955322266, "time_total_s": 1231.102314710617, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 391.22306275367737, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 24.92666666666667, "ram_util_percent": 79.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8333333333333335e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.525634765625, "policy_loss": -92936887037952.0, "vf_loss": 2424312746.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 536.0, "diff_num_grad_updates_vs_sampler_policy": 535.0}}, "num_env_steps_sampled": 199080, "num_env_steps_trained": 199080, "num_agent_steps_sampled": 199080, "num_agent_steps_trained": 199080}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29894.95090696485, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417286290248404, "mean_inference_ms": 0.25033468485670596, "mean_action_processing_ms": 0.059259596535717954, "mean_env_wait_ms": 1.4968690964864626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002550363540649414, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.04543113708496094}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30193.32410706295, "episode_reward_mean": -29894.95090696485, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29745.553896643254, -29927.65467760712, -30058.40235005125, -29935.211429532952, -29951.548342308342, -29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417286290248404, "mean_inference_ms": 0.25033468485670596, "mean_action_processing_ms": 0.059259596535717954, "mean_env_wait_ms": 1.4968690964864626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002550363540649414, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.04543113708496094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199080, "num_agent_steps_trained": 199080, "num_env_steps_sampled": 199080, "num_env_steps_trained": 199080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.66108364089226, "num_env_steps_trained_throughput_per_sec": 161.66108364089226, "timesteps_total": 199080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 199080, "timers": {"training_iteration_time_ms": 2227.309, "sample_time_ms": 2221.586, "load_time_ms": 0.218, "load_throughput": 1653108.649, "learn_time_ms": 4.891, "learn_throughput": 73607.238, "synch_weights_time_ms": 0.58}, "counters": {"num_env_steps_sampled": 199080, "num_env_steps_trained": 199080, "num_agent_steps_sampled": 199080, "num_agent_steps_trained": 199080}, "done": false, "episodes_total": 553, "training_iteration": 111, "trial_id": "a960d_00000", "date": "2023-07-25_16-10-21", "timestamp": 1690290621, "time_this_iter_s": 11.139427185058594, "time_total_s": 1242.2417418956757, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 402.36248993873596, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 24.33125, "ram_util_percent": 79.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.527099609375, "policy_loss": -580145082314069.4, "vf_loss": 2475165226.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 551.0, "diff_num_grad_updates_vs_sampler_policy": 550.0}}, "num_env_steps_sampled": 200880, "num_env_steps_trained": 200880, "num_agent_steps_sampled": 200880, "num_agent_steps_trained": 200880}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29897.412298267125, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416949182534742, "mean_inference_ms": 0.2502711644215736, "mean_action_processing_ms": 0.059251685632627386, "mean_env_wait_ms": 1.4950729926348338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025544166564941406, "StateBufferConnector_ms": 0.001749277114868164, "ViewRequirementAgentConnector_ms": 0.04539632797241211}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29897.412298267125, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29908.948147761006, -29988.290838417823, -30072.19708565531, -29813.709558711813, -29908.149724030805, -29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416949182534742, "mean_inference_ms": 0.2502711644215736, "mean_action_processing_ms": 0.059251685632627386, "mean_env_wait_ms": 1.4950729926348338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025544166564941406, "StateBufferConnector_ms": 0.001749277114868164, "ViewRequirementAgentConnector_ms": 0.04539632797241211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200880, "num_agent_steps_trained": 200880, "num_env_steps_sampled": 200880, "num_env_steps_trained": 200880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.13733281470556, "num_env_steps_trained_throughput_per_sec": 162.13733281470556, "timesteps_total": 200880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 200880, "timers": {"training_iteration_time_ms": 2223.599, "sample_time_ms": 2217.9, "load_time_ms": 0.218, "load_throughput": 1653470.696, "learn_time_ms": 4.877, "learn_throughput": 73821.719, "synch_weights_time_ms": 0.57}, "counters": {"num_env_steps_sampled": 200880, "num_env_steps_trained": 200880, "num_agent_steps_sampled": 200880, "num_agent_steps_trained": 200880}, "done": false, "episodes_total": 558, "training_iteration": 112, "trial_id": "a960d_00000", "date": "2023-07-25_16-10-32", "timestamp": 1690290632, "time_this_iter_s": 11.103808164596558, "time_total_s": 1253.3455500602722, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 413.4662981033325, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 23.38125, "ram_util_percent": 79.9875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.527587890625, "policy_loss": -162810693655210.66, "vf_loss": 2486755456.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 566.0, "diff_num_grad_updates_vs_sampler_policy": 565.0}}, "num_env_steps_sampled": 202680, "num_env_steps_trained": 202680, "num_agent_steps_sampled": 202680, "num_agent_steps_trained": 202680}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29899.487072985765, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416645957014842, "mean_inference_ms": 0.2502146468953892, "mean_action_processing_ms": 0.059245078356456544, "mean_env_wait_ms": 1.493424733873271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025484561920166016, "StateBufferConnector_ms": 0.0017397403717041016, "ViewRequirementAgentConnector_ms": 0.04517698287963867}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29899.487072985765, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29746.064923905655, -29664.64730539403, -29816.12834969093, -29978.350422450927, -30120.851811795754, -29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416645957014842, "mean_inference_ms": 0.2502146468953892, "mean_action_processing_ms": 0.059245078356456544, "mean_env_wait_ms": 1.493424733873271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025484561920166016, "StateBufferConnector_ms": 0.0017397403717041016, "ViewRequirementAgentConnector_ms": 0.04517698287963867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202680, "num_agent_steps_trained": 202680, "num_env_steps_sampled": 202680, "num_env_steps_trained": 202680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.5678677103915, "num_env_steps_trained_throughput_per_sec": 161.5678677103915, "timesteps_total": 202680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 202680, "timers": {"training_iteration_time_ms": 2224.244, "sample_time_ms": 2218.946, "load_time_ms": 0.216, "load_throughput": 1666794.834, "learn_time_ms": 4.557, "learn_throughput": 78990.842, "synch_weights_time_ms": 0.493}, "counters": {"num_env_steps_sampled": 202680, "num_env_steps_trained": 202680, "num_agent_steps_sampled": 202680, "num_agent_steps_trained": 202680}, "done": false, "episodes_total": 563, "training_iteration": 113, "trial_id": "a960d_00000", "date": "2023-07-25_16-10-43", "timestamp": 1690290643, "time_this_iter_s": 11.142890930175781, "time_total_s": 1264.488440990448, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 424.6091890335083, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.1125, "ram_util_percent": 79.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -127956637013333.33, "vf_loss": 2477521749.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 580.0}}, "num_env_steps_sampled": 204480, "num_env_steps_trained": 204480, "num_agent_steps_sampled": 204480, "num_agent_steps_trained": 204480}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29902.423894517386, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416429513730341, "mean_inference_ms": 0.25017209458099343, "mean_action_processing_ms": 0.05924028611234514, "mean_env_wait_ms": 1.491919637952946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025675296783447266, "StateBufferConnector_ms": 0.0017426013946533203, "ViewRequirementAgentConnector_ms": 0.04526114463806152}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29902.423894517386, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29830.716445258433, -29823.048726072004, -29886.1158117443, -29600.4427986055, -30188.276287547124, -30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416429513730341, "mean_inference_ms": 0.25017209458099343, "mean_action_processing_ms": 0.05924028611234514, "mean_env_wait_ms": 1.491919637952946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025675296783447266, "StateBufferConnector_ms": 0.0017426013946533203, "ViewRequirementAgentConnector_ms": 0.04526114463806152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204480, "num_agent_steps_trained": 204480, "num_env_steps_sampled": 204480, "num_env_steps_trained": 204480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.58627220339918, "num_env_steps_trained_throughput_per_sec": 158.58627220339918, "timesteps_total": 204480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 204480, "timers": {"training_iteration_time_ms": 2249.102, "sample_time_ms": 2243.625, "load_time_ms": 0.222, "load_throughput": 1622903.525, "learn_time_ms": 4.688, "learn_throughput": 76793.36, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 204480, "num_env_steps_trained": 204480, "num_agent_steps_sampled": 204480, "num_agent_steps_trained": 204480}, "done": false, "episodes_total": 568, "training_iteration": 114, "trial_id": "a960d_00000", "date": "2023-07-25_16-10-55", "timestamp": 1690290655, "time_this_iter_s": 11.352656126022339, "time_total_s": 1275.8410971164703, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 435.96184515953064, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 27.0875, "ram_util_percent": 79.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -52564971164330.664, "vf_loss": 2477338560.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 596.0, "diff_num_grad_updates_vs_sampler_policy": 595.0}}, "num_env_steps_sampled": 206280, "num_env_steps_trained": 206280, "num_agent_steps_sampled": 206280, "num_agent_steps_trained": 206280}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29906.572620800147, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416191764568788, "mean_inference_ms": 0.25013620364192646, "mean_action_processing_ms": 0.059236222601715266, "mean_env_wait_ms": 1.4905239242124741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002551555633544922, "StateBufferConnector_ms": 0.0017399787902832031, "ViewRequirementAgentConnector_ms": 0.045076847076416016}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29906.572620800147, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30115.08017611, -29779.88681327636, -30013.673737248955, -29600.88248481218, -29985.972818871178, -29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416191764568788, "mean_inference_ms": 0.25013620364192646, "mean_action_processing_ms": 0.059236222601715266, "mean_env_wait_ms": 1.4905239242124741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002551555633544922, "StateBufferConnector_ms": 0.0017399787902832031, "ViewRequirementAgentConnector_ms": 0.045076847076416016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206280, "num_agent_steps_trained": 206280, "num_env_steps_sampled": 206280, "num_env_steps_trained": 206280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.65281080827614, "num_env_steps_trained_throughput_per_sec": 161.65281080827614, "timesteps_total": 206280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 206280, "timers": {"training_iteration_time_ms": 2248.516, "sample_time_ms": 2243.056, "load_time_ms": 0.226, "load_throughput": 1589420.463, "learn_time_ms": 4.643, "learn_throughput": 77538.28, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 206280, "num_env_steps_trained": 206280, "num_agent_steps_sampled": 206280, "num_agent_steps_trained": 206280}, "done": false, "episodes_total": 573, "training_iteration": 115, "trial_id": "a960d_00000", "date": "2023-07-25_16-11-06", "timestamp": 1690290666, "time_this_iter_s": 11.13706088066101, "time_total_s": 1286.9781579971313, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 447.09890604019165, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.4375, "ram_util_percent": 79.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.333333333333332e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -66982263808000.0, "vf_loss": 2481501568.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 611.0, "diff_num_grad_updates_vs_sampler_policy": 610.0}}, "num_env_steps_sampled": 208080, "num_env_steps_trained": 208080, "num_agent_steps_sampled": 208080, "num_agent_steps_trained": 208080}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29905.217370828912, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415974006411333, "mean_inference_ms": 0.25009723622692537, "mean_action_processing_ms": 0.05923154514444407, "mean_env_wait_ms": 1.489244009071402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025467872619628906, "StateBufferConnector_ms": 0.001737833023071289, "ViewRequirementAgentConnector_ms": 0.04505157470703125}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29905.217370828912, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29931.32736591855, -29831.44732074501, -29792.247663065515, -29850.767882691915, -29934.425418701117, -29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415974006411333, "mean_inference_ms": 0.25009723622692537, "mean_action_processing_ms": 0.05923154514444407, "mean_env_wait_ms": 1.489244009071402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025467872619628906, "StateBufferConnector_ms": 0.001737833023071289, "ViewRequirementAgentConnector_ms": 0.04505157470703125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208080, "num_agent_steps_trained": 208080, "num_env_steps_sampled": 208080, "num_env_steps_trained": 208080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.5523457834044, "num_env_steps_trained_throughput_per_sec": 160.5523457834044, "timesteps_total": 208080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 208080, "timers": {"training_iteration_time_ms": 2234.618, "sample_time_ms": 2229.354, "load_time_ms": 0.224, "load_throughput": 1608725.165, "learn_time_ms": 4.481, "learn_throughput": 80331.415, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 208080, "num_env_steps_trained": 208080, "num_agent_steps_sampled": 208080, "num_agent_steps_trained": 208080}, "done": false, "episodes_total": 578, "training_iteration": 116, "trial_id": "a960d_00000", "date": "2023-07-25_16-11-17", "timestamp": 1690290677, "time_this_iter_s": 11.21339201927185, "time_total_s": 1298.1915500164032, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 458.3122980594635, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 27.88125, "ram_util_percent": 80.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666666666666666e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -24609452435456.0, "vf_loss": 2507471018.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 626.0, "diff_num_grad_updates_vs_sampler_policy": 625.0}}, "num_env_steps_sampled": 209880, "num_env_steps_trained": 209880, "num_agent_steps_sampled": 209880, "num_agent_steps_trained": 209880}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29903.632591287573, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415814053143099, "mean_inference_ms": 0.2500609805316142, "mean_action_processing_ms": 0.05922675686201969, "mean_env_wait_ms": 1.4880385926416688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002537250518798828, "StateBufferConnector_ms": 0.0017466545104980469, "ViewRequirementAgentConnector_ms": 0.044951438903808594}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29903.632591287573, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29907.020086824858, -29941.172726442324, -29997.379775812256, -29987.486911580447, -29833.329081547326, -29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415814053143099, "mean_inference_ms": 0.2500609805316142, "mean_action_processing_ms": 0.05922675686201969, "mean_env_wait_ms": 1.4880385926416688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002537250518798828, "StateBufferConnector_ms": 0.0017466545104980469, "ViewRequirementAgentConnector_ms": 0.044951438903808594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209880, "num_agent_steps_trained": 209880, "num_env_steps_sampled": 209880, "num_env_steps_trained": 209880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.77469109544774, "num_env_steps_trained_throughput_per_sec": 159.77469109544774, "timesteps_total": 209880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 209880, "timers": {"training_iteration_time_ms": 2247.707, "sample_time_ms": 2242.471, "load_time_ms": 0.221, "load_throughput": 1629910.881, "learn_time_ms": 4.466, "learn_throughput": 80610.172, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 209880, "num_env_steps_trained": 209880, "num_agent_steps_sampled": 209880, "num_agent_steps_trained": 209880}, "done": false, "episodes_total": 583, "training_iteration": 117, "trial_id": "a960d_00000", "date": "2023-07-25_16-11-28", "timestamp": 1690290688, "time_this_iter_s": 11.267882108688354, "time_total_s": 1309.4594321250916, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 469.58018016815186, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.181250000000002, "ram_util_percent": 80.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.2e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -20068614094165.332, "vf_loss": 2498581077.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 641.0, "diff_num_grad_updates_vs_sampler_policy": 640.0}}, "num_env_steps_sampled": 211680, "num_env_steps_trained": 211680, "num_agent_steps_sampled": 211680, "num_agent_steps_trained": 211680}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29900.14334027328, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415706848900779, "mean_inference_ms": 0.25003337831302663, "mean_action_processing_ms": 0.05922330398432922, "mean_env_wait_ms": 1.4869450108323832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002531290054321289, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.04488039016723633}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29900.14334027328, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29878.70227430078, -30050.912701439778, -29774.164754062494, -30193.32410706295, -29922.226634533312, -29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415706848900779, "mean_inference_ms": 0.25003337831302663, "mean_action_processing_ms": 0.05922330398432922, "mean_env_wait_ms": 1.4869450108323832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002531290054321289, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.04488039016723633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211680, "num_agent_steps_trained": 211680, "num_env_steps_sampled": 211680, "num_env_steps_trained": 211680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.8070218321905, "num_env_steps_trained_throughput_per_sec": 160.8070218321905, "timesteps_total": 211680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 211680, "timers": {"training_iteration_time_ms": 2245.93, "sample_time_ms": 2240.479, "load_time_ms": 0.221, "load_throughput": 1626399.655, "learn_time_ms": 4.64, "learn_throughput": 77588.88, "synch_weights_time_ms": 0.555}, "counters": {"num_env_steps_sampled": 211680, "num_env_steps_trained": 211680, "num_agent_steps_sampled": 211680, "num_agent_steps_trained": 211680}, "done": false, "episodes_total": 588, "training_iteration": 118, "trial_id": "a960d_00000", "date": "2023-07-25_16-11-39", "timestamp": 1690290699, "time_this_iter_s": 11.195591926574707, "time_total_s": 1320.6550240516663, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 480.77577209472656, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 27.025, "ram_util_percent": 80.01875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8666666666666664e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -27156279724032.0, "vf_loss": 2502732757.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 656.0, "diff_num_grad_updates_vs_sampler_policy": 655.0}}, "num_env_steps_sampled": 213480, "num_env_steps_trained": 213480, "num_agent_steps_sampled": 213480, "num_agent_steps_trained": 213480}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29894.948664649153, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415607530392588, "mean_inference_ms": 0.2500125301090381, "mean_action_processing_ms": 0.059220913353644614, "mean_env_wait_ms": 1.4859384423598638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025255680084228516, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.04489445686340332}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29894.948664649153, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29716.10694066846, -29925.824564584564, -29753.58399780374, -30100.40587010828, -29787.23004829942, -30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415607530392588, "mean_inference_ms": 0.2500125301090381, "mean_action_processing_ms": 0.059220913353644614, "mean_env_wait_ms": 1.4859384423598638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025255680084228516, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.04489445686340332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 213480, "num_agent_steps_trained": 213480, "num_env_steps_sampled": 213480, "num_env_steps_trained": 213480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.06388154637, "num_env_steps_trained_throughput_per_sec": 161.06388154637, "timesteps_total": 213480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 213480, "timers": {"training_iteration_time_ms": 2236.913, "sample_time_ms": 2231.474, "load_time_ms": 0.22, "load_throughput": 1635206.238, "learn_time_ms": 4.637, "learn_throughput": 77644.338, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 213480, "num_env_steps_trained": 213480, "num_agent_steps_sampled": 213480, "num_agent_steps_trained": 213480}, "done": false, "episodes_total": 593, "training_iteration": 119, "trial_id": "a960d_00000", "date": "2023-07-25_16-11-51", "timestamp": 1690290711, "time_this_iter_s": 11.177849054336548, "time_total_s": 1331.8328731060028, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 491.9536211490631, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 25.299999999999997, "ram_util_percent": 80.14375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5333333333333333e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -4749242951338.667, "vf_loss": 2526211669.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 671.0, "diff_num_grad_updates_vs_sampler_policy": 670.0}}, "num_env_steps_sampled": 215280, "num_env_steps_trained": 215280, "num_agent_steps_sampled": 215280, "num_agent_steps_trained": 215280}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29895.65065803311, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415478715345538, "mean_inference_ms": 0.24998768598022714, "mean_action_processing_ms": 0.059217992472216326, "mean_env_wait_ms": 1.4849725680680548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025200843811035156, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04494166374206543}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30270.975091070046, "episode_reward_mean": -29895.65065803311, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30067.661164082758, -30037.494054137624, -29935.121216533582, -29752.71746531769, -30133.49190596245, -29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415478715345538, "mean_inference_ms": 0.24998768598022714, "mean_action_processing_ms": 0.059217992472216326, "mean_env_wait_ms": 1.4849725680680548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025200843811035156, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04494166374206543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215280, "num_agent_steps_trained": 215280, "num_env_steps_sampled": 215280, "num_env_steps_trained": 215280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.63746850292122, "num_env_steps_trained_throughput_per_sec": 161.63746850292122, "timesteps_total": 215280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 215280, "timers": {"training_iteration_time_ms": 2231.163, "sample_time_ms": 2225.837, "load_time_ms": 0.219, "load_throughput": 1640892.676, "learn_time_ms": 4.564, "learn_throughput": 78869.539, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 215280, "num_env_steps_trained": 215280, "num_agent_steps_sampled": 215280, "num_agent_steps_trained": 215280}, "done": false, "episodes_total": 598, "training_iteration": 120, "trial_id": "a960d_00000", "date": "2023-07-25_16-12-02", "timestamp": 1690290722, "time_this_iter_s": 11.138211965560913, "time_total_s": 1342.9710850715637, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 503.091833114624, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 25.233333333333334, "ram_util_percent": 79.85333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5286865234375, "policy_loss": -1701562131114.6667, "vf_loss": 2441273493.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 686.0, "diff_num_grad_updates_vs_sampler_policy": 685.0}}, "num_env_steps_sampled": 217080, "num_env_steps_trained": 217080, "num_agent_steps_sampled": 217080, "num_agent_steps_trained": 217080}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29887.38380969605, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415398047762178, "mean_inference_ms": 0.24996039688158206, "mean_action_processing_ms": 0.059213974408525355, "mean_env_wait_ms": 1.4841025087753104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.0017306804656982422, "ViewRequirementAgentConnector_ms": 0.044992923736572266}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29887.38380969605, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29856.576306529256, -30006.878385791908, -29761.04988890927, -29768.87416274808, -30061.72342152655, -30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415398047762178, "mean_inference_ms": 0.24996039688158206, "mean_action_processing_ms": 0.059213974408525355, "mean_env_wait_ms": 1.4841025087753104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.0017306804656982422, "ViewRequirementAgentConnector_ms": 0.044992923736572266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217080, "num_agent_steps_trained": 217080, "num_env_steps_sampled": 217080, "num_env_steps_trained": 217080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.28374952632444, "num_env_steps_trained_throughput_per_sec": 160.28374952632444, "timesteps_total": 217080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 217080, "timers": {"training_iteration_time_ms": 2236.602, "sample_time_ms": 2231.309, "load_time_ms": 0.218, "load_throughput": 1654376.509, "learn_time_ms": 4.545, "learn_throughput": 79210.047, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 217080, "num_env_steps_trained": 217080, "num_agent_steps_sampled": 217080, "num_agent_steps_trained": 217080}, "done": false, "episodes_total": 603, "training_iteration": 121, "trial_id": "a960d_00000", "date": "2023-07-25_16-12-13", "timestamp": 1690290733, "time_this_iter_s": 11.232223987579346, "time_total_s": 1354.203309059143, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 514.3240571022034, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 21.96875, "ram_util_percent": 80.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5286865234375, "policy_loss": -2412030465365.3335, "vf_loss": 2448724074.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 701.0, "diff_num_grad_updates_vs_sampler_policy": 700.0}}, "num_env_steps_sampled": 218880, "num_env_steps_trained": 218880, "num_agent_steps_sampled": 218880, "num_agent_steps_trained": 218880}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29881.8482508148, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415321781850204, "mean_inference_ms": 0.24992956459641077, "mean_action_processing_ms": 0.0592092912458487, "mean_env_wait_ms": 1.483263349489177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024950504302978516, "StateBufferConnector_ms": 0.0017349720001220703, "ViewRequirementAgentConnector_ms": 0.044854164123535156}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29881.8482508148, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30031.46874531941, -29624.367548333747, -29848.44664282186, -29950.799126754388, -29883.704171012243, -29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415321781850204, "mean_inference_ms": 0.24992956459641077, "mean_action_processing_ms": 0.0592092912458487, "mean_env_wait_ms": 1.483263349489177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024950504302978516, "StateBufferConnector_ms": 0.0017349720001220703, "ViewRequirementAgentConnector_ms": 0.044854164123535156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218880, "num_agent_steps_trained": 218880, "num_env_steps_sampled": 218880, "num_env_steps_trained": 218880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.45831319212982, "num_env_steps_trained_throughput_per_sec": 160.45831319212982, "timesteps_total": 218880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 218880, "timers": {"training_iteration_time_ms": 2244.786, "sample_time_ms": 2239.549, "load_time_ms": 0.215, "load_throughput": 1674930.05, "learn_time_ms": 4.493, "learn_throughput": 80117.019, "synch_weights_time_ms": 0.496}, "counters": {"num_env_steps_sampled": 218880, "num_env_steps_trained": 218880, "num_agent_steps_sampled": 218880, "num_agent_steps_trained": 218880}, "done": false, "episodes_total": 608, "training_iteration": 122, "trial_id": "a960d_00000", "date": "2023-07-25_16-12-24", "timestamp": 1690290744, "time_this_iter_s": 11.219925165176392, "time_total_s": 1365.4232342243195, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 525.5439822673798, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 25.30625, "ram_util_percent": 79.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -1555273377109.3333, "vf_loss": 2463888426.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 716.0, "diff_num_grad_updates_vs_sampler_policy": 715.0}}, "num_env_steps_sampled": 220680, "num_env_steps_trained": 220680, "num_agent_steps_sampled": 220680, "num_agent_steps_trained": 220680}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29883.61240126554, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41525635535614, "mean_inference_ms": 0.24989461834522989, "mean_action_processing_ms": 0.05920401832128297, "mean_env_wait_ms": 1.4824283743065712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024847984313964844, "StateBufferConnector_ms": 0.0017375946044921875, "ViewRequirementAgentConnector_ms": 0.04491615295410156}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29883.61240126554, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29608.196005397098, -29630.701973640647, -29775.041667033176, -29841.00907835013, -29955.528989663177, -29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41525635535614, "mean_inference_ms": 0.24989461834522989, "mean_action_processing_ms": 0.05920401832128297, "mean_env_wait_ms": 1.4824283743065712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024847984313964844, "StateBufferConnector_ms": 0.0017375946044921875, "ViewRequirementAgentConnector_ms": 0.04491615295410156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220680, "num_agent_steps_trained": 220680, "num_env_steps_sampled": 220680, "num_env_steps_trained": 220680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.47393380164053, "num_env_steps_trained_throughput_per_sec": 161.47393380164053, "timesteps_total": 220680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 220680, "timers": {"training_iteration_time_ms": 2236.509, "sample_time_ms": 2231.272, "load_time_ms": 0.216, "load_throughput": 1669743.935, "learn_time_ms": 4.481, "learn_throughput": 80346.803, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 220680, "num_env_steps_trained": 220680, "num_agent_steps_sampled": 220680, "num_agent_steps_trained": 220680}, "done": false, "episodes_total": 613, "training_iteration": 123, "trial_id": "a960d_00000", "date": "2023-07-25_16-12-35", "timestamp": 1690290755, "time_this_iter_s": 11.149394989013672, "time_total_s": 1376.5726292133331, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 536.6933772563934, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.9375, "ram_util_percent": 79.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -4779892462933.333, "vf_loss": 2478238037.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 731.0, "diff_num_grad_updates_vs_sampler_policy": 730.0}}, "num_env_steps_sampled": 222480, "num_env_steps_trained": 222480, "num_agent_steps_sampled": 222480, "num_agent_steps_trained": 222480}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29893.238333429257, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415094099001076, "mean_inference_ms": 0.24986083924530234, "mean_action_processing_ms": 0.059198848816504716, "mean_env_wait_ms": 1.4816328920933948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024895668029785156, "StateBufferConnector_ms": 0.0017249584197998047, "ViewRequirementAgentConnector_ms": 0.04495382308959961}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29893.238333429257, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29963.548646547406, -30005.713177196576, -30022.980248079133, -29909.34041516828, -30015.370795432736, -29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415094099001076, "mean_inference_ms": 0.24986083924530234, "mean_action_processing_ms": 0.059198848816504716, "mean_env_wait_ms": 1.4816328920933948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024895668029785156, "StateBufferConnector_ms": 0.0017249584197998047, "ViewRequirementAgentConnector_ms": 0.04495382308959961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222480, "num_agent_steps_trained": 222480, "num_env_steps_sampled": 222480, "num_env_steps_trained": 222480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.00799475067936, "num_env_steps_trained_throughput_per_sec": 162.00799475067936, "timesteps_total": 222480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 222480, "timers": {"training_iteration_time_ms": 2225.778, "sample_time_ms": 2220.55, "load_time_ms": 0.216, "load_throughput": 1670482.841, "learn_time_ms": 4.464, "learn_throughput": 80649.353, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 222480, "num_env_steps_trained": 222480, "num_agent_steps_sampled": 222480, "num_agent_steps_trained": 222480}, "done": false, "episodes_total": 618, "training_iteration": 124, "trial_id": "a960d_00000", "date": "2023-07-25_16-12-47", "timestamp": 1690290767, "time_this_iter_s": 11.11256217956543, "time_total_s": 1387.6851913928986, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 547.8059394359589, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 24.69375, "ram_util_percent": 79.73124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -3010442561194.6665, "vf_loss": 2501733461.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 746.0, "diff_num_grad_updates_vs_sampler_policy": 745.0}}, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29889.119015205073, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414947777530113, "mean_inference_ms": 0.24982676996405928, "mean_action_processing_ms": 0.059193508180105575, "mean_env_wait_ms": 1.4808997526641994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024907588958740234, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.04491114616394043}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29889.119015205073, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29793.849537632166, -29995.616848108653, -29786.63834174492, -29727.833056931646, -30047.073009344775, -30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414947777530113, "mean_inference_ms": 0.24982676996405928, "mean_action_processing_ms": 0.059193508180105575, "mean_env_wait_ms": 1.4808997526641994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024907588958740234, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.04491114616394043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.11406401939783, "num_env_steps_trained_throughput_per_sec": 161.11406401939783, "timesteps_total": 224280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 224280, "timers": {"training_iteration_time_ms": 2228.268, "sample_time_ms": 2222.92, "load_time_ms": 0.221, "load_throughput": 1632554.265, "learn_time_ms": 4.569, "learn_throughput": 78799.568, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "done": false, "episodes_total": 623, "training_iteration": 125, "trial_id": "a960d_00000", "date": "2023-07-25_16-12-58", "timestamp": 1690290778, "time_this_iter_s": 11.174338102340698, "time_total_s": 1398.8595294952393, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 558.9802775382996, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 22.98125, "ram_util_percent": 79.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -2537219014656.0, "vf_loss": 2475493397.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 761.0, "diff_num_grad_updates_vs_sampler_policy": 760.0}}, "num_env_steps_sampled": 226080, "num_env_steps_trained": 226080, "num_agent_steps_sampled": 226080, "num_agent_steps_trained": 226080}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29887.22487629977, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4148024801872126, "mean_inference_ms": 0.24980215431084843, "mean_action_processing_ms": 0.059189370347001675, "mean_env_wait_ms": 1.4802246902464065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025153160095214844, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.045531272888183594}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29887.22487629977, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30095.01580646582, -29896.821700443154, -29824.723006651468, -29944.422094880738, -29979.81865623112, -29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4148024801872126, "mean_inference_ms": 0.24980215431084843, "mean_action_processing_ms": 0.059189370347001675, "mean_env_wait_ms": 1.4802246902464065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025153160095214844, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.045531272888183594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226080, "num_agent_steps_trained": 226080, "num_env_steps_sampled": 226080, "num_env_steps_trained": 226080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.9336733673734, "num_env_steps_trained_throughput_per_sec": 160.9336733673734, "timesteps_total": 226080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 226080, "timers": {"training_iteration_time_ms": 2235.684, "sample_time_ms": 2230.351, "load_time_ms": 0.223, "load_throughput": 1610784.553, "learn_time_ms": 4.565, "learn_throughput": 78861.301, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 226080, "num_env_steps_trained": 226080, "num_agent_steps_sampled": 226080, "num_agent_steps_trained": 226080}, "done": false, "episodes_total": 628, "training_iteration": 126, "trial_id": "a960d_00000", "date": "2023-07-25_16-13-09", "timestamp": 1690290789, "time_this_iter_s": 11.186664819717407, "time_total_s": 1410.0461943149567, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 570.166942358017, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 25.818749999999998, "ram_util_percent": 78.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -2357652560554.6665, "vf_loss": 2464707072.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 776.0, "diff_num_grad_updates_vs_sampler_policy": 775.0}}, "num_env_steps_sampled": 227880, "num_env_steps_trained": 227880, "num_agent_steps_sampled": 227880, "num_agent_steps_trained": 227880}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29884.691613351955, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41472153423711, "mean_inference_ms": 0.24978324044988306, "mean_action_processing_ms": 0.059186231312106194, "mean_env_wait_ms": 1.4795869111140991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025174617767333984, "StateBufferConnector_ms": 0.0017347335815429688, "ViewRequirementAgentConnector_ms": 0.045502424240112305}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29884.691613351955, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29865.80750368644, -29820.927295969585, -29742.85783042236, -29769.727518484986, -30009.422638357, -29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41472153423711, "mean_inference_ms": 0.24978324044988306, "mean_action_processing_ms": 0.059186231312106194, "mean_env_wait_ms": 1.4795869111140991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025174617767333984, "StateBufferConnector_ms": 0.0017347335815429688, "ViewRequirementAgentConnector_ms": 0.045502424240112305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227880, "num_agent_steps_trained": 227880, "num_env_steps_sampled": 227880, "num_env_steps_trained": 227880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.16178010277855, "num_env_steps_trained_throughput_per_sec": 161.16178010277855, "timesteps_total": 227880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 227880, "timers": {"training_iteration_time_ms": 2235.353, "sample_time_ms": 2229.981, "load_time_ms": 0.231, "load_throughput": 1558255.356, "learn_time_ms": 4.598, "learn_throughput": 78300.635, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 227880, "num_env_steps_trained": 227880, "num_agent_steps_sampled": 227880, "num_agent_steps_trained": 227880}, "done": false, "episodes_total": 633, "training_iteration": 127, "trial_id": "a960d_00000", "date": "2023-07-25_16-13-20", "timestamp": 1690290800, "time_this_iter_s": 11.171046018600464, "time_total_s": 1421.2172403335571, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 581.3379883766174, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 35.6125, "ram_util_percent": 79.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -2414631709354.6665, "vf_loss": 2518032490.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 791.0, "diff_num_grad_updates_vs_sampler_policy": 790.0}}, "num_env_steps_sampled": 229680, "num_env_steps_trained": 229680, "num_agent_steps_sampled": 229680, "num_agent_steps_trained": 229680}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29893.896011838286, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4147065829431815, "mean_inference_ms": 0.2497641536753702, "mean_action_processing_ms": 0.05918290151511064, "mean_env_wait_ms": 1.4789520367682873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519369125366211, "StateBufferConnector_ms": 0.0017273426055908203, "ViewRequirementAgentConnector_ms": 0.04547572135925293}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29893.896011838286, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29938.80467380298, -29665.51152654036, -30153.451513455642, -29820.201134335133, -29761.004390788094, -29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4147065829431815, "mean_inference_ms": 0.2497641536753702, "mean_action_processing_ms": 0.05918290151511064, "mean_env_wait_ms": 1.4789520367682873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519369125366211, "StateBufferConnector_ms": 0.0017273426055908203, "ViewRequirementAgentConnector_ms": 0.04547572135925293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229680, "num_agent_steps_trained": 229680, "num_env_steps_sampled": 229680, "num_env_steps_trained": 229680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.30984734300003, "num_env_steps_trained_throughput_per_sec": 161.30984734300003, "timesteps_total": 229680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 229680, "timers": {"training_iteration_time_ms": 2232.745, "sample_time_ms": 2227.169, "load_time_ms": 0.239, "load_throughput": 1503185.107, "learn_time_ms": 4.772, "learn_throughput": 75445.038, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 229680, "num_env_steps_trained": 229680, "num_agent_steps_sampled": 229680, "num_agent_steps_trained": 229680}, "done": false, "episodes_total": 638, "training_iteration": 128, "trial_id": "a960d_00000", "date": "2023-07-25_16-13-31", "timestamp": 1690290811, "time_this_iter_s": 11.160778045654297, "time_total_s": 1432.3780183792114, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 592.4987664222717, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 25.799999999999997, "ram_util_percent": 79.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -3683704755541.3335, "vf_loss": 2466959680.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 806.0, "diff_num_grad_updates_vs_sampler_policy": 805.0}}, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29891.769687346998, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414800540447386, "mean_inference_ms": 0.24974549089713885, "mean_action_processing_ms": 0.05917974890496998, "mean_env_wait_ms": 1.478327724987745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025014877319335938, "StateBufferConnector_ms": 0.0017249584197998047, "ViewRequirementAgentConnector_ms": 0.04536724090576172}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29891.769687346998, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29710.2212020606, -29874.533854489946, -29781.12581226828, -29988.738242663094, -30072.771991262587, -29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414800540447386, "mean_inference_ms": 0.24974549089713885, "mean_action_processing_ms": 0.05917974890496998, "mean_env_wait_ms": 1.478327724987745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025014877319335938, "StateBufferConnector_ms": 0.0017249584197998047, "ViewRequirementAgentConnector_ms": 0.04536724090576172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.12263816035428, "num_env_steps_trained_throughput_per_sec": 158.12263816035428, "timesteps_total": 231480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 231480, "timers": {"training_iteration_time_ms": 2254.212, "sample_time_ms": 2248.737, "load_time_ms": 0.231, "load_throughput": 1560509.963, "learn_time_ms": 4.684, "learn_throughput": 76855.509, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "done": false, "episodes_total": 643, "training_iteration": 129, "trial_id": "a960d_00000", "date": "2023-07-25_16-13-43", "timestamp": 1690290823, "time_this_iter_s": 11.385646104812622, "time_total_s": 1443.763664484024, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 603.8844125270844, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 26.5375, "ram_util_percent": 78.16874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -3279541725866.6665, "vf_loss": 2504200085.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 821.0, "diff_num_grad_updates_vs_sampler_policy": 820.0}}, "num_env_steps_sampled": 233280, "num_env_steps_trained": 233280, "num_agent_steps_sampled": 233280, "num_agent_steps_trained": 233280}, "sampler_results": {"episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29893.40712902519, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414951593241259, "mean_inference_ms": 0.24972908156652168, "mean_action_processing_ms": 0.05917686730614084, "mean_env_wait_ms": 1.4777045593416351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024967193603515625, "StateBufferConnector_ms": 0.0017123222351074219, "ViewRequirementAgentConnector_ms": 0.04531240463256836}}, "episode_reward_max": -29575.693395109574, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29893.40712902519, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29928.151666575228, -29963.40900264323, -29984.223390810384, -29959.997762340423, -29575.693395109574, -29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414951593241259, "mean_inference_ms": 0.24972908156652168, "mean_action_processing_ms": 0.05917686730614084, "mean_env_wait_ms": 1.4777045593416351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024967193603515625, "StateBufferConnector_ms": 0.0017123222351074219, "ViewRequirementAgentConnector_ms": 0.04531240463256836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233280, "num_agent_steps_trained": 233280, "num_env_steps_sampled": 233280, "num_env_steps_trained": 233280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.9822060089825, "num_env_steps_trained_throughput_per_sec": 160.9822060089825, "timesteps_total": 233280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 233280, "timers": {"training_iteration_time_ms": 2256.483, "sample_time_ms": 2251.202, "load_time_ms": 0.224, "load_throughput": 1607697.445, "learn_time_ms": 4.503, "learn_throughput": 79939.299, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 233280, "num_env_steps_trained": 233280, "num_agent_steps_sampled": 233280, "num_agent_steps_trained": 233280}, "done": false, "episodes_total": 648, "training_iteration": 130, "trial_id": "a960d_00000", "date": "2023-07-25_16-13-54", "timestamp": 1690290834, "time_this_iter_s": 11.18355417251587, "time_total_s": 1454.94721865654, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 615.0679666996002, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 24.35, "ram_util_percent": 78.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -2211839092736.0, "vf_loss": 2469769536.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 836.0, "diff_num_grad_updates_vs_sampler_policy": 835.0}}, "num_env_steps_sampled": 235080, "num_env_steps_trained": 235080, "num_agent_steps_sampled": 235080, "num_agent_steps_trained": 235080}, "sampler_results": {"episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29891.668383703767, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415159944659466, "mean_inference_ms": 0.24971257514626402, "mean_action_processing_ms": 0.05917365907476133, "mean_env_wait_ms": 1.4771285544086696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496480941772461, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.0452723503112793}}, "episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29891.668383703767, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29921.876483966447, -29779.06429467824, -30270.975091070046, -29999.237549803816, -29893.35640685157, -30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415159944659466, "mean_inference_ms": 0.24971257514626402, "mean_action_processing_ms": 0.05917365907476133, "mean_env_wait_ms": 1.4771285544086696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496480941772461, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.0452723503112793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235080, "num_agent_steps_trained": 235080, "num_env_steps_sampled": 235080, "num_env_steps_trained": 235080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.8430834598112, "num_env_steps_trained_throughput_per_sec": 159.8430834598112, "timesteps_total": 235080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 235080, "timers": {"training_iteration_time_ms": 2244.231, "sample_time_ms": 2238.877, "load_time_ms": 0.229, "load_throughput": 1569104.687, "learn_time_ms": 4.545, "learn_throughput": 79204.23, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 235080, "num_env_steps_trained": 235080, "num_agent_steps_sampled": 235080, "num_agent_steps_trained": 235080}, "done": false, "episodes_total": 653, "training_iteration": 131, "trial_id": "a960d_00000", "date": "2023-07-25_16-14-05", "timestamp": 1690290845, "time_this_iter_s": 11.263210773468018, "time_total_s": 1466.210429430008, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 626.3311774730682, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 25.4375, "ram_util_percent": 78.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -4711985905664.0, "vf_loss": 2507676629.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 851.0, "diff_num_grad_updates_vs_sampler_policy": 850.0}}, "num_env_steps_sampled": 236880, "num_env_steps_trained": 236880, "num_agent_steps_sampled": 236880, "num_agent_steps_trained": 236880}, "sampler_results": {"episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29888.785068857134, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415417776126135, "mean_inference_ms": 0.24969181334773652, "mean_action_processing_ms": 0.05916967446737095, "mean_env_wait_ms": 1.4765954542159545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.04527783393859863}}, "episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29888.785068857134, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30065.54756622546, -29887.648916951028, -30227.490425610355, -29866.52094003497, -29851.564977618495, -30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415417776126135, "mean_inference_ms": 0.24969181334773652, "mean_action_processing_ms": 0.05916967446737095, "mean_env_wait_ms": 1.4765954542159545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.04527783393859863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236880, "num_agent_steps_trained": 236880, "num_env_steps_sampled": 236880, "num_env_steps_trained": 236880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.79294576236128, "num_env_steps_trained_throughput_per_sec": 160.79294576236128, "timesteps_total": 236880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 236880, "timers": {"training_iteration_time_ms": 2245.547, "sample_time_ms": 2240.186, "load_time_ms": 0.226, "load_throughput": 1590592.479, "learn_time_ms": 4.563, "learn_throughput": 78886.845, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 236880, "num_env_steps_trained": 236880, "num_agent_steps_sampled": 236880, "num_agent_steps_trained": 236880}, "done": false, "episodes_total": 658, "training_iteration": 132, "trial_id": "a960d_00000", "date": "2023-07-25_16-14-16", "timestamp": 1690290856, "time_this_iter_s": 11.196659088134766, "time_total_s": 1477.4070885181427, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 637.527836561203, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 24.6875, "ram_util_percent": 78.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -1588154615125.3333, "vf_loss": 2498754069.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 866.0, "diff_num_grad_updates_vs_sampler_policy": 865.0}}, "num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680}, "sampler_results": {"episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29880.54198345269, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41568240025079, "mean_inference_ms": 0.24967744506991651, "mean_action_processing_ms": 0.05916649925046914, "mean_env_wait_ms": 1.4761168744433064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.04543018341064453}}, "episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29880.54198345269, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30078.25715740086, -29793.08434007858, -29928.57044656255, -29995.679242740563, -29824.13377961663, -30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41568240025079, "mean_inference_ms": 0.24967744506991651, "mean_action_processing_ms": 0.05916649925046914, "mean_env_wait_ms": 1.4761168744433064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.04543018341064453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680, "num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.35304508522486, "num_env_steps_trained_throughput_per_sec": 160.35304508522486, "timesteps_total": 238680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 238680, "timers": {"training_iteration_time_ms": 2241.96, "sample_time_ms": 2236.585, "load_time_ms": 0.233, "load_throughput": 1544547.3, "learn_time_ms": 4.575, "learn_throughput": 78687.462, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680}, "done": false, "episodes_total": 663, "training_iteration": 133, "trial_id": "a960d_00000", "date": "2023-07-25_16-14-28", "timestamp": 1690290868, "time_this_iter_s": 11.227340936660767, "time_total_s": 1488.6344294548035, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 648.7551774978638, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 25.075, "ram_util_percent": 78.50625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -1185850069674.6667, "vf_loss": 2524454101.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 881.0, "diff_num_grad_updates_vs_sampler_policy": 880.0}}, "num_env_steps_sampled": 240480, "num_env_steps_trained": 240480, "num_agent_steps_sampled": 240480, "num_agent_steps_trained": 240480}, "sampler_results": {"episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29881.22728432536, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415868971187899, "mean_inference_ms": 0.24965463310172667, "mean_action_processing_ms": 0.0591621453852831, "mean_env_wait_ms": 1.475631648957654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024919509887695312, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04535174369812012}}, "episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29881.22728432536, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30076.200990973135, -29967.326952678573, -29881.4037883489, -29949.837535432907, -29868.703430070007, -29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415868971187899, "mean_inference_ms": 0.24965463310172667, "mean_action_processing_ms": 0.0591621453852831, "mean_env_wait_ms": 1.475631648957654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024919509887695312, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04535174369812012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240480, "num_agent_steps_trained": 240480, "num_env_steps_sampled": 240480, "num_env_steps_trained": 240480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.68408848409237, "num_env_steps_trained_throughput_per_sec": 160.68408848409237, "timesteps_total": 240480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 240480, "timers": {"training_iteration_time_ms": 2242.718, "sample_time_ms": 2237.249, "load_time_ms": 0.232, "load_throughput": 1554565.469, "learn_time_ms": 4.654, "learn_throughput": 77353.571, "synch_weights_time_ms": 0.55}, "counters": {"num_env_steps_sampled": 240480, "num_env_steps_trained": 240480, "num_agent_steps_sampled": 240480, "num_agent_steps_trained": 240480}, "done": false, "episodes_total": 668, "training_iteration": 134, "trial_id": "a960d_00000", "date": "2023-07-25_16-14-39", "timestamp": 1690290879, "time_this_iter_s": 11.204140901565552, "time_total_s": 1499.838570356369, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 659.9593183994293, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 25.2125, "ram_util_percent": 78.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -2661227850410.6665, "vf_loss": 2490635797.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 896.0, "diff_num_grad_updates_vs_sampler_policy": 895.0}}, "num_env_steps_sampled": 242280, "num_env_steps_trained": 242280, "num_agent_steps_sampled": 242280, "num_agent_steps_trained": 242280}, "sampler_results": {"episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29877.178887016955, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416095053139237, "mean_inference_ms": 0.24963578968725927, "mean_action_processing_ms": 0.05915838585135344, "mean_env_wait_ms": 1.4751918163604734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024967193603515625, "StateBufferConnector_ms": 0.0017251968383789062, "ViewRequirementAgentConnector_ms": 0.045372724533081055}}, "episode_reward_max": -29587.152882324364, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29877.178887016955, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29918.282956834293, -30006.77310013857, -29841.506967715348, -29769.609865254162, -29823.798143252774, -29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416095053139237, "mean_inference_ms": 0.24963578968725927, "mean_action_processing_ms": 0.05915838585135344, "mean_env_wait_ms": 1.4751918163604734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024967193603515625, "StateBufferConnector_ms": 0.0017251968383789062, "ViewRequirementAgentConnector_ms": 0.045372724533081055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242280, "num_agent_steps_trained": 242280, "num_env_steps_sampled": 242280, "num_env_steps_trained": 242280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.72927287784833, "num_env_steps_trained_throughput_per_sec": 159.72927287784833, "timesteps_total": 242280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 242280, "timers": {"training_iteration_time_ms": 2247.104, "sample_time_ms": 2241.669, "load_time_ms": 0.221, "load_throughput": 1627451.433, "learn_time_ms": 4.573, "learn_throughput": 78719.049, "synch_weights_time_ms": 0.603}, "counters": {"num_env_steps_sampled": 242280, "num_env_steps_trained": 242280, "num_agent_steps_sampled": 242280, "num_agent_steps_trained": 242280}, "done": false, "episodes_total": 673, "training_iteration": 135, "trial_id": "a960d_00000", "date": "2023-07-25_16-14-50", "timestamp": 1690290890, "time_this_iter_s": 11.271108150482178, "time_total_s": 1511.1096785068512, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 671.2304265499115, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 28.31875, "ram_util_percent": 78.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -2201047225685.3335, "vf_loss": 2484324053.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 911.0, "diff_num_grad_updates_vs_sampler_policy": 910.0}}, "num_env_steps_sampled": 244080, "num_env_steps_trained": 244080, "num_agent_steps_sampled": 244080, "num_agent_steps_trained": 244080}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29875.219706824002, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416301422621213, "mean_inference_ms": 0.24962041363455206, "mean_action_processing_ms": 0.05915521275450853, "mean_env_wait_ms": 1.4747531962750855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04543185234069824}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29875.219706824002, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29856.297432094663, -29889.3988048295, -29763.913475295147, -29742.405925150335, -29929.722059618845, -29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416301422621213, "mean_inference_ms": 0.24962041363455206, "mean_action_processing_ms": 0.05915521275450853, "mean_env_wait_ms": 1.4747531962750855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04543185234069824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244080, "num_agent_steps_trained": 244080, "num_env_steps_sampled": 244080, "num_env_steps_trained": 244080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.24576283204712, "num_env_steps_trained_throughput_per_sec": 161.24576283204712, "timesteps_total": 244080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 244080, "timers": {"training_iteration_time_ms": 2243.203, "sample_time_ms": 2237.859, "load_time_ms": 0.222, "load_throughput": 1619422.394, "learn_time_ms": 4.495, "learn_throughput": 80097.045, "synch_weights_time_ms": 0.589}, "counters": {"num_env_steps_sampled": 244080, "num_env_steps_trained": 244080, "num_agent_steps_sampled": 244080, "num_agent_steps_trained": 244080}, "done": false, "episodes_total": 678, "training_iteration": 136, "trial_id": "a960d_00000", "date": "2023-07-25_16-15-01", "timestamp": 1690290901, "time_this_iter_s": 11.165151119232178, "time_total_s": 1522.2748296260834, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 682.3955776691437, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 26.40625, "ram_util_percent": 78.53125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284830729167, "policy_loss": -1615320905728.0, "vf_loss": 2448645610.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 926.0, "diff_num_grad_updates_vs_sampler_policy": 925.0}}, "num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29877.29638919181, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416436532131337, "mean_inference_ms": 0.24961115693607072, "mean_action_processing_ms": 0.059152949154839866, "mean_env_wait_ms": 1.4743381656352732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025086402893066406, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.045496463775634766}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29877.29638919181, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29813.09332453046, -30004.036218914367, -29935.3001565707, -29612.92480724958, -29952.10897351319, -29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416436532131337, "mean_inference_ms": 0.24961115693607072, "mean_action_processing_ms": 0.059152949154839866, "mean_env_wait_ms": 1.4743381656352732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025086402893066406, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.045496463775634766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880, "num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.97839247948588, "num_env_steps_trained_throughput_per_sec": 160.97839247948588, "timesteps_total": 245880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 245880, "timers": {"training_iteration_time_ms": 2234.462, "sample_time_ms": 2229.272, "load_time_ms": 0.217, "load_throughput": 1656372.795, "learn_time_ms": 4.441, "learn_throughput": 81062.406, "synch_weights_time_ms": 0.501}, "counters": {"num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880}, "done": false, "episodes_total": 683, "training_iteration": 137, "trial_id": "a960d_00000", "date": "2023-07-25_16-15-13", "timestamp": 1690290913, "time_this_iter_s": 11.18378496170044, "time_total_s": 1533.4586145877838, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 693.5793626308441, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 26.446666666666665, "ram_util_percent": 78.44000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284830729167, "policy_loss": -3867052675072.0, "vf_loss": 2448506752.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 941.0, "diff_num_grad_updates_vs_sampler_policy": 940.0}}, "num_env_steps_sampled": 247680, "num_env_steps_trained": 247680, "num_agent_steps_sampled": 247680, "num_agent_steps_trained": 247680}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29878.242466277556, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416560469212713, "mean_inference_ms": 0.24960502262079842, "mean_action_processing_ms": 0.05915122626060551, "mean_env_wait_ms": 1.4739594034959103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017194747924804688, "ViewRequirementAgentConnector_ms": 0.045528411865234375}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29878.242466277556, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29939.51864060132, -29753.007858298963, -29861.39703234289, -29789.0956324031, -29956.843745339676, -29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416560469212713, "mean_inference_ms": 0.24960502262079842, "mean_action_processing_ms": 0.05915122626060551, "mean_env_wait_ms": 1.4739594034959103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017194747924804688, "ViewRequirementAgentConnector_ms": 0.045528411865234375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247680, "num_agent_steps_trained": 247680, "num_env_steps_sampled": 247680, "num_env_steps_trained": 247680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.34733031870257, "num_env_steps_trained_throughput_per_sec": 160.34733031870257, "timesteps_total": 247680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 247680, "timers": {"training_iteration_time_ms": 2240.717, "sample_time_ms": 2235.525, "load_time_ms": 0.217, "load_throughput": 1660927.775, "learn_time_ms": 4.451, "learn_throughput": 80889.571, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 247680, "num_env_steps_trained": 247680, "num_agent_steps_sampled": 247680, "num_agent_steps_trained": 247680}, "done": false, "episodes_total": 688, "training_iteration": 138, "trial_id": "a960d_00000", "date": "2023-07-25_16-15-24", "timestamp": 1690290924, "time_this_iter_s": 11.227720975875854, "time_total_s": 1544.6863355636597, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 704.80708360672, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 27.143749999999997, "ram_util_percent": 78.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -4994989969408.0, "vf_loss": 2492457749.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 956.0, "diff_num_grad_updates_vs_sampler_policy": 955.0}}, "num_env_steps_sampled": 249480, "num_env_steps_trained": 249480, "num_agent_steps_sampled": 249480, "num_agent_steps_trained": 249480}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29878.890043368134, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41670095482557, "mean_inference_ms": 0.2495960348214965, "mean_action_processing_ms": 0.059148987071927284, "mean_env_wait_ms": 1.4735882543461671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025086402893066406, "StateBufferConnector_ms": 0.0017194747924804688, "ViewRequirementAgentConnector_ms": 0.04560995101928711}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29878.890043368134, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29835.14638345779, -29628.14542711562, -29835.88128171453, -29939.053062470943, -30115.12460510148, -29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41670095482557, "mean_inference_ms": 0.2495960348214965, "mean_action_processing_ms": 0.059148987071927284, "mean_env_wait_ms": 1.4735882543461671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025086402893066406, "StateBufferConnector_ms": 0.0017194747924804688, "ViewRequirementAgentConnector_ms": 0.04560995101928711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249480, "num_agent_steps_trained": 249480, "num_env_steps_sampled": 249480, "num_env_steps_trained": 249480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.8502792113462, "num_env_steps_trained_throughput_per_sec": 160.8502792113462, "timesteps_total": 249480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 249480, "timers": {"training_iteration_time_ms": 2241.607, "sample_time_ms": 2236.358, "load_time_ms": 0.216, "load_throughput": 1663306.279, "learn_time_ms": 4.501, "learn_throughput": 79986.303, "synch_weights_time_ms": 0.501}, "counters": {"num_env_steps_sampled": 249480, "num_env_steps_trained": 249480, "num_agent_steps_sampled": 249480, "num_agent_steps_trained": 249480}, "done": false, "episodes_total": 693, "training_iteration": 139, "trial_id": "a960d_00000", "date": "2023-07-25_16-15-35", "timestamp": 1690290935, "time_this_iter_s": 11.192621946334839, "time_total_s": 1555.8789575099945, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 715.9997055530548, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 26.706249999999997, "ram_util_percent": 78.30625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -1834989715456.0, "vf_loss": 2451720234.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 971.0, "diff_num_grad_updates_vs_sampler_policy": 970.0}}, "num_env_steps_sampled": 251280, "num_env_steps_trained": 251280, "num_agent_steps_sampled": 251280, "num_agent_steps_trained": 251280}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29874.389115855658, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416878506030991, "mean_inference_ms": 0.24958928732465202, "mean_action_processing_ms": 0.059147069356391226, "mean_env_wait_ms": 1.4732458725484165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025098323822021484, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.045560598373413086}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30276.51995271732, "episode_reward_mean": -29874.389115855658, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29612.83322873432, -29852.382304439045, -30276.51995271732, -29770.912604113197, -29587.152882324364, -29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416878506030991, "mean_inference_ms": 0.24958928732465202, "mean_action_processing_ms": 0.059147069356391226, "mean_env_wait_ms": 1.4732458725484165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025098323822021484, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.045560598373413086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251280, "num_agent_steps_trained": 251280, "num_env_steps_sampled": 251280, "num_env_steps_trained": 251280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.0745722293164, "num_env_steps_trained_throughput_per_sec": 160.0745722293164, "timesteps_total": 251280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 251280, "timers": {"training_iteration_time_ms": 2243.519, "sample_time_ms": 2238.134, "load_time_ms": 0.222, "load_throughput": 1622729.113, "learn_time_ms": 4.609, "learn_throughput": 78115.109, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 251280, "num_env_steps_trained": 251280, "num_agent_steps_sampled": 251280, "num_agent_steps_trained": 251280}, "done": false, "episodes_total": 698, "training_iteration": 140, "trial_id": "a960d_00000", "date": "2023-07-25_16-15-46", "timestamp": 1690290946, "time_this_iter_s": 11.246849060058594, "time_total_s": 1567.125806570053, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 727.2465546131134, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 27.025000000000002, "ram_util_percent": 78.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -1996706023424.0, "vf_loss": 2507978837.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 986.0, "diff_num_grad_updates_vs_sampler_policy": 985.0}}, "num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30254.20701990135, "episode_reward_mean": -29879.67861343847, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41703885968951, "mean_inference_ms": 0.24958055951497143, "mean_action_processing_ms": 0.05914492580290136, "mean_env_wait_ms": 1.472908409692466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001707315444946289, "ViewRequirementAgentConnector_ms": 0.04547309875488281}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30254.20701990135, "episode_reward_mean": -29879.67861343847, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29747.453953250028, -30007.105107842457, -29797.732459913914, -29723.96183562133, -29625.29292075239, -29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41703885968951, "mean_inference_ms": 0.24958055951497143, "mean_action_processing_ms": 0.05914492580290136, "mean_env_wait_ms": 1.472908409692466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001707315444946289, "ViewRequirementAgentConnector_ms": 0.04547309875488281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080, "num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.81199185569685, "num_env_steps_trained_throughput_per_sec": 160.81199185569685, "timesteps_total": 253080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 253080, "timers": {"training_iteration_time_ms": 2243.785, "sample_time_ms": 2238.314, "load_time_ms": 0.225, "load_throughput": 1600540.004, "learn_time_ms": 4.674, "learn_throughput": 77017.803, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080}, "done": false, "episodes_total": 703, "training_iteration": 141, "trial_id": "a960d_00000", "date": "2023-07-25_16-15-58", "timestamp": 1690290958, "time_this_iter_s": 11.19543719291687, "time_total_s": 1578.32124376297, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 738.4419918060303, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 26.2125, "ram_util_percent": 78.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -1712869941589.3333, "vf_loss": 2512376704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1001.0, "diff_num_grad_updates_vs_sampler_policy": 1000.0}}, "num_env_steps_sampled": 254880, "num_env_steps_trained": 254880, "num_agent_steps_sampled": 254880, "num_agent_steps_trained": 254880}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30254.20701990135, "episode_reward_mean": -29880.234844752442, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417189068197164, "mean_inference_ms": 0.24957755724840805, "mean_action_processing_ms": 0.05914363491692193, "mean_env_wait_ms": 1.4725956477776623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0016980171203613281, "ViewRequirementAgentConnector_ms": 0.04533696174621582}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30254.20701990135, "episode_reward_mean": -29880.234844752442, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29974.222942322376, -29918.110932059768, -29909.646481518685, -29949.41967573963, -29763.80124767544, -30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417189068197164, "mean_inference_ms": 0.24957755724840805, "mean_action_processing_ms": 0.05914363491692193, "mean_env_wait_ms": 1.4725956477776623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0016980171203613281, "ViewRequirementAgentConnector_ms": 0.04533696174621582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254880, "num_agent_steps_trained": 254880, "num_env_steps_sampled": 254880, "num_env_steps_trained": 254880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.86366878018455, "num_env_steps_trained_throughput_per_sec": 159.86366878018455, "timesteps_total": 254880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 254880, "timers": {"training_iteration_time_ms": 2245.269, "sample_time_ms": 2239.9, "load_time_ms": 0.218, "load_throughput": 1648956.47, "learn_time_ms": 4.597, "learn_throughput": 78317.692, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 254880, "num_env_steps_trained": 254880, "num_agent_steps_sampled": 254880, "num_agent_steps_trained": 254880}, "done": false, "episodes_total": 708, "training_iteration": 142, "trial_id": "a960d_00000", "date": "2023-07-25_16-16-09", "timestamp": 1690290969, "time_this_iter_s": 11.261637926101685, "time_total_s": 1589.5828816890717, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 749.703629732132, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 25.3375, "ram_util_percent": 78.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5279134114583, "policy_loss": -2031115180373.3333, "vf_loss": 2511563925.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1016.0, "diff_num_grad_updates_vs_sampler_policy": 1015.0}}, "num_env_steps_sampled": 256680, "num_env_steps_trained": 256680, "num_agent_steps_sampled": 256680, "num_agent_steps_trained": 256680}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30254.20701990135, "episode_reward_mean": -29885.512059415214, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417346265844231, "mean_inference_ms": 0.2495778968423781, "mean_action_processing_ms": 0.05914278027967598, "mean_env_wait_ms": 1.4722742151724892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025169849395751953, "StateBufferConnector_ms": 0.0017011165618896484, "ViewRequirementAgentConnector_ms": 0.045302629470825195}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30254.20701990135, "episode_reward_mean": -29885.512059415214, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30254.20701990135, -29906.93886461087, -29978.20085408458, -29788.42839135032, -29845.29580050788, -30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417346265844231, "mean_inference_ms": 0.2495778968423781, "mean_action_processing_ms": 0.05914278027967598, "mean_env_wait_ms": 1.4722742151724892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025169849395751953, "StateBufferConnector_ms": 0.0017011165618896484, "ViewRequirementAgentConnector_ms": 0.045302629470825195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256680, "num_agent_steps_trained": 256680, "num_env_steps_sampled": 256680, "num_env_steps_trained": 256680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.94069708988616, "num_env_steps_trained_throughput_per_sec": 161.94069708988616, "timesteps_total": 256680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 256680, "timers": {"training_iteration_time_ms": 2237.468, "sample_time_ms": 2232.044, "load_time_ms": 0.214, "load_throughput": 1679401.001, "learn_time_ms": 4.621, "learn_throughput": 77908.346, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 256680, "num_env_steps_trained": 256680, "num_agent_steps_sampled": 256680, "num_agent_steps_trained": 256680}, "done": false, "episodes_total": 713, "training_iteration": 143, "trial_id": "a960d_00000", "date": "2023-07-25_16-16-20", "timestamp": 1690290980, "time_this_iter_s": 11.117280960083008, "time_total_s": 1600.7001626491547, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 760.820910692215, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 28.2875, "ram_util_percent": 77.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -924471427072.0, "vf_loss": 2487276842.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1031.0, "diff_num_grad_updates_vs_sampler_policy": 1030.0}}, "num_env_steps_sampled": 258480, "num_env_steps_trained": 258480, "num_agent_steps_sampled": 258480, "num_agent_steps_trained": 258480}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30147.612053542714, "episode_reward_mean": -29885.918837989968, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417509115794717, "mean_inference_ms": 0.24958595885756865, "mean_action_processing_ms": 0.059142981479990475, "mean_env_wait_ms": 1.472003403102613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025184154510498047, "StateBufferConnector_ms": 0.0017066001892089844, "ViewRequirementAgentConnector_ms": 0.04543662071228027}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30147.612053542714, "episode_reward_mean": -29885.918837989968, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30080.149393006774, -29907.03562528812, -29863.441360318997, -29746.730280024032, -29907.66480136848, -29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417509115794717, "mean_inference_ms": 0.24958595885756865, "mean_action_processing_ms": 0.059142981479990475, "mean_env_wait_ms": 1.472003403102613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025184154510498047, "StateBufferConnector_ms": 0.0017066001892089844, "ViewRequirementAgentConnector_ms": 0.04543662071228027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258480, "num_agent_steps_trained": 258480, "num_env_steps_sampled": 258480, "num_env_steps_trained": 258480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.4033887253463, "num_env_steps_trained_throughput_per_sec": 160.4033887253463, "timesteps_total": 258480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 258480, "timers": {"training_iteration_time_ms": 2233.679, "sample_time_ms": 2228.279, "load_time_ms": 0.224, "load_throughput": 1605816.697, "learn_time_ms": 4.59, "learn_throughput": 78434.857, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 258480, "num_env_steps_trained": 258480, "num_agent_steps_sampled": 258480, "num_agent_steps_trained": 258480}, "done": false, "episodes_total": 718, "training_iteration": 144, "trial_id": "a960d_00000", "date": "2023-07-25_16-16-31", "timestamp": 1690290991, "time_this_iter_s": 11.223698377609253, "time_total_s": 1611.923861026764, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 772.0446090698242, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 27.58125, "ram_util_percent": 77.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -1513971508565.3333, "vf_loss": 2494192640.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1046.0, "diff_num_grad_updates_vs_sampler_policy": 1045.0}}, "num_env_steps_sampled": 260280, "num_env_steps_trained": 260280, "num_agent_steps_sampled": 260280, "num_agent_steps_trained": 260280}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30147.612053542714, "episode_reward_mean": -29884.52990189507, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417666784804875, "mean_inference_ms": 0.2495955041896824, "mean_action_processing_ms": 0.05914355385470113, "mean_env_wait_ms": 1.471751282031174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513408660888672, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.045452117919921875}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30147.612053542714, "episode_reward_mean": -29884.52990189507, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29799.465046558333, -29723.272987125412, -30014.172631492675, -29801.357406135867, -29823.328831919393, -29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417666784804875, "mean_inference_ms": 0.2495955041896824, "mean_action_processing_ms": 0.05914355385470113, "mean_env_wait_ms": 1.471751282031174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513408660888672, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.045452117919921875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260280, "num_agent_steps_trained": 260280, "num_env_steps_sampled": 260280, "num_env_steps_trained": 260280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.96906022028597, "num_env_steps_trained_throughput_per_sec": 160.96906022028597, "timesteps_total": 260280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 260280, "timers": {"training_iteration_time_ms": 2240.389, "sample_time_ms": 2235.097, "load_time_ms": 0.23, "load_throughput": 1568452.727, "learn_time_ms": 4.46, "learn_throughput": 80725.67, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 260280, "num_env_steps_trained": 260280, "num_agent_steps_sampled": 260280, "num_agent_steps_trained": 260280}, "done": false, "episodes_total": 723, "training_iteration": 145, "trial_id": "a960d_00000", "date": "2023-07-25_16-16-42", "timestamp": 1690291002, "time_this_iter_s": 11.184353113174438, "time_total_s": 1623.1082141399384, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 783.2289621829987, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.7125, "ram_util_percent": 77.16874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -1336650470741.3333, "vf_loss": 2530550485.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1061.0, "diff_num_grad_updates_vs_sampler_policy": 1060.0}}, "num_env_steps_sampled": 262080, "num_env_steps_trained": 262080, "num_agent_steps_sampled": 262080, "num_agent_steps_trained": 262080}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30147.612053542714, "episode_reward_mean": -29892.120692186243, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417878632058443, "mean_inference_ms": 0.2496028519374905, "mean_action_processing_ms": 0.05914385262981101, "mean_env_wait_ms": 1.471485429554133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002478361129760742, "StateBufferConnector_ms": 0.0016875267028808594, "ViewRequirementAgentConnector_ms": 0.0448153018951416}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30147.612053542714, "episode_reward_mean": -29892.120692186243, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29925.081844830456, -30057.51588838187, -29852.02108768469, -29852.799329058085, -29800.056819935475, -29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417878632058443, "mean_inference_ms": 0.2496028519374905, "mean_action_processing_ms": 0.05914385262981101, "mean_env_wait_ms": 1.471485429554133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002478361129760742, "StateBufferConnector_ms": 0.0016875267028808594, "ViewRequirementAgentConnector_ms": 0.0448153018951416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262080, "num_agent_steps_trained": 262080, "num_env_steps_sampled": 262080, "num_env_steps_trained": 262080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.7797057191008, "num_env_steps_trained_throughput_per_sec": 159.7797057191008, "timesteps_total": 262080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 262080, "timers": {"training_iteration_time_ms": 2244.769, "sample_time_ms": 2239.438, "load_time_ms": 0.227, "load_throughput": 1584583.314, "learn_time_ms": 4.478, "learn_throughput": 80399.853, "synch_weights_time_ms": 0.594}, "counters": {"num_env_steps_sampled": 262080, "num_env_steps_trained": 262080, "num_agent_steps_sampled": 262080, "num_agent_steps_trained": 262080}, "done": false, "episodes_total": 728, "training_iteration": 146, "trial_id": "a960d_00000", "date": "2023-07-25_16-16-54", "timestamp": 1690291014, "time_this_iter_s": 11.267629861831665, "time_total_s": 1634.37584400177, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 794.4965920448303, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 29.793750000000003, "ram_util_percent": 77.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5279134114583, "policy_loss": -1508884198741.3333, "vf_loss": 2537277632.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1076.0, "diff_num_grad_updates_vs_sampler_policy": 1075.0}}, "num_env_steps_sampled": 263880, "num_env_steps_trained": 263880, "num_agent_steps_sampled": 263880, "num_agent_steps_trained": 263880}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30147.612053542714, "episode_reward_mean": -29897.248155007754, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418083363386151, "mean_inference_ms": 0.24961136715209356, "mean_action_processing_ms": 0.05914438744625294, "mean_env_wait_ms": 1.471239039879763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002488851547241211, "StateBufferConnector_ms": 0.0016937255859375, "ViewRequirementAgentConnector_ms": 0.044891357421875}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30147.612053542714, "episode_reward_mean": -29897.248155007754, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29941.32965683405, -29925.728782725975, -30076.49182633619, -30147.612053542714, -30038.020316113612, -29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418083363386151, "mean_inference_ms": 0.24961136715209356, "mean_action_processing_ms": 0.05914438744625294, "mean_env_wait_ms": 1.471239039879763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002488851547241211, "StateBufferConnector_ms": 0.0016937255859375, "ViewRequirementAgentConnector_ms": 0.044891357421875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263880, "num_agent_steps_trained": 263880, "num_env_steps_sampled": 263880, "num_env_steps_trained": 263880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.00336047656543, "num_env_steps_trained_throughput_per_sec": 161.00336047656543, "timesteps_total": 263880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 263880, "timers": {"training_iteration_time_ms": 2244.531, "sample_time_ms": 2239.262, "load_time_ms": 0.222, "load_throughput": 1621161.091, "learn_time_ms": 4.489, "learn_throughput": 80189.777, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 263880, "num_env_steps_trained": 263880, "num_agent_steps_sampled": 263880, "num_agent_steps_trained": 263880}, "done": false, "episodes_total": 733, "training_iteration": 147, "trial_id": "a960d_00000", "date": "2023-07-25_16-17-05", "timestamp": 1690291025, "time_this_iter_s": 11.182007789611816, "time_total_s": 1645.5578517913818, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 805.6785998344421, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 25.475, "ram_util_percent": 78.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -1919553137322.6667, "vf_loss": 2503065920.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1091.0, "diff_num_grad_updates_vs_sampler_policy": 1090.0}}, "num_env_steps_sampled": 265680, "num_env_steps_trained": 265680, "num_agent_steps_sampled": 265680, "num_agent_steps_trained": 265680}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29891.72748444158, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418288173958703, "mean_inference_ms": 0.24962293735036079, "mean_action_processing_ms": 0.059145431197703345, "mean_env_wait_ms": 1.4710209984711256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025064945220947266, "StateBufferConnector_ms": 0.0017056465148925781, "ViewRequirementAgentConnector_ms": 0.045125484466552734}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29891.72748444158, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29613.54035699749, -29825.579752468766, -29955.12349524476, -29927.803217622095, -29804.293967461, -29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418288173958703, "mean_inference_ms": 0.24962293735036079, "mean_action_processing_ms": 0.059145431197703345, "mean_env_wait_ms": 1.4710209984711256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025064945220947266, "StateBufferConnector_ms": 0.0017056465148925781, "ViewRequirementAgentConnector_ms": 0.045125484466552734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265680, "num_agent_steps_trained": 265680, "num_env_steps_sampled": 265680, "num_env_steps_trained": 265680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.4721874745202, "num_env_steps_trained_throughput_per_sec": 160.4721874745202, "timesteps_total": 265680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 265680, "timers": {"training_iteration_time_ms": 2239.669, "sample_time_ms": 2234.413, "load_time_ms": 0.221, "load_throughput": 1627100.69, "learn_time_ms": 4.482, "learn_throughput": 80316.887, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 265680, "num_env_steps_trained": 265680, "num_agent_steps_sampled": 265680, "num_agent_steps_trained": 265680}, "done": false, "episodes_total": 738, "training_iteration": 148, "trial_id": "a960d_00000", "date": "2023-07-25_16-17-16", "timestamp": 1690291036, "time_this_iter_s": 11.218998193740845, "time_total_s": 1656.7768499851227, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 816.897598028183, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 30.36875, "ram_util_percent": 78.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5279947916667, "policy_loss": -1701860917248.0, "vf_loss": 2518726250.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1106.0, "diff_num_grad_updates_vs_sampler_policy": 1105.0}}, "num_env_steps_sampled": 267480, "num_env_steps_trained": 267480, "num_agent_steps_sampled": 267480, "num_agent_steps_trained": 267480}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29895.15431102951, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418367983289418, "mean_inference_ms": 0.24963153899650017, "mean_action_processing_ms": 0.05914591021933131, "mean_env_wait_ms": 1.4708121119543227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.001712799072265625, "ViewRequirementAgentConnector_ms": 0.04516720771789551}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29895.15431102951, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29807.427121512017, -29919.73427193729, -29911.614880867026, -30009.276341577883, -29943.082654670045, -29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418367983289418, "mean_inference_ms": 0.24963153899650017, "mean_action_processing_ms": 0.05914591021933131, "mean_env_wait_ms": 1.4708121119543227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.001712799072265625, "ViewRequirementAgentConnector_ms": 0.04516720771789551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267480, "num_agent_steps_trained": 267480, "num_env_steps_sampled": 267480, "num_env_steps_trained": 267480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.75161742571888, "num_env_steps_trained_throughput_per_sec": 161.75161742571888, "timesteps_total": 267480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 267480, "timers": {"training_iteration_time_ms": 2234.496, "sample_time_ms": 2229.217, "load_time_ms": 0.221, "load_throughput": 1632554.265, "learn_time_ms": 4.503, "learn_throughput": 79941.839, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 267480, "num_env_steps_trained": 267480, "num_agent_steps_sampled": 267480, "num_agent_steps_trained": 267480}, "done": false, "episodes_total": 743, "training_iteration": 149, "trial_id": "a960d_00000", "date": "2023-07-25_16-17-27", "timestamp": 1690291047, "time_this_iter_s": 11.13087010383606, "time_total_s": 1667.9077200889587, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 828.028468132019, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 24.026666666666664, "ram_util_percent": 77.91333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -2777102923776.0, "vf_loss": 2460340544.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1121.0, "diff_num_grad_updates_vs_sampler_policy": 1120.0}}, "num_env_steps_sampled": 269280, "num_env_steps_trained": 269280, "num_agent_steps_sampled": 269280, "num_agent_steps_trained": 269280}, "sampler_results": {"episode_reward_max": -29542.026873572773, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29888.465100308742, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418415522006852, "mean_inference_ms": 0.24964071308193042, "mean_action_processing_ms": 0.05914649608293063, "mean_env_wait_ms": 1.4706297426216517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025179386138916016, "StateBufferConnector_ms": 0.0017325878143310547, "ViewRequirementAgentConnector_ms": 0.04522132873535156}}, "episode_reward_max": -29542.026873572773, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29888.465100308742, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29874.31297061503, -29851.133620893277, -29896.847753263733, -29866.91334424447, -29748.39299632066, -29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418415522006852, "mean_inference_ms": 0.24964071308193042, "mean_action_processing_ms": 0.05914649608293063, "mean_env_wait_ms": 1.4706297426216517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025179386138916016, "StateBufferConnector_ms": 0.0017325878143310547, "ViewRequirementAgentConnector_ms": 0.04522132873535156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269280, "num_agent_steps_trained": 269280, "num_env_steps_sampled": 269280, "num_env_steps_trained": 269280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4525588275303, "num_env_steps_trained_throughput_per_sec": 161.4525588275303, "timesteps_total": 269280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 269280, "timers": {"training_iteration_time_ms": 2227.686, "sample_time_ms": 2222.423, "load_time_ms": 0.214, "load_throughput": 1683708.118, "learn_time_ms": 4.508, "learn_throughput": 79858.125, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 269280, "num_env_steps_trained": 269280, "num_agent_steps_sampled": 269280, "num_agent_steps_trained": 269280}, "done": false, "episodes_total": 748, "training_iteration": 150, "trial_id": "a960d_00000", "date": "2023-07-25_16-17-38", "timestamp": 1690291058, "time_this_iter_s": 11.150890827178955, "time_total_s": 1679.0586109161377, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 839.179358959198, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 23.1875, "ram_util_percent": 78.44375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -2757080502272.0, "vf_loss": 2461867157.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1136.0, "diff_num_grad_updates_vs_sampler_policy": 1135.0}}, "num_env_steps_sampled": 271080, "num_env_steps_trained": 271080, "num_agent_steps_sampled": 271080, "num_agent_steps_trained": 271080}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29886.857505381806, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418430972520311, "mean_inference_ms": 0.24964989679522953, "mean_action_processing_ms": 0.05914704016174234, "mean_env_wait_ms": 1.4704661430042612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518892288208008, "StateBufferConnector_ms": 0.0017306804656982422, "ViewRequirementAgentConnector_ms": 0.04525136947631836}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29886.857505381806, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29928.006181910456, -29737.386766207215, -29890.4299476468, -30041.25230745027, -29979.103138491304, -29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418430972520311, "mean_inference_ms": 0.24964989679522953, "mean_action_processing_ms": 0.05914704016174234, "mean_env_wait_ms": 1.4704661430042612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518892288208008, "StateBufferConnector_ms": 0.0017306804656982422, "ViewRequirementAgentConnector_ms": 0.04525136947631836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271080, "num_agent_steps_trained": 271080, "num_env_steps_sampled": 271080, "num_env_steps_trained": 271080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.22988643819977, "num_env_steps_trained_throughput_per_sec": 160.22988643819977, "timesteps_total": 271080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 271080, "timers": {"training_iteration_time_ms": 2238.255, "sample_time_ms": 2232.948, "load_time_ms": 0.217, "load_throughput": 1656736.274, "learn_time_ms": 4.542, "learn_throughput": 79252.453, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 271080, "num_env_steps_trained": 271080, "num_agent_steps_sampled": 271080, "num_agent_steps_trained": 271080}, "done": false, "episodes_total": 753, "training_iteration": 151, "trial_id": "a960d_00000", "date": "2023-07-25_16-17-50", "timestamp": 1690291070, "time_this_iter_s": 11.235876083374023, "time_total_s": 1690.2944869995117, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 850.415235042572, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 24.575, "ram_util_percent": 78.66875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -1266336874496.0, "vf_loss": 2512784618.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1151.0, "diff_num_grad_updates_vs_sampler_policy": 1150.0}}, "num_env_steps_sampled": 272880, "num_env_steps_trained": 272880, "num_agent_steps_sampled": 272880, "num_agent_steps_trained": 272880}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29888.050798346332, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418416373674598, "mean_inference_ms": 0.24966092538212734, "mean_action_processing_ms": 0.059147849349372346, "mean_env_wait_ms": 1.4703036124649567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025179386138916016, "StateBufferConnector_ms": 0.001733541488647461, "ViewRequirementAgentConnector_ms": 0.04528021812438965}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29888.050798346332, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29857.340151658645, -29617.69198596786, -29791.733745424954, -29834.62714475995, -29973.071258184587, -29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418416373674598, "mean_inference_ms": 0.24966092538212734, "mean_action_processing_ms": 0.059147849349372346, "mean_env_wait_ms": 1.4703036124649567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025179386138916016, "StateBufferConnector_ms": 0.001733541488647461, "ViewRequirementAgentConnector_ms": 0.04528021812438965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272880, "num_agent_steps_trained": 272880, "num_env_steps_sampled": 272880, "num_env_steps_trained": 272880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.07546318800573, "num_env_steps_trained_throughput_per_sec": 162.07546318800573, "timesteps_total": 272880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 272880, "timers": {"training_iteration_time_ms": 2233.97, "sample_time_ms": 2228.684, "load_time_ms": 0.228, "load_throughput": 1575983.133, "learn_time_ms": 4.512, "learn_throughput": 79794.4, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 272880, "num_env_steps_trained": 272880, "num_agent_steps_sampled": 272880, "num_agent_steps_trained": 272880}, "done": false, "episodes_total": 758, "training_iteration": 152, "trial_id": "a960d_00000", "date": "2023-07-25_16-18-01", "timestamp": 1690291081, "time_this_iter_s": 11.107992887496948, "time_total_s": 1701.4024798870087, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 861.523227930069, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 22.1875, "ram_util_percent": 78.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -1709081908565.3333, "vf_loss": 2510274965.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1166.0, "diff_num_grad_updates_vs_sampler_policy": 1165.0}}, "num_env_steps_sampled": 274680, "num_env_steps_trained": 274680, "num_agent_steps_sampled": 274680, "num_agent_steps_trained": 274680}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29888.73609434948, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418401235820544, "mean_inference_ms": 0.24966736371756512, "mean_action_processing_ms": 0.05914813084246571, "mean_env_wait_ms": 1.4701326258782585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508401870727539, "StateBufferConnector_ms": 0.0017282962799072266, "ViewRequirementAgentConnector_ms": 0.04515719413757324}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29888.73609434948, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29722.517445481993, -29977.181539163063, -29881.77375929325, -30050.11685089601, -30056.66545883187, -29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418401235820544, "mean_inference_ms": 0.24966736371756512, "mean_action_processing_ms": 0.05914813084246571, "mean_env_wait_ms": 1.4701326258782585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508401870727539, "StateBufferConnector_ms": 0.0017282962799072266, "ViewRequirementAgentConnector_ms": 0.04515719413757324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274680, "num_agent_steps_trained": 274680, "num_env_steps_sampled": 274680, "num_env_steps_trained": 274680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.00727819918313, "num_env_steps_trained_throughput_per_sec": 161.00727819918313, "timesteps_total": 274680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 274680, "timers": {"training_iteration_time_ms": 2228.546, "sample_time_ms": 2223.301, "load_time_ms": 0.225, "load_throughput": 1601898.409, "learn_time_ms": 4.483, "learn_throughput": 80299.375, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 274680, "num_env_steps_trained": 274680, "num_agent_steps_sampled": 274680, "num_agent_steps_trained": 274680}, "done": false, "episodes_total": 763, "training_iteration": 153, "trial_id": "a960d_00000", "date": "2023-07-25_16-18-12", "timestamp": 1690291092, "time_this_iter_s": 11.181725978851318, "time_total_s": 1712.58420586586, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 872.7049539089203, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 26.18125, "ram_util_percent": 78.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -2742509581482.6665, "vf_loss": 2447171370.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1181.0, "diff_num_grad_updates_vs_sampler_policy": 1180.0}}, "num_env_steps_sampled": 276480, "num_env_steps_trained": 276480, "num_agent_steps_sampled": 276480, "num_agent_steps_trained": 276480}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29881.455081651216, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418371127018554, "mean_inference_ms": 0.24966960373393612, "mean_action_processing_ms": 0.05914774626104308, "mean_env_wait_ms": 1.4699731868811512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025017261505126953, "StateBufferConnector_ms": 0.0017201900482177734, "ViewRequirementAgentConnector_ms": 0.04515266418457031}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29881.455081651216, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29852.90856035433, -30131.353466467797, -29765.4694701914, -29746.465492046475, -29842.435977603345, -30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418371127018554, "mean_inference_ms": 0.24966960373393612, "mean_action_processing_ms": 0.05914774626104308, "mean_env_wait_ms": 1.4699731868811512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025017261505126953, "StateBufferConnector_ms": 0.0017201900482177734, "ViewRequirementAgentConnector_ms": 0.04515266418457031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276480, "num_agent_steps_trained": 276480, "num_env_steps_sampled": 276480, "num_env_steps_trained": 276480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.17543222453946, "num_env_steps_trained_throughput_per_sec": 161.17543222453946, "timesteps_total": 276480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 276480, "timers": {"training_iteration_time_ms": 2234.748, "sample_time_ms": 2229.42, "load_time_ms": 0.223, "load_throughput": 1617860.752, "learn_time_ms": 4.544, "learn_throughput": 79219.19, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 276480, "num_env_steps_trained": 276480, "num_agent_steps_sampled": 276480, "num_agent_steps_trained": 276480}, "done": false, "episodes_total": 768, "training_iteration": 154, "trial_id": "a960d_00000", "date": "2023-07-25_16-18-23", "timestamp": 1690291103, "time_this_iter_s": 11.170109033584595, "time_total_s": 1723.7543148994446, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 883.8750629425049, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 24.81875, "ram_util_percent": 78.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -2095109778090.6667, "vf_loss": 2503803157.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1196.0, "diff_num_grad_updates_vs_sampler_policy": 1195.0}}, "num_env_steps_sampled": 278280, "num_env_steps_trained": 278280, "num_agent_steps_sampled": 278280, "num_agent_steps_trained": 278280}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29884.027280236256, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418302903975781, "mean_inference_ms": 0.2496695193368425, "mean_action_processing_ms": 0.05914721888512011, "mean_env_wait_ms": 1.4698060334221117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025069713592529297, "StateBufferConnector_ms": 0.0017209053039550781, "ViewRequirementAgentConnector_ms": 0.04516911506652832}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29884.027280236256, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30097.070689665135, -29785.01411033172, -29542.026873572773, -29927.799707149727, -29812.14163317983, -29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418302903975781, "mean_inference_ms": 0.2496695193368425, "mean_action_processing_ms": 0.05914721888512011, "mean_env_wait_ms": 1.4698060334221117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025069713592529297, "StateBufferConnector_ms": 0.0017209053039550781, "ViewRequirementAgentConnector_ms": 0.04516911506652832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278280, "num_agent_steps_trained": 278280, "num_env_steps_sampled": 278280, "num_env_steps_trained": 278280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.62244742513334, "num_env_steps_trained_throughput_per_sec": 161.62244742513334, "timesteps_total": 278280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 278280, "timers": {"training_iteration_time_ms": 2230.493, "sample_time_ms": 2225.183, "load_time_ms": 0.226, "load_throughput": 1591598.44, "learn_time_ms": 4.517, "learn_throughput": 79701.739, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 278280, "num_env_steps_trained": 278280, "num_agent_steps_sampled": 278280, "num_agent_steps_trained": 278280}, "done": false, "episodes_total": 773, "training_iteration": 155, "trial_id": "a960d_00000", "date": "2023-07-25_16-18-34", "timestamp": 1690291114, "time_this_iter_s": 11.13923978805542, "time_total_s": 1734.8935546875, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 895.0143027305603, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 25.373333333333335, "ram_util_percent": 78.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -1448510387541.3333, "vf_loss": 2531255808.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1211.0, "diff_num_grad_updates_vs_sampler_policy": 1210.0}}, "num_env_steps_sampled": 280080, "num_env_steps_trained": 280080, "num_agent_steps_sampled": 280080, "num_agent_steps_trained": 280080}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29886.921042099893, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418211703336309, "mean_inference_ms": 0.2496673614780107, "mean_action_processing_ms": 0.05914639494782575, "mean_env_wait_ms": 1.4696339566076142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025053024291992188, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.04512453079223633}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29886.921042099893, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29997.7893966003, -29729.41348595864, -29884.75006470069, -30102.581532367756, -29674.871454141805, -29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418211703336309, "mean_inference_ms": 0.2496673614780107, "mean_action_processing_ms": 0.05914639494782575, "mean_env_wait_ms": 1.4696339566076142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025053024291992188, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.04512453079223633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280080, "num_agent_steps_trained": 280080, "num_env_steps_sampled": 280080, "num_env_steps_trained": 280080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.93218697170033, "num_env_steps_trained_throughput_per_sec": 162.93218697170033, "timesteps_total": 280080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 280080, "timers": {"training_iteration_time_ms": 2218.451, "sample_time_ms": 2213.218, "load_time_ms": 0.23, "load_throughput": 1564066.128, "learn_time_ms": 4.46, "learn_throughput": 80724.807, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 280080, "num_env_steps_trained": 280080, "num_agent_steps_sampled": 280080, "num_agent_steps_trained": 280080}, "done": false, "episodes_total": 778, "training_iteration": 156, "trial_id": "a960d_00000", "date": "2023-07-25_16-18-45", "timestamp": 1690291125, "time_this_iter_s": 11.049571990966797, "time_total_s": 1745.9431266784668, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 906.0638747215271, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.94375, "ram_util_percent": 78.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -2236744750080.0, "vf_loss": 2516668373.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1226.0, "diff_num_grad_updates_vs_sampler_policy": 1225.0}}, "num_env_steps_sampled": 281880, "num_env_steps_trained": 281880, "num_agent_steps_sampled": 281880, "num_agent_steps_trained": 281880}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29892.653850687988, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418111958367985, "mean_inference_ms": 0.2496606582882189, "mean_action_processing_ms": 0.059144863624071196, "mean_env_wait_ms": 1.469453970950862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002510547637939453, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04512906074523926}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29892.653850687988, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29849.022264720566, -30000.487121518014, -29782.34280267629, -30106.737659768114, -29673.481340669874, -29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418111958367985, "mean_inference_ms": 0.2496606582882189, "mean_action_processing_ms": 0.059144863624071196, "mean_env_wait_ms": 1.469453970950862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002510547637939453, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04512906074523926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281880, "num_agent_steps_trained": 281880, "num_env_steps_sampled": 281880, "num_env_steps_trained": 281880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.22854387979953, "num_env_steps_trained_throughput_per_sec": 162.22854387979953, "timesteps_total": 281880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 281880, "timers": {"training_iteration_time_ms": 2214.291, "sample_time_ms": 2209.103, "load_time_ms": 0.228, "load_throughput": 1580602.366, "learn_time_ms": 4.424, "learn_throughput": 81369.502, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 281880, "num_env_steps_trained": 281880, "num_agent_steps_sampled": 281880, "num_agent_steps_trained": 281880}, "done": false, "episodes_total": 783, "training_iteration": 157, "trial_id": "a960d_00000", "date": "2023-07-25_16-18-57", "timestamp": 1690291137, "time_this_iter_s": 11.097569942474365, "time_total_s": 1757.0406966209412, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 917.1614446640015, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 22.55625, "ram_util_percent": 78.13125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -3941172106581.3335, "vf_loss": 2468857749.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1241.0, "diff_num_grad_updates_vs_sampler_policy": 1240.0}}, "num_env_steps_sampled": 283680, "num_env_steps_trained": 283680, "num_agent_steps_sampled": 283680, "num_agent_steps_trained": 283680}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29894.30469081332, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417992501538976, "mean_inference_ms": 0.24965012316276528, "mean_action_processing_ms": 0.05914263778364685, "mean_env_wait_ms": 1.4692636505846948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002527475357055664, "StateBufferConnector_ms": 0.0017249584197998047, "ViewRequirementAgentConnector_ms": 0.04526853561401367}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29894.30469081332, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29956.71287402835, -29771.566860107345, -29816.716561253834, -29944.206317188728, -29875.418005466658, -29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417992501538976, "mean_inference_ms": 0.24965012316276528, "mean_action_processing_ms": 0.05914263778364685, "mean_env_wait_ms": 1.4692636505846948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002527475357055664, "StateBufferConnector_ms": 0.0017249584197998047, "ViewRequirementAgentConnector_ms": 0.04526853561401367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283680, "num_agent_steps_trained": 283680, "num_env_steps_sampled": 283680, "num_env_steps_trained": 283680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.95057660626028, "num_env_steps_trained_throughput_per_sec": 161.95057660626028, "timesteps_total": 283680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 283680, "timers": {"training_iteration_time_ms": 2220.987, "sample_time_ms": 2215.813, "load_time_ms": 0.219, "load_throughput": 1640179.709, "learn_time_ms": 4.416, "learn_throughput": 81525.025, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 283680, "num_env_steps_trained": 283680, "num_agent_steps_sampled": 283680, "num_agent_steps_trained": 283680}, "done": false, "episodes_total": 788, "training_iteration": 158, "trial_id": "a960d_00000", "date": "2023-07-25_16-19-08", "timestamp": 1690291148, "time_this_iter_s": 11.116641998291016, "time_total_s": 1768.1573386192322, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 928.2780866622925, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 23.89333333333333, "ram_util_percent": 78.30666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -3640361074688.0, "vf_loss": 2482193578.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1256.0, "diff_num_grad_updates_vs_sampler_policy": 1255.0}}, "num_env_steps_sampled": 285480, "num_env_steps_trained": 285480, "num_agent_steps_sampled": 285480, "num_agent_steps_trained": 285480}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29895.29559175194, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417894058302042, "mean_inference_ms": 0.2496440372171486, "mean_action_processing_ms": 0.05914124407490846, "mean_env_wait_ms": 1.4690808613591813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017292499542236328, "ViewRequirementAgentConnector_ms": 0.045256614685058594}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29895.29559175194, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29869.136634540995, -29825.263936875122, -29712.41948549975, -29722.240282224462, -29774.197669471865, -29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417894058302042, "mean_inference_ms": 0.2496440372171486, "mean_action_processing_ms": 0.05914124407490846, "mean_env_wait_ms": 1.4690808613591813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017292499542236328, "ViewRequirementAgentConnector_ms": 0.045256614685058594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285480, "num_agent_steps_trained": 285480, "num_env_steps_sampled": 285480, "num_env_steps_trained": 285480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.68750794498393, "num_env_steps_trained_throughput_per_sec": 159.68750794498393, "timesteps_total": 285480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 285480, "timers": {"training_iteration_time_ms": 2238.643, "sample_time_ms": 2233.374, "load_time_ms": 0.218, "load_throughput": 1647696.901, "learn_time_ms": 4.498, "learn_throughput": 80033.363, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 285480, "num_env_steps_trained": 285480, "num_agent_steps_sampled": 285480, "num_agent_steps_trained": 285480}, "done": false, "episodes_total": 793, "training_iteration": 159, "trial_id": "a960d_00000", "date": "2023-07-25_16-19-19", "timestamp": 1690291159, "time_this_iter_s": 11.274112939834595, "time_total_s": 1779.4314515590668, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 939.5521996021271, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 28.54375, "ram_util_percent": 78.34375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -1225782593536.0, "vf_loss": 2520483925.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1271.0, "diff_num_grad_updates_vs_sampler_policy": 1270.0}}, "num_env_steps_sampled": 287280, "num_env_steps_trained": 287280, "num_agent_steps_sampled": 287280, "num_agent_steps_trained": 287280}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29902.114961972762, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417778247288415, "mean_inference_ms": 0.24963581910062743, "mean_action_processing_ms": 0.059139495879588264, "mean_env_wait_ms": 1.4688915640772573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025398731231689453, "StateBufferConnector_ms": 0.0017337799072265625, "ViewRequirementAgentConnector_ms": 0.045298099517822266}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29902.114961972762, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29918.416758961983, -30075.07615915504, -29747.659764026663, -29825.55823468169, -30062.03981378379, -29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417778247288415, "mean_inference_ms": 0.24963581910062743, "mean_action_processing_ms": 0.059139495879588264, "mean_env_wait_ms": 1.4688915640772573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025398731231689453, "StateBufferConnector_ms": 0.0017337799072265625, "ViewRequirementAgentConnector_ms": 0.045298099517822266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287280, "num_agent_steps_trained": 287280, "num_env_steps_sampled": 287280, "num_env_steps_trained": 287280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.3048223744758, "num_env_steps_trained_throughput_per_sec": 161.3048223744758, "timesteps_total": 287280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 287280, "timers": {"training_iteration_time_ms": 2243.092, "sample_time_ms": 2237.83, "load_time_ms": 0.216, "load_throughput": 1667162.902, "learn_time_ms": 4.5, "learn_throughput": 80004.951, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 287280, "num_env_steps_trained": 287280, "num_agent_steps_sampled": 287280, "num_agent_steps_trained": 287280}, "done": false, "episodes_total": 798, "training_iteration": 160, "trial_id": "a960d_00000", "date": "2023-07-25_16-19-30", "timestamp": 1690291170, "time_this_iter_s": 11.161112070083618, "time_total_s": 1790.5925636291504, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 950.7133116722107, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 23.80625, "ram_util_percent": 78.29374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -1695294816256.0, "vf_loss": 2482167296.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1286.0, "diff_num_grad_updates_vs_sampler_policy": 1285.0}}, "num_env_steps_sampled": 289080, "num_env_steps_trained": 289080, "num_agent_steps_sampled": 289080, "num_agent_steps_trained": 289080}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29900.40146021404, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417668752918065, "mean_inference_ms": 0.2496292226105988, "mean_action_processing_ms": 0.05913818538319008, "mean_env_wait_ms": 1.4687091972919837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025551319122314453, "StateBufferConnector_ms": 0.0017499923706054688, "ViewRequirementAgentConnector_ms": 0.045467376708984375}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29900.40146021404, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29807.520332839613, -29745.839098573608, -29741.77121686718, -29662.4091990626, -29999.6295614346, -29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417668752918065, "mean_inference_ms": 0.2496292226105988, "mean_action_processing_ms": 0.05913818538319008, "mean_env_wait_ms": 1.4687091972919837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025551319122314453, "StateBufferConnector_ms": 0.0017499923706054688, "ViewRequirementAgentConnector_ms": 0.045467376708984375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289080, "num_agent_steps_trained": 289080, "num_env_steps_sampled": 289080, "num_env_steps_trained": 289080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.43549814818297, "num_env_steps_trained_throughput_per_sec": 160.43549814818297, "timesteps_total": 289080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 289080, "timers": {"training_iteration_time_ms": 2237.837, "sample_time_ms": 2232.642, "load_time_ms": 0.219, "load_throughput": 1642856.534, "learn_time_ms": 4.448, "learn_throughput": 80940.737, "synch_weights_time_ms": 0.497}, "counters": {"num_env_steps_sampled": 289080, "num_env_steps_trained": 289080, "num_agent_steps_sampled": 289080, "num_agent_steps_trained": 289080}, "done": false, "episodes_total": 803, "training_iteration": 161, "trial_id": "a960d_00000", "date": "2023-07-25_16-19-41", "timestamp": 1690291181, "time_this_iter_s": 11.22157883644104, "time_total_s": 1801.8141424655914, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 961.9348905086517, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 25.56875, "ram_util_percent": 78.48125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528564453125, "policy_loss": -2878279957845.3335, "vf_loss": 2459025088.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1301.0, "diff_num_grad_updates_vs_sampler_policy": 1300.0}}, "num_env_steps_sampled": 290880, "num_env_steps_trained": 290880, "num_agent_steps_sampled": 290880, "num_agent_steps_trained": 290880}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29904.578520863095, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417552611778555, "mean_inference_ms": 0.24962084017290587, "mean_action_processing_ms": 0.05913663879783934, "mean_env_wait_ms": 1.4685179114684745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025539398193359375, "StateBufferConnector_ms": 0.0017507076263427734, "ViewRequirementAgentConnector_ms": 0.045441627502441406}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29904.578520863095, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29863.29256824564, -29903.889210772122, -30069.532446856963, -30098.74050831461, -30107.468011403886, -30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417552611778555, "mean_inference_ms": 0.24962084017290587, "mean_action_processing_ms": 0.05913663879783934, "mean_env_wait_ms": 1.4685179114684745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025539398193359375, "StateBufferConnector_ms": 0.0017507076263427734, "ViewRequirementAgentConnector_ms": 0.045441627502441406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290880, "num_agent_steps_trained": 290880, "num_env_steps_sampled": 290880, "num_env_steps_trained": 290880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.62216088164988, "num_env_steps_trained_throughput_per_sec": 160.62216088164988, "timesteps_total": 290880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 290880, "timers": {"training_iteration_time_ms": 2242.58, "sample_time_ms": 2237.33, "load_time_ms": 0.222, "load_throughput": 1624474.922, "learn_time_ms": 4.496, "learn_throughput": 80068.588, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 290880, "num_env_steps_trained": 290880, "num_agent_steps_sampled": 290880, "num_agent_steps_trained": 290880}, "done": false, "episodes_total": 808, "training_iteration": 162, "trial_id": "a960d_00000", "date": "2023-07-25_16-19-53", "timestamp": 1690291193, "time_this_iter_s": 11.208427906036377, "time_total_s": 1813.0225703716278, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 973.1433184146881, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 25.06875, "ram_util_percent": 78.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -3179042428245.3335, "vf_loss": 2505114240.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1316.0, "diff_num_grad_updates_vs_sampler_policy": 1315.0}}, "num_env_steps_sampled": 292680, "num_env_steps_trained": 292680, "num_agent_steps_sampled": 292680, "num_agent_steps_trained": 292680}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29900.47423264013, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4174415304060775, "mean_inference_ms": 0.24961116651550863, "mean_action_processing_ms": 0.05913498271145235, "mean_env_wait_ms": 1.468356684222227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00255584716796875, "StateBufferConnector_ms": 0.0017518997192382812, "ViewRequirementAgentConnector_ms": 0.04542040824890137}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29900.47423264013, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30103.297724046322, -29875.420146061442, -30111.06637983567, -29899.213417340325, -29824.75112064638, -29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4174415304060775, "mean_inference_ms": 0.24961116651550863, "mean_action_processing_ms": 0.05913498271145235, "mean_env_wait_ms": 1.468356684222227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00255584716796875, "StateBufferConnector_ms": 0.0017518997192382812, "ViewRequirementAgentConnector_ms": 0.04542040824890137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292680, "num_agent_steps_trained": 292680, "num_env_steps_sampled": 292680, "num_env_steps_trained": 292680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.04315774782285, "num_env_steps_trained_throughput_per_sec": 161.04315774782285, "timesteps_total": 292680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 292680, "timers": {"training_iteration_time_ms": 2238.346, "sample_time_ms": 2233.05, "load_time_ms": 0.219, "load_throughput": 1647517.119, "learn_time_ms": 4.53, "learn_throughput": 79466.422, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 292680, "num_env_steps_trained": 292680, "num_agent_steps_sampled": 292680, "num_agent_steps_trained": 292680}, "done": false, "episodes_total": 813, "training_iteration": 163, "trial_id": "a960d_00000", "date": "2023-07-25_16-20-04", "timestamp": 1690291204, "time_this_iter_s": 11.179177045822144, "time_total_s": 1824.20174741745, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 984.3224954605103, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 26.799999999999997, "ram_util_percent": 78.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -3254427997525.3335, "vf_loss": 2450329685.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1331.0, "diff_num_grad_updates_vs_sampler_policy": 1330.0}}, "num_env_steps_sampled": 294480, "num_env_steps_trained": 294480, "num_agent_steps_sampled": 294480, "num_agent_steps_trained": 294480}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29893.433245272794, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417337991267214, "mean_inference_ms": 0.24960015994119253, "mean_action_processing_ms": 0.059133160020881405, "mean_env_wait_ms": 1.4682075657089493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002547740936279297, "StateBufferConnector_ms": 0.001744985580444336, "ViewRequirementAgentConnector_ms": 0.045159339904785156}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29893.433245272794, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29714.261354281312, -29805.399402630395, -29864.638206019383, -30039.661465695284, -29942.16742189025, -29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417337991267214, "mean_inference_ms": 0.24960015994119253, "mean_action_processing_ms": 0.059133160020881405, "mean_env_wait_ms": 1.4682075657089493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002547740936279297, "StateBufferConnector_ms": 0.001744985580444336, "ViewRequirementAgentConnector_ms": 0.045159339904785156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 294480, "num_agent_steps_trained": 294480, "num_env_steps_sampled": 294480, "num_env_steps_trained": 294480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.72358221004757, "num_env_steps_trained_throughput_per_sec": 159.72358221004757, "timesteps_total": 294480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 294480, "timers": {"training_iteration_time_ms": 2244.65, "sample_time_ms": 2239.401, "load_time_ms": 0.225, "load_throughput": 1603259.121, "learn_time_ms": 4.474, "learn_throughput": 80460.69, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 294480, "num_env_steps_trained": 294480, "num_agent_steps_sampled": 294480, "num_agent_steps_trained": 294480}, "done": false, "episodes_total": 818, "training_iteration": 164, "trial_id": "a960d_00000", "date": "2023-07-25_16-20-15", "timestamp": 1690291215, "time_this_iter_s": 11.271607160568237, "time_total_s": 1835.4733545780182, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 995.5941026210785, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 24.69375, "ram_util_percent": 78.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -3879217228458.6665, "vf_loss": 2472576832.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1346.0, "diff_num_grad_updates_vs_sampler_policy": 1345.0}}, "num_env_steps_sampled": 296280, "num_env_steps_trained": 296280, "num_agent_steps_sampled": 296280, "num_agent_steps_trained": 296280}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29896.873264056725, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417241621503569, "mean_inference_ms": 0.24958926976248932, "mean_action_processing_ms": 0.05913132735143913, "mean_env_wait_ms": 1.4680511907932265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002549886703491211, "StateBufferConnector_ms": 0.001744985580444336, "ViewRequirementAgentConnector_ms": 0.045127153396606445}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29896.873264056725, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29789.92618878809, -30107.73391718237, -30007.60028164607, -29928.129218646125, -30087.28632608672, -29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417241621503569, "mean_inference_ms": 0.24958926976248932, "mean_action_processing_ms": 0.05913132735143913, "mean_env_wait_ms": 1.4680511907932265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002549886703491211, "StateBufferConnector_ms": 0.001744985580444336, "ViewRequirementAgentConnector_ms": 0.045127153396606445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296280, "num_agent_steps_trained": 296280, "num_env_steps_sampled": 296280, "num_env_steps_trained": 296280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.23726730200548, "num_env_steps_trained_throughput_per_sec": 161.23726730200548, "timesteps_total": 296280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 296280, "timers": {"training_iteration_time_ms": 2243.304, "sample_time_ms": 2237.865, "load_time_ms": 0.234, "load_throughput": 1537157.121, "learn_time_ms": 4.648, "learn_throughput": 77449.589, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 296280, "num_env_steps_trained": 296280, "num_agent_steps_sampled": 296280, "num_agent_steps_trained": 296280}, "done": false, "episodes_total": 823, "training_iteration": 165, "trial_id": "a960d_00000", "date": "2023-07-25_16-20-26", "timestamp": 1690291226, "time_this_iter_s": 11.165732860565186, "time_total_s": 1846.6390874385834, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1006.7598354816437, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 26.71875, "ram_util_percent": 78.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -3803561317717.3335, "vf_loss": 2465760810.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1361.0, "diff_num_grad_updates_vs_sampler_policy": 1360.0}}, "num_env_steps_sampled": 298080, "num_env_steps_trained": 298080, "num_agent_steps_sampled": 298080, "num_agent_steps_trained": 298080}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29891.098814492027, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417123801687513, "mean_inference_ms": 0.24957851698355596, "mean_action_processing_ms": 0.059129547887424215, "mean_env_wait_ms": 1.467914357673423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025594234466552734, "StateBufferConnector_ms": 0.0017549991607666016, "ViewRequirementAgentConnector_ms": 0.04510903358459473}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30143.421188656746, "episode_reward_mean": -29891.098814492027, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29791.273294524246, -30001.831156697255, -30131.581580646605, -29932.114031516223, -30143.421188656746, -30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417123801687513, "mean_inference_ms": 0.24957851698355596, "mean_action_processing_ms": 0.059129547887424215, "mean_env_wait_ms": 1.467914357673423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025594234466552734, "StateBufferConnector_ms": 0.0017549991607666016, "ViewRequirementAgentConnector_ms": 0.04510903358459473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298080, "num_agent_steps_trained": 298080, "num_env_steps_sampled": 298080, "num_env_steps_trained": 298080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.80680636380055, "num_env_steps_trained_throughput_per_sec": 159.80680636380055, "timesteps_total": 298080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 298080, "timers": {"training_iteration_time_ms": 2242.717, "sample_time_ms": 2237.25, "load_time_ms": 0.232, "load_throughput": 1552966.615, "learn_time_ms": 4.657, "learn_throughput": 77304.86, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 298080, "num_env_steps_trained": 298080, "num_agent_steps_sampled": 298080, "num_agent_steps_trained": 298080}, "done": false, "episodes_total": 828, "training_iteration": 166, "trial_id": "a960d_00000", "date": "2023-07-25_16-20-38", "timestamp": 1690291238, "time_this_iter_s": 11.265718221664429, "time_total_s": 1857.9048056602478, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1018.0255537033081, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 27.606250000000003, "ram_util_percent": 78.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5279541015625, "policy_loss": -3437567391061.3335, "vf_loss": 2545511722.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1376.0, "diff_num_grad_updates_vs_sampler_policy": 1375.0}}, "num_env_steps_sampled": 299880, "num_env_steps_trained": 299880, "num_agent_steps_sampled": 299880, "num_agent_steps_trained": 299880}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30201.010487843967, "episode_reward_mean": -29888.29847763241, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417001920525468, "mean_inference_ms": 0.24956848509556714, "mean_action_processing_ms": 0.059127787543360746, "mean_env_wait_ms": 1.467781821257402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025496482849121094, "StateBufferConnector_ms": 0.0017609596252441406, "ViewRequirementAgentConnector_ms": 0.044995784759521484}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30201.010487843967, "episode_reward_mean": -29888.29847763241, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30033.366811237593, -29907.30466688356, -29659.525247900696, -30008.938765626095, -29967.980087287324, -29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417001920525468, "mean_inference_ms": 0.24956848509556714, "mean_action_processing_ms": 0.059127787543360746, "mean_env_wait_ms": 1.467781821257402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025496482849121094, "StateBufferConnector_ms": 0.0017609596252441406, "ViewRequirementAgentConnector_ms": 0.044995784759521484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299880, "num_agent_steps_trained": 299880, "num_env_steps_sampled": 299880, "num_env_steps_trained": 299880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.19233543424866, "num_env_steps_trained_throughput_per_sec": 161.19233543424866, "timesteps_total": 299880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 299880, "timers": {"training_iteration_time_ms": 2243.028, "sample_time_ms": 2237.699, "load_time_ms": 0.225, "load_throughput": 1602408.405, "learn_time_ms": 4.525, "learn_throughput": 79560.214, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 299880, "num_env_steps_trained": 299880, "num_agent_steps_sampled": 299880, "num_agent_steps_trained": 299880}, "done": false, "episodes_total": 833, "training_iteration": 167, "trial_id": "a960d_00000", "date": "2023-07-25_16-20-49", "timestamp": 1690291249, "time_this_iter_s": 11.16887879371643, "time_total_s": 1869.0736844539642, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1029.1944324970245, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 24.5875, "ram_util_percent": 78.38749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -1760923317589.3333, "vf_loss": 2496155434.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1391.0, "diff_num_grad_updates_vs_sampler_policy": 1390.0}}, "num_env_steps_sampled": 301680, "num_env_steps_trained": 301680, "num_agent_steps_sampled": 301680, "num_agent_steps_trained": 301680}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29890.45003961742, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4168707664165785, "mean_inference_ms": 0.2495577760746918, "mean_action_processing_ms": 0.05912591437802142, "mean_env_wait_ms": 1.4676312594397165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025675296783447266, "StateBufferConnector_ms": 0.0017657279968261719, "ViewRequirementAgentConnector_ms": 0.044849395751953125}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29890.45003961742, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29564.505877423468, -29865.3583944041, -30034.03361522328, -29922.738160834888, -30082.387400701227, -29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4168707664165785, "mean_inference_ms": 0.2495577760746918, "mean_action_processing_ms": 0.05912591437802142, "mean_env_wait_ms": 1.4676312594397165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025675296783447266, "StateBufferConnector_ms": 0.0017657279968261719, "ViewRequirementAgentConnector_ms": 0.044849395751953125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301680, "num_agent_steps_trained": 301680, "num_env_steps_sampled": 301680, "num_env_steps_trained": 301680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.9862974313906, "num_env_steps_trained_throughput_per_sec": 161.9862974313906, "timesteps_total": 301680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 301680, "timers": {"training_iteration_time_ms": 2227.874, "sample_time_ms": 2222.583, "load_time_ms": 0.217, "load_throughput": 1659649.857, "learn_time_ms": 4.508, "learn_throughput": 79858.97, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 301680, "num_env_steps_trained": 301680, "num_agent_steps_sampled": 301680, "num_agent_steps_trained": 301680}, "done": false, "episodes_total": 838, "training_iteration": 168, "trial_id": "a960d_00000", "date": "2023-07-25_16-21-00", "timestamp": 1690291260, "time_this_iter_s": 11.11423373222351, "time_total_s": 1880.1879181861877, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1040.308666229248, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 24.34375, "ram_util_percent": 78.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -3140342465194.6665, "vf_loss": 2488579904.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1406.0, "diff_num_grad_updates_vs_sampler_policy": 1405.0}}, "num_env_steps_sampled": 303480, "num_env_steps_trained": 303480, "num_agent_steps_sampled": 303480, "num_agent_steps_trained": 303480}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29890.616490003904, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416760197844889, "mean_inference_ms": 0.24954836467102964, "mean_action_processing_ms": 0.05912407798305093, "mean_env_wait_ms": 1.4674772247796621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025632381439208984, "StateBufferConnector_ms": 0.0017576217651367188, "ViewRequirementAgentConnector_ms": 0.0448758602142334}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29890.616490003904, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29730.325776240737, -29708.33644172784, -30004.10316892896, -29780.509343386788, -29698.939468203407, -29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416760197844889, "mean_inference_ms": 0.24954836467102964, "mean_action_processing_ms": 0.05912407798305093, "mean_env_wait_ms": 1.4674772247796621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025632381439208984, "StateBufferConnector_ms": 0.0017576217651367188, "ViewRequirementAgentConnector_ms": 0.0448758602142334}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303480, "num_agent_steps_trained": 303480, "num_env_steps_sampled": 303480, "num_env_steps_trained": 303480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.3548964836278, "num_env_steps_trained_throughput_per_sec": 161.3548964836278, "timesteps_total": 303480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 303480, "timers": {"training_iteration_time_ms": 2226.749, "sample_time_ms": 2221.568, "load_time_ms": 0.217, "load_throughput": 1659102.78, "learn_time_ms": 4.414, "learn_throughput": 81560.694, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 303480, "num_env_steps_trained": 303480, "num_agent_steps_sampled": 303480, "num_agent_steps_trained": 303480}, "done": false, "episodes_total": 843, "training_iteration": 169, "trial_id": "a960d_00000", "date": "2023-07-25_16-21-11", "timestamp": 1690291271, "time_this_iter_s": 11.157555341720581, "time_total_s": 1891.3454735279083, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1051.4662215709686, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 25.93125, "ram_util_percent": 78.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -1946646435157.3333, "vf_loss": 2495031573.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1421.0, "diff_num_grad_updates_vs_sampler_policy": 1420.0}}, "num_env_steps_sampled": 305280, "num_env_steps_trained": 305280, "num_agent_steps_sampled": 305280, "num_agent_steps_trained": 305280}, "sampler_results": {"episode_reward_max": -29506.935638345472, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29901.44649809017, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416679895321762, "mean_inference_ms": 0.2495411306257995, "mean_action_processing_ms": 0.05912264305022111, "mean_env_wait_ms": 1.4673184156226973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025589466094970703, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.044803619384765625}}, "episode_reward_max": -29506.935638345472, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29901.44649809017, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29506.935638345472, -30070.832488683165, -30021.18756527938, -29775.033543362373, -29702.85195697399, -29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416679895321762, "mean_inference_ms": 0.2495411306257995, "mean_action_processing_ms": 0.05912264305022111, "mean_env_wait_ms": 1.4673184156226973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025589466094970703, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.044803619384765625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 305280, "num_agent_steps_trained": 305280, "num_env_steps_sampled": 305280, "num_env_steps_trained": 305280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.4801556985967, "num_env_steps_trained_throughput_per_sec": 160.4801556985967, "timesteps_total": 305280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 305280, "timers": {"training_iteration_time_ms": 2237.178, "sample_time_ms": 2231.97, "load_time_ms": 0.216, "load_throughput": 1664589.836, "learn_time_ms": 4.42, "learn_throughput": 81444.553, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 305280, "num_env_steps_trained": 305280, "num_agent_steps_sampled": 305280, "num_agent_steps_trained": 305280}, "done": false, "episodes_total": 848, "training_iteration": 170, "trial_id": "a960d_00000", "date": "2023-07-25_16-21-22", "timestamp": 1690291282, "time_this_iter_s": 11.21836519241333, "time_total_s": 1902.5638387203217, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1062.684586763382, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 26.53125, "ram_util_percent": 78.54375000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -1909032768853.3333, "vf_loss": 2497355712.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1436.0, "diff_num_grad_updates_vs_sampler_policy": 1435.0}}, "num_env_steps_sampled": 307080, "num_env_steps_trained": 307080, "num_agent_steps_sampled": 307080, "num_agent_steps_trained": 307080}, "sampler_results": {"episode_reward_max": -29526.198068131023, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29906.45098297231, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416598534684272, "mean_inference_ms": 0.24953421511068322, "mean_action_processing_ms": 0.059121395534825545, "mean_env_wait_ms": 1.4671390928033987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.001741170883178711, "ViewRequirementAgentConnector_ms": 0.04489398002624512}}, "episode_reward_max": -29526.198068131023, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29906.45098297231, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29794.517233402694, -29957.47423544048, -29894.565334560986, -30029.523790666273, -30019.427044086955, -29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416598534684272, "mean_inference_ms": 0.24953421511068322, "mean_action_processing_ms": 0.059121395534825545, "mean_env_wait_ms": 1.4671390928033987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.001741170883178711, "ViewRequirementAgentConnector_ms": 0.04489398002624512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307080, "num_agent_steps_trained": 307080, "num_env_steps_sampled": 307080, "num_env_steps_trained": 307080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.29023864213255, "num_env_steps_trained_throughput_per_sec": 161.29023864213255, "timesteps_total": 307080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 307080, "timers": {"training_iteration_time_ms": 2237.624, "sample_time_ms": 2232.189, "load_time_ms": 0.224, "load_throughput": 1604451.642, "learn_time_ms": 4.609, "learn_throughput": 78102.18, "synch_weights_time_ms": 0.567}, "counters": {"num_env_steps_sampled": 307080, "num_env_steps_trained": 307080, "num_agent_steps_sampled": 307080, "num_agent_steps_trained": 307080}, "done": false, "episodes_total": 853, "training_iteration": 171, "trial_id": "a960d_00000", "date": "2023-07-25_16-21-33", "timestamp": 1690291293, "time_this_iter_s": 11.162022352218628, "time_total_s": 1913.7258610725403, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1073.8466091156006, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 27.2125, "ram_util_percent": 78.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -1009426274986.6666, "vf_loss": 2476124522.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1451.0, "diff_num_grad_updates_vs_sampler_policy": 1450.0}}, "num_env_steps_sampled": 308880, "num_env_steps_trained": 308880, "num_agent_steps_sampled": 308880, "num_agent_steps_trained": 308880}, "sampler_results": {"episode_reward_max": -29526.198068131023, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29902.530882960884, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416541333066321, "mean_inference_ms": 0.24952840394718792, "mean_action_processing_ms": 0.059120412534259155, "mean_env_wait_ms": 1.4669646751045633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025599002838134766, "StateBufferConnector_ms": 0.0017368793487548828, "ViewRequirementAgentConnector_ms": 0.04485034942626953}}, "episode_reward_max": -29526.198068131023, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29902.530882960884, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29817.16911990246, -29848.055129876462, -30004.119741394596, -29526.198068131023, -29947.451827005916, -29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416541333066321, "mean_inference_ms": 0.24952840394718792, "mean_action_processing_ms": 0.059120412534259155, "mean_env_wait_ms": 1.4669646751045633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025599002838134766, "StateBufferConnector_ms": 0.0017368793487548828, "ViewRequirementAgentConnector_ms": 0.04485034942626953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308880, "num_agent_steps_trained": 308880, "num_env_steps_sampled": 308880, "num_env_steps_trained": 308880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.0886732798306, "num_env_steps_trained_throughput_per_sec": 161.0886732798306, "timesteps_total": 308880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 308880, "timers": {"training_iteration_time_ms": 2233.388, "sample_time_ms": 2228.035, "load_time_ms": 0.224, "load_throughput": 1604963.265, "learn_time_ms": 4.559, "learn_throughput": 78964.404, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 308880, "num_env_steps_trained": 308880, "num_agent_steps_sampled": 308880, "num_agent_steps_trained": 308880}, "done": false, "episodes_total": 858, "training_iteration": 172, "trial_id": "a960d_00000", "date": "2023-07-25_16-21-45", "timestamp": 1690291305, "time_this_iter_s": 11.176006078720093, "time_total_s": 1924.9018671512604, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1085.0226151943207, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 25.613333333333333, "ram_util_percent": 78.60666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284830729167, "policy_loss": -1670448010581.3333, "vf_loss": 2459585600.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1466.0, "diff_num_grad_updates_vs_sampler_policy": 1465.0}}, "num_env_steps_sampled": 310680, "num_env_steps_trained": 310680, "num_agent_steps_sampled": 310680, "num_agent_steps_trained": 310680}, "sampler_results": {"episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29900.695017545124, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416484209969932, "mean_inference_ms": 0.2495247507735699, "mean_action_processing_ms": 0.05911978586674382, "mean_env_wait_ms": 1.4668094185427794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025620460510253906, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.04483842849731445}}, "episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29900.695017545124, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29765.0850684978, -29773.338460031606, -29896.577302644746, -29874.75435401042, -29650.39859865625, -29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416484209969932, "mean_inference_ms": 0.2495247507735699, "mean_action_processing_ms": 0.05911978586674382, "mean_env_wait_ms": 1.4668094185427794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025620460510253906, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.04483842849731445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310680, "num_agent_steps_trained": 310680, "num_env_steps_sampled": 310680, "num_env_steps_trained": 310680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.17287198918223, "num_env_steps_trained_throughput_per_sec": 160.17287198918223, "timesteps_total": 310680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 310680, "timers": {"training_iteration_time_ms": 2241.174, "sample_time_ms": 2236.057, "load_time_ms": 0.215, "load_throughput": 1674930.05, "learn_time_ms": 4.365, "learn_throughput": 82471.691, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 310680, "num_env_steps_trained": 310680, "num_agent_steps_sampled": 310680, "num_agent_steps_trained": 310680}, "done": false, "episodes_total": 863, "training_iteration": 173, "trial_id": "a960d_00000", "date": "2023-07-25_16-21-56", "timestamp": 1690291316, "time_this_iter_s": 11.239891767501831, "time_total_s": 1936.1417589187622, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1096.2625069618225, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 24.40625, "ram_util_percent": 78.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284830729167, "policy_loss": -1646051718485.3333, "vf_loss": 2447759744.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1481.0, "diff_num_grad_updates_vs_sampler_policy": 1480.0}}, "num_env_steps_sampled": 312480, "num_env_steps_trained": 312480, "num_agent_steps_sampled": 312480, "num_agent_steps_trained": 312480}, "sampler_results": {"episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29903.727356780622, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416434263837158, "mean_inference_ms": 0.2495233184589054, "mean_action_processing_ms": 0.05911951287877363, "mean_env_wait_ms": 1.4666587856800684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025713443756103516, "StateBufferConnector_ms": 0.0017399787902832031, "ViewRequirementAgentConnector_ms": 0.04489278793334961}}, "episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29903.727356780622, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29862.29762811674, -30097.817623155872, -29683.80691851695, -30001.457800151686, -29950.472855226297, -29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416434263837158, "mean_inference_ms": 0.2495233184589054, "mean_action_processing_ms": 0.05911951287877363, "mean_env_wait_ms": 1.4666587856800684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025713443756103516, "StateBufferConnector_ms": 0.0017399787902832031, "ViewRequirementAgentConnector_ms": 0.04489278793334961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312480, "num_agent_steps_trained": 312480, "num_env_steps_sampled": 312480, "num_env_steps_trained": 312480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.76580063453298, "num_env_steps_trained_throughput_per_sec": 160.76580063453298, "timesteps_total": 312480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 312480, "timers": {"training_iteration_time_ms": 2243.418, "sample_time_ms": 2238.241, "load_time_ms": 0.216, "load_throughput": 1667715.308, "learn_time_ms": 4.431, "learn_throughput": 81252.593, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 312480, "num_env_steps_trained": 312480, "num_agent_steps_sampled": 312480, "num_agent_steps_trained": 312480}, "done": false, "episodes_total": 868, "training_iteration": 174, "trial_id": "a960d_00000", "date": "2023-07-25_16-22-07", "timestamp": 1690291327, "time_this_iter_s": 11.198773860931396, "time_total_s": 1947.3405327796936, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1107.461280822754, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 25.19375, "ram_util_percent": 78.13749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -1872354497877.3333, "vf_loss": 2490391381.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1496.0, "diff_num_grad_updates_vs_sampler_policy": 1495.0}}, "num_env_steps_sampled": 314280, "num_env_steps_trained": 314280, "num_agent_steps_sampled": 314280, "num_agent_steps_trained": 314280}, "sampler_results": {"episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29900.545074874284, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416394383460162, "mean_inference_ms": 0.24952231084803167, "mean_action_processing_ms": 0.05911916966729852, "mean_env_wait_ms": 1.4665174667348335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025844573974609375, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.04534125328063965}}, "episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29900.545074874284, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29911.52757712479, -29741.61098530391, -29736.787525017513, -29965.770861293375, -30097.732251523175, -29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416394383460162, "mean_inference_ms": 0.24952231084803167, "mean_action_processing_ms": 0.05911916966729852, "mean_env_wait_ms": 1.4665174667348335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025844573974609375, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.04534125328063965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314280, "num_agent_steps_trained": 314280, "num_env_steps_sampled": 314280, "num_env_steps_trained": 314280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.9844475287207, "num_env_steps_trained_throughput_per_sec": 160.9844475287207, "timesteps_total": 314280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 314280, "timers": {"training_iteration_time_ms": 2237.752, "sample_time_ms": 2232.559, "load_time_ms": 0.215, "load_throughput": 1675859.534, "learn_time_ms": 4.439, "learn_throughput": 81107.691, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 314280, "num_env_steps_trained": 314280, "num_agent_steps_sampled": 314280, "num_agent_steps_trained": 314280}, "done": false, "episodes_total": 873, "training_iteration": 175, "trial_id": "a960d_00000", "date": "2023-07-25_16-22-18", "timestamp": 1690291338, "time_this_iter_s": 11.183406114578247, "time_total_s": 1958.5239388942719, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1118.6446869373322, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 24.24375, "ram_util_percent": 78.29374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -2625898949290.6665, "vf_loss": 2531917226.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1511.0, "diff_num_grad_updates_vs_sampler_policy": 1510.0}}, "num_env_steps_sampled": 316080, "num_env_steps_trained": 316080, "num_agent_steps_sampled": 316080, "num_agent_steps_trained": 316080}, "sampler_results": {"episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29899.228961912704, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416396008883678, "mean_inference_ms": 0.24952197370861862, "mean_action_processing_ms": 0.05911882432629289, "mean_env_wait_ms": 1.4663945634259858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002584695816040039, "StateBufferConnector_ms": 0.0017383098602294922, "ViewRequirementAgentConnector_ms": 0.04534626007080078}}, "episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29899.228961912704, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29913.57473959998, -29814.906095835096, -29969.197514251064, -30128.848136311855, -30136.160306580627, -30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416396008883678, "mean_inference_ms": 0.24952197370861862, "mean_action_processing_ms": 0.05911882432629289, "mean_env_wait_ms": 1.4663945634259858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002584695816040039, "StateBufferConnector_ms": 0.0017383098602294922, "ViewRequirementAgentConnector_ms": 0.04534626007080078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316080, "num_agent_steps_trained": 316080, "num_env_steps_sampled": 316080, "num_env_steps_trained": 316080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.4406634432952, "num_env_steps_trained_throughput_per_sec": 160.4406634432952, "timesteps_total": 316080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 316080, "timers": {"training_iteration_time_ms": 2240.021, "sample_time_ms": 2234.855, "load_time_ms": 0.214, "load_throughput": 1683895.885, "learn_time_ms": 4.422, "learn_throughput": 81412.497, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 316080, "num_env_steps_trained": 316080, "num_agent_steps_sampled": 316080, "num_agent_steps_trained": 316080}, "done": false, "episodes_total": 878, "training_iteration": 176, "trial_id": "a960d_00000", "date": "2023-07-25_16-22-30", "timestamp": 1690291350, "time_this_iter_s": 11.221204042434692, "time_total_s": 1969.7451429367065, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1129.8658909797668, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 25.5625, "ram_util_percent": 78.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -3137227989674.6665, "vf_loss": 2461802218.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1526.0, "diff_num_grad_updates_vs_sampler_policy": 1525.0}}, "num_env_steps_sampled": 317880, "num_env_steps_trained": 317880, "num_agent_steps_sampled": 317880, "num_agent_steps_trained": 317880}, "sampler_results": {"episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29891.224275017805, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416408616394527, "mean_inference_ms": 0.2495233115013311, "mean_action_processing_ms": 0.05911863516572068, "mean_env_wait_ms": 1.4663062925637649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002583742141723633, "StateBufferConnector_ms": 0.0017452239990234375, "ViewRequirementAgentConnector_ms": 0.04545235633850098}}, "episode_reward_max": -29524.12045709442, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29891.224275017805, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30015.001721467674, -30040.746708147013, -29947.74635367912, -29825.08509309499, -29748.575325496357, -29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416408616394527, "mean_inference_ms": 0.2495233115013311, "mean_action_processing_ms": 0.05911863516572068, "mean_env_wait_ms": 1.4663062925637649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002583742141723633, "StateBufferConnector_ms": 0.0017452239990234375, "ViewRequirementAgentConnector_ms": 0.04545235633850098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317880, "num_agent_steps_trained": 317880, "num_env_steps_sampled": 317880, "num_env_steps_trained": 317880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.16554586277587, "num_env_steps_trained_throughput_per_sec": 160.16554586277587, "timesteps_total": 317880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 317880, "timers": {"training_iteration_time_ms": 2245.738, "sample_time_ms": 2240.512, "load_time_ms": 0.217, "load_throughput": 1660197.295, "learn_time_ms": 4.484, "learn_throughput": 80286.993, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 317880, "num_env_steps_trained": 317880, "num_agent_steps_sampled": 317880, "num_agent_steps_trained": 317880}, "done": false, "episodes_total": 883, "training_iteration": 177, "trial_id": "a960d_00000", "date": "2023-07-25_16-22-41", "timestamp": 1690291361, "time_this_iter_s": 11.240380048751831, "time_total_s": 1980.9855229854584, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1141.1062710285187, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 24.98125, "ram_util_percent": 78.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -2032842462549.3333, "vf_loss": 2508941994.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1541.0, "diff_num_grad_updates_vs_sampler_policy": 1540.0}}, "num_env_steps_sampled": 319680, "num_env_steps_trained": 319680, "num_agent_steps_sampled": 319680, "num_agent_steps_trained": 319680}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29887.09170911599, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4164444924174076, "mean_inference_ms": 0.24952517081692493, "mean_action_processing_ms": 0.059118724927849496, "mean_env_wait_ms": 1.4662288353224842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002567768096923828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.04528927803039551}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29887.09170911599, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29846.409855634083, -29796.681390749985, -29835.43545303323, -30092.809330168213, -29892.374682322486, -29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4164444924174076, "mean_inference_ms": 0.24952517081692493, "mean_action_processing_ms": 0.059118724927849496, "mean_env_wait_ms": 1.4662288353224842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002567768096923828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.04528927803039551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319680, "num_agent_steps_trained": 319680, "num_env_steps_sampled": 319680, "num_env_steps_trained": 319680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.43853591512445, "num_env_steps_trained_throughput_per_sec": 160.43853591512445, "timesteps_total": 319680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 319680, "timers": {"training_iteration_time_ms": 2245.753, "sample_time_ms": 2240.453, "load_time_ms": 0.22, "load_throughput": 1636801.561, "learn_time_ms": 4.53, "learn_throughput": 79477.716, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 319680, "num_env_steps_trained": 319680, "num_agent_steps_sampled": 319680, "num_agent_steps_trained": 319680}, "done": false, "episodes_total": 888, "training_iteration": 178, "trial_id": "a960d_00000", "date": "2023-07-25_16-22-52", "timestamp": 1690291372, "time_this_iter_s": 11.221627950668335, "time_total_s": 1992.2071509361267, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1152.327898979187, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 26.4375, "ram_util_percent": 78.23750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -2014799211178.6667, "vf_loss": 2463282090.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1556.0, "diff_num_grad_updates_vs_sampler_policy": 1555.0}}, "num_env_steps_sampled": 321480, "num_env_steps_trained": 321480, "num_agent_steps_sampled": 321480, "num_agent_steps_trained": 321480}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29888.629064446886, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416455833256362, "mean_inference_ms": 0.24952491749980069, "mean_action_processing_ms": 0.05911835663547789, "mean_env_wait_ms": 1.4661531817752225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.04521679878234863}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29888.629064446886, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29948.79135114304, -29766.877907602575, -29917.208780245677, -29910.451580468154, -30041.865411234336, -29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416455833256362, "mean_inference_ms": 0.24952491749980069, "mean_action_processing_ms": 0.05911835663547789, "mean_env_wait_ms": 1.4661531817752225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.04521679878234863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 321480, "num_agent_steps_trained": 321480, "num_env_steps_sampled": 321480, "num_env_steps_trained": 321480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.84817507480543, "num_env_steps_trained_throughput_per_sec": 160.84817507480543, "timesteps_total": 321480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 321480, "timers": {"training_iteration_time_ms": 2240.984, "sample_time_ms": 2235.724, "load_time_ms": 0.219, "load_throughput": 1645900.85, "learn_time_ms": 4.488, "learn_throughput": 80205.963, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 321480, "num_env_steps_trained": 321480, "num_agent_steps_sampled": 321480, "num_agent_steps_trained": 321480}, "done": false, "episodes_total": 893, "training_iteration": 179, "trial_id": "a960d_00000", "date": "2023-07-25_16-23-03", "timestamp": 1690291383, "time_this_iter_s": 11.192623138427734, "time_total_s": 2003.3997740745544, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1163.5205221176147, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 23.71875, "ram_util_percent": 78.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5279947916667, "policy_loss": -3529825252693.3335, "vf_loss": 2533057962.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1571.0, "diff_num_grad_updates_vs_sampler_policy": 1570.0}}, "num_env_steps_sampled": 323280, "num_env_steps_trained": 323280, "num_agent_steps_sampled": 323280, "num_agent_steps_trained": 323280}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29890.521842895574, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416472524150768, "mean_inference_ms": 0.24952564380916903, "mean_action_processing_ms": 0.05911828931421738, "mean_env_wait_ms": 1.4660725130223033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025665760040283203, "StateBufferConnector_ms": 0.001741647720336914, "ViewRequirementAgentConnector_ms": 0.04523348808288574}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29890.521842895574, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29790.46236405816, -29992.208679714502, -30042.7147930647, -29755.46965405321, -29876.5450638474, -29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416472524150768, "mean_inference_ms": 0.24952564380916903, "mean_action_processing_ms": 0.05911828931421738, "mean_env_wait_ms": 1.4660725130223033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025665760040283203, "StateBufferConnector_ms": 0.001741647720336914, "ViewRequirementAgentConnector_ms": 0.04523348808288574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323280, "num_agent_steps_trained": 323280, "num_env_steps_sampled": 323280, "num_env_steps_trained": 323280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4035351764595, "num_env_steps_trained_throughput_per_sec": 161.4035351764595, "timesteps_total": 323280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 323280, "timers": {"training_iteration_time_ms": 2234.276, "sample_time_ms": 2229.011, "load_time_ms": 0.217, "load_throughput": 1656191.115, "learn_time_ms": 4.497, "learn_throughput": 80061.37, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 323280, "num_env_steps_trained": 323280, "num_agent_steps_sampled": 323280, "num_agent_steps_trained": 323280}, "done": false, "episodes_total": 898, "training_iteration": 180, "trial_id": "a960d_00000", "date": "2023-07-25_16-23-14", "timestamp": 1690291394, "time_this_iter_s": 11.154202699661255, "time_total_s": 2014.5539767742157, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1174.674724817276, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 28.543750000000003, "ram_util_percent": 78.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -2040599123285.3333, "vf_loss": 2496868202.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1586.0, "diff_num_grad_updates_vs_sampler_policy": 1585.0}}, "num_env_steps_sampled": 325080, "num_env_steps_trained": 325080, "num_agent_steps_sampled": 325080, "num_agent_steps_trained": 325080}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29889.43915129694, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416489378623106, "mean_inference_ms": 0.24952561559291972, "mean_action_processing_ms": 0.05911794969696858, "mean_env_wait_ms": 1.4659887207035407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002553701400756836, "StateBufferConnector_ms": 0.0017347335815429688, "ViewRequirementAgentConnector_ms": 0.0451359748840332}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29889.43915129694, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29952.150386711714, -30027.542977524696, -29980.608932878808, -29654.081732654013, -29760.49144391256, -29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416489378623106, "mean_inference_ms": 0.24952561559291972, "mean_action_processing_ms": 0.05911794969696858, "mean_env_wait_ms": 1.4659887207035407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002553701400756836, "StateBufferConnector_ms": 0.0017347335815429688, "ViewRequirementAgentConnector_ms": 0.0451359748840332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 325080, "num_agent_steps_trained": 325080, "num_env_steps_sampled": 325080, "num_env_steps_trained": 325080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.64059230063222, "num_env_steps_trained_throughput_per_sec": 160.64059230063222, "timesteps_total": 325080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 325080, "timers": {"training_iteration_time_ms": 2235.722, "sample_time_ms": 2230.488, "load_time_ms": 0.216, "load_throughput": 1669374.726, "learn_time_ms": 4.474, "learn_throughput": 80459.832, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 325080, "num_env_steps_trained": 325080, "num_agent_steps_sampled": 325080, "num_agent_steps_trained": 325080}, "done": false, "episodes_total": 903, "training_iteration": 181, "trial_id": "a960d_00000", "date": "2023-07-25_16-23-26", "timestamp": 1690291406, "time_this_iter_s": 11.207260131835938, "time_total_s": 2025.7612369060516, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1185.881984949112, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 27.65625, "ram_util_percent": 78.29375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -2500136534016.0, "vf_loss": 2514827221.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1601.0, "diff_num_grad_updates_vs_sampler_policy": 1600.0}}, "num_env_steps_sampled": 326880, "num_env_steps_trained": 326880, "num_agent_steps_sampled": 326880, "num_agent_steps_trained": 326880}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29892.025421377824, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416511009008702, "mean_inference_ms": 0.24952713863841264, "mean_action_processing_ms": 0.059117786380067816, "mean_env_wait_ms": 1.4659515633485154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002554178237915039, "StateBufferConnector_ms": 0.001737356185913086, "ViewRequirementAgentConnector_ms": 0.045206308364868164}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29892.025421377824, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29915.888788642424, -29824.559767934294, -30073.001005324597, -29850.505992697836, -29968.538368697216, -29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416511009008702, "mean_inference_ms": 0.24952713863841264, "mean_action_processing_ms": 0.059117786380067816, "mean_env_wait_ms": 1.4659515633485154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002554178237915039, "StateBufferConnector_ms": 0.001737356185913086, "ViewRequirementAgentConnector_ms": 0.045206308364868164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326880, "num_agent_steps_trained": 326880, "num_env_steps_sampled": 326880, "num_env_steps_trained": 326880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.75898346820645, "num_env_steps_trained_throughput_per_sec": 157.75898346820645, "timesteps_total": 326880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 326880, "timers": {"training_iteration_time_ms": 2261.484, "sample_time_ms": 2256.136, "load_time_ms": 0.226, "load_throughput": 1595297.876, "learn_time_ms": 4.56, "learn_throughput": 78946.238, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 326880, "num_env_steps_trained": 326880, "num_agent_steps_sampled": 326880, "num_agent_steps_trained": 326880}, "done": false, "episodes_total": 908, "training_iteration": 182, "trial_id": "a960d_00000", "date": "2023-07-25_16-23-37", "timestamp": 1690291417, "time_this_iter_s": 11.411988019943237, "time_total_s": 2037.1732249259949, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1197.2939729690552, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 26.01875, "ram_util_percent": 77.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -1810179964928.0, "vf_loss": 2491665642.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1616.0, "diff_num_grad_updates_vs_sampler_policy": 1615.0}}, "num_env_steps_sampled": 328680, "num_env_steps_trained": 328680, "num_agent_steps_sampled": 328680, "num_agent_steps_trained": 328680}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29892.703224660912, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4165202739681915, "mean_inference_ms": 0.24952957936507444, "mean_action_processing_ms": 0.05911770158411638, "mean_env_wait_ms": 1.465919167785392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025510787963867188, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.045198917388916016}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29892.703224660912, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29674.771591674416, -29808.42998321277, -30040.02049631861, -29873.785335934885, -29712.64264405703, -29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4165202739681915, "mean_inference_ms": 0.24952957936507444, "mean_action_processing_ms": 0.05911770158411638, "mean_env_wait_ms": 1.465919167785392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025510787963867188, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.045198917388916016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328680, "num_agent_steps_trained": 328680, "num_env_steps_sampled": 328680, "num_env_steps_trained": 328680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.46675062648524, "num_env_steps_trained_throughput_per_sec": 161.46675062648524, "timesteps_total": 328680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 328680, "timers": {"training_iteration_time_ms": 2255.751, "sample_time_ms": 2250.187, "load_time_ms": 0.245, "load_throughput": 1470252.619, "learn_time_ms": 4.725, "learn_throughput": 76183.504, "synch_weights_time_ms": 0.555}, "counters": {"num_env_steps_sampled": 328680, "num_env_steps_trained": 328680, "num_agent_steps_sampled": 328680, "num_agent_steps_trained": 328680}, "done": false, "episodes_total": 913, "training_iteration": 183, "trial_id": "a960d_00000", "date": "2023-07-25_16-23-48", "timestamp": 1690291428, "time_this_iter_s": 11.150118112564087, "time_total_s": 2048.323343038559, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1208.4440910816193, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 22.981250000000003, "ram_util_percent": 77.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -1450499816789.3333, "vf_loss": 2507465429.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1631.0, "diff_num_grad_updates_vs_sampler_policy": 1630.0}}, "num_env_steps_sampled": 330480, "num_env_steps_trained": 330480, "num_agent_steps_sampled": 330480, "num_agent_steps_trained": 330480}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29894.90608408651, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416530978701079, "mean_inference_ms": 0.2495330525600332, "mean_action_processing_ms": 0.05911786428554185, "mean_env_wait_ms": 1.4658803670125053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025458335876464844, "StateBufferConnector_ms": 0.001733541488647461, "ViewRequirementAgentConnector_ms": 0.045214176177978516}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29894.90608408651, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29991.54541534784, -30009.448060213177, -30052.010585975793, -29906.618904685824, -29750.506762686615, -30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416530978701079, "mean_inference_ms": 0.2495330525600332, "mean_action_processing_ms": 0.05911786428554185, "mean_env_wait_ms": 1.4658803670125053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025458335876464844, "StateBufferConnector_ms": 0.001733541488647461, "ViewRequirementAgentConnector_ms": 0.045214176177978516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 330480, "num_agent_steps_trained": 330480, "num_env_steps_sampled": 330480, "num_env_steps_trained": 330480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.74043911937795, "num_env_steps_trained_throughput_per_sec": 159.74043911937795, "timesteps_total": 330480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 330480, "timers": {"training_iteration_time_ms": 2241.599, "sample_time_ms": 2236.163, "load_time_ms": 0.234, "load_throughput": 1535437.706, "learn_time_ms": 4.615, "learn_throughput": 77998.091, "synch_weights_time_ms": 0.551}, "counters": {"num_env_steps_sampled": 330480, "num_env_steps_trained": 330480, "num_agent_steps_sampled": 330480, "num_agent_steps_trained": 330480}, "done": false, "episodes_total": 918, "training_iteration": 184, "trial_id": "a960d_00000", "date": "2023-07-25_16-24-00", "timestamp": 1690291440, "time_this_iter_s": 11.270537376403809, "time_total_s": 2059.5938804149628, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1219.714628458023, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 25.6625, "ram_util_percent": 77.76875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -4035770269696.0, "vf_loss": 2495936469.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1646.0, "diff_num_grad_updates_vs_sampler_policy": 1645.0}}, "num_env_steps_sampled": 332280, "num_env_steps_trained": 332280, "num_agent_steps_sampled": 332280, "num_agent_steps_trained": 332280}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29893.93019131072, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416546252835203, "mean_inference_ms": 0.24953479374175822, "mean_action_processing_ms": 0.059117868056722374, "mean_env_wait_ms": 1.4658385175335957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025522708892822266, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.045274972915649414}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29893.93019131072, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30118.92865766994, -29813.365998727462, -29758.071536914387, -29837.989486634233, -29814.875295933973, -29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416546252835203, "mean_inference_ms": 0.24953479374175822, "mean_action_processing_ms": 0.059117868056722374, "mean_env_wait_ms": 1.4658385175335957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025522708892822266, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.045274972915649414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332280, "num_agent_steps_trained": 332280, "num_env_steps_sampled": 332280, "num_env_steps_trained": 332280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4674896352045, "num_env_steps_trained_throughput_per_sec": 161.4674896352045, "timesteps_total": 332280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 332280, "timers": {"training_iteration_time_ms": 2241.594, "sample_time_ms": 2236.337, "load_time_ms": 0.221, "load_throughput": 1629559.076, "learn_time_ms": 4.472, "learn_throughput": 80493.717, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 332280, "num_env_steps_trained": 332280, "num_agent_steps_sampled": 332280, "num_agent_steps_trained": 332280}, "done": false, "episodes_total": 923, "training_iteration": 185, "trial_id": "a960d_00000", "date": "2023-07-25_16-24-11", "timestamp": 1690291451, "time_this_iter_s": 11.149858951568604, "time_total_s": 2070.7437393665314, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1230.8644874095917, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 25.087500000000002, "ram_util_percent": 77.58749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -2233253694805.3335, "vf_loss": 2513056448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1661.0, "diff_num_grad_updates_vs_sampler_policy": 1660.0}}, "num_env_steps_sampled": 334080, "num_env_steps_trained": 334080, "num_agent_steps_sampled": 334080, "num_agent_steps_trained": 334080}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29891.012312996398, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416546839147969, "mean_inference_ms": 0.24953380506621156, "mean_action_processing_ms": 0.059117469116073976, "mean_env_wait_ms": 1.4657884463556488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002553701400756836, "StateBufferConnector_ms": 0.001737833023071289, "ViewRequirementAgentConnector_ms": 0.04537534713745117}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29891.012312996398, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29991.112410750517, -29849.15100388427, -29899.319897409176, -29779.593766191294, -30201.010487843967, -29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416546839147969, "mean_inference_ms": 0.24953380506621156, "mean_action_processing_ms": 0.059117469116073976, "mean_env_wait_ms": 1.4657884463556488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002553701400756836, "StateBufferConnector_ms": 0.001737833023071289, "ViewRequirementAgentConnector_ms": 0.04537534713745117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 334080, "num_agent_steps_trained": 334080, "num_env_steps_sampled": 334080, "num_env_steps_trained": 334080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.1279212643284, "num_env_steps_trained_throughput_per_sec": 161.1279212643284, "timesteps_total": 334080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 334080, "timers": {"training_iteration_time_ms": 2231.891, "sample_time_ms": 2226.528, "load_time_ms": 0.22, "load_throughput": 1639645.39, "learn_time_ms": 4.575, "learn_throughput": 78694.843, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 334080, "num_env_steps_trained": 334080, "num_agent_steps_sampled": 334080, "num_agent_steps_trained": 334080}, "done": false, "episodes_total": 928, "training_iteration": 186, "trial_id": "a960d_00000", "date": "2023-07-25_16-24-22", "timestamp": 1690291462, "time_this_iter_s": 11.173549890518188, "time_total_s": 2081.9172892570496, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1242.0380373001099, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 25.51875, "ram_util_percent": 77.75625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -4233682381482.6665, "vf_loss": 2499830293.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1676.0, "diff_num_grad_updates_vs_sampler_policy": 1675.0}}, "num_env_steps_sampled": 335880, "num_env_steps_trained": 335880, "num_agent_steps_sampled": 335880, "num_agent_steps_trained": 335880}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29887.87565797456, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4165471119251585, "mean_inference_ms": 0.2495335706696553, "mean_action_processing_ms": 0.05911721612594988, "mean_env_wait_ms": 1.4657439040224118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025627613067626953, "StateBufferConnector_ms": 0.0017268657684326172, "ViewRequirementAgentConnector_ms": 0.04548764228820801}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30214.679800016085, "episode_reward_mean": -29887.87565797456, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29979.809047569208, -30073.265943805123, -29637.81483001369, -30214.679800016085, -29886.70215603181, -29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4165471119251585, "mean_inference_ms": 0.2495335706696553, "mean_action_processing_ms": 0.05911721612594988, "mean_env_wait_ms": 1.4657439040224118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025627613067626953, "StateBufferConnector_ms": 0.0017268657684326172, "ViewRequirementAgentConnector_ms": 0.04548764228820801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 335880, "num_agent_steps_trained": 335880, "num_env_steps_sampled": 335880, "num_env_steps_trained": 335880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.04176306832073, "num_env_steps_trained_throughput_per_sec": 161.04176306832073, "timesteps_total": 335880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 335880, "timers": {"training_iteration_time_ms": 2234.838, "sample_time_ms": 2229.46, "load_time_ms": 0.217, "load_throughput": 1660014.776, "learn_time_ms": 4.598, "learn_throughput": 78299.823, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 335880, "num_env_steps_trained": 335880, "num_agent_steps_sampled": 335880, "num_agent_steps_trained": 335880}, "done": false, "episodes_total": 933, "training_iteration": 187, "trial_id": "a960d_00000", "date": "2023-07-25_16-24-33", "timestamp": 1690291473, "time_this_iter_s": 11.179237842559814, "time_total_s": 2093.0965270996094, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1253.2172751426697, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 25.987499999999997, "ram_util_percent": 77.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -2765585219584.0, "vf_loss": 2474742656.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1691.0, "diff_num_grad_updates_vs_sampler_policy": 1690.0}}, "num_env_steps_sampled": 337680, "num_env_steps_trained": 337680, "num_agent_steps_sampled": 337680, "num_agent_steps_trained": 337680}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29883.79551722001, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416531916184758, "mean_inference_ms": 0.24953272873580912, "mean_action_processing_ms": 0.05911686451196733, "mean_env_wait_ms": 1.465723094391368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002526998519897461, "StateBufferConnector_ms": 0.0017151832580566406, "ViewRequirementAgentConnector_ms": 0.04544687271118164}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29883.79551722001, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29977.2582813218, -29773.394934155396, -29952.927444979756, -29873.70823030989, -29908.379596468538, -29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416531916184758, "mean_inference_ms": 0.24953272873580912, "mean_action_processing_ms": 0.05911686451196733, "mean_env_wait_ms": 1.465723094391368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002526998519897461, "StateBufferConnector_ms": 0.0017151832580566406, "ViewRequirementAgentConnector_ms": 0.04544687271118164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337680, "num_agent_steps_trained": 337680, "num_env_steps_sampled": 337680, "num_env_steps_trained": 337680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.85673514214756, "num_env_steps_trained_throughput_per_sec": 161.85673514214756, "timesteps_total": 337680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 337680, "timers": {"training_iteration_time_ms": 2229.808, "sample_time_ms": 2224.556, "load_time_ms": 0.221, "load_throughput": 1630967.207, "learn_time_ms": 4.48, "learn_throughput": 80364.336, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 337680, "num_env_steps_trained": 337680, "num_agent_steps_sampled": 337680, "num_agent_steps_trained": 337680}, "done": false, "episodes_total": 938, "training_iteration": 188, "trial_id": "a960d_00000", "date": "2023-07-25_16-24-44", "timestamp": 1690291484, "time_this_iter_s": 11.123272895812988, "time_total_s": 2104.2197999954224, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1264.3405480384827, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 24.6, "ram_util_percent": 76.70666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -3236048902826.6665, "vf_loss": 2497973141.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1706.0, "diff_num_grad_updates_vs_sampler_policy": 1705.0}}, "num_env_steps_sampled": 339480, "num_env_steps_trained": 339480, "num_agent_steps_sampled": 339480, "num_agent_steps_trained": 339480}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29889.913530048285, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416512089265669, "mean_inference_ms": 0.24953276510378125, "mean_action_processing_ms": 0.05911678758341193, "mean_env_wait_ms": 1.46569328919464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025310516357421875, "StateBufferConnector_ms": 0.0017178058624267578, "ViewRequirementAgentConnector_ms": 0.04539060592651367}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29889.913530048285, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29965.244605368218, -30097.094751011242, -30092.562396121044, -29929.951427424025, -29920.36182718991, -29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416512089265669, "mean_inference_ms": 0.24953276510378125, "mean_action_processing_ms": 0.05911678758341193, "mean_env_wait_ms": 1.46569328919464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025310516357421875, "StateBufferConnector_ms": 0.0017178058624267578, "ViewRequirementAgentConnector_ms": 0.04539060592651367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 339480, "num_agent_steps_trained": 339480, "num_env_steps_sampled": 339480, "num_env_steps_trained": 339480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.2534932305146, "num_env_steps_trained_throughput_per_sec": 162.2534932305146, "timesteps_total": 339480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 339480, "timers": {"training_iteration_time_ms": 2221.46, "sample_time_ms": 2216.267, "load_time_ms": 0.221, "load_throughput": 1632201.319, "learn_time_ms": 4.429, "learn_throughput": 81290.213, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 339480, "num_env_steps_trained": 339480, "num_agent_steps_sampled": 339480, "num_agent_steps_trained": 339480}, "done": false, "episodes_total": 943, "training_iteration": 189, "trial_id": "a960d_00000", "date": "2023-07-25_16-24-55", "timestamp": 1690291495, "time_this_iter_s": 11.095970153808594, "time_total_s": 2115.315770149231, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1275.4365181922913, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 25.10625, "ram_util_percent": 76.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -4633842532352.0, "vf_loss": 2472022336.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1721.0, "diff_num_grad_updates_vs_sampler_policy": 1720.0}}, "num_env_steps_sampled": 341280, "num_env_steps_trained": 341280, "num_agent_steps_sampled": 341280, "num_agent_steps_trained": 341280}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29885.03328551481, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416474095797593, "mean_inference_ms": 0.24953383096921855, "mean_action_processing_ms": 0.059116931814357496, "mean_env_wait_ms": 1.4656645352888742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002531766891479492, "StateBufferConnector_ms": 0.0017237663269042969, "ViewRequirementAgentConnector_ms": 0.04543709754943848}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29885.03328551481, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29873.57213317788, -29654.074936687015, -29855.061151799764, -30165.19937498209, -30029.38208421121, -29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416474095797593, "mean_inference_ms": 0.24953383096921855, "mean_action_processing_ms": 0.059116931814357496, "mean_env_wait_ms": 1.4656645352888742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002531766891479492, "StateBufferConnector_ms": 0.0017237663269042969, "ViewRequirementAgentConnector_ms": 0.04543709754943848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 341280, "num_agent_steps_trained": 341280, "num_env_steps_sampled": 341280, "num_env_steps_trained": 341280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.32167345280283, "num_env_steps_trained_throughput_per_sec": 161.32167345280283, "timesteps_total": 341280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 341280, "timers": {"training_iteration_time_ms": 2225.147, "sample_time_ms": 2219.63, "load_time_ms": 0.222, "load_throughput": 1624824.535, "learn_time_ms": 4.702, "learn_throughput": 76567.891, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 341280, "num_env_steps_trained": 341280, "num_agent_steps_sampled": 341280, "num_agent_steps_trained": 341280}, "done": false, "episodes_total": 948, "training_iteration": 190, "trial_id": "a960d_00000", "date": "2023-07-25_16-25-07", "timestamp": 1690291507, "time_this_iter_s": 11.159888982772827, "time_total_s": 2126.475659132004, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1286.596407175064, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 27.006249999999998, "ram_util_percent": 76.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5285237630208, "policy_loss": -4102425870336.0, "vf_loss": 2456739818.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1736.0, "diff_num_grad_updates_vs_sampler_policy": 1735.0}}, "num_env_steps_sampled": 343080, "num_env_steps_trained": 343080, "num_agent_steps_sampled": 343080, "num_agent_steps_trained": 343080}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29884.54434328096, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416440166595191, "mean_inference_ms": 0.24953586630579017, "mean_action_processing_ms": 0.0591172337000685, "mean_env_wait_ms": 1.4656405536882366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025310516357421875, "StateBufferConnector_ms": 0.0017275810241699219, "ViewRequirementAgentConnector_ms": 0.045349836349487305}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29884.54434328096, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29941.608145996244, -29566.372711064367, -29887.93809927277, -30100.51132868259, -29807.06735199936, -29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416440166595191, "mean_inference_ms": 0.24953586630579017, "mean_action_processing_ms": 0.0591172337000685, "mean_env_wait_ms": 1.4656405536882366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025310516357421875, "StateBufferConnector_ms": 0.0017275810241699219, "ViewRequirementAgentConnector_ms": 0.045349836349487305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 343080, "num_agent_steps_trained": 343080, "num_env_steps_sampled": 343080, "num_env_steps_trained": 343080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.91328829983323, "num_env_steps_trained_throughput_per_sec": 160.91328829983323, "timesteps_total": 343080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 343080, "timers": {"training_iteration_time_ms": 2234.387, "sample_time_ms": 2228.801, "load_time_ms": 0.226, "load_throughput": 1592941.703, "learn_time_ms": 4.744, "learn_throughput": 75887.915, "synch_weights_time_ms": 0.579}, "counters": {"num_env_steps_sampled": 343080, "num_env_steps_trained": 343080, "num_agent_steps_sampled": 343080, "num_agent_steps_trained": 343080}, "done": false, "episodes_total": 953, "training_iteration": 191, "trial_id": "a960d_00000", "date": "2023-07-25_16-25-18", "timestamp": 1690291518, "time_this_iter_s": 11.188257694244385, "time_total_s": 2137.663916826248, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1297.7846648693085, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 35.88125, "ram_util_percent": 76.86875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -2119567960746.6667, "vf_loss": 2516640874.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1751.0, "diff_num_grad_updates_vs_sampler_policy": 1750.0}}, "num_env_steps_sampled": 344880, "num_env_steps_trained": 344880, "num_agent_steps_sampled": 344880, "num_agent_steps_trained": 344880}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29885.81268385386, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416390769406508, "mean_inference_ms": 0.24953667752319866, "mean_action_processing_ms": 0.05911741098438842, "mean_env_wait_ms": 1.465627070862232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002537250518798828, "StateBufferConnector_ms": 0.0017352104187011719, "ViewRequirementAgentConnector_ms": 0.04541134834289551}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29885.81268385386, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29524.12045709442, -29881.992453037135, -29866.211552498502, -29980.44560608911, -29706.63727601465, -29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416390769406508, "mean_inference_ms": 0.24953667752319866, "mean_action_processing_ms": 0.05911741098438842, "mean_env_wait_ms": 1.465627070862232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002537250518798828, "StateBufferConnector_ms": 0.0017352104187011719, "ViewRequirementAgentConnector_ms": 0.04541134834289551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344880, "num_agent_steps_trained": 344880, "num_env_steps_sampled": 344880, "num_env_steps_trained": 344880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.59139679999794, "num_env_steps_trained_throughput_per_sec": 161.59139679999794, "timesteps_total": 344880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 344880, "timers": {"training_iteration_time_ms": 2232.526, "sample_time_ms": 2227.286, "load_time_ms": 0.22, "load_throughput": 1636446.776, "learn_time_ms": 4.457, "learn_throughput": 80778.357, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 344880, "num_env_steps_trained": 344880, "num_agent_steps_sampled": 344880, "num_agent_steps_trained": 344880}, "done": false, "episodes_total": 958, "training_iteration": 192, "trial_id": "a960d_00000", "date": "2023-07-25_16-25-29", "timestamp": 1690291529, "time_this_iter_s": 11.141447305679321, "time_total_s": 2148.8053641319275, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1308.9261121749878, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 23.268749999999997, "ram_util_percent": 76.78125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -3570866039466.6665, "vf_loss": 2475399317.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1766.0, "diff_num_grad_updates_vs_sampler_policy": 1765.0}}, "num_env_steps_sampled": 346680, "num_env_steps_trained": 346680, "num_agent_steps_sampled": 346680, "num_agent_steps_trained": 346680}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29895.060209638843, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416318030717351, "mean_inference_ms": 0.24953896642619816, "mean_action_processing_ms": 0.059117689904323714, "mean_env_wait_ms": 1.4655879889078693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002538919448852539, "StateBufferConnector_ms": 0.0017447471618652344, "ViewRequirementAgentConnector_ms": 0.04544663429260254}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30205.786486559657, "episode_reward_mean": -29895.060209638843, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29824.001442996883, -29784.33939349065, -29759.1132578216, -30205.786486559657, -29690.147126522974, -29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416318030717351, "mean_inference_ms": 0.24953896642619816, "mean_action_processing_ms": 0.059117689904323714, "mean_env_wait_ms": 1.4655879889078693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002538919448852539, "StateBufferConnector_ms": 0.0017447471618652344, "ViewRequirementAgentConnector_ms": 0.04544663429260254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 346680, "num_agent_steps_trained": 346680, "num_env_steps_sampled": 346680, "num_env_steps_trained": 346680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.99362166251288, "num_env_steps_trained_throughput_per_sec": 162.99362166251288, "timesteps_total": 346680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 346680, "timers": {"training_iteration_time_ms": 2218.249, "sample_time_ms": 2213.003, "load_time_ms": 0.212, "load_throughput": 1695429.418, "learn_time_ms": 4.463, "learn_throughput": 80658.4, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 346680, "num_env_steps_trained": 346680, "num_agent_steps_sampled": 346680, "num_agent_steps_trained": 346680}, "done": false, "episodes_total": 963, "training_iteration": 193, "trial_id": "a960d_00000", "date": "2023-07-25_16-25-40", "timestamp": 1690291540, "time_this_iter_s": 11.04531216621399, "time_total_s": 2159.8506762981415, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1319.9714243412018, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 22.40666666666667, "ram_util_percent": 76.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -3532327544149.3335, "vf_loss": 2501597184.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1781.0, "diff_num_grad_updates_vs_sampler_policy": 1780.0}}, "num_env_steps_sampled": 348480, "num_env_steps_trained": 348480, "num_agent_steps_sampled": 348480, "num_agent_steps_trained": 348480}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29898.349524383088, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416221595494829, "mean_inference_ms": 0.2495400780501207, "mean_action_processing_ms": 0.05911779336219523, "mean_env_wait_ms": 1.4655344013980578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002540111541748047, "StateBufferConnector_ms": 0.00174713134765625, "ViewRequirementAgentConnector_ms": 0.04545140266418457}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29898.349524383088, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29865.573705457795, -29947.704077563183, -29843.17860944088, -29796.43143026399, -29824.736811806695, -29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416221595494829, "mean_inference_ms": 0.2495400780501207, "mean_action_processing_ms": 0.05911779336219523, "mean_env_wait_ms": 1.4655344013980578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002540111541748047, "StateBufferConnector_ms": 0.00174713134765625, "ViewRequirementAgentConnector_ms": 0.04545140266418457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348480, "num_agent_steps_trained": 348480, "num_env_steps_sampled": 348480, "num_env_steps_trained": 348480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.3177164641149, "num_env_steps_trained_throughput_per_sec": 163.3177164641149, "timesteps_total": 348480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 348480, "timers": {"training_iteration_time_ms": 2206.474, "sample_time_ms": 2201.218, "load_time_ms": 0.215, "load_throughput": 1677535.207, "learn_time_ms": 4.467, "learn_throughput": 80599.415, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 348480, "num_env_steps_trained": 348480, "num_agent_steps_sampled": 348480, "num_agent_steps_trained": 348480}, "done": false, "episodes_total": 968, "training_iteration": 194, "trial_id": "a960d_00000", "date": "2023-07-25_16-25-51", "timestamp": 1690291551, "time_this_iter_s": 11.023641109466553, "time_total_s": 2170.874317407608, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1330.9950654506683, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 22.34375, "ram_util_percent": 76.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -3276794178218.6665, "vf_loss": 2463514069.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1796.0, "diff_num_grad_updates_vs_sampler_policy": 1795.0}}, "num_env_steps_sampled": 350280, "num_env_steps_trained": 350280, "num_agent_steps_sampled": 350280, "num_agent_steps_trained": 350280}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29899.488870797097, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416104034263208, "mean_inference_ms": 0.24954165925265578, "mean_action_processing_ms": 0.05911795912226716, "mean_env_wait_ms": 1.4654776170502726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513885498046875, "StateBufferConnector_ms": 0.0017430782318115234, "ViewRequirementAgentConnector_ms": 0.044965267181396484}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29899.488870797097, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29920.33092837831, -29869.594069482784, -29916.482567635987, -29546.258814989033, -30069.151523619195, -29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416104034263208, "mean_inference_ms": 0.24954165925265578, "mean_action_processing_ms": 0.05911795912226716, "mean_env_wait_ms": 1.4654776170502726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513885498046875, "StateBufferConnector_ms": 0.0017430782318115234, "ViewRequirementAgentConnector_ms": 0.044965267181396484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 350280, "num_agent_steps_trained": 350280, "num_env_steps_sampled": 350280, "num_env_steps_trained": 350280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.63443343881087, "num_env_steps_trained_throughput_per_sec": 162.63443343881087, "timesteps_total": 350280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 350280, "timers": {"training_iteration_time_ms": 2208.914, "sample_time_ms": 2203.744, "load_time_ms": 0.213, "load_throughput": 1690304.982, "learn_time_ms": 4.411, "learn_throughput": 81607.419, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 350280, "num_env_steps_trained": 350280, "num_agent_steps_sampled": 350280, "num_agent_steps_trained": 350280}, "done": false, "episodes_total": 973, "training_iteration": 195, "trial_id": "a960d_00000", "date": "2023-07-25_16-26-02", "timestamp": 1690291562, "time_this_iter_s": 11.069746017456055, "time_total_s": 2181.944063425064, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1342.0648114681244, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 22.71875, "ram_util_percent": 76.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -3166196553045.3335, "vf_loss": 2483861248.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1811.0, "diff_num_grad_updates_vs_sampler_policy": 1810.0}}, "num_env_steps_sampled": 352080, "num_env_steps_trained": 352080, "num_agent_steps_sampled": 352080, "num_agent_steps_trained": 352080}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29900.90842035444, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41595791994558, "mean_inference_ms": 0.24954252506967456, "mean_action_processing_ms": 0.05911807993600471, "mean_env_wait_ms": 1.465417312262943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025069713592529297, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.04499077796936035}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29900.90842035444, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29770.1851333456, -29917.08971224502, -29693.681458186213, -30048.748474594016, -29732.51332471801, -29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41595791994558, "mean_inference_ms": 0.24954252506967456, "mean_action_processing_ms": 0.05911807993600471, "mean_env_wait_ms": 1.465417312262943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025069713592529297, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.04499077796936035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352080, "num_agent_steps_trained": 352080, "num_env_steps_sampled": 352080, "num_env_steps_trained": 352080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.5481478891469, "num_env_steps_trained_throughput_per_sec": 162.5481478891469, "timesteps_total": 352080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 352080, "timers": {"training_iteration_time_ms": 2214.132, "sample_time_ms": 2208.987, "load_time_ms": 0.221, "load_throughput": 1631495.883, "learn_time_ms": 4.394, "learn_throughput": 81929.779, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 352080, "num_env_steps_trained": 352080, "num_agent_steps_sampled": 352080, "num_agent_steps_trained": 352080}, "done": false, "episodes_total": 978, "training_iteration": 196, "trial_id": "a960d_00000", "date": "2023-07-25_16-26-13", "timestamp": 1690291573, "time_this_iter_s": 11.075708866119385, "time_total_s": 2193.0197722911835, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1353.1405203342438, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 25.24666666666667, "ram_util_percent": 76.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -3122577309696.0, "vf_loss": 2474038613.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1826.0, "diff_num_grad_updates_vs_sampler_policy": 1825.0}}, "num_env_steps_sampled": 353880, "num_env_steps_trained": 353880, "num_agent_steps_sampled": 353880, "num_agent_steps_trained": 353880}, "sampler_results": {"episode_reward_max": -29410.864909992524, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29898.68064807354, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41578636729935, "mean_inference_ms": 0.2495449879616732, "mean_action_processing_ms": 0.05911851599015719, "mean_env_wait_ms": 1.4653558171594216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508401870727539, "StateBufferConnector_ms": 0.0017435550689697266, "ViewRequirementAgentConnector_ms": 0.04500102996826172}}, "episode_reward_max": -29410.864909992524, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29898.68064807354, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29821.550465983677, -29410.864909992524, -29847.504159699933, -30025.760690168623, -30058.218385858578, -29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41578636729935, "mean_inference_ms": 0.2495449879616732, "mean_action_processing_ms": 0.05911851599015719, "mean_env_wait_ms": 1.4653558171594216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508401870727539, "StateBufferConnector_ms": 0.0017435550689697266, "ViewRequirementAgentConnector_ms": 0.04500102996826172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 353880, "num_agent_steps_trained": 353880, "num_env_steps_sampled": 353880, "num_env_steps_trained": 353880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.73913568810406, "num_env_steps_trained_throughput_per_sec": 161.73913568810406, "timesteps_total": 353880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 353880, "timers": {"training_iteration_time_ms": 2220.258, "sample_time_ms": 2215.088, "load_time_ms": 0.224, "load_throughput": 1607184.077, "learn_time_ms": 4.406, "learn_throughput": 81698.379, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 353880, "num_env_steps_trained": 353880, "num_agent_steps_sampled": 353880, "num_agent_steps_trained": 353880}, "done": false, "episodes_total": 983, "training_iteration": 197, "trial_id": "a960d_00000", "date": "2023-07-25_16-26-24", "timestamp": 1690291584, "time_this_iter_s": 11.13109278678894, "time_total_s": 2204.1508650779724, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1364.2716131210327, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 23.15, "ram_util_percent": 75.44375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -4803719989930.667, "vf_loss": 2499606485.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1841.0, "diff_num_grad_updates_vs_sampler_policy": 1840.0}}, "num_env_steps_sampled": 355680, "num_env_steps_trained": 355680, "num_agent_steps_sampled": 355680, "num_agent_steps_trained": 355680}, "sampler_results": {"episode_reward_max": -29470.56335677233, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29899.39011798012, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415638010851743, "mean_inference_ms": 0.24955442073848758, "mean_action_processing_ms": 0.05912001813948397, "mean_env_wait_ms": 1.4653112555292152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017468929290771484, "ViewRequirementAgentConnector_ms": 0.04523110389709473}}, "episode_reward_max": -29470.56335677233, "episode_reward_min": -30173.955004504525, "episode_reward_mean": -29899.39011798012, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29692.863678916114, -30173.955004504525, -30017.378236077962, -29928.275390235234, -29804.97393526435, -29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415638010851743, "mean_inference_ms": 0.24955442073848758, "mean_action_processing_ms": 0.05912001813948397, "mean_env_wait_ms": 1.4653112555292152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017468929290771484, "ViewRequirementAgentConnector_ms": 0.04523110389709473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 355680, "num_agent_steps_trained": 355680, "num_env_steps_sampled": 355680, "num_env_steps_trained": 355680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.4932279816469, "num_env_steps_trained_throughput_per_sec": 157.4932279816469, "timesteps_total": 355680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 355680, "timers": {"training_iteration_time_ms": 2255.8, "sample_time_ms": 2250.449, "load_time_ms": 0.232, "load_throughput": 1553126.353, "learn_time_ms": 4.555, "learn_throughput": 79028.464, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 355680, "num_env_steps_trained": 355680, "num_agent_steps_sampled": 355680, "num_agent_steps_trained": 355680}, "done": false, "episodes_total": 988, "training_iteration": 198, "trial_id": "a960d_00000", "date": "2023-07-25_16-26-36", "timestamp": 1690291596, "time_this_iter_s": 11.431143045425415, "time_total_s": 2215.582008123398, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1375.7027561664581, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 29.225, "ram_util_percent": 76.14375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -1406796864170.6667, "vf_loss": 2504745685.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1856.0, "diff_num_grad_updates_vs_sampler_policy": 1855.0}}, "num_env_steps_sampled": 357480, "num_env_steps_trained": 357480, "num_agent_steps_sampled": 357480, "num_agent_steps_trained": 357480}, "sampler_results": {"episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29901.966067013593, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415487380493312, "mean_inference_ms": 0.24956297171778993, "mean_action_processing_ms": 0.059121440942678724, "mean_env_wait_ms": 1.4652573030212426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542257308959961, "StateBufferConnector_ms": 0.0017478466033935547, "ViewRequirementAgentConnector_ms": 0.045345306396484375}}, "episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29901.966067013593, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29787.267248985892, -29901.960389248885, -30021.83071601856, -29943.06420549961, -30120.3503158088, -29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415487380493312, "mean_inference_ms": 0.24956297171778993, "mean_action_processing_ms": 0.059121440942678724, "mean_env_wait_ms": 1.4652573030212426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542257308959961, "StateBufferConnector_ms": 0.0017478466033935547, "ViewRequirementAgentConnector_ms": 0.045345306396484375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 357480, "num_agent_steps_trained": 357480, "num_env_steps_sampled": 357480, "num_env_steps_trained": 357480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.81280649148704, "num_env_steps_trained_throughput_per_sec": 161.81280649148704, "timesteps_total": 357480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 357480, "timers": {"training_iteration_time_ms": 2255.293, "sample_time_ms": 2249.959, "load_time_ms": 0.23, "load_throughput": 1565687.93, "learn_time_ms": 4.538, "learn_throughput": 79330.733, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 357480, "num_env_steps_trained": 357480, "num_agent_steps_sampled": 357480, "num_agent_steps_trained": 357480}, "done": false, "episodes_total": 993, "training_iteration": 199, "trial_id": "a960d_00000", "date": "2023-07-25_16-26-47", "timestamp": 1690291607, "time_this_iter_s": 11.126080989837646, "time_total_s": 2226.7080891132355, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1386.8288371562958, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 26.1625, "ram_util_percent": 77.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -982168884565.3334, "vf_loss": 2489695616.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1871.0, "diff_num_grad_updates_vs_sampler_policy": 1870.0}}, "num_env_steps_sampled": 359280, "num_env_steps_trained": 359280, "num_agent_steps_sampled": 359280, "num_agent_steps_trained": 359280}, "sampler_results": {"episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29898.15297336022, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415328093987887, "mean_inference_ms": 0.24957215292527343, "mean_action_processing_ms": 0.059122876764416396, "mean_env_wait_ms": 1.4652171416292332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002538442611694336, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.04540109634399414}}, "episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29898.15297336022, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29865.080779286836, -29895.989195815106, -29844.07353800157, -29719.448727772695, -30024.539153998547, -29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415328093987887, "mean_inference_ms": 0.24957215292527343, "mean_action_processing_ms": 0.059122876764416396, "mean_env_wait_ms": 1.4652171416292332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002538442611694336, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.04540109634399414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 359280, "num_agent_steps_trained": 359280, "num_env_steps_sampled": 359280, "num_env_steps_trained": 359280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.2510768675449, "num_env_steps_trained_throughput_per_sec": 161.2510768675449, "timesteps_total": 359280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 359280, "timers": {"training_iteration_time_ms": 2228.659, "sample_time_ms": 2223.43, "load_time_ms": 0.214, "load_throughput": 1678467.586, "learn_time_ms": 4.459, "learn_throughput": 80734.734, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 359280, "num_env_steps_trained": 359280, "num_agent_steps_sampled": 359280, "num_agent_steps_trained": 359280}, "done": false, "episodes_total": 998, "training_iteration": 200, "trial_id": "a960d_00000", "date": "2023-07-25_16-26-58", "timestamp": 1690291618, "time_this_iter_s": 11.164906024932861, "time_total_s": 2237.8729951381683, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1397.9937431812286, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 23.3375, "ram_util_percent": 76.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -1587082863616.0, "vf_loss": 2486361024.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1886.0, "diff_num_grad_updates_vs_sampler_policy": 1885.0}}, "num_env_steps_sampled": 361080, "num_env_steps_trained": 361080, "num_agent_steps_sampled": 361080, "num_agent_steps_trained": 361080}, "sampler_results": {"episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29903.812452117178, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4151665697608475, "mean_inference_ms": 0.24958425397537354, "mean_action_processing_ms": 0.05912470001547243, "mean_env_wait_ms": 1.4651726600194133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002530813217163086, "StateBufferConnector_ms": 0.0017309188842773438, "ViewRequirementAgentConnector_ms": 0.04534792900085449}}, "episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29903.812452117178, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29767.27724149248, -29818.52941023651, -30004.60724390184, -29982.052499492762, -30061.036086646738, -29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4151665697608475, "mean_inference_ms": 0.24958425397537354, "mean_action_processing_ms": 0.05912470001547243, "mean_env_wait_ms": 1.4651726600194133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002530813217163086, "StateBufferConnector_ms": 0.0017309188842773438, "ViewRequirementAgentConnector_ms": 0.04534792900085449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 361080, "num_agent_steps_trained": 361080, "num_env_steps_sampled": 361080, "num_env_steps_trained": 361080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.92727224980365, "num_env_steps_trained_throughput_per_sec": 160.92727224980365, "timesteps_total": 361080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 361080, "timers": {"training_iteration_time_ms": 2234.78, "sample_time_ms": 2229.48, "load_time_ms": 0.216, "load_throughput": 1666610.861, "learn_time_ms": 4.531, "learn_throughput": 79454.714, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 361080, "num_env_steps_trained": 361080, "num_agent_steps_sampled": 361080, "num_agent_steps_trained": 361080}, "done": false, "episodes_total": 1003, "training_iteration": 201, "trial_id": "a960d_00000", "date": "2023-07-25_16-27-09", "timestamp": 1690291629, "time_this_iter_s": 11.187230110168457, "time_total_s": 2249.060225248337, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1409.180973291397, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 36.73125, "ram_util_percent": 77.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -1752317493930.6667, "vf_loss": 2497250176.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1901.0, "diff_num_grad_updates_vs_sampler_policy": 1900.0}}, "num_env_steps_sampled": 362880, "num_env_steps_trained": 362880, "num_agent_steps_sampled": 362880, "num_agent_steps_trained": 362880}, "sampler_results": {"episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29900.59783043219, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414998502502096, "mean_inference_ms": 0.24959642183068786, "mean_action_processing_ms": 0.05912658908041449, "mean_env_wait_ms": 1.4650898361542444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002529621124267578, "StateBufferConnector_ms": 0.0017311573028564453, "ViewRequirementAgentConnector_ms": 0.04529285430908203}}, "episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29900.59783043219, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29899.95882069996, -30052.49754765318, -29912.923753476654, -29920.621237053932, -29914.272892721914, -29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414998502502096, "mean_inference_ms": 0.24959642183068786, "mean_action_processing_ms": 0.05912658908041449, "mean_env_wait_ms": 1.4650898361542444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002529621124267578, "StateBufferConnector_ms": 0.0017311573028564453, "ViewRequirementAgentConnector_ms": 0.04529285430908203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 362880, "num_agent_steps_trained": 362880, "num_env_steps_sampled": 362880, "num_env_steps_trained": 362880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.2268803704994, "num_env_steps_trained_throughput_per_sec": 160.2268803704994, "timesteps_total": 362880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 362880, "timers": {"training_iteration_time_ms": 2241.915, "sample_time_ms": 2236.646, "load_time_ms": 0.22, "load_throughput": 1637511.593, "learn_time_ms": 4.492, "learn_throughput": 80138.705, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 362880, "num_env_steps_trained": 362880, "num_agent_steps_sampled": 362880, "num_agent_steps_trained": 362880}, "done": false, "episodes_total": 1008, "training_iteration": 202, "trial_id": "a960d_00000", "date": "2023-07-25_16-27-21", "timestamp": 1690291641, "time_this_iter_s": 11.23636794090271, "time_total_s": 2260.2965931892395, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1420.4173412322998, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 25.60625, "ram_util_percent": 77.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -790729151829.3334, "vf_loss": 2473081194.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1916.0, "diff_num_grad_updates_vs_sampler_policy": 1915.0}}, "num_env_steps_sampled": 364680, "num_env_steps_trained": 364680, "num_agent_steps_sampled": 364680, "num_agent_steps_trained": 364680}, "sampler_results": {"episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29895.251929904352, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414834790088949, "mean_inference_ms": 0.24961240467712037, "mean_action_processing_ms": 0.059129142908244975, "mean_env_wait_ms": 1.46502373559357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536773681640625, "StateBufferConnector_ms": 0.0017354488372802734, "ViewRequirementAgentConnector_ms": 0.045735836029052734}}, "episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29895.251929904352, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29748.619083027028, -29942.287711773013, -29711.408213481685, -29889.260182622125, -30038.360802853244, -29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414834790088949, "mean_inference_ms": 0.24961240467712037, "mean_action_processing_ms": 0.059129142908244975, "mean_env_wait_ms": 1.46502373559357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536773681640625, "StateBufferConnector_ms": 0.0017354488372802734, "ViewRequirementAgentConnector_ms": 0.045735836029052734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364680, "num_agent_steps_trained": 364680, "num_env_steps_sampled": 364680, "num_env_steps_trained": 364680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.1081935004755, "num_env_steps_trained_throughput_per_sec": 160.1081935004755, "timesteps_total": 364680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 364680, "timers": {"training_iteration_time_ms": 2247.635, "sample_time_ms": 2242.375, "load_time_ms": 0.228, "load_throughput": 1580933.347, "learn_time_ms": 4.461, "learn_throughput": 80693.746, "synch_weights_time_ms": 0.537}, "counters": {"num_env_steps_sampled": 364680, "num_env_steps_trained": 364680, "num_agent_steps_sampled": 364680, "num_agent_steps_trained": 364680}, "done": false, "episodes_total": 1013, "training_iteration": 203, "trial_id": "a960d_00000", "date": "2023-07-25_16-27-32", "timestamp": 1690291652, "time_this_iter_s": 11.244660139083862, "time_total_s": 2271.5412533283234, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1431.6620013713837, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 25.080000000000002, "ram_util_percent": 77.98666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -2093471789738.6667, "vf_loss": 2469672384.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1931.0, "diff_num_grad_updates_vs_sampler_policy": 1930.0}}, "num_env_steps_sampled": 366480, "num_env_steps_trained": 366480, "num_agent_steps_sampled": 366480, "num_agent_steps_trained": 366480}, "sampler_results": {"episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29894.20801527712, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4146578644349, "mean_inference_ms": 0.24962479202935928, "mean_action_processing_ms": 0.05913108002881045, "mean_env_wait_ms": 1.4649599432861315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542257308959961, "StateBufferConnector_ms": 0.001741647720336914, "ViewRequirementAgentConnector_ms": 0.04584836959838867}}, "episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29894.20801527712, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29725.335857997452, -29798.074782257343, -30119.78552030353, -29987.348907044303, -29981.99538372729, -29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4146578644349, "mean_inference_ms": 0.24962479202935928, "mean_action_processing_ms": 0.05913108002881045, "mean_env_wait_ms": 1.4649599432861315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542257308959961, "StateBufferConnector_ms": 0.001741647720336914, "ViewRequirementAgentConnector_ms": 0.04584836959838867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 366480, "num_agent_steps_trained": 366480, "num_env_steps_sampled": 366480, "num_env_steps_trained": 366480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.7119620790515, "num_env_steps_trained_throughput_per_sec": 160.7119620790515, "timesteps_total": 366480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 366480, "timers": {"training_iteration_time_ms": 2244.244, "sample_time_ms": 2239.036, "load_time_ms": 0.223, "load_throughput": 1614746.487, "learn_time_ms": 4.428, "learn_throughput": 81302.468, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 366480, "num_env_steps_trained": 366480, "num_agent_steps_sampled": 366480, "num_agent_steps_trained": 366480}, "done": false, "episodes_total": 1018, "training_iteration": 204, "trial_id": "a960d_00000", "date": "2023-07-25_16-27-43", "timestamp": 1690291663, "time_this_iter_s": 11.202295064926147, "time_total_s": 2282.7435483932495, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1442.8642964363098, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 24.1125, "ram_util_percent": 77.89375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -3473956811776.0, "vf_loss": 2466852778.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1946.0, "diff_num_grad_updates_vs_sampler_policy": 1945.0}}, "num_env_steps_sampled": 368280, "num_env_steps_trained": 368280, "num_agent_steps_sampled": 368280, "num_agent_steps_trained": 368280}, "sampler_results": {"episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29891.13135236148, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414466618457103, "mean_inference_ms": 0.24963919266988352, "mean_action_processing_ms": 0.05913319221077327, "mean_env_wait_ms": 1.4649130129635797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025336742401123047, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.04583549499511719}}, "episode_reward_max": -29470.56335677233, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29891.13135236148, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29711.890305427863, -29990.675663573264, -29470.56335677233, -29910.004436074698, -29968.30938259971, -30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414466618457103, "mean_inference_ms": 0.24963919266988352, "mean_action_processing_ms": 0.05913319221077327, "mean_env_wait_ms": 1.4649130129635797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025336742401123047, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.04583549499511719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368280, "num_agent_steps_trained": 368280, "num_env_steps_sampled": 368280, "num_env_steps_trained": 368280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.40951527484353, "num_env_steps_trained_throughput_per_sec": 161.40951527484353, "timesteps_total": 368280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 368280, "timers": {"training_iteration_time_ms": 2235.183, "sample_time_ms": 2229.948, "load_time_ms": 0.213, "load_throughput": 1686905.865, "learn_time_ms": 4.474, "learn_throughput": 80470.552, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 368280, "num_env_steps_trained": 368280, "num_agent_steps_sampled": 368280, "num_agent_steps_trained": 368280}, "done": false, "episodes_total": 1023, "training_iteration": 205, "trial_id": "a960d_00000", "date": "2023-07-25_16-27-54", "timestamp": 1690291674, "time_this_iter_s": 11.153754949569702, "time_total_s": 2293.897303342819, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1454.0180513858795, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 24.50625, "ram_util_percent": 77.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -2990541744810.6665, "vf_loss": 2483372842.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1961.0, "diff_num_grad_updates_vs_sampler_policy": 1960.0}}, "num_env_steps_sampled": 370080, "num_env_steps_trained": 370080, "num_agent_steps_sampled": 370080, "num_agent_steps_trained": 370080}, "sampler_results": {"episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29894.2054049562, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414270193865386, "mean_inference_ms": 0.24965501050876068, "mean_action_processing_ms": 0.05913552749353259, "mean_env_wait_ms": 1.464869812026613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025339126586914062, "StateBufferConnector_ms": 0.0017282962799072266, "ViewRequirementAgentConnector_ms": 0.04579615592956543}}, "episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29894.2054049562, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30002.30775751759, -29863.654141309813, -29916.12627509672, -29674.096108316116, -29950.337781656133, -29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414270193865386, "mean_inference_ms": 0.24965501050876068, "mean_action_processing_ms": 0.05913552749353259, "mean_env_wait_ms": 1.464869812026613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025339126586914062, "StateBufferConnector_ms": 0.0017282962799072266, "ViewRequirementAgentConnector_ms": 0.04579615592956543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 370080, "num_agent_steps_trained": 370080, "num_env_steps_sampled": 370080, "num_env_steps_trained": 370080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.25616392957735, "num_env_steps_trained_throughput_per_sec": 161.25616392957735, "timesteps_total": 370080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 370080, "timers": {"training_iteration_time_ms": 2231.401, "sample_time_ms": 2225.862, "load_time_ms": 0.23, "load_throughput": 1562447.682, "learn_time_ms": 4.709, "learn_throughput": 76441.912, "synch_weights_time_ms": 0.566}, "counters": {"num_env_steps_sampled": 370080, "num_env_steps_trained": 370080, "num_agent_steps_sampled": 370080, "num_agent_steps_trained": 370080}, "done": false, "episodes_total": 1028, "training_iteration": 206, "trial_id": "a960d_00000", "date": "2023-07-25_16-28-05", "timestamp": 1690291685, "time_this_iter_s": 11.164829969406128, "time_total_s": 2305.0621333122253, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1465.1828813552856, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 27.137500000000003, "ram_util_percent": 77.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5286051432292, "policy_loss": -2813721705130.6665, "vf_loss": 2456011690.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1976.0, "diff_num_grad_updates_vs_sampler_policy": 1975.0}}, "num_env_steps_sampled": 371880, "num_env_steps_trained": 371880, "num_agent_steps_sampled": 371880, "num_agent_steps_trained": 371880}, "sampler_results": {"episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29889.169851225182, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414072999753025, "mean_inference_ms": 0.2496704354912205, "mean_action_processing_ms": 0.05913783786462853, "mean_env_wait_ms": 1.464835507493372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025436878204345703, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04588723182678223}}, "episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29889.169851225182, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29806.0955041238, -29879.01570495862, -30088.82690065827, -29823.363312632046, -29786.956279607264, -29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414072999753025, "mean_inference_ms": 0.2496704354912205, "mean_action_processing_ms": 0.05913783786462853, "mean_env_wait_ms": 1.464835507493372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025436878204345703, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04588723182678223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 371880, "num_agent_steps_trained": 371880, "num_env_steps_sampled": 371880, "num_env_steps_trained": 371880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.7149453214547, "num_env_steps_trained_throughput_per_sec": 160.7149453214547, "timesteps_total": 371880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 371880, "timers": {"training_iteration_time_ms": 2236.221, "sample_time_ms": 2230.739, "load_time_ms": 0.233, "load_throughput": 1542023.529, "learn_time_ms": 4.653, "learn_throughput": 77362.29, "synch_weights_time_ms": 0.562}, "counters": {"num_env_steps_sampled": 371880, "num_env_steps_trained": 371880, "num_agent_steps_sampled": 371880, "num_agent_steps_trained": 371880}, "done": false, "episodes_total": 1033, "training_iteration": 207, "trial_id": "a960d_00000", "date": "2023-07-25_16-28-17", "timestamp": 1690291697, "time_this_iter_s": 11.201883792877197, "time_total_s": 2316.2640171051025, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1476.3847651481628, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 25.20625, "ram_util_percent": 77.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -2846640859818.6665, "vf_loss": 2519223680.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1991.0, "diff_num_grad_updates_vs_sampler_policy": 1990.0}}, "num_env_steps_sampled": 373680, "num_env_steps_trained": 373680, "num_agent_steps_sampled": 373680, "num_agent_steps_trained": 373680}, "sampler_results": {"episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29892.794936718958, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41389667861016, "mean_inference_ms": 0.24968649982699503, "mean_action_processing_ms": 0.059140323826673454, "mean_env_wait_ms": 1.4647932414251346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025475025177001953, "StateBufferConnector_ms": 0.0017354488372802734, "ViewRequirementAgentConnector_ms": 0.04592585563659668}}, "episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29892.794936718958, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29884.248360291185, -30099.673655159044, -30133.026700386556, -29947.440990484643, -30033.080063741876, -30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41389667861016, "mean_inference_ms": 0.24968649982699503, "mean_action_processing_ms": 0.059140323826673454, "mean_env_wait_ms": 1.4647932414251346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025475025177001953, "StateBufferConnector_ms": 0.0017354488372802734, "ViewRequirementAgentConnector_ms": 0.04592585563659668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 373680, "num_agent_steps_trained": 373680, "num_env_steps_sampled": 373680, "num_env_steps_trained": 373680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.24775684578916, "num_env_steps_trained_throughput_per_sec": 161.24775684578916, "timesteps_total": 373680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 373680, "timers": {"training_iteration_time_ms": 2236.281, "sample_time_ms": 2231.06, "load_time_ms": 0.217, "load_throughput": 1656372.795, "learn_time_ms": 4.461, "learn_throughput": 80702.803, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 373680, "num_env_steps_trained": 373680, "num_agent_steps_sampled": 373680, "num_agent_steps_trained": 373680}, "done": false, "episodes_total": 1038, "training_iteration": 208, "trial_id": "a960d_00000", "date": "2023-07-25_16-28-28", "timestamp": 1690291708, "time_this_iter_s": 11.1649808883667, "time_total_s": 2327.4289979934692, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1487.5497460365295, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 24.25, "ram_util_percent": 77.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -2923117196629.3335, "vf_loss": 2510500053.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2006.0, "diff_num_grad_updates_vs_sampler_policy": 2005.0}}, "num_env_steps_sampled": 375480, "num_env_steps_trained": 375480, "num_agent_steps_sampled": 375480, "num_agent_steps_trained": 375480}, "sampler_results": {"episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29885.284094877057, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413732734999011, "mean_inference_ms": 0.2497024537341254, "mean_action_processing_ms": 0.059142742127312894, "mean_env_wait_ms": 1.4647694802370654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025551319122314453, "StateBufferConnector_ms": 0.001743316650390625, "ViewRequirementAgentConnector_ms": 0.04601716995239258}}, "episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29885.284094877057, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30068.66353719098, -29768.889279503717, -29921.51239286844, -29942.055540148613, -29816.069804055205, -30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413732734999011, "mean_inference_ms": 0.2497024537341254, "mean_action_processing_ms": 0.059142742127312894, "mean_env_wait_ms": 1.4647694802370654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025551319122314453, "StateBufferConnector_ms": 0.001743316650390625, "ViewRequirementAgentConnector_ms": 0.04601716995239258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 375480, "num_agent_steps_trained": 375480, "num_env_steps_sampled": 375480, "num_env_steps_trained": 375480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.51152462437665, "num_env_steps_trained_throughput_per_sec": 160.51152462437665, "timesteps_total": 375480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 375480, "timers": {"training_iteration_time_ms": 2237.7, "sample_time_ms": 2232.421, "load_time_ms": 0.218, "load_throughput": 1653108.649, "learn_time_ms": 4.513, "learn_throughput": 79762.366, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 375480, "num_env_steps_trained": 375480, "num_agent_steps_sampled": 375480, "num_agent_steps_trained": 375480}, "done": false, "episodes_total": 1043, "training_iteration": 209, "trial_id": "a960d_00000", "date": "2023-07-25_16-28-39", "timestamp": 1690291719, "time_this_iter_s": 11.216195106506348, "time_total_s": 2338.6451930999756, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1498.765941143036, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 25.15625, "ram_util_percent": 77.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284830729167, "policy_loss": -1654616806741.3333, "vf_loss": 2471178069.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2021.0, "diff_num_grad_updates_vs_sampler_policy": 2020.0}}, "num_env_steps_sampled": 377280, "num_env_steps_trained": 377280, "num_agent_steps_sampled": 377280, "num_agent_steps_trained": 377280}, "sampler_results": {"episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29882.647424612856, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413578981104783, "mean_inference_ms": 0.24971700946193937, "mean_action_processing_ms": 0.05914480698740472, "mean_env_wait_ms": 1.4647456717855099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552032470703125, "StateBufferConnector_ms": 0.0017430782318115234, "ViewRequirementAgentConnector_ms": 0.04594993591308594}}, "episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29882.647424612856, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30059.352742278406, -29751.656731920448, -30111.943830204513, -29862.334461123868, -29743.10769194612, -29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413578981104783, "mean_inference_ms": 0.24971700946193937, "mean_action_processing_ms": 0.05914480698740472, "mean_env_wait_ms": 1.4647456717855099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552032470703125, "StateBufferConnector_ms": 0.0017430782318115234, "ViewRequirementAgentConnector_ms": 0.04594993591308594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 377280, "num_agent_steps_trained": 377280, "num_env_steps_sampled": 377280, "num_env_steps_trained": 377280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.0309396651255, "num_env_steps_trained_throughput_per_sec": 161.0309396651255, "timesteps_total": 377280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 377280, "timers": {"training_iteration_time_ms": 2239.203, "sample_time_ms": 2233.951, "load_time_ms": 0.219, "load_throughput": 1645721.46, "learn_time_ms": 4.471, "learn_throughput": 80510.885, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 377280, "num_env_steps_trained": 377280, "num_agent_steps_sampled": 377280, "num_agent_steps_trained": 377280}, "done": false, "episodes_total": 1048, "training_iteration": 210, "trial_id": "a960d_00000", "date": "2023-07-25_16-28-50", "timestamp": 1690291730, "time_this_iter_s": 11.18003511428833, "time_total_s": 2349.825228214264, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1509.9459762573242, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 23.96666666666666, "ram_util_percent": 77.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5279947916667, "policy_loss": -2950750296064.0, "vf_loss": 2528769600.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2036.0, "diff_num_grad_updates_vs_sampler_policy": 2035.0}}, "num_env_steps_sampled": 379080, "num_env_steps_trained": 379080, "num_agent_steps_sampled": 379080, "num_agent_steps_trained": 379080}, "sampler_results": {"episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29886.61484916897, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41341211270448, "mean_inference_ms": 0.2497315496271755, "mean_action_processing_ms": 0.05914686421693736, "mean_env_wait_ms": 1.4647226421882857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025634765625, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04599142074584961}}, "episode_reward_max": -29597.163333397795, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29886.61484916897, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29840.033309767932, -29926.197561383186, -29899.42715271439, -29743.63854300982, -30021.03512742982, -30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41341211270448, "mean_inference_ms": 0.2497315496271755, "mean_action_processing_ms": 0.05914686421693736, "mean_env_wait_ms": 1.4647226421882857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025634765625, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04599142074584961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 379080, "num_agent_steps_trained": 379080, "num_env_steps_sampled": 379080, "num_env_steps_trained": 379080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.94515383921217, "num_env_steps_trained_throughput_per_sec": 161.94515383921217, "timesteps_total": 379080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 379080, "timers": {"training_iteration_time_ms": 2229.275, "sample_time_ms": 2224.08, "load_time_ms": 0.22, "load_throughput": 1638577.797, "learn_time_ms": 4.414, "learn_throughput": 81555.408, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 379080, "num_env_steps_trained": 379080, "num_agent_steps_sampled": 379080, "num_agent_steps_trained": 379080}, "done": false, "episodes_total": 1053, "training_iteration": 211, "trial_id": "a960d_00000", "date": "2023-07-25_16-29-01", "timestamp": 1690291741, "time_this_iter_s": 11.116949796676636, "time_total_s": 2360.9421780109406, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1521.0629260540009, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 21.987499999999997, "ram_util_percent": 77.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5286051432292, "policy_loss": -2714644490922.6665, "vf_loss": 2423215616.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2051.0, "diff_num_grad_updates_vs_sampler_policy": 2050.0}}, "num_env_steps_sampled": 380880, "num_env_steps_trained": 380880, "num_agent_steps_sampled": 380880, "num_agent_steps_trained": 380880}, "sampler_results": {"episode_reward_max": -29586.395268183976, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29885.36476108099, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413260621579633, "mean_inference_ms": 0.2497470232958048, "mean_action_processing_ms": 0.059148957403187784, "mean_env_wait_ms": 1.4646965414288866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025718212127685547, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.04600882530212402}}, "episode_reward_max": -29586.395268183976, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29885.36476108099, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30000.474203810023, -30147.125243633072, -29844.80607441074, -30122.67456296737, -29769.079838410373, -29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413260621579633, "mean_inference_ms": 0.2497470232958048, "mean_action_processing_ms": 0.059148957403187784, "mean_env_wait_ms": 1.4646965414288866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025718212127685547, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.04600882530212402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380880, "num_agent_steps_trained": 380880, "num_env_steps_sampled": 380880, "num_env_steps_trained": 380880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.907533531642, "num_env_steps_trained_throughput_per_sec": 160.907533531642, "timesteps_total": 380880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 380880, "timers": {"training_iteration_time_ms": 2230.132, "sample_time_ms": 2224.963, "load_time_ms": 0.219, "load_throughput": 1647157.674, "learn_time_ms": 4.411, "learn_throughput": 81614.918, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 380880, "num_env_steps_trained": 380880, "num_agent_steps_sampled": 380880, "num_agent_steps_trained": 380880}, "done": false, "episodes_total": 1058, "training_iteration": 212, "trial_id": "a960d_00000", "date": "2023-07-25_16-29-13", "timestamp": 1690291753, "time_this_iter_s": 11.188589096069336, "time_total_s": 2372.13076710701, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1532.2515151500702, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 24.831249999999997, "ram_util_percent": 77.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5285237630208, "policy_loss": -2725127372800.0, "vf_loss": 2456353920.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2066.0, "diff_num_grad_updates_vs_sampler_policy": 2065.0}}, "num_env_steps_sampled": 382680, "num_env_steps_trained": 382680, "num_agent_steps_sampled": 382680, "num_agent_steps_trained": 382680}, "sampler_results": {"episode_reward_max": -29586.395268183976, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29883.726478178516, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413132102692089, "mean_inference_ms": 0.24975850515156808, "mean_action_processing_ms": 0.05915043775317686, "mean_env_wait_ms": 1.464676236741111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002577543258666992, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.04599809646606445}}, "episode_reward_max": -29586.395268183976, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29883.726478178516, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29955.400082842825, -29936.070888656184, -30071.37049562809, -29660.49027740698, -29968.98743728209, -29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413132102692089, "mean_inference_ms": 0.24975850515156808, "mean_action_processing_ms": 0.05915043775317686, "mean_env_wait_ms": 1.464676236741111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002577543258666992, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.04599809646606445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 382680, "num_agent_steps_trained": 382680, "num_env_steps_sampled": 382680, "num_env_steps_trained": 382680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.74509216822463, "num_env_steps_trained_throughput_per_sec": 161.74509216822463, "timesteps_total": 382680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 382680, "timers": {"training_iteration_time_ms": 2231.508, "sample_time_ms": 2226.299, "load_time_ms": 0.223, "load_throughput": 1617340.874, "learn_time_ms": 4.441, "learn_throughput": 81064.582, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 382680, "num_env_steps_trained": 382680, "num_agent_steps_sampled": 382680, "num_agent_steps_trained": 382680}, "done": false, "episodes_total": 1063, "training_iteration": 213, "trial_id": "a960d_00000", "date": "2023-07-25_16-29-24", "timestamp": 1690291764, "time_this_iter_s": 11.130697965621948, "time_total_s": 2383.261465072632, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1543.3822131156921, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 22.768749999999997, "ram_util_percent": 78.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -2661202061994.6665, "vf_loss": 2491457749.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2081.0, "diff_num_grad_updates_vs_sampler_policy": 2080.0}}, "num_env_steps_sampled": 384480, "num_env_steps_trained": 384480, "num_agent_steps_sampled": 384480, "num_agent_steps_trained": 384480}, "sampler_results": {"episode_reward_max": -29586.395268183976, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29883.665396398865, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413017443858522, "mean_inference_ms": 0.24977175513820477, "mean_action_processing_ms": 0.05915213334032748, "mean_env_wait_ms": 1.4646634830076775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025849342346191406, "StateBufferConnector_ms": 0.0017306804656982422, "ViewRequirementAgentConnector_ms": 0.046036720275878906}}, "episode_reward_max": -29586.395268183976, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29883.665396398865, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29770.481976578703, -30119.050719130264, -29849.269147924944, -29921.575822110222, -29731.18161018936, -29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413017443858522, "mean_inference_ms": 0.24977175513820477, "mean_action_processing_ms": 0.05915213334032748, "mean_env_wait_ms": 1.4646634830076775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025849342346191406, "StateBufferConnector_ms": 0.0017306804656982422, "ViewRequirementAgentConnector_ms": 0.046036720275878906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384480, "num_agent_steps_trained": 384480, "num_env_steps_sampled": 384480, "num_env_steps_trained": 384480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.1199836706426, "num_env_steps_trained_throughput_per_sec": 162.1199836706426, "timesteps_total": 384480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 384480, "timers": {"training_iteration_time_ms": 2223.142, "sample_time_ms": 2217.901, "load_time_ms": 0.223, "load_throughput": 1615956.164, "learn_time_ms": 4.455, "learn_throughput": 80811.646, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 384480, "num_env_steps_trained": 384480, "num_agent_steps_sampled": 384480, "num_agent_steps_trained": 384480}, "done": false, "episodes_total": 1068, "training_iteration": 214, "trial_id": "a960d_00000", "date": "2023-07-25_16-29-35", "timestamp": 1690291775, "time_this_iter_s": 11.104815006256104, "time_total_s": 2394.366280078888, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1554.4870281219482, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 24.746666666666666, "ram_util_percent": 78.47333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -1739168393898.6667, "vf_loss": 2484826133.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2096.0, "diff_num_grad_updates_vs_sampler_policy": 2095.0}}, "num_env_steps_sampled": 386280, "num_env_steps_trained": 386280, "num_agent_steps_sampled": 386280, "num_agent_steps_trained": 386280}, "sampler_results": {"episode_reward_max": -29566.374889871357, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29881.95113211785, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412915692862541, "mean_inference_ms": 0.24978384005937698, "mean_action_processing_ms": 0.05915361430291128, "mean_env_wait_ms": 1.464654121777044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025916099548339844, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.04604482650756836}}, "episode_reward_max": -29566.374889871357, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29881.95113211785, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29965.414654438347, -30148.493143052274, -29774.360691131184, -29719.205965659516, -29856.29840555847, -29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412915692862541, "mean_inference_ms": 0.24978384005937698, "mean_action_processing_ms": 0.05915361430291128, "mean_env_wait_ms": 1.464654121777044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025916099548339844, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.04604482650756836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 386280, "num_agent_steps_trained": 386280, "num_env_steps_sampled": 386280, "num_env_steps_trained": 386280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.89605629230735, "num_env_steps_trained_throughput_per_sec": 161.89605629230735, "timesteps_total": 386280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 386280, "timers": {"training_iteration_time_ms": 2222.104, "sample_time_ms": 2216.802, "load_time_ms": 0.216, "load_throughput": 1664773.363, "learn_time_ms": 4.511, "learn_throughput": 79800.726, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 386280, "num_env_steps_trained": 386280, "num_agent_steps_sampled": 386280, "num_agent_steps_trained": 386280}, "done": false, "episodes_total": 1073, "training_iteration": 215, "trial_id": "a960d_00000", "date": "2023-07-25_16-29-46", "timestamp": 1690291786, "time_this_iter_s": 11.120235919952393, "time_total_s": 2405.4865159988403, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1565.6072640419006, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 24.625, "ram_util_percent": 78.00625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -1723259267754.6667, "vf_loss": 2494853077.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2111.0, "diff_num_grad_updates_vs_sampler_policy": 2110.0}}, "num_env_steps_sampled": 388080, "num_env_steps_trained": 388080, "num_agent_steps_sampled": 388080, "num_agent_steps_trained": 388080}, "sampler_results": {"episode_reward_max": -29566.374889871357, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29877.849356840878, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412813289570782, "mean_inference_ms": 0.24979756704423076, "mean_action_processing_ms": 0.05915525181695852, "mean_env_wait_ms": 1.4646584167831387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025959014892578125, "StateBufferConnector_ms": 0.001730203628540039, "ViewRequirementAgentConnector_ms": 0.04599142074584961}}, "episode_reward_max": -29566.374889871357, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29877.849356840878, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29844.116199629083, -29835.158514233342, -29816.837086471314, -29597.163333397795, -29846.165741267316, -29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412813289570782, "mean_inference_ms": 0.24979756704423076, "mean_action_processing_ms": 0.05915525181695852, "mean_env_wait_ms": 1.4646584167831387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025959014892578125, "StateBufferConnector_ms": 0.001730203628540039, "ViewRequirementAgentConnector_ms": 0.04599142074584961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388080, "num_agent_steps_trained": 388080, "num_env_steps_sampled": 388080, "num_env_steps_trained": 388080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.80909916250806, "num_env_steps_trained_throughput_per_sec": 161.80909916250806, "timesteps_total": 388080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 388080, "timers": {"training_iteration_time_ms": 2224.237, "sample_time_ms": 2218.964, "load_time_ms": 0.216, "load_throughput": 1666978.847, "learn_time_ms": 4.497, "learn_throughput": 80054.579, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 388080, "num_env_steps_trained": 388080, "num_agent_steps_sampled": 388080, "num_agent_steps_trained": 388080}, "done": false, "episodes_total": 1078, "training_iteration": 216, "trial_id": "a960d_00000", "date": "2023-07-25_16-29-57", "timestamp": 1690291797, "time_this_iter_s": 11.126272201538086, "time_total_s": 2416.6127882003784, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1576.7335362434387, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 23.9125, "ram_util_percent": 75.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5279541015625, "policy_loss": -2793722893653.3335, "vf_loss": 2529618538.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2126.0, "diff_num_grad_updates_vs_sampler_policy": 2125.0}}, "num_env_steps_sampled": 389880, "num_env_steps_trained": 389880, "num_agent_steps_sampled": 389880, "num_agent_steps_trained": 389880}, "sampler_results": {"episode_reward_max": -29566.374889871357, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29880.02695670932, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412718130578975, "mean_inference_ms": 0.24981033939908998, "mean_action_processing_ms": 0.05915675050918038, "mean_env_wait_ms": 1.4646492606292583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025870800018310547, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.04585695266723633}}, "episode_reward_max": -29566.374889871357, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29880.02695670932, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29798.38415914509, -29889.89186389666, -29844.698890398005, -29724.856141162505, -29977.014547759758, -30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412718130578975, "mean_inference_ms": 0.24981033939908998, "mean_action_processing_ms": 0.05915675050918038, "mean_env_wait_ms": 1.4646492606292583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025870800018310547, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.04585695266723633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 389880, "num_agent_steps_trained": 389880, "num_env_steps_sampled": 389880, "num_env_steps_trained": 389880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.5005588161625, "num_env_steps_trained_throughput_per_sec": 162.5005588161625, "timesteps_total": 389880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 389880, "timers": {"training_iteration_time_ms": 2220.101, "sample_time_ms": 2214.941, "load_time_ms": 0.215, "load_throughput": 1671777.502, "learn_time_ms": 4.399, "learn_throughput": 81840.965, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 389880, "num_env_steps_trained": 389880, "num_agent_steps_sampled": 389880, "num_agent_steps_trained": 389880}, "done": false, "episodes_total": 1083, "training_iteration": 217, "trial_id": "a960d_00000", "date": "2023-07-25_16-30-08", "timestamp": 1690291808, "time_this_iter_s": 11.07892918586731, "time_total_s": 2427.6917173862457, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1587.812465429306, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 24.30625, "ram_util_percent": 75.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -2780962727253.3335, "vf_loss": 2513635328.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2141.0, "diff_num_grad_updates_vs_sampler_policy": 2140.0}}, "num_env_steps_sampled": 391680, "num_env_steps_trained": 391680, "num_agent_steps_sampled": 391680, "num_agent_steps_trained": 391680}, "sampler_results": {"episode_reward_max": -29566.374889871357, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29886.12511598046, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412585942405298, "mean_inference_ms": 0.24981754934386546, "mean_action_processing_ms": 0.05915728834526968, "mean_env_wait_ms": 1.464620659422504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002565622329711914, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.045674800872802734}}, "episode_reward_max": -29566.374889871357, "episode_reward_min": -30280.59926122694, "episode_reward_mean": -29886.12511598046, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30280.59926122694, -29790.587649190256, -30016.838698009284, -29895.69533158129, -29891.320208336536, -30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412585942405298, "mean_inference_ms": 0.24981754934386546, "mean_action_processing_ms": 0.05915728834526968, "mean_env_wait_ms": 1.464620659422504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002565622329711914, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.045674800872802734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 391680, "num_agent_steps_trained": 391680, "num_env_steps_sampled": 391680, "num_env_steps_trained": 391680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.63975945399986, "num_env_steps_trained_throughput_per_sec": 161.63975945399986, "timesteps_total": 391680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 391680, "timers": {"training_iteration_time_ms": 2221.266, "sample_time_ms": 2216.079, "load_time_ms": 0.216, "load_throughput": 1666978.847, "learn_time_ms": 4.416, "learn_throughput": 81525.465, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 391680, "num_env_steps_trained": 391680, "num_agent_steps_sampled": 391680, "num_agent_steps_trained": 391680}, "done": false, "episodes_total": 1088, "training_iteration": 218, "trial_id": "a960d_00000", "date": "2023-07-25_16-30-19", "timestamp": 1690291819, "time_this_iter_s": 11.138049125671387, "time_total_s": 2438.829766511917, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1598.9505145549774, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 24.253333333333334, "ram_util_percent": 76.49333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.52783203125, "policy_loss": -1819098038272.0, "vf_loss": 2527607765.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2156.0, "diff_num_grad_updates_vs_sampler_policy": 2155.0}}, "num_env_steps_sampled": 393480, "num_env_steps_trained": 393480, "num_agent_steps_sampled": 393480, "num_agent_steps_trained": 393480}, "sampler_results": {"episode_reward_max": -29566.374889871357, "episode_reward_min": -30206.386033823313, "episode_reward_mean": -29886.0556408558, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4124448623348815, "mean_inference_ms": 0.24982478396986857, "mean_action_processing_ms": 0.05915784612254061, "mean_env_wait_ms": 1.4645960857027795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002554655075073242, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04552769660949707}}, "episode_reward_max": -29566.374889871357, "episode_reward_min": -30206.386033823313, "episode_reward_mean": -29886.0556408558, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30000.728855736223, -29932.42078560514, -29872.9561924052, -29760.14238733203, -29826.915289146178, -29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4124448623348815, "mean_inference_ms": 0.24982478396986857, "mean_action_processing_ms": 0.05915784612254061, "mean_env_wait_ms": 1.4645960857027795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002554655075073242, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04552769660949707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 393480, "num_agent_steps_trained": 393480, "num_env_steps_sampled": 393480, "num_env_steps_trained": 393480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.38079291367998, "num_env_steps_trained_throughput_per_sec": 162.38079291367998, "timesteps_total": 393480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 393480, "timers": {"training_iteration_time_ms": 2222.083, "sample_time_ms": 2216.724, "load_time_ms": 0.234, "load_throughput": 1537470.156, "learn_time_ms": 4.551, "learn_throughput": 79105.058, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 393480, "num_env_steps_trained": 393480, "num_agent_steps_sampled": 393480, "num_agent_steps_trained": 393480}, "done": false, "episodes_total": 1093, "training_iteration": 219, "trial_id": "a960d_00000", "date": "2023-07-25_16-30-30", "timestamp": 1690291830, "time_this_iter_s": 11.087157011032104, "time_total_s": 2449.916923522949, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1610.0376715660095, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 22.85625, "ram_util_percent": 76.66874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -1726009600682.6667, "vf_loss": 2510412970.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2171.0, "diff_num_grad_updates_vs_sampler_policy": 2170.0}}, "num_env_steps_sampled": 395280, "num_env_steps_trained": 395280, "num_agent_steps_sampled": 395280, "num_agent_steps_trained": 395280}, "sampler_results": {"episode_reward_max": -29566.374889871357, "episode_reward_min": -30206.386033823313, "episode_reward_mean": -29888.40194116312, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412295473687871, "mean_inference_ms": 0.2498309921538818, "mean_action_processing_ms": 0.059158189193315065, "mean_env_wait_ms": 1.4645692427183832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002556324005126953, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.04542970657348633}}, "episode_reward_max": -29566.374889871357, "episode_reward_min": -30206.386033823313, "episode_reward_mean": -29888.40194116312, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29945.47437590601, -29826.63331238621, -30206.386033823313, -30050.243611854225, -29886.341936601333, -29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412295473687871, "mean_inference_ms": 0.2498309921538818, "mean_action_processing_ms": 0.059158189193315065, "mean_env_wait_ms": 1.4645692427183832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002556324005126953, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.04542970657348633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 395280, "num_agent_steps_trained": 395280, "num_env_steps_sampled": 395280, "num_env_steps_trained": 395280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.31921897890396, "num_env_steps_trained_throughput_per_sec": 162.31921897890396, "timesteps_total": 395280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 395280, "timers": {"training_iteration_time_ms": 2217.421, "sample_time_ms": 2211.93, "load_time_ms": 0.234, "load_throughput": 1539507.993, "learn_time_ms": 4.676, "learn_throughput": 76995.418, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 395280, "num_env_steps_trained": 395280, "num_agent_steps_sampled": 395280, "num_agent_steps_trained": 395280}, "done": false, "episodes_total": 1098, "training_iteration": 220, "trial_id": "a960d_00000", "date": "2023-07-25_16-30-42", "timestamp": 1690291842, "time_this_iter_s": 11.091317176818848, "time_total_s": 2461.008240699768, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1621.1289887428284, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 24.09375, "ram_util_percent": 76.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -2503914007210.6665, "vf_loss": 2468640277.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2186.0, "diff_num_grad_updates_vs_sampler_policy": 2185.0}}, "num_env_steps_sampled": 397080, "num_env_steps_trained": 397080, "num_agent_steps_sampled": 397080, "num_agent_steps_trained": 397080}, "sampler_results": {"episode_reward_max": -29566.374889871357, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29883.216288566662, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412123913400742, "mean_inference_ms": 0.2498330347247861, "mean_action_processing_ms": 0.05915800078084666, "mean_env_wait_ms": 1.4645497304142103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002553224563598633, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.04540371894836426}}, "episode_reward_max": -29566.374889871357, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29883.216288566662, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29891.875505396336, -29794.603104073256, -29785.41140253756, -29912.311544152217, -29927.838757112364, -29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412123913400742, "mean_inference_ms": 0.2498330347247861, "mean_action_processing_ms": 0.05915800078084666, "mean_env_wait_ms": 1.4645497304142103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002553224563598633, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.04540371894836426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 397080, "num_agent_steps_trained": 397080, "num_env_steps_sampled": 397080, "num_env_steps_trained": 397080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.5551651038743, "num_env_steps_trained_throughput_per_sec": 162.5551651038743, "timesteps_total": 397080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 397080, "timers": {"training_iteration_time_ms": 2216.233, "sample_time_ms": 2210.871, "load_time_ms": 0.213, "load_throughput": 1689737.511, "learn_time_ms": 4.587, "learn_throughput": 78485.412, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 397080, "num_env_steps_trained": 397080, "num_agent_steps_sampled": 397080, "num_agent_steps_trained": 397080}, "done": false, "episodes_total": 1103, "training_iteration": 221, "trial_id": "a960d_00000", "date": "2023-07-25_16-30-53", "timestamp": 1690291853, "time_this_iter_s": 11.075228929519653, "time_total_s": 2472.0834696292877, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1632.204217672348, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 23.1875, "ram_util_percent": 75.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -1500006886058.6667, "vf_loss": 2489151210.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2201.0, "diff_num_grad_updates_vs_sampler_policy": 2200.0}}, "num_env_steps_sampled": 398880, "num_env_steps_trained": 398880, "num_agent_steps_sampled": 398880, "num_agent_steps_trained": 398880}, "sampler_results": {"episode_reward_max": -29566.374889871357, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29884.05870065022, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411943465784994, "mean_inference_ms": 0.2498320044606582, "mean_action_processing_ms": 0.05915736114363335, "mean_env_wait_ms": 1.4645156416158673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025594234466552734, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.04542422294616699}}, "episode_reward_max": -29566.374889871357, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29884.05870065022, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29820.96628404856, -29795.421718711437, -29874.28091924617, -29867.861710001023, -29807.15356681416, -29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411943465784994, "mean_inference_ms": 0.2498320044606582, "mean_action_processing_ms": 0.05915736114363335, "mean_env_wait_ms": 1.4645156416158673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025594234466552734, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.04542422294616699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 398880, "num_agent_steps_trained": 398880, "num_env_steps_sampled": 398880, "num_env_steps_trained": 398880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.24173233038655, "num_env_steps_trained_throughput_per_sec": 162.24173233038655, "timesteps_total": 398880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 398880, "timers": {"training_iteration_time_ms": 2216.762, "sample_time_ms": 2211.383, "load_time_ms": 0.214, "load_throughput": 1682957.468, "learn_time_ms": 4.565, "learn_throughput": 78853.476, "synch_weights_time_ms": 0.567}, "counters": {"num_env_steps_sampled": 398880, "num_env_steps_trained": 398880, "num_agent_steps_sampled": 398880, "num_agent_steps_trained": 398880}, "done": false, "episodes_total": 1108, "training_iteration": 222, "trial_id": "a960d_00000", "date": "2023-07-25_16-31-04", "timestamp": 1690291864, "time_this_iter_s": 11.096885919570923, "time_total_s": 2483.1803555488586, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1643.301103591919, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 22.279999999999998, "ram_util_percent": 75.81333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -1294462035285.3333, "vf_loss": 2486064384.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2216.0, "diff_num_grad_updates_vs_sampler_policy": 2215.0}}, "num_env_steps_sampled": 400680, "num_env_steps_trained": 400680, "num_agent_steps_sampled": 400680, "num_agent_steps_trained": 400680}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29881.511588856425, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411751530345531, "mean_inference_ms": 0.24982725135121142, "mean_action_processing_ms": 0.05915614268628744, "mean_env_wait_ms": 1.4644713343984341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025568008422851562, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.0450289249420166}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29881.511588856425, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29838.69749820983, -30005.94458778755, -29838.69965791939, -29695.096951973836, -29847.105835143608, -29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411751530345531, "mean_inference_ms": 0.24982725135121142, "mean_action_processing_ms": 0.05915614268628744, "mean_env_wait_ms": 1.4644713343984341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025568008422851562, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.0450289249420166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400680, "num_agent_steps_trained": 400680, "num_env_steps_sampled": 400680, "num_env_steps_trained": 400680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.05107986728453, "num_env_steps_trained_throughput_per_sec": 162.05107986728453, "timesteps_total": 400680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 400680, "timers": {"training_iteration_time_ms": 2220.206, "sample_time_ms": 2214.629, "load_time_ms": 0.22, "load_throughput": 1638222.242, "learn_time_ms": 4.716, "learn_throughput": 76334.48, "synch_weights_time_ms": 0.609}, "counters": {"num_env_steps_sampled": 400680, "num_env_steps_trained": 400680, "num_agent_steps_sampled": 400680, "num_agent_steps_trained": 400680}, "done": false, "episodes_total": 1113, "training_iteration": 223, "trial_id": "a960d_00000", "date": "2023-07-25_16-31-15", "timestamp": 1690291875, "time_this_iter_s": 11.1096031665802, "time_total_s": 2494.289958715439, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1654.4107067584991, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 25.299999999999997, "ram_util_percent": 76.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -1043297881429.3334, "vf_loss": 2455344405.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2231.0, "diff_num_grad_updates_vs_sampler_policy": 2230.0}}, "num_env_steps_sampled": 402480, "num_env_steps_trained": 402480, "num_agent_steps_sampled": 402480, "num_agent_steps_trained": 402480}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29885.061822404637, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411565450533271, "mean_inference_ms": 0.24982167708072495, "mean_action_processing_ms": 0.05915481617025376, "mean_env_wait_ms": 1.4644155202637759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025577545166015625, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.04498291015625}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29885.061822404637, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29967.179557522537, -29998.798944795035, -29933.192804209193, -29656.627047849055, -29749.075805389868, -29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411565450533271, "mean_inference_ms": 0.24982167708072495, "mean_action_processing_ms": 0.05915481617025376, "mean_env_wait_ms": 1.4644155202637759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025577545166015625, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.04498291015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 402480, "num_agent_steps_trained": 402480, "num_env_steps_sampled": 402480, "num_env_steps_trained": 402480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.31196012901458, "num_env_steps_trained_throughput_per_sec": 161.31196012901458, "timesteps_total": 402480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 402480, "timers": {"training_iteration_time_ms": 2226.602, "sample_time_ms": 2221.229, "load_time_ms": 0.219, "load_throughput": 1646618.8, "learn_time_ms": 4.569, "learn_throughput": 78791.344, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 402480, "num_env_steps_trained": 402480, "num_agent_steps_sampled": 402480, "num_agent_steps_trained": 402480}, "done": false, "episodes_total": 1118, "training_iteration": 224, "trial_id": "a960d_00000", "date": "2023-07-25_16-31-26", "timestamp": 1690291886, "time_this_iter_s": 11.160603046417236, "time_total_s": 2505.450561761856, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1665.5713098049164, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 24.262500000000003, "ram_util_percent": 77.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -977101168640.0, "vf_loss": 2495690944.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2246.0, "diff_num_grad_updates_vs_sampler_policy": 2245.0}}, "num_env_steps_sampled": 404280, "num_env_steps_trained": 404280, "num_agent_steps_sampled": 404280, "num_agent_steps_trained": 404280}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29888.845471928915, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411390882344881, "mean_inference_ms": 0.24981578772656532, "mean_action_processing_ms": 0.059153519946861195, "mean_env_wait_ms": 1.4643519760661032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025634765625, "StateBufferConnector_ms": 0.0017228126525878906, "ViewRequirementAgentConnector_ms": 0.04500007629394531}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29888.845471928915, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29926.67973712818, -29841.384306054708, -29790.070934722837, -30026.393289185344, -29774.32013682992, -29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411390882344881, "mean_inference_ms": 0.24981578772656532, "mean_action_processing_ms": 0.059153519946861195, "mean_env_wait_ms": 1.4643519760661032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025634765625, "StateBufferConnector_ms": 0.0017228126525878906, "ViewRequirementAgentConnector_ms": 0.04500007629394531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404280, "num_agent_steps_trained": 404280, "num_env_steps_sampled": 404280, "num_env_steps_trained": 404280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.37866368819368, "num_env_steps_trained_throughput_per_sec": 161.37866368819368, "timesteps_total": 404280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 404280, "timers": {"training_iteration_time_ms": 2231.23, "sample_time_ms": 2226.095, "load_time_ms": 0.215, "load_throughput": 1677721.6, "learn_time_ms": 4.378, "learn_throughput": 82237.672, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 404280, "num_env_steps_trained": 404280, "num_agent_steps_sampled": 404280, "num_agent_steps_trained": 404280}, "done": false, "episodes_total": 1123, "training_iteration": 225, "trial_id": "a960d_00000", "date": "2023-07-25_16-31-37", "timestamp": 1690291897, "time_this_iter_s": 11.15589690208435, "time_total_s": 2516.6064586639404, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1676.7272067070007, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 23.512500000000003, "ram_util_percent": 77.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -2051490840576.0, "vf_loss": 2495131626.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2261.0, "diff_num_grad_updates_vs_sampler_policy": 2260.0}}, "num_env_steps_sampled": 406080, "num_env_steps_trained": 406080, "num_agent_steps_sampled": 406080, "num_agent_steps_trained": 406080}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29887.730497751505, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411223659433567, "mean_inference_ms": 0.2498085251638218, "mean_action_processing_ms": 0.05915203734767363, "mean_env_wait_ms": 1.4642819485230836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025658607482910156, "StateBufferConnector_ms": 0.0017337799072265625, "ViewRequirementAgentConnector_ms": 0.04507803916931152}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29887.730497751505, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29822.739639815325, -29706.55858974926, -29870.81824090392, -29824.533883670232, -29678.316336655003, -29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411223659433567, "mean_inference_ms": 0.2498085251638218, "mean_action_processing_ms": 0.05915203734767363, "mean_env_wait_ms": 1.4642819485230836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025658607482910156, "StateBufferConnector_ms": 0.0017337799072265625, "ViewRequirementAgentConnector_ms": 0.04507803916931152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 406080, "num_agent_steps_trained": 406080, "num_env_steps_sampled": 406080, "num_env_steps_trained": 406080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.5885573149512, "num_env_steps_trained_throughput_per_sec": 161.5885573149512, "timesteps_total": 406080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 406080, "timers": {"training_iteration_time_ms": 2229.319, "sample_time_ms": 2223.985, "load_time_ms": 0.219, "load_throughput": 1641071.014, "learn_time_ms": 4.537, "learn_throughput": 79355.748, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 406080, "num_env_steps_trained": 406080, "num_agent_steps_sampled": 406080, "num_agent_steps_trained": 406080}, "done": false, "episodes_total": 1128, "training_iteration": 226, "trial_id": "a960d_00000", "date": "2023-07-25_16-31-48", "timestamp": 1690291908, "time_this_iter_s": 11.141527652740479, "time_total_s": 2527.747986316681, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1687.8687343597412, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 26.450000000000003, "ram_util_percent": 77.08125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528564453125, "policy_loss": -4901367300096.0, "vf_loss": 2424918080.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2276.0, "diff_num_grad_updates_vs_sampler_policy": 2275.0}}, "num_env_steps_sampled": 407880, "num_env_steps_trained": 407880, "num_agent_steps_sampled": 407880, "num_agent_steps_trained": 407880}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29888.733182676784, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411048770280071, "mean_inference_ms": 0.24980111527359428, "mean_action_processing_ms": 0.05915056320964217, "mean_env_wait_ms": 1.4642075778978807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025475025177001953, "StateBufferConnector_ms": 0.0017292499542236328, "ViewRequirementAgentConnector_ms": 0.04495644569396973}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29888.733182676784, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29878.786417026997, -30000.209238637766, -29848.163438861226, -29963.71834709713, -30055.888809733915, -29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411048770280071, "mean_inference_ms": 0.24980111527359428, "mean_action_processing_ms": 0.05915056320964217, "mean_env_wait_ms": 1.4642075778978807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025475025177001953, "StateBufferConnector_ms": 0.0017292499542236328, "ViewRequirementAgentConnector_ms": 0.04495644569396973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 407880, "num_agent_steps_trained": 407880, "num_env_steps_sampled": 407880, "num_env_steps_trained": 407880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.8063317816408, "num_env_steps_trained_throughput_per_sec": 161.8063317816408, "timesteps_total": 407880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 407880, "timers": {"training_iteration_time_ms": 2226.371, "sample_time_ms": 2221.06, "load_time_ms": 0.22, "load_throughput": 1639823.458, "learn_time_ms": 4.531, "learn_throughput": 79457.641, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 407880, "num_env_steps_trained": 407880, "num_agent_steps_sampled": 407880, "num_agent_steps_trained": 407880}, "done": false, "episodes_total": 1133, "training_iteration": 227, "trial_id": "a960d_00000", "date": "2023-07-25_16-32-00", "timestamp": 1690291920, "time_this_iter_s": 11.126547813415527, "time_total_s": 2538.8745341300964, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1698.9952821731567, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 22.686666666666667, "ram_util_percent": 77.02666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -3281633300480.0, "vf_loss": 2492625450.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2291.0, "diff_num_grad_updates_vs_sampler_policy": 2290.0}}, "num_env_steps_sampled": 409680, "num_env_steps_trained": 409680, "num_agent_steps_sampled": 409680, "num_agent_steps_trained": 409680}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29884.471733402428, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410876379251899, "mean_inference_ms": 0.24979241051342121, "mean_action_processing_ms": 0.05914886049096295, "mean_env_wait_ms": 1.4641436863490511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552032470703125, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04493975639343262}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29884.471733402428, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29753.104630391852, -29738.693409295367, -29987.44777250886, -29872.452863902272, -29994.686909774966, -29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410876379251899, "mean_inference_ms": 0.24979241051342121, "mean_action_processing_ms": 0.05914886049096295, "mean_env_wait_ms": 1.4641436863490511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552032470703125, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04493975639343262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 409680, "num_agent_steps_trained": 409680, "num_env_steps_sampled": 409680, "num_env_steps_trained": 409680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.52075953737855, "num_env_steps_trained_throughput_per_sec": 160.52075953737855, "timesteps_total": 409680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 409680, "timers": {"training_iteration_time_ms": 2233.782, "sample_time_ms": 2228.469, "load_time_ms": 0.217, "load_throughput": 1662024.7, "learn_time_ms": 4.56, "learn_throughput": 78949.953, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 409680, "num_env_steps_trained": 409680, "num_agent_steps_sampled": 409680, "num_agent_steps_trained": 409680}, "done": false, "episodes_total": 1138, "training_iteration": 228, "trial_id": "a960d_00000", "date": "2023-07-25_16-32-11", "timestamp": 1690291931, "time_this_iter_s": 11.215591192245483, "time_total_s": 2550.090125322342, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1710.2108733654022, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 24.53125, "ram_util_percent": 76.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5287272135417, "policy_loss": -1655770574165.3333, "vf_loss": 2429986496.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2306.0, "diff_num_grad_updates_vs_sampler_policy": 2305.0}}, "num_env_steps_sampled": 411480, "num_env_steps_trained": 411480, "num_agent_steps_sampled": 411480, "num_agent_steps_trained": 411480}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29878.06270657608, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410699559381171, "mean_inference_ms": 0.24978313259472892, "mean_action_processing_ms": 0.059147003780085125, "mean_env_wait_ms": 1.46408473631846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025517940521240234, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.044928789138793945}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29878.06270657608, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29798.13797538252, -29858.928016660953, -29828.816180254315, -29997.20158882835, -29770.43976622069, -29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410699559381171, "mean_inference_ms": 0.24978313259472892, "mean_action_processing_ms": 0.059147003780085125, "mean_env_wait_ms": 1.46408473631846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025517940521240234, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.044928789138793945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 411480, "num_agent_steps_trained": 411480, "num_env_steps_sampled": 411480, "num_env_steps_trained": 411480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.61271270276146, "num_env_steps_trained_throughput_per_sec": 160.61271270276146, "timesteps_total": 411480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 411480, "timers": {"training_iteration_time_ms": 2242.049, "sample_time_ms": 2236.617, "load_time_ms": 0.217, "load_throughput": 1662390.664, "learn_time_ms": 4.656, "learn_throughput": 77326.238, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 411480, "num_env_steps_trained": 411480, "num_agent_steps_sampled": 411480, "num_agent_steps_trained": 411480}, "done": false, "episodes_total": 1143, "training_iteration": 229, "trial_id": "a960d_00000", "date": "2023-07-25_16-32-22", "timestamp": 1690291942, "time_this_iter_s": 11.209099054336548, "time_total_s": 2561.2992243766785, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1721.4199724197388, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 23.924999999999997, "ram_util_percent": 76.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -1579041906688.0, "vf_loss": 2474005845.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2321.0, "diff_num_grad_updates_vs_sampler_policy": 2320.0}}, "num_env_steps_sampled": 413280, "num_env_steps_trained": 413280, "num_agent_steps_sampled": 413280, "num_agent_steps_trained": 413280}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29877.957284235476, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410523232915311, "mean_inference_ms": 0.2497720937276242, "mean_action_processing_ms": 0.059144942820045475, "mean_env_wait_ms": 1.4640255041832324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002553701400756836, "StateBufferConnector_ms": 0.001726388931274414, "ViewRequirementAgentConnector_ms": 0.04495716094970703}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29877.957284235476, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29893.149991985458, -30147.74495619323, -29975.956494541508, -29815.654965375055, -30092.63150499034, -30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410523232915311, "mean_inference_ms": 0.2497720937276242, "mean_action_processing_ms": 0.059144942820045475, "mean_env_wait_ms": 1.4640255041832324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002553701400756836, "StateBufferConnector_ms": 0.001726388931274414, "ViewRequirementAgentConnector_ms": 0.04495716094970703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 413280, "num_agent_steps_trained": 413280, "num_env_steps_sampled": 413280, "num_env_steps_trained": 413280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.37198912534393, "num_env_steps_trained_throughput_per_sec": 161.37198912534393, "timesteps_total": 413280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 413280, "timers": {"training_iteration_time_ms": 2236.134, "sample_time_ms": 2230.869, "load_time_ms": 0.214, "load_throughput": 1680335.455, "learn_time_ms": 4.501, "learn_throughput": 79990.541, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 413280, "num_env_steps_trained": 413280, "num_agent_steps_sampled": 413280, "num_agent_steps_trained": 413280}, "done": false, "episodes_total": 1148, "training_iteration": 230, "trial_id": "a960d_00000", "date": "2023-07-25_16-32-33", "timestamp": 1690291953, "time_this_iter_s": 11.156357049942017, "time_total_s": 2572.4555814266205, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1732.5763294696808, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 21.35, "ram_util_percent": 76.83124999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.52783203125, "policy_loss": -2967589782186.6665, "vf_loss": 2533679381.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2336.0, "diff_num_grad_updates_vs_sampler_policy": 2335.0}}, "num_env_steps_sampled": 415080, "num_env_steps_trained": 415080, "num_agent_steps_sampled": 415080, "num_agent_steps_trained": 415080}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29879.836292037264, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410357860550991, "mean_inference_ms": 0.2497584857121734, "mean_action_processing_ms": 0.059142453957626344, "mean_env_wait_ms": 1.4639579777268636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00254058837890625, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04495501518249512}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29879.836292037264, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30087.79969642544, -29972.53711510015, -29776.53047231009, -29882.060333486723, -29586.395268183976, -29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410357860550991, "mean_inference_ms": 0.2497584857121734, "mean_action_processing_ms": 0.059142453957626344, "mean_env_wait_ms": 1.4639579777268636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00254058837890625, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04495501518249512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 415080, "num_agent_steps_trained": 415080, "num_env_steps_sampled": 415080, "num_env_steps_trained": 415080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.28426862071208, "num_env_steps_trained_throughput_per_sec": 162.28426862071208, "timesteps_total": 415080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 415080, "timers": {"training_iteration_time_ms": 2224.591, "sample_time_ms": 2219.405, "load_time_ms": 0.214, "load_throughput": 1679774.658, "learn_time_ms": 4.418, "learn_throughput": 81484.11, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 415080, "num_env_steps_trained": 415080, "num_agent_steps_sampled": 415080, "num_agent_steps_trained": 415080}, "done": false, "episodes_total": 1153, "training_iteration": 231, "trial_id": "a960d_00000", "date": "2023-07-25_16-32-44", "timestamp": 1690291964, "time_this_iter_s": 11.093924283981323, "time_total_s": 2583.549505710602, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1743.670253753662, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 24.98125, "ram_util_percent": 76.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -2669083301205.3335, "vf_loss": 2498751829.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2351.0, "diff_num_grad_updates_vs_sampler_policy": 2350.0}}, "num_env_steps_sampled": 416880, "num_env_steps_trained": 416880, "num_agent_steps_sampled": 416880, "num_agent_steps_trained": 416880}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29882.427519763853, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410172997395263, "mean_inference_ms": 0.24974353971288024, "mean_action_processing_ms": 0.05913973336692686, "mean_env_wait_ms": 1.4638848777104123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025267601013183594, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.044925689697265625}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29882.427519763853, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29776.33489189294, -30060.070654114636, -30117.50661870195, -29984.596899698587, -29781.822568576226, -29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410172997395263, "mean_inference_ms": 0.24974353971288024, "mean_action_processing_ms": 0.05913973336692686, "mean_env_wait_ms": 1.4638848777104123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025267601013183594, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.044925689697265625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416880, "num_agent_steps_trained": 416880, "num_env_steps_sampled": 416880, "num_env_steps_trained": 416880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.15127361013043, "num_env_steps_trained_throughput_per_sec": 163.15127361013043, "timesteps_total": 416880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 416880, "timers": {"training_iteration_time_ms": 2212.424, "sample_time_ms": 2206.915, "load_time_ms": 0.218, "load_throughput": 1650398.339, "learn_time_ms": 4.577, "learn_throughput": 78654.67, "synch_weights_time_ms": 0.679}, "counters": {"num_env_steps_sampled": 416880, "num_env_steps_trained": 416880, "num_agent_steps_sampled": 416880, "num_agent_steps_trained": 416880}, "done": false, "episodes_total": 1158, "training_iteration": 232, "trial_id": "a960d_00000", "date": "2023-07-25_16-32-55", "timestamp": 1690291975, "time_this_iter_s": 11.034847021102905, "time_total_s": 2594.5843527317047, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1754.705100774765, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 23.206666666666667, "ram_util_percent": 76.32000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -1624492288682.6667, "vf_loss": 2485783722.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2366.0, "diff_num_grad_updates_vs_sampler_policy": 2365.0}}, "num_env_steps_sampled": 418680, "num_env_steps_trained": 418680, "num_agent_steps_sampled": 418680, "num_agent_steps_trained": 418680}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29875.992123835724, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4099803246322615, "mean_inference_ms": 0.2497301429038545, "mean_action_processing_ms": 0.059137306943995605, "mean_env_wait_ms": 1.4638238252874656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519845962524414, "StateBufferConnector_ms": 0.001712799072265625, "ViewRequirementAgentConnector_ms": 0.04491233825683594}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29875.992123835724, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29689.061265078595, -29841.690173792846, -30129.07080355735, -30059.23087275862, -29867.157888663467, -29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4099803246322615, "mean_inference_ms": 0.2497301429038545, "mean_action_processing_ms": 0.059137306943995605, "mean_env_wait_ms": 1.4638238252874656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519845962524414, "StateBufferConnector_ms": 0.001712799072265625, "ViewRequirementAgentConnector_ms": 0.04491233825683594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 418680, "num_agent_steps_trained": 418680, "num_env_steps_sampled": 418680, "num_env_steps_trained": 418680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.49780863665723, "num_env_steps_trained_throughput_per_sec": 161.49780863665723, "timesteps_total": 418680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 418680, "timers": {"training_iteration_time_ms": 2217.826, "sample_time_ms": 2212.345, "load_time_ms": 0.217, "load_throughput": 1661658.897, "learn_time_ms": 4.566, "learn_throughput": 78846.888, "synch_weights_time_ms": 0.664}, "counters": {"num_env_steps_sampled": 418680, "num_env_steps_trained": 418680, "num_agent_steps_sampled": 418680, "num_agent_steps_trained": 418680}, "done": false, "episodes_total": 1163, "training_iteration": 233, "trial_id": "a960d_00000", "date": "2023-07-25_16-33-07", "timestamp": 1690291987, "time_this_iter_s": 11.147704124450684, "time_total_s": 2605.7320568561554, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1765.8528048992157, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 25.5, "ram_util_percent": 76.44375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -2727661216426.6665, "vf_loss": 2528050517.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2381.0, "diff_num_grad_updates_vs_sampler_policy": 2380.0}}, "num_env_steps_sampled": 420480, "num_env_steps_trained": 420480, "num_agent_steps_sampled": 420480, "num_agent_steps_trained": 420480}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29876.290674157368, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409785666200964, "mean_inference_ms": 0.2497160013640471, "mean_action_processing_ms": 0.059134836100834226, "mean_env_wait_ms": 1.4637659896715547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017125606536865234, "ViewRequirementAgentConnector_ms": 0.04485940933227539}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29876.290674157368, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29849.826350861917, -29566.374889871357, -30075.69864951151, -29881.756777123115, -29846.476180463767, -29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409785666200964, "mean_inference_ms": 0.2497160013640471, "mean_action_processing_ms": 0.059134836100834226, "mean_env_wait_ms": 1.4637659896715547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017125606536865234, "ViewRequirementAgentConnector_ms": 0.04485940933227539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420480, "num_agent_steps_trained": 420480, "num_env_steps_sampled": 420480, "num_env_steps_trained": 420480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.42633396394152, "num_env_steps_trained_throughput_per_sec": 162.42633396394152, "timesteps_total": 420480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 420480, "timers": {"training_iteration_time_ms": 2222.751, "sample_time_ms": 2217.605, "load_time_ms": 0.213, "load_throughput": 1690872.833, "learn_time_ms": 4.392, "learn_throughput": 81974.703, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 420480, "num_env_steps_trained": 420480, "num_agent_steps_sampled": 420480, "num_agent_steps_trained": 420480}, "done": false, "episodes_total": 1168, "training_iteration": 234, "trial_id": "a960d_00000", "date": "2023-07-25_16-33-18", "timestamp": 1690291998, "time_this_iter_s": 11.083906173706055, "time_total_s": 2616.8159630298615, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1776.9367110729218, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 23.831249999999997, "ram_util_percent": 76.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284830729167, "policy_loss": -2802673975296.0, "vf_loss": 2441203242.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2396.0, "diff_num_grad_updates_vs_sampler_policy": 2395.0}}, "num_env_steps_sampled": 422280, "num_env_steps_trained": 422280, "num_agent_steps_sampled": 422280, "num_agent_steps_trained": 422280}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29880.787906130045, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409595693651537, "mean_inference_ms": 0.24970188194645926, "mean_action_processing_ms": 0.05913240697938736, "mean_env_wait_ms": 1.4637030759524812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04484391212463379}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29880.787906130045, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29915.064656886447, -29715.245853164077, -29760.896820954524, -29735.702294549374, -29926.68570658808, -29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409595693651537, "mean_inference_ms": 0.24970188194645926, "mean_action_processing_ms": 0.05913240697938736, "mean_env_wait_ms": 1.4637030759524812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04484391212463379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 422280, "num_agent_steps_trained": 422280, "num_env_steps_sampled": 422280, "num_env_steps_trained": 422280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.25101747688942, "num_env_steps_trained_throughput_per_sec": 162.25101747688942, "timesteps_total": 422280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 422280, "timers": {"training_iteration_time_ms": 2217.578, "sample_time_ms": 2212.45, "load_time_ms": 0.216, "load_throughput": 1664773.363, "learn_time_ms": 4.375, "learn_throughput": 82279.796, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 422280, "num_env_steps_trained": 422280, "num_agent_steps_sampled": 422280, "num_agent_steps_trained": 422280}, "done": false, "episodes_total": 1173, "training_iteration": 235, "trial_id": "a960d_00000", "date": "2023-07-25_16-33-29", "timestamp": 1690292009, "time_this_iter_s": 11.096065998077393, "time_total_s": 2627.912029027939, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1788.0327770709991, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 23.95625, "ram_util_percent": 76.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -2912866830336.0, "vf_loss": 2485232490.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2411.0, "diff_num_grad_updates_vs_sampler_policy": 2410.0}}, "num_env_steps_sampled": 424080, "num_env_steps_trained": 424080, "num_agent_steps_sampled": 424080, "num_agent_steps_trained": 424080}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29882.992153909767, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40944261765648, "mean_inference_ms": 0.2496861222705914, "mean_action_processing_ms": 0.05912979820213757, "mean_env_wait_ms": 1.4636303759210674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025072097778320312, "StateBufferConnector_ms": 0.001720428466796875, "ViewRequirementAgentConnector_ms": 0.04489016532897949}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29882.992153909767, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29813.09768639764, -29653.404729542173, -29787.207845432924, -29746.38494578815, -30157.105654682517, -29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40944261765648, "mean_inference_ms": 0.2496861222705914, "mean_action_processing_ms": 0.05912979820213757, "mean_env_wait_ms": 1.4636303759210674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025072097778320312, "StateBufferConnector_ms": 0.001720428466796875, "ViewRequirementAgentConnector_ms": 0.04489016532897949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424080, "num_agent_steps_trained": 424080, "num_env_steps_sampled": 424080, "num_env_steps_trained": 424080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.9652209133286, "num_env_steps_trained_throughput_per_sec": 159.9652209133286, "timesteps_total": 424080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 424080, "timers": {"training_iteration_time_ms": 2234.628, "sample_time_ms": 2229.421, "load_time_ms": 0.231, "load_throughput": 1555205.933, "learn_time_ms": 4.434, "learn_throughput": 81183.569, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 424080, "num_env_steps_trained": 424080, "num_agent_steps_sampled": 424080, "num_agent_steps_trained": 424080}, "done": false, "episodes_total": 1178, "training_iteration": 236, "trial_id": "a960d_00000", "date": "2023-07-25_16-33-40", "timestamp": 1690292020, "time_this_iter_s": 11.254416942596436, "time_total_s": 2639.1664459705353, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1799.2871940135956, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 26.439999999999998, "ram_util_percent": 76.40666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -2829864307712.0, "vf_loss": 2484563669.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2426.0, "diff_num_grad_updates_vs_sampler_policy": 2425.0}}, "num_env_steps_sampled": 425880, "num_env_steps_trained": 425880, "num_agent_steps_sampled": 425880, "num_agent_steps_trained": 425880}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29882.46826396775, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409303274184874, "mean_inference_ms": 0.2496704503715144, "mean_action_processing_ms": 0.059127216728613215, "mean_env_wait_ms": 1.4635585604590249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025115013122558594, "StateBufferConnector_ms": 0.0017330646514892578, "ViewRequirementAgentConnector_ms": 0.044924020767211914}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.53923111884, "episode_reward_mean": -29882.46826396775, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29947.148814346565, -30188.53923111884, -29685.693531499623, -30019.390848871433, -30003.889103639456, -30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409303274184874, "mean_inference_ms": 0.2496704503715144, "mean_action_processing_ms": 0.059127216728613215, "mean_env_wait_ms": 1.4635585604590249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025115013122558594, "StateBufferConnector_ms": 0.0017330646514892578, "ViewRequirementAgentConnector_ms": 0.044924020767211914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 425880, "num_agent_steps_trained": 425880, "num_env_steps_sampled": 425880, "num_env_steps_trained": 425880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.60767129140518, "num_env_steps_trained_throughput_per_sec": 161.60767129140518, "timesteps_total": 425880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 425880, "timers": {"training_iteration_time_ms": 2239.044, "sample_time_ms": 2233.782, "load_time_ms": 0.232, "load_throughput": 1550096.951, "learn_time_ms": 4.474, "learn_throughput": 80472.268, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 425880, "num_env_steps_trained": 425880, "num_agent_steps_sampled": 425880, "num_agent_steps_trained": 425880}, "done": false, "episodes_total": 1183, "training_iteration": 237, "trial_id": "a960d_00000", "date": "2023-07-25_16-33-51", "timestamp": 1690292031, "time_this_iter_s": 11.140102863311768, "time_total_s": 2650.306548833847, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1810.4272968769073, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 24.46875, "ram_util_percent": 75.98750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -1553378028202.6667, "vf_loss": 2500889536.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2441.0, "diff_num_grad_updates_vs_sampler_policy": 2440.0}}, "num_env_steps_sampled": 427680, "num_env_steps_trained": 427680, "num_agent_steps_sampled": 427680, "num_agent_steps_trained": 427680}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29880.65519341421, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409163926352518, "mean_inference_ms": 0.24965359782560392, "mean_action_processing_ms": 0.059124463773829995, "mean_env_wait_ms": 1.4634848400693858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025124549865722656, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.045003652572631836}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29880.65519341421, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30039.30113083486, -29940.09494991693, -30077.68535480931, -29718.147860809488, -30092.86433950829, -30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409163926352518, "mean_inference_ms": 0.24965359782560392, "mean_action_processing_ms": 0.059124463773829995, "mean_env_wait_ms": 1.4634848400693858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025124549865722656, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.045003652572631836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 427680, "num_agent_steps_trained": 427680, "num_env_steps_sampled": 427680, "num_env_steps_trained": 427680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.14165065813245, "num_env_steps_trained_throughput_per_sec": 162.14165065813245, "timesteps_total": 427680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 427680, "timers": {"training_iteration_time_ms": 2223.939, "sample_time_ms": 2218.691, "load_time_ms": 0.217, "load_throughput": 1660197.295, "learn_time_ms": 4.452, "learn_throughput": 80859.682, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 427680, "num_env_steps_trained": 427680, "num_agent_steps_sampled": 427680, "num_agent_steps_trained": 427680}, "done": false, "episodes_total": 1188, "training_iteration": 238, "trial_id": "a960d_00000", "date": "2023-07-25_16-34-02", "timestamp": 1690292042, "time_this_iter_s": 11.103934049606323, "time_total_s": 2661.4104828834534, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1821.5312309265137, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 26.675, "ram_util_percent": 75.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -2920468409002.6665, "vf_loss": 2463766037.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2456.0, "diff_num_grad_updates_vs_sampler_policy": 2455.0}}, "num_env_steps_sampled": 429480, "num_env_steps_trained": 429480, "num_agent_steps_sampled": 429480, "num_agent_steps_trained": 429480}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29876.394597448787, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409012675767401, "mean_inference_ms": 0.24963839370872123, "mean_action_processing_ms": 0.059121970174724855, "mean_env_wait_ms": 1.4634266138276157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002520322799682617, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.04508662223815918}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29876.394597448787, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30103.55490686015, -29927.678681889232, -29782.3749020018, -29759.963060579084, -30054.22198962631, -29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409012675767401, "mean_inference_ms": 0.24963839370872123, "mean_action_processing_ms": 0.059121970174724855, "mean_env_wait_ms": 1.4634266138276157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002520322799682617, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.04508662223815918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 429480, "num_agent_steps_trained": 429480, "num_env_steps_sampled": 429480, "num_env_steps_trained": 429480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.18147619300285, "num_env_steps_trained_throughput_per_sec": 162.18147619300285, "timesteps_total": 429480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 429480, "timers": {"training_iteration_time_ms": 2219.998, "sample_time_ms": 2214.485, "load_time_ms": 0.218, "load_throughput": 1654920.473, "learn_time_ms": 4.581, "learn_throughput": 78584.262, "synch_weights_time_ms": 0.679}, "counters": {"num_env_steps_sampled": 429480, "num_env_steps_trained": 429480, "num_agent_steps_sampled": 429480, "num_agent_steps_trained": 429480}, "done": false, "episodes_total": 1193, "training_iteration": 239, "trial_id": "a960d_00000", "date": "2023-07-25_16-34-13", "timestamp": 1690292053, "time_this_iter_s": 11.100820064544678, "time_total_s": 2672.511302947998, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1832.6320509910583, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 23.862499999999997, "ram_util_percent": 75.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -2575160639488.0, "vf_loss": 2503720512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2471.0, "diff_num_grad_updates_vs_sampler_policy": 2470.0}}, "num_env_steps_sampled": 431280, "num_env_steps_trained": 431280, "num_agent_steps_sampled": 431280, "num_agent_steps_trained": 431280}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29872.64896510799, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4088730250131025, "mean_inference_ms": 0.24962276440399989, "mean_action_processing_ms": 0.05911934210229141, "mean_env_wait_ms": 1.4633716357211437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518892288208008, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.045082807540893555}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29872.64896510799, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29938.607236198517, -29934.968177850016, -29757.5912668864, -30052.657653467806, -29712.68967652265, -29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4088730250131025, "mean_inference_ms": 0.24962276440399989, "mean_action_processing_ms": 0.05911934210229141, "mean_env_wait_ms": 1.4633716357211437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518892288208008, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.045082807540893555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 431280, "num_agent_steps_trained": 431280, "num_env_steps_sampled": 431280, "num_env_steps_trained": 431280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.45849421803118, "num_env_steps_trained_throughput_per_sec": 161.45849421803118, "timesteps_total": 431280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 431280, "timers": {"training_iteration_time_ms": 2224.696, "sample_time_ms": 2219.23, "load_time_ms": 0.218, "load_throughput": 1649136.566, "learn_time_ms": 4.545, "learn_throughput": 79207.138, "synch_weights_time_ms": 0.667}, "counters": {"num_env_steps_sampled": 431280, "num_env_steps_trained": 431280, "num_agent_steps_sampled": 431280, "num_agent_steps_trained": 431280}, "done": false, "episodes_total": 1198, "training_iteration": 240, "trial_id": "a960d_00000", "date": "2023-07-25_16-34-25", "timestamp": 1690292065, "time_this_iter_s": 11.15070104598999, "time_total_s": 2683.662003993988, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1843.7827520370483, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 23.68125, "ram_util_percent": 76.00625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528564453125, "policy_loss": -2139755189589.3333, "vf_loss": 2456067136.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2486.0, "diff_num_grad_updates_vs_sampler_policy": 2485.0}}, "num_env_steps_sampled": 433080, "num_env_steps_trained": 433080, "num_agent_steps_sampled": 433080, "num_agent_steps_trained": 433080}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29867.10160546658, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40874968558633, "mean_inference_ms": 0.24960994521986302, "mean_action_processing_ms": 0.05911715117592335, "mean_env_wait_ms": 1.4633258156706441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025246143341064453, "StateBufferConnector_ms": 0.0017497539520263672, "ViewRequirementAgentConnector_ms": 0.04507279396057129}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29867.10160546658, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29864.818677734565, -29719.11797228691, -29860.58148706127, -30087.421536050915, -29864.341848493914, -29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40874968558633, "mean_inference_ms": 0.24960994521986302, "mean_action_processing_ms": 0.05911715117592335, "mean_env_wait_ms": 1.4633258156706441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025246143341064453, "StateBufferConnector_ms": 0.0017497539520263672, "ViewRequirementAgentConnector_ms": 0.04507279396057129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 433080, "num_agent_steps_trained": 433080, "num_env_steps_sampled": 433080, "num_env_steps_trained": 433080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.42193017842598, "num_env_steps_trained_throughput_per_sec": 160.42193017842598, "timesteps_total": 433080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 433080, "timers": {"training_iteration_time_ms": 2236.87, "sample_time_ms": 2231.686, "load_time_ms": 0.214, "load_throughput": 1679027.51, "learn_time_ms": 4.42, "learn_throughput": 81444.553, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 433080, "num_env_steps_trained": 433080, "num_agent_steps_sampled": 433080, "num_agent_steps_trained": 433080}, "done": false, "episodes_total": 1203, "training_iteration": 241, "trial_id": "a960d_00000", "date": "2023-07-25_16-34-36", "timestamp": 1690292076, "time_this_iter_s": 11.222521781921387, "time_total_s": 2694.8845257759094, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1855.0052738189697, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 25.246666666666663, "ram_util_percent": 76.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -3380244622677.3335, "vf_loss": 2500741312.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2501.0, "diff_num_grad_updates_vs_sampler_policy": 2500.0}}, "num_env_steps_sampled": 434880, "num_env_steps_trained": 434880, "num_agent_steps_sampled": 434880, "num_agent_steps_trained": 434880}, "sampler_results": {"episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29867.262309475398, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408633663266112, "mean_inference_ms": 0.24959705261427284, "mean_action_processing_ms": 0.05911493583567246, "mean_env_wait_ms": 1.4632797464837364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025246143341064453, "StateBufferConnector_ms": 0.001760244369506836, "ViewRequirementAgentConnector_ms": 0.045052528381347656}}, "episode_reward_max": -29506.20031451907, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29867.262309475398, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29659.051062895058, -30001.30562795059, -29816.0887950678, -29506.20031451907, -29928.327219008763, -29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408633663266112, "mean_inference_ms": 0.24959705261427284, "mean_action_processing_ms": 0.05911493583567246, "mean_env_wait_ms": 1.4632797464837364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025246143341064453, "StateBufferConnector_ms": 0.001760244369506836, "ViewRequirementAgentConnector_ms": 0.045052528381347656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 434880, "num_agent_steps_trained": 434880, "num_env_steps_sampled": 434880, "num_env_steps_trained": 434880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.99835502864346, "num_env_steps_trained_throughput_per_sec": 161.99835502864346, "timesteps_total": 434880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 434880, "timers": {"training_iteration_time_ms": 2233.154, "sample_time_ms": 2227.94, "load_time_ms": 0.215, "load_throughput": 1673074.172, "learn_time_ms": 4.462, "learn_throughput": 80683.828, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 434880, "num_env_steps_trained": 434880, "num_agent_steps_sampled": 434880, "num_agent_steps_trained": 434880}, "done": false, "episodes_total": 1208, "training_iteration": 242, "trial_id": "a960d_00000", "date": "2023-07-25_16-34-47", "timestamp": 1690292087, "time_this_iter_s": 11.113625049591064, "time_total_s": 2705.9981508255005, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1866.1188988685608, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 23.7375, "ram_util_percent": 76.41875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -4504747469482.667, "vf_loss": 2524395008.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2516.0, "diff_num_grad_updates_vs_sampler_policy": 2515.0}}, "num_env_steps_sampled": 436680, "num_env_steps_trained": 436680, "num_agent_steps_sampled": 436680, "num_agent_steps_trained": 436680}, "sampler_results": {"episode_reward_max": -29514.552466838843, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29876.830389219856, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408543117479692, "mean_inference_ms": 0.24958622380665396, "mean_action_processing_ms": 0.059113042604671255, "mean_env_wait_ms": 1.4632260500318173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002527475357055664, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.04505014419555664}}, "episode_reward_max": -29514.552466838843, "episode_reward_min": -30188.16869916114, "episode_reward_mean": -29876.830389219856, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29889.60665026869, -29944.392199196136, -29960.839678239314, -30029.33718150569, -29756.392176645695, -30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408543117479692, "mean_inference_ms": 0.24958622380665396, "mean_action_processing_ms": 0.059113042604671255, "mean_env_wait_ms": 1.4632260500318173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002527475357055664, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.04505014419555664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436680, "num_agent_steps_trained": 436680, "num_env_steps_sampled": 436680, "num_env_steps_trained": 436680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.6194920428886, "num_env_steps_trained_throughput_per_sec": 160.6194920428886, "timesteps_total": 436680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 436680, "timers": {"training_iteration_time_ms": 2231.774, "sample_time_ms": 2226.548, "load_time_ms": 0.217, "load_throughput": 1661293.256, "learn_time_ms": 4.469, "learn_throughput": 80549.969, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 436680, "num_env_steps_trained": 436680, "num_agent_steps_sampled": 436680, "num_agent_steps_trained": 436680}, "done": false, "episodes_total": 1213, "training_iteration": 243, "trial_id": "a960d_00000", "date": "2023-07-25_16-34-58", "timestamp": 1690292098, "time_this_iter_s": 11.20871114730835, "time_total_s": 2717.206861972809, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1877.3276100158691, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 26.575000000000003, "ram_util_percent": 76.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -2738236637184.0, "vf_loss": 2502241194.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2531.0, "diff_num_grad_updates_vs_sampler_policy": 2530.0}}, "num_env_steps_sampled": 438480, "num_env_steps_trained": 438480, "num_agent_steps_sampled": 438480, "num_agent_steps_trained": 438480}, "sampler_results": {"episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29880.2377182025, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408453189091906, "mean_inference_ms": 0.24957558278399372, "mean_action_processing_ms": 0.05911114640509656, "mean_env_wait_ms": 1.4631657809466359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519369125366211, "StateBufferConnector_ms": 0.0017542839050292969, "ViewRequirementAgentConnector_ms": 0.04496908187866211}}, "episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29880.2377182025, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30013.23658599793, -29914.3039424142, -29870.01682270887, -29931.933890204593, -29953.747870869003, -29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408453189091906, "mean_inference_ms": 0.24957558278399372, "mean_action_processing_ms": 0.05911114640509656, "mean_env_wait_ms": 1.4631657809466359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519369125366211, "StateBufferConnector_ms": 0.0017542839050292969, "ViewRequirementAgentConnector_ms": 0.04496908187866211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 438480, "num_agent_steps_trained": 438480, "num_env_steps_sampled": 438480, "num_env_steps_trained": 438480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.98759382372762, "num_env_steps_trained_throughput_per_sec": 161.98759382372762, "timesteps_total": 438480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 438480, "timers": {"training_iteration_time_ms": 2231.848, "sample_time_ms": 2226.65, "load_time_ms": 0.215, "load_throughput": 1670667.67, "learn_time_ms": 4.451, "learn_throughput": 80871.808, "synch_weights_time_ms": 0.498}, "counters": {"num_env_steps_sampled": 438480, "num_env_steps_trained": 438480, "num_agent_steps_sampled": 438480, "num_agent_steps_trained": 438480}, "done": false, "episodes_total": 1218, "training_iteration": 244, "trial_id": "a960d_00000", "date": "2023-07-25_16-35-09", "timestamp": 1690292109, "time_this_iter_s": 11.114113092422485, "time_total_s": 2728.3209750652313, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1888.4417231082916, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 25.43125, "ram_util_percent": 76.41875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -2454015584938.6665, "vf_loss": 2499054165.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2546.0, "diff_num_grad_updates_vs_sampler_policy": 2545.0}}, "num_env_steps_sampled": 440280, "num_env_steps_trained": 440280, "num_agent_steps_sampled": 440280, "num_agent_steps_trained": 440280}, "sampler_results": {"episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29879.63930728885, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408362834305605, "mean_inference_ms": 0.24956532062352474, "mean_action_processing_ms": 0.05910932886419442, "mean_env_wait_ms": 1.4631089406349422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002523660659790039, "StateBufferConnector_ms": 0.0017545223236083984, "ViewRequirementAgentConnector_ms": 0.044942378997802734}}, "episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29879.63930728885, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29615.67707729315, -29846.167228525934, -29829.07269698558, -30011.6829395918, -29944.751043783006, -29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408362834305605, "mean_inference_ms": 0.24956532062352474, "mean_action_processing_ms": 0.05910932886419442, "mean_env_wait_ms": 1.4631089406349422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002523660659790039, "StateBufferConnector_ms": 0.0017545223236083984, "ViewRequirementAgentConnector_ms": 0.044942378997802734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440280, "num_agent_steps_trained": 440280, "num_env_steps_sampled": 440280, "num_env_steps_trained": 440280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.2248200574663, "num_env_steps_trained_throughput_per_sec": 161.2248200574663, "timesteps_total": 440280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 440280, "timers": {"training_iteration_time_ms": 2227.639, "sample_time_ms": 2222.401, "load_time_ms": 0.213, "load_throughput": 1691062.202, "learn_time_ms": 4.448, "learn_throughput": 80931.626, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 440280, "num_env_steps_trained": 440280, "num_agent_steps_sampled": 440280, "num_agent_steps_trained": 440280}, "done": false, "episodes_total": 1223, "training_iteration": 245, "trial_id": "a960d_00000", "date": "2023-07-25_16-35-20", "timestamp": 1690292120, "time_this_iter_s": 11.16651201248169, "time_total_s": 2739.487487077713, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1899.6082351207733, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 25.700000000000003, "ram_util_percent": 76.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -1843979638101.3333, "vf_loss": 2498438250.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2561.0, "diff_num_grad_updates_vs_sampler_policy": 2560.0}}, "num_env_steps_sampled": 442080, "num_env_steps_trained": 442080, "num_agent_steps_sampled": 442080, "num_agent_steps_trained": 442080}, "sampler_results": {"episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29884.147949632235, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408264557930317, "mean_inference_ms": 0.24955561302238935, "mean_action_processing_ms": 0.05910755466381172, "mean_env_wait_ms": 1.4630494488415695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025174617767333984, "StateBufferConnector_ms": 0.0017414093017578125, "ViewRequirementAgentConnector_ms": 0.04487037658691406}}, "episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29884.147949632235, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29933.199535417065, -29874.355268356547, -29926.199581504607, -29711.79359216653, -29557.687205876195, -29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408264557930317, "mean_inference_ms": 0.24955561302238935, "mean_action_processing_ms": 0.05910755466381172, "mean_env_wait_ms": 1.4630494488415695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025174617767333984, "StateBufferConnector_ms": 0.0017414093017578125, "ViewRequirementAgentConnector_ms": 0.04487037658691406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 442080, "num_agent_steps_trained": 442080, "num_env_steps_sampled": 442080, "num_env_steps_trained": 442080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.71475052137814, "num_env_steps_trained_throughput_per_sec": 162.71475052137814, "timesteps_total": 442080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 442080, "timers": {"training_iteration_time_ms": 2222.673, "sample_time_ms": 2217.476, "load_time_ms": 0.213, "load_throughput": 1686717.426, "learn_time_ms": 4.413, "learn_throughput": 81579.201, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 442080, "num_env_steps_trained": 442080, "num_agent_steps_sampled": 442080, "num_agent_steps_trained": 442080}, "done": false, "episodes_total": 1228, "training_iteration": 246, "trial_id": "a960d_00000", "date": "2023-07-25_16-35-32", "timestamp": 1690292132, "time_this_iter_s": 11.064462900161743, "time_total_s": 2750.5519499778748, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1910.672698020935, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 23.75333333333333, "ram_util_percent": 76.15333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -2066127563434.6667, "vf_loss": 2472608768.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2576.0, "diff_num_grad_updates_vs_sampler_policy": 2575.0}}, "num_env_steps_sampled": 443880, "num_env_steps_trained": 443880, "num_agent_steps_sampled": 443880, "num_agent_steps_trained": 443880}, "sampler_results": {"episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29884.548538394974, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408162506678429, "mean_inference_ms": 0.24954638455408693, "mean_action_processing_ms": 0.05910582010789184, "mean_env_wait_ms": 1.4629911242165423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002515554428100586, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04483294486999512}}, "episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29884.548538394974, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29742.15137347062, -30183.288921063435, -29734.052753706277, -29750.7846316222, -29910.34364405934, -29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408162506678429, "mean_inference_ms": 0.24954638455408693, "mean_action_processing_ms": 0.05910582010789184, "mean_env_wait_ms": 1.4629911242165423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002515554428100586, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04483294486999512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 443880, "num_agent_steps_trained": 443880, "num_env_steps_sampled": 443880, "num_env_steps_trained": 443880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.19443746829853, "num_env_steps_trained_throughput_per_sec": 162.19443746829853, "timesteps_total": 443880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 443880, "timers": {"training_iteration_time_ms": 2216.0, "sample_time_ms": 2210.828, "load_time_ms": 0.214, "load_throughput": 1678840.827, "learn_time_ms": 4.414, "learn_throughput": 81558.491, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 443880, "num_env_steps_trained": 443880, "num_agent_steps_sampled": 443880, "num_agent_steps_trained": 443880}, "done": false, "episodes_total": 1233, "training_iteration": 247, "trial_id": "a960d_00000", "date": "2023-07-25_16-35-43", "timestamp": 1690292143, "time_this_iter_s": 11.099927186965942, "time_total_s": 2761.6518771648407, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1921.772625207901, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 24.2875, "ram_util_percent": 76.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -2817315995648.0, "vf_loss": 2500082346.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2591.0, "diff_num_grad_updates_vs_sampler_policy": 2590.0}}, "num_env_steps_sampled": 445680, "num_env_steps_trained": 445680, "num_agent_steps_sampled": 445680, "num_agent_steps_trained": 445680}, "sampler_results": {"episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29888.715026826918, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40805027621026, "mean_inference_ms": 0.2495391400106887, "mean_action_processing_ms": 0.059104363367824965, "mean_env_wait_ms": 1.4629313877340593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025148391723632812, "StateBufferConnector_ms": 0.0017476081848144531, "ViewRequirementAgentConnector_ms": 0.04484295845031738}}, "episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29888.715026826918, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29790.13864050587, -29771.341995114875, -29750.160519607212, -29823.466051437827, -29570.37569657257, -29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40805027621026, "mean_inference_ms": 0.2495391400106887, "mean_action_processing_ms": 0.059104363367824965, "mean_env_wait_ms": 1.4629313877340593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025148391723632812, "StateBufferConnector_ms": 0.0017476081848144531, "ViewRequirementAgentConnector_ms": 0.04484295845031738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 445680, "num_agent_steps_trained": 445680, "num_env_steps_sampled": 445680, "num_env_steps_trained": 445680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4320386527855, "num_env_steps_trained_throughput_per_sec": 161.4320386527855, "timesteps_total": 445680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 445680, "timers": {"training_iteration_time_ms": 2224.79, "sample_time_ms": 2219.563, "load_time_ms": 0.216, "load_throughput": 1669743.935, "learn_time_ms": 4.452, "learn_throughput": 80869.642, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 445680, "num_env_steps_trained": 445680, "num_agent_steps_sampled": 445680, "num_agent_steps_trained": 445680}, "done": false, "episodes_total": 1238, "training_iteration": 248, "trial_id": "a960d_00000", "date": "2023-07-25_16-35-54", "timestamp": 1690292154, "time_this_iter_s": 11.152228116989136, "time_total_s": 2772.80410528183, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1932.9248533248901, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 22.9, "ram_util_percent": 76.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -1872574666069.3333, "vf_loss": 2472419861.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2606.0, "diff_num_grad_updates_vs_sampler_policy": 2605.0}}, "num_env_steps_sampled": 447480, "num_env_steps_trained": 447480, "num_agent_steps_sampled": 447480, "num_agent_steps_trained": 447480}, "sampler_results": {"episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29897.449624838595, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407931381575238, "mean_inference_ms": 0.24953211601650654, "mean_action_processing_ms": 0.05910300443371179, "mean_env_wait_ms": 1.4628589710011901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00250244140625, "StateBufferConnector_ms": 0.0017437934875488281, "ViewRequirementAgentConnector_ms": 0.04475045204162598}}, "episode_reward_max": -29514.552466838843, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29897.449624838595, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29748.793342859568, -29694.84916296762, -30127.50247728918, -29859.503407133347, -29812.33290303647, -29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407931381575238, "mean_inference_ms": 0.24953211601650654, "mean_action_processing_ms": 0.05910300443371179, "mean_env_wait_ms": 1.4628589710011901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00250244140625, "StateBufferConnector_ms": 0.0017437934875488281, "ViewRequirementAgentConnector_ms": 0.04475045204162598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 447480, "num_agent_steps_trained": 447480, "num_env_steps_sampled": 447480, "num_env_steps_trained": 447480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.39689146024236, "num_env_steps_trained_throughput_per_sec": 162.39689146024236, "timesteps_total": 447480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 447480, "timers": {"training_iteration_time_ms": 2223.407, "sample_time_ms": 2218.167, "load_time_ms": 0.216, "load_throughput": 1666243.037, "learn_time_ms": 4.477, "learn_throughput": 80410.129, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 447480, "num_env_steps_trained": 447480, "num_agent_steps_sampled": 447480, "num_agent_steps_trained": 447480}, "done": false, "episodes_total": 1243, "training_iteration": 249, "trial_id": "a960d_00000", "date": "2023-07-25_16-36-05", "timestamp": 1690292165, "time_this_iter_s": 11.08595609664917, "time_total_s": 2783.890061378479, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1944.0108094215393, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 24.53333333333334, "ram_util_percent": 76.23333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5286865234375, "policy_loss": -1983560581120.0, "vf_loss": 2412341632.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2621.0, "diff_num_grad_updates_vs_sampler_policy": 2620.0}}, "num_env_steps_sampled": 449280, "num_env_steps_trained": 449280, "num_agent_steps_sampled": 449280, "num_agent_steps_trained": 449280}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29892.871387491996, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40780863744583, "mean_inference_ms": 0.2495266135790553, "mean_action_processing_ms": 0.05910182249093916, "mean_env_wait_ms": 1.4627897988840963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.001745462417602539, "ViewRequirementAgentConnector_ms": 0.04476213455200195}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29892.871387491996, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29927.22130114377, -29912.5619491487, -30017.190439137095, -30067.89630467375, -30188.16869916114, -29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40780863744583, "mean_inference_ms": 0.2495266135790553, "mean_action_processing_ms": 0.05910182249093916, "mean_env_wait_ms": 1.4627897988840963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.001745462417602539, "ViewRequirementAgentConnector_ms": 0.04476213455200195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 449280, "num_agent_steps_trained": 449280, "num_env_steps_sampled": 449280, "num_env_steps_trained": 449280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.43739258975418, "num_env_steps_trained_throughput_per_sec": 161.43739258975418, "timesteps_total": 449280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 449280, "timers": {"training_iteration_time_ms": 2223.37, "sample_time_ms": 2218.143, "load_time_ms": 0.216, "load_throughput": 1663489.523, "learn_time_ms": 4.47, "learn_throughput": 80529.778, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 449280, "num_env_steps_trained": 449280, "num_agent_steps_sampled": 449280, "num_agent_steps_trained": 449280}, "done": false, "episodes_total": 1248, "training_iteration": 250, "trial_id": "a960d_00000", "date": "2023-07-25_16-36-16", "timestamp": 1690292176, "time_this_iter_s": 11.151906251907349, "time_total_s": 2795.0419676303864, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1955.1627156734467, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 22.93125, "ram_util_percent": 76.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -2614288411306.6665, "vf_loss": 2481185962.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2636.0, "diff_num_grad_updates_vs_sampler_policy": 2635.0}}, "num_env_steps_sampled": 451080, "num_env_steps_trained": 451080, "num_agent_steps_sampled": 451080, "num_agent_steps_trained": 451080}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29885.63649400186, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4076879314916475, "mean_inference_ms": 0.24952188850597737, "mean_action_processing_ms": 0.05910084228299906, "mean_env_wait_ms": 1.4627353024599188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017466545104980469, "ViewRequirementAgentConnector_ms": 0.04470944404602051}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29885.63649400186, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29938.599483736583, -29961.060808314673, -29703.95370215963, -30090.099810314943, -29870.73185364018, -29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4076879314916475, "mean_inference_ms": 0.24952188850597737, "mean_action_processing_ms": 0.05910084228299906, "mean_env_wait_ms": 1.4627353024599188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017466545104980469, "ViewRequirementAgentConnector_ms": 0.04470944404602051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 451080, "num_agent_steps_trained": 451080, "num_env_steps_sampled": 451080, "num_env_steps_trained": 451080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.9254851048032, "num_env_steps_trained_throughput_per_sec": 160.9254851048032, "timesteps_total": 451080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 451080, "timers": {"training_iteration_time_ms": 2233.504, "sample_time_ms": 2228.297, "load_time_ms": 0.22, "load_throughput": 1638222.242, "learn_time_ms": 4.452, "learn_throughput": 80863.579, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 451080, "num_env_steps_trained": 451080, "num_agent_steps_sampled": 451080, "num_agent_steps_trained": 451080}, "done": false, "episodes_total": 1253, "training_iteration": 251, "trial_id": "a960d_00000", "date": "2023-07-25_16-36-27", "timestamp": 1690292187, "time_this_iter_s": 11.187502145767212, "time_total_s": 2806.2294697761536, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1966.3502178192139, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 23.9375, "ram_util_percent": 76.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -2879014241621.3335, "vf_loss": 2482861781.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2651.0, "diff_num_grad_updates_vs_sampler_policy": 2650.0}}, "num_env_steps_sampled": 452880, "num_env_steps_trained": 452880, "num_agent_steps_sampled": 452880, "num_agent_steps_trained": 452880}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29886.345678512313, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407587833691132, "mean_inference_ms": 0.24951841553365262, "mean_action_processing_ms": 0.05910006051598213, "mean_env_wait_ms": 1.4626805948805293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025093555450439453, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.04473423957824707}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29886.345678512313, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29514.552466838843, -29898.958397495546, -29946.190871269442, -29869.56969103156, -29847.52061353533, -29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407587833691132, "mean_inference_ms": 0.24951841553365262, "mean_action_processing_ms": 0.05910006051598213, "mean_env_wait_ms": 1.4626805948805293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025093555450439453, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.04473423957824707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452880, "num_agent_steps_trained": 452880, "num_env_steps_sampled": 452880, "num_env_steps_trained": 452880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.5968512430628, "num_env_steps_trained_throughput_per_sec": 161.5968512430628, "timesteps_total": 452880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 452880, "timers": {"training_iteration_time_ms": 2232.404, "sample_time_ms": 2227.139, "load_time_ms": 0.219, "load_throughput": 1640892.676, "learn_time_ms": 4.504, "learn_throughput": 79933.375, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 452880, "num_env_steps_trained": 452880, "num_agent_steps_sampled": 452880, "num_agent_steps_trained": 452880}, "done": false, "episodes_total": 1258, "training_iteration": 252, "trial_id": "a960d_00000", "date": "2023-07-25_16-36-38", "timestamp": 1690292198, "time_this_iter_s": 11.140756845474243, "time_total_s": 2817.370226621628, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1977.490974664688, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 25.8, "ram_util_percent": 76.55624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -1770046707029.3333, "vf_loss": 2464201386.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2666.0, "diff_num_grad_updates_vs_sampler_policy": 2665.0}}, "num_env_steps_sampled": 454680, "num_env_steps_trained": 454680, "num_agent_steps_sampled": 454680, "num_agent_steps_trained": 454680}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29892.000581508568, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4075073024788605, "mean_inference_ms": 0.2495154194835158, "mean_action_processing_ms": 0.0590992941715998, "mean_env_wait_ms": 1.4626184205545931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025076866149902344, "StateBufferConnector_ms": 0.001760244369506836, "ViewRequirementAgentConnector_ms": 0.04472708702087402}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29892.000581508568, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29931.048965521342, -29799.515975368013, -30023.500441410648, -29776.326166255396, -30085.674487459622, -30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4075073024788605, "mean_inference_ms": 0.2495154194835158, "mean_action_processing_ms": 0.0590992941715998, "mean_env_wait_ms": 1.4626184205545931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025076866149902344, "StateBufferConnector_ms": 0.001760244369506836, "ViewRequirementAgentConnector_ms": 0.04472708702087402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 454680, "num_agent_steps_trained": 454680, "num_env_steps_sampled": 454680, "num_env_steps_trained": 454680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.5159508340401, "num_env_steps_trained_throughput_per_sec": 160.5159508340401, "timesteps_total": 454680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 454680, "timers": {"training_iteration_time_ms": 2235.258, "sample_time_ms": 2229.982, "load_time_ms": 0.218, "load_throughput": 1651662.043, "learn_time_ms": 4.509, "learn_throughput": 79834.058, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 454680, "num_env_steps_trained": 454680, "num_agent_steps_sampled": 454680, "num_agent_steps_trained": 454680}, "done": false, "episodes_total": 1263, "training_iteration": 253, "trial_id": "a960d_00000", "date": "2023-07-25_16-36-50", "timestamp": 1690292210, "time_this_iter_s": 11.215803861618042, "time_total_s": 2828.586030483246, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1988.7067785263062, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 26.1875, "ram_util_percent": 76.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -1595635777536.0, "vf_loss": 2458483370.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2681.0, "diff_num_grad_updates_vs_sampler_policy": 2680.0}}, "num_env_steps_sampled": 456480, "num_env_steps_trained": 456480, "num_agent_steps_sampled": 456480, "num_agent_steps_trained": 456480}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29891.823152896668, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407441007487108, "mean_inference_ms": 0.24951308112461112, "mean_action_processing_ms": 0.059098650924177897, "mean_env_wait_ms": 1.46255427644533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025129318237304688, "StateBufferConnector_ms": 0.001764059066772461, "ViewRequirementAgentConnector_ms": 0.04475069046020508}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29891.823152896668, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30036.994267004768, -30034.6145982358, -29878.812796074137, -30082.57447150445, -29636.859912280714, -29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407441007487108, "mean_inference_ms": 0.24951308112461112, "mean_action_processing_ms": 0.059098650924177897, "mean_env_wait_ms": 1.46255427644533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025129318237304688, "StateBufferConnector_ms": 0.001764059066772461, "ViewRequirementAgentConnector_ms": 0.04475069046020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456480, "num_agent_steps_trained": 456480, "num_env_steps_sampled": 456480, "num_env_steps_trained": 456480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4653175213786, "num_env_steps_trained_throughput_per_sec": 161.4653175213786, "timesteps_total": 456480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 456480, "timers": {"training_iteration_time_ms": 2236.165, "sample_time_ms": 2230.954, "load_time_ms": 0.218, "load_throughput": 1652565.875, "learn_time_ms": 4.457, "learn_throughput": 80764.531, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 456480, "num_env_steps_trained": 456480, "num_agent_steps_sampled": 456480, "num_agent_steps_trained": 456480}, "done": false, "episodes_total": 1268, "training_iteration": 254, "trial_id": "a960d_00000", "date": "2023-07-25_16-37-01", "timestamp": 1690292221, "time_this_iter_s": 11.150084018707275, "time_total_s": 2839.736114501953, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1999.8568625450134, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 25.10625, "ram_util_percent": 76.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -1841152957098.6667, "vf_loss": 2509753386.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2696.0, "diff_num_grad_updates_vs_sampler_policy": 2695.0}}, "num_env_steps_sampled": 458280, "num_env_steps_trained": 458280, "num_agent_steps_sampled": 458280, "num_agent_steps_trained": 458280}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29882.91912867295, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407389886912898, "mean_inference_ms": 0.24951113603142935, "mean_action_processing_ms": 0.05909809260642127, "mean_env_wait_ms": 1.4625024569624683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025072097778320312, "StateBufferConnector_ms": 0.001758575439453125, "ViewRequirementAgentConnector_ms": 0.04476022720336914}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29882.91912867295, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29698.8522731633, -30023.933654458153, -29985.185284367286, -29697.828801514184, -29868.22009661146, -29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407389886912898, "mean_inference_ms": 0.24951113603142935, "mean_action_processing_ms": 0.05909809260642127, "mean_env_wait_ms": 1.4625024569624683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025072097778320312, "StateBufferConnector_ms": 0.001758575439453125, "ViewRequirementAgentConnector_ms": 0.04476022720336914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 458280, "num_agent_steps_trained": 458280, "num_env_steps_sampled": 458280, "num_env_steps_trained": 458280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.8700431136299, "num_env_steps_trained_throughput_per_sec": 159.8700431136299, "timesteps_total": 458280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 458280, "timers": {"training_iteration_time_ms": 2240.696, "sample_time_ms": 2235.521, "load_time_ms": 0.216, "load_throughput": 1669190.184, "learn_time_ms": 4.437, "learn_throughput": 81144.304, "synch_weights_time_ms": 0.492}, "counters": {"num_env_steps_sampled": 458280, "num_env_steps_trained": 458280, "num_agent_steps_sampled": 458280, "num_agent_steps_trained": 458280}, "done": false, "episodes_total": 1273, "training_iteration": 255, "trial_id": "a960d_00000", "date": "2023-07-25_16-37-12", "timestamp": 1690292232, "time_this_iter_s": 11.261286973953247, "time_total_s": 2850.9974014759064, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2011.1181495189667, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 26.25, "ram_util_percent": 76.34375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -1212766003200.0, "vf_loss": 2469076736.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2711.0, "diff_num_grad_updates_vs_sampler_policy": 2710.0}}, "num_env_steps_sampled": 460080, "num_env_steps_trained": 460080, "num_agent_steps_sampled": 460080, "num_agent_steps_trained": 460080}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29884.193983315443, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407321664383699, "mean_inference_ms": 0.2495098637435866, "mean_action_processing_ms": 0.05909762710945717, "mean_env_wait_ms": 1.4624508981810973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025238990783691406, "StateBufferConnector_ms": 0.001756429672241211, "ViewRequirementAgentConnector_ms": 0.0449373722076416}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29884.193983315443, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29999.09170851317, -29764.80363737106, -29944.657139171133, -29516.78273219112, -29879.47665039601, -29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407321664383699, "mean_inference_ms": 0.2495098637435866, "mean_action_processing_ms": 0.05909762710945717, "mean_env_wait_ms": 1.4624508981810973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025238990783691406, "StateBufferConnector_ms": 0.001756429672241211, "ViewRequirementAgentConnector_ms": 0.0449373722076416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460080, "num_agent_steps_trained": 460080, "num_env_steps_sampled": 460080, "num_env_steps_trained": 460080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.38361391437542, "num_env_steps_trained_throughput_per_sec": 161.38361391437542, "timesteps_total": 460080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 460080, "timers": {"training_iteration_time_ms": 2241.26, "sample_time_ms": 2235.935, "load_time_ms": 0.216, "load_throughput": 1667346.996, "learn_time_ms": 4.557, "learn_throughput": 78994.148, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 460080, "num_env_steps_trained": 460080, "num_agent_steps_sampled": 460080, "num_agent_steps_trained": 460080}, "done": false, "episodes_total": 1278, "training_iteration": 256, "trial_id": "a960d_00000", "date": "2023-07-25_16-37-23", "timestamp": 1690292243, "time_this_iter_s": 11.155597925186157, "time_total_s": 2862.1529994010925, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2022.2737474441528, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 24.686666666666664, "ram_util_percent": 76.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5279134114583, "policy_loss": -1361467891712.0, "vf_loss": 2548764949.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2726.0, "diff_num_grad_updates_vs_sampler_policy": 2725.0}}, "num_env_steps_sampled": 461880, "num_env_steps_trained": 461880, "num_agent_steps_sampled": 461880, "num_agent_steps_trained": 461880}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29890.656954179274, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407251263202756, "mean_inference_ms": 0.2495111961321895, "mean_action_processing_ms": 0.05909755846485343, "mean_env_wait_ms": 1.462402652341242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017528533935546875, "ViewRequirementAgentConnector_ms": 0.04518008232116699}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30209.35857592941, "episode_reward_mean": -29890.656954179274, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29958.83195807226, -29934.070851997407, -29873.858488526133, -29842.094859292225, -30054.49831623332, -29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407251263202756, "mean_inference_ms": 0.2495111961321895, "mean_action_processing_ms": 0.05909755846485343, "mean_env_wait_ms": 1.462402652341242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017528533935546875, "ViewRequirementAgentConnector_ms": 0.04518008232116699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 461880, "num_agent_steps_trained": 461880, "num_env_steps_sampled": 461880, "num_env_steps_trained": 461880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.3343597533925, "num_env_steps_trained_throughput_per_sec": 161.3343597533925, "timesteps_total": 461880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 461880, "timers": {"training_iteration_time_ms": 2231.04, "sample_time_ms": 2225.699, "load_time_ms": 0.219, "load_throughput": 1640357.892, "learn_time_ms": 4.561, "learn_throughput": 78930.969, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 461880, "num_env_steps_trained": 461880, "num_agent_steps_sampled": 461880, "num_agent_steps_trained": 461880}, "done": false, "episodes_total": 1283, "training_iteration": 257, "trial_id": "a960d_00000", "date": "2023-07-25_16-37-35", "timestamp": 1690292255, "time_this_iter_s": 11.159013271331787, "time_total_s": 2873.3120126724243, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2033.4327607154846, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 24.94375, "ram_util_percent": 76.55624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -1329221913258.6667, "vf_loss": 2482840554.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2741.0, "diff_num_grad_updates_vs_sampler_policy": 2740.0}}, "num_env_steps_sampled": 463680, "num_env_steps_trained": 463680, "num_agent_steps_sampled": 463680, "num_agent_steps_trained": 463680}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29891.05738791003, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407179966796804, "mean_inference_ms": 0.24951192009081727, "mean_action_processing_ms": 0.059097353093322466, "mean_env_wait_ms": 1.4623556201017767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518177032470703, "StateBufferConnector_ms": 0.0017440319061279297, "ViewRequirementAgentConnector_ms": 0.04502224922180176}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29891.05738791003, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29964.79561044219, -29907.989000574475, -29731.35158921429, -30067.349672035692, -29770.54816706961, -30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407179966796804, "mean_inference_ms": 0.24951192009081727, "mean_action_processing_ms": 0.059097353093322466, "mean_env_wait_ms": 1.4623556201017767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518177032470703, "StateBufferConnector_ms": 0.0017440319061279297, "ViewRequirementAgentConnector_ms": 0.04502224922180176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 463680, "num_agent_steps_trained": 463680, "num_env_steps_sampled": 463680, "num_env_steps_trained": 463680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.41494281275183, "num_env_steps_trained_throughput_per_sec": 162.41494281275183, "timesteps_total": 463680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 463680, "timers": {"training_iteration_time_ms": 2223.959, "sample_time_ms": 2218.749, "load_time_ms": 0.218, "load_throughput": 1654195.267, "learn_time_ms": 4.459, "learn_throughput": 80732.144, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 463680, "num_env_steps_trained": 463680, "num_agent_steps_sampled": 463680, "num_agent_steps_trained": 463680}, "done": false, "episodes_total": 1288, "training_iteration": 258, "trial_id": "a960d_00000", "date": "2023-07-25_16-37-46", "timestamp": 1690292266, "time_this_iter_s": 11.085340976715088, "time_total_s": 2884.3973536491394, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2044.5181016921997, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 23.0625, "ram_util_percent": 76.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -1133937927509.3333, "vf_loss": 2498244266.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2756.0, "diff_num_grad_updates_vs_sampler_policy": 2755.0}}, "num_env_steps_sampled": 465480, "num_env_steps_trained": 465480, "num_agent_steps_sampled": 465480, "num_agent_steps_trained": 465480}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29893.574174272464, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407132020778254, "mean_inference_ms": 0.2495120759526229, "mean_action_processing_ms": 0.05909703442784782, "mean_env_wait_ms": 1.4623037739275424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025148391723632812, "StateBufferConnector_ms": 0.0017430782318115234, "ViewRequirementAgentConnector_ms": 0.04504537582397461}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29893.574174272464, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30022.656510046825, -29765.941380725293, -29628.417591694117, -29902.91323315027, -29933.30159126076, -29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407132020778254, "mean_inference_ms": 0.2495120759526229, "mean_action_processing_ms": 0.05909703442784782, "mean_env_wait_ms": 1.4623037739275424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025148391723632812, "StateBufferConnector_ms": 0.0017430782318115234, "ViewRequirementAgentConnector_ms": 0.04504537582397461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 465480, "num_agent_steps_trained": 465480, "num_env_steps_sampled": 465480, "num_env_steps_trained": 465480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.80433657172162, "num_env_steps_trained_throughput_per_sec": 160.80433657172162, "timesteps_total": 465480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 465480, "timers": {"training_iteration_time_ms": 2227.636, "sample_time_ms": 2222.419, "load_time_ms": 0.215, "load_throughput": 1674001.596, "learn_time_ms": 4.471, "learn_throughput": 80511.314, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 465480, "num_env_steps_trained": 465480, "num_agent_steps_sampled": 465480, "num_agent_steps_trained": 465480}, "done": false, "episodes_total": 1293, "training_iteration": 259, "trial_id": "a960d_00000", "date": "2023-07-25_16-37-57", "timestamp": 1690292277, "time_this_iter_s": 11.195844888687134, "time_total_s": 2895.5931985378265, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2055.713946580887, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 23.9125, "ram_util_percent": 76.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281982421875, "policy_loss": -2115852531029.3333, "vf_loss": 2502857642.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2771.0, "diff_num_grad_updates_vs_sampler_policy": 2770.0}}, "num_env_steps_sampled": 467280, "num_env_steps_trained": 467280, "num_agent_steps_sampled": 467280, "num_agent_steps_trained": 467280}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29897.99642926628, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407085619594578, "mean_inference_ms": 0.24951294004210844, "mean_action_processing_ms": 0.05909687615009, "mean_env_wait_ms": 1.4622491303846175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00251007080078125, "StateBufferConnector_ms": 0.0017328262329101562, "ViewRequirementAgentConnector_ms": 0.04500150680541992}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29897.99642926628, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29703.137664440386, -29875.643092282302, -29902.866761865207, -29650.55125678071, -29709.57927141651, -29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407085619594578, "mean_inference_ms": 0.24951294004210844, "mean_action_processing_ms": 0.05909687615009, "mean_env_wait_ms": 1.4622491303846175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00251007080078125, "StateBufferConnector_ms": 0.0017328262329101562, "ViewRequirementAgentConnector_ms": 0.04500150680541992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 467280, "num_agent_steps_trained": 467280, "num_env_steps_sampled": 467280, "num_env_steps_trained": 467280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.58759239695289, "num_env_steps_trained_throughput_per_sec": 161.58759239695289, "timesteps_total": 467280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 467280, "timers": {"training_iteration_time_ms": 2233.311, "sample_time_ms": 2228.03, "load_time_ms": 0.218, "load_throughput": 1654557.791, "learn_time_ms": 4.518, "learn_throughput": 79679.448, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 467280, "num_env_steps_trained": 467280, "num_agent_steps_sampled": 467280, "num_agent_steps_trained": 467280}, "done": false, "episodes_total": 1298, "training_iteration": 260, "trial_id": "a960d_00000", "date": "2023-07-25_16-38-08", "timestamp": 1690292288, "time_this_iter_s": 11.141634702682495, "time_total_s": 2906.734833240509, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2066.8555812835693, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 25.16, "ram_util_percent": 76.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -1364547330048.0, "vf_loss": 2459474965.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2786.0, "diff_num_grad_updates_vs_sampler_policy": 2785.0}}, "num_env_steps_sampled": 469080, "num_env_steps_trained": 469080, "num_agent_steps_sampled": 469080, "num_agent_steps_trained": 469080}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29901.098557450947, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407039883857057, "mean_inference_ms": 0.24951245470093697, "mean_action_processing_ms": 0.05909649648206192, "mean_env_wait_ms": 1.462189186971232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508401870727539, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.04503297805786133}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29901.098557450947, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29910.9688431542, -29971.857377540982, -29912.624079970446, -29682.498878337396, -29934.402743505514, -30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407039883857057, "mean_inference_ms": 0.24951245470093697, "mean_action_processing_ms": 0.05909649648206192, "mean_env_wait_ms": 1.462189186971232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508401870727539, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.04503297805786133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 469080, "num_agent_steps_trained": 469080, "num_env_steps_sampled": 469080, "num_env_steps_trained": 469080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.00907402884232, "num_env_steps_trained_throughput_per_sec": 161.00907402884232, "timesteps_total": 469080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 469080, "timers": {"training_iteration_time_ms": 2231.887, "sample_time_ms": 2226.611, "load_time_ms": 0.22, "load_throughput": 1635383.342, "learn_time_ms": 4.51, "learn_throughput": 79818.865, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 469080, "num_env_steps_trained": 469080, "num_agent_steps_sampled": 469080, "num_agent_steps_trained": 469080}, "done": false, "episodes_total": 1303, "training_iteration": 261, "trial_id": "a960d_00000", "date": "2023-07-25_16-38-19", "timestamp": 1690292299, "time_this_iter_s": 11.181442975997925, "time_total_s": 2917.916276216507, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2078.0370242595673, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 25.2625, "ram_util_percent": 76.48125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -2521657698986.6665, "vf_loss": 2527155690.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2801.0, "diff_num_grad_updates_vs_sampler_policy": 2800.0}}, "num_env_steps_sampled": 470880, "num_env_steps_trained": 470880, "num_agent_steps_sampled": 470880, "num_agent_steps_trained": 470880}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29902.5963051484, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407005578558034, "mean_inference_ms": 0.24951237289823897, "mean_action_processing_ms": 0.059096204254750734, "mean_env_wait_ms": 1.4621269322773924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025098323822021484, "StateBufferConnector_ms": 0.0017361640930175781, "ViewRequirementAgentConnector_ms": 0.04513263702392578}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29902.5963051484, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30040.850150586208, -29895.800508152148, -29900.9071255069, -29960.400059956388, -30069.82314968524, -30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407005578558034, "mean_inference_ms": 0.24951237289823897, "mean_action_processing_ms": 0.059096204254750734, "mean_env_wait_ms": 1.4621269322773924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025098323822021484, "StateBufferConnector_ms": 0.0017361640930175781, "ViewRequirementAgentConnector_ms": 0.04513263702392578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 470880, "num_agent_steps_trained": 470880, "num_env_steps_sampled": 470880, "num_env_steps_trained": 470880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.22092616899923, "num_env_steps_trained_throughput_per_sec": 161.22092616899923, "timesteps_total": 470880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 470880, "timers": {"training_iteration_time_ms": 2234.42, "sample_time_ms": 2229.105, "load_time_ms": 0.223, "load_throughput": 1616475.153, "learn_time_ms": 4.533, "learn_throughput": 79420.863, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 470880, "num_env_steps_trained": 470880, "num_agent_steps_sampled": 470880, "num_agent_steps_trained": 470880}, "done": false, "episodes_total": 1308, "training_iteration": 262, "trial_id": "a960d_00000", "date": "2023-07-25_16-38-30", "timestamp": 1690292310, "time_this_iter_s": 11.166882038116455, "time_total_s": 2929.0831582546234, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2089.2039062976837, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 25.206249999999997, "ram_util_percent": 76.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -813129098581.3334, "vf_loss": 2464803157.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2816.0, "diff_num_grad_updates_vs_sampler_policy": 2815.0}}, "num_env_steps_sampled": 472680, "num_env_steps_trained": 472680, "num_agent_steps_sampled": 472680, "num_agent_steps_trained": 472680}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29898.323676191372, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40696283022462, "mean_inference_ms": 0.24951158159341552, "mean_action_processing_ms": 0.05909577732232116, "mean_env_wait_ms": 1.4620674970425755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025167465209960938, "StateBufferConnector_ms": 0.0017304420471191406, "ViewRequirementAgentConnector_ms": 0.04510807991027832}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29898.323676191372, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30046.508365502083, -29944.168702740022, -30209.35857592941, -29731.860496403235, -29989.404643545255, -29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40696283022462, "mean_inference_ms": 0.24951158159341552, "mean_action_processing_ms": 0.05909577732232116, "mean_env_wait_ms": 1.4620674970425755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025167465209960938, "StateBufferConnector_ms": 0.0017304420471191406, "ViewRequirementAgentConnector_ms": 0.04510807991027832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472680, "num_agent_steps_trained": 472680, "num_env_steps_sampled": 472680, "num_env_steps_trained": 472680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.23968122253413, "num_env_steps_trained_throughput_per_sec": 161.23968122253413, "timesteps_total": 472680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 472680, "timers": {"training_iteration_time_ms": 2232.821, "sample_time_ms": 2227.389, "load_time_ms": 0.226, "load_throughput": 1595466.441, "learn_time_ms": 4.633, "learn_throughput": 77708.272, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 472680, "num_env_steps_trained": 472680, "num_agent_steps_sampled": 472680, "num_agent_steps_trained": 472680}, "done": false, "episodes_total": 1313, "training_iteration": 263, "trial_id": "a960d_00000", "date": "2023-07-25_16-38-42", "timestamp": 1690292322, "time_this_iter_s": 11.165934085845947, "time_total_s": 2940.2490923404694, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2100.3698403835297, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 28.231250000000003, "ram_util_percent": 76.47500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -1275077689344.0, "vf_loss": 2466121856.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2831.0, "diff_num_grad_updates_vs_sampler_policy": 2830.0}}, "num_env_steps_sampled": 474480, "num_env_steps_trained": 474480, "num_agent_steps_sampled": 474480, "num_agent_steps_trained": 474480}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29888.444168728358, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406915757396834, "mean_inference_ms": 0.24951086846210488, "mean_action_processing_ms": 0.059095452778879426, "mean_env_wait_ms": 1.4620179132331403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00252532958984375, "StateBufferConnector_ms": 0.0017325878143310547, "ViewRequirementAgentConnector_ms": 0.04518938064575195}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29888.444168728358, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29939.873624452015, -29847.970126875116, -29720.03619036988, -30158.263903101746, -29957.254176030812, -30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406915757396834, "mean_inference_ms": 0.24951086846210488, "mean_action_processing_ms": 0.059095452778879426, "mean_env_wait_ms": 1.4620179132331403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00252532958984375, "StateBufferConnector_ms": 0.0017325878143310547, "ViewRequirementAgentConnector_ms": 0.04518938064575195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 474480, "num_agent_steps_trained": 474480, "num_env_steps_sampled": 474480, "num_env_steps_trained": 474480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.55411100183315, "num_env_steps_trained_throughput_per_sec": 161.55411100183315, "timesteps_total": 474480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 474480, "timers": {"training_iteration_time_ms": 2230.518, "sample_time_ms": 2224.906, "load_time_ms": 0.224, "load_throughput": 1610269.212, "learn_time_ms": 4.816, "learn_throughput": 74758.114, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 474480, "num_env_steps_trained": 474480, "num_agent_steps_sampled": 474480, "num_agent_steps_trained": 474480}, "done": false, "episodes_total": 1318, "training_iteration": 264, "trial_id": "a960d_00000", "date": "2023-07-25_16-38-53", "timestamp": 1690292333, "time_this_iter_s": 11.14384412765503, "time_total_s": 2951.3929364681244, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2111.5136845111847, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 23.19375, "ram_util_percent": 76.44375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -1036951257088.0, "vf_loss": 2449882112.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2846.0, "diff_num_grad_updates_vs_sampler_policy": 2845.0}}, "num_env_steps_sampled": 476280, "num_env_steps_trained": 476280, "num_agent_steps_sampled": 476280, "num_agent_steps_trained": 476280}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29883.629566815885, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406874725872744, "mean_inference_ms": 0.24950906807681064, "mean_action_processing_ms": 0.059094933946161, "mean_env_wait_ms": 1.4619767247994881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002520322799682617, "StateBufferConnector_ms": 0.0017323493957519531, "ViewRequirementAgentConnector_ms": 0.045228004455566406}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29883.629566815885, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30085.41530009631, -29994.883512531316, -29893.654395306625, -29778.45610211443, -29945.805910469717, -29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406874725872744, "mean_inference_ms": 0.24950906807681064, "mean_action_processing_ms": 0.059094933946161, "mean_env_wait_ms": 1.4619767247994881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002520322799682617, "StateBufferConnector_ms": 0.0017323493957519531, "ViewRequirementAgentConnector_ms": 0.045228004455566406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476280, "num_agent_steps_trained": 476280, "num_env_steps_sampled": 476280, "num_env_steps_trained": 476280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.02144995097987, "num_env_steps_trained_throughput_per_sec": 160.02144995097987, "timesteps_total": 476280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 476280, "timers": {"training_iteration_time_ms": 2239.017, "sample_time_ms": 2233.497, "load_time_ms": 0.218, "load_throughput": 1650939.689, "learn_time_ms": 4.739, "learn_throughput": 75957.394, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 476280, "num_env_steps_trained": 476280, "num_agent_steps_sampled": 476280, "num_agent_steps_trained": 476280}, "done": false, "episodes_total": 1323, "training_iteration": 265, "trial_id": "a960d_00000", "date": "2023-07-25_16-39-04", "timestamp": 1690292344, "time_this_iter_s": 11.250761032104492, "time_total_s": 2962.643697500229, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2122.764445543289, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 24.28125, "ram_util_percent": 76.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -989479381674.6666, "vf_loss": 2510264021.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2861.0, "diff_num_grad_updates_vs_sampler_policy": 2860.0}}, "num_env_steps_sampled": 478080, "num_env_steps_trained": 478080, "num_agent_steps_sampled": 478080, "num_agent_steps_trained": 478080}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29884.76698746263, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40684986863538, "mean_inference_ms": 0.2495073591078819, "mean_action_processing_ms": 0.05909445707019063, "mean_env_wait_ms": 1.461937744913705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025298595428466797, "StateBufferConnector_ms": 0.0017361640930175781, "ViewRequirementAgentConnector_ms": 0.0452876091003418}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29884.76698746263, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29880.892959791585, -29714.494271747008, -29768.207390051663, -29878.91184323862, -29800.78759476656, -30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40684986863538, "mean_inference_ms": 0.2495073591078819, "mean_action_processing_ms": 0.05909445707019063, "mean_env_wait_ms": 1.461937744913705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025298595428466797, "StateBufferConnector_ms": 0.0017361640930175781, "ViewRequirementAgentConnector_ms": 0.0452876091003418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 478080, "num_agent_steps_trained": 478080, "num_env_steps_sampled": 478080, "num_env_steps_trained": 478080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.0803145818261, "num_env_steps_trained_throughput_per_sec": 161.0803145818261, "timesteps_total": 478080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 478080, "timers": {"training_iteration_time_ms": 2242.294, "sample_time_ms": 2236.946, "load_time_ms": 0.221, "load_throughput": 1628855.922, "learn_time_ms": 4.568, "learn_throughput": 78816.432, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 478080, "num_env_steps_trained": 478080, "num_agent_steps_sampled": 478080, "num_agent_steps_trained": 478080}, "done": false, "episodes_total": 1328, "training_iteration": 266, "trial_id": "a960d_00000", "date": "2023-07-25_16-39-15", "timestamp": 1690292355, "time_this_iter_s": 11.176717758178711, "time_total_s": 2973.8204152584076, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2133.941163301468, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 25.76875, "ram_util_percent": 76.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -1402006304085.3333, "vf_loss": 2470816405.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2876.0, "diff_num_grad_updates_vs_sampler_policy": 2875.0}}, "num_env_steps_sampled": 479880, "num_env_steps_trained": 479880, "num_agent_steps_sampled": 479880, "num_agent_steps_trained": 479880}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29888.990302969705, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406834097564774, "mean_inference_ms": 0.24950511256981706, "mean_action_processing_ms": 0.059093860232741734, "mean_env_wait_ms": 1.461899096081256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025441646575927734, "StateBufferConnector_ms": 0.0017392635345458984, "ViewRequirementAgentConnector_ms": 0.04538750648498535}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29888.990302969705, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30071.35331194663, -30034.84433005296, -29828.859193861957, -29792.580968337134, -30009.632362916862, -30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406834097564774, "mean_inference_ms": 0.24950511256981706, "mean_action_processing_ms": 0.059093860232741734, "mean_env_wait_ms": 1.461899096081256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025441646575927734, "StateBufferConnector_ms": 0.0017392635345458984, "ViewRequirementAgentConnector_ms": 0.04538750648498535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 479880, "num_agent_steps_trained": 479880, "num_env_steps_sampled": 479880, "num_env_steps_trained": 479880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.50488056282077, "num_env_steps_trained_throughput_per_sec": 161.50488056282077, "timesteps_total": 479880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 479880, "timers": {"training_iteration_time_ms": 2231.963, "sample_time_ms": 2226.655, "load_time_ms": 0.22, "load_throughput": 1636092.144, "learn_time_ms": 4.536, "learn_throughput": 79367.845, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 479880, "num_env_steps_trained": 479880, "num_agent_steps_sampled": 479880, "num_agent_steps_trained": 479880}, "done": false, "episodes_total": 1333, "training_iteration": 267, "trial_id": "a960d_00000", "date": "2023-07-25_16-39-26", "timestamp": 1690292366, "time_this_iter_s": 11.147440195083618, "time_total_s": 2984.967855453491, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2145.0886034965515, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 23.660000000000004, "ram_util_percent": 75.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284423828125, "policy_loss": -1651628355584.0, "vf_loss": 2458546858.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2891.0, "diff_num_grad_updates_vs_sampler_policy": 2890.0}}, "num_env_steps_sampled": 481680, "num_env_steps_trained": 481680, "num_agent_steps_sampled": 481680, "num_agent_steps_trained": 481680}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29883.864368571732, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406808800602838, "mean_inference_ms": 0.24950228620375633, "mean_action_processing_ms": 0.05909325333097703, "mean_env_wait_ms": 1.4618592574444043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025489330291748047, "StateBufferConnector_ms": 0.0017285346984863281, "ViewRequirementAgentConnector_ms": 0.04541826248168945}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29883.864368571732, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30091.041714445644, -29749.913826480875, -29934.13568422282, -29961.00536884295, -29842.846110413662, -29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406808800602838, "mean_inference_ms": 0.24950228620375633, "mean_action_processing_ms": 0.05909325333097703, "mean_env_wait_ms": 1.4618592574444043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025489330291748047, "StateBufferConnector_ms": 0.0017285346984863281, "ViewRequirementAgentConnector_ms": 0.04541826248168945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 481680, "num_agent_steps_trained": 481680, "num_env_steps_sampled": 481680, "num_env_steps_trained": 481680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.6463915011205, "num_env_steps_trained_throughput_per_sec": 162.6463915011205, "timesteps_total": 481680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 481680, "timers": {"training_iteration_time_ms": 2221.203, "sample_time_ms": 2215.939, "load_time_ms": 0.217, "load_throughput": 1657463.71, "learn_time_ms": 4.506, "learn_throughput": 79886.01, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 481680, "num_env_steps_trained": 481680, "num_agent_steps_sampled": 481680, "num_agent_steps_trained": 481680}, "done": false, "episodes_total": 1338, "training_iteration": 268, "trial_id": "a960d_00000", "date": "2023-07-25_16-39-37", "timestamp": 1690292377, "time_this_iter_s": 11.06895899772644, "time_total_s": 2996.0368144512177, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2156.157562494278, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 23.262500000000003, "ram_util_percent": 74.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -1101298745344.0, "vf_loss": 2470391893.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2906.0, "diff_num_grad_updates_vs_sampler_policy": 2905.0}}, "num_env_steps_sampled": 483480, "num_env_steps_trained": 483480, "num_agent_steps_sampled": 483480, "num_agent_steps_trained": 483480}, "sampler_results": {"episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29884.09766986798, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406777777477331, "mean_inference_ms": 0.24949861585841965, "mean_action_processing_ms": 0.05909248899564983, "mean_env_wait_ms": 1.4618178837488194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002547740936279297, "StateBufferConnector_ms": 0.0017254352569580078, "ViewRequirementAgentConnector_ms": 0.045401573181152344}}, "episode_reward_max": -29480.528590313406, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29884.09766986798, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29842.388323273964, -29815.081939751, -29708.29682634497, -29938.861878943088, -29480.528590313406, -30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406777777477331, "mean_inference_ms": 0.24949861585841965, "mean_action_processing_ms": 0.05909248899564983, "mean_env_wait_ms": 1.4618178837488194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002547740936279297, "StateBufferConnector_ms": 0.0017254352569580078, "ViewRequirementAgentConnector_ms": 0.045401573181152344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 483480, "num_agent_steps_trained": 483480, "num_env_steps_sampled": 483480, "num_env_steps_trained": 483480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.46303466056338, "num_env_steps_trained_throughput_per_sec": 163.46303466056338, "timesteps_total": 483480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 483480, "timers": {"training_iteration_time_ms": 2207.852, "sample_time_ms": 2202.507, "load_time_ms": 0.219, "load_throughput": 1646439.254, "learn_time_ms": 4.565, "learn_throughput": 78853.888, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 483480, "num_env_steps_trained": 483480, "num_agent_steps_sampled": 483480, "num_agent_steps_trained": 483480}, "done": false, "episodes_total": 1343, "training_iteration": 269, "trial_id": "a960d_00000", "date": "2023-07-25_16-39-48", "timestamp": 1690292388, "time_this_iter_s": 11.01395583152771, "time_total_s": 3007.0507702827454, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2167.1715183258057, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 21.1625, "ram_util_percent": 74.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -2378177164629.3335, "vf_loss": 2448262101.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2921.0, "diff_num_grad_updates_vs_sampler_policy": 2920.0}}, "num_env_steps_sampled": 485280, "num_env_steps_trained": 485280, "num_agent_steps_sampled": 485280, "num_agent_steps_trained": 485280}, "sampler_results": {"episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29886.49911431305, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406742844546292, "mean_inference_ms": 0.2494947358039591, "mean_action_processing_ms": 0.059091749010447024, "mean_env_wait_ms": 1.4617777898099893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025451183319091797, "StateBufferConnector_ms": 0.0017285346984863281, "ViewRequirementAgentConnector_ms": 0.04544472694396973}}, "episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29886.49911431305, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30002.80408152756, -29873.302386194737, -29773.7335211922, -29915.586012283264, -29824.123343052437, -29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406742844546292, "mean_inference_ms": 0.2494947358039591, "mean_action_processing_ms": 0.059091749010447024, "mean_env_wait_ms": 1.4617777898099893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025451183319091797, "StateBufferConnector_ms": 0.0017285346984863281, "ViewRequirementAgentConnector_ms": 0.04544472694396973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 485280, "num_agent_steps_trained": 485280, "num_env_steps_sampled": 485280, "num_env_steps_trained": 485280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.74207055978084, "num_env_steps_trained_throughput_per_sec": 161.74207055978084, "timesteps_total": 485280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 485280, "timers": {"training_iteration_time_ms": 2214.04, "sample_time_ms": 2208.596, "load_time_ms": 0.217, "load_throughput": 1659467.458, "learn_time_ms": 4.659, "learn_throughput": 77268.465, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 485280, "num_env_steps_trained": 485280, "num_agent_steps_sampled": 485280, "num_agent_steps_trained": 485280}, "done": false, "episodes_total": 1348, "training_iteration": 270, "trial_id": "a960d_00000", "date": "2023-07-25_16-40-00", "timestamp": 1690292400, "time_this_iter_s": 11.130897998809814, "time_total_s": 3018.181668281555, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2178.3024163246155, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 21.806666666666665, "ram_util_percent": 74.90666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283610026042, "policy_loss": -1770277513898.6667, "vf_loss": 2478096341.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2936.0, "diff_num_grad_updates_vs_sampler_policy": 2935.0}}, "num_env_steps_sampled": 487080, "num_env_steps_trained": 487080, "num_agent_steps_sampled": 487080, "num_agent_steps_trained": 487080}, "sampler_results": {"episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29888.496760916474, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406701222777491, "mean_inference_ms": 0.24949165969623596, "mean_action_processing_ms": 0.05909115413308685, "mean_env_wait_ms": 1.4617388017918929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025501251220703125, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.04550766944885254}}, "episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29888.496760916474, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29926.896167991337, -30031.416973791733, -29768.858513764997, -30008.604978943564, -29899.5874747204, -29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406701222777491, "mean_inference_ms": 0.24949165969623596, "mean_action_processing_ms": 0.05909115413308685, "mean_env_wait_ms": 1.4617388017918929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025501251220703125, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.04550766944885254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 487080, "num_agent_steps_trained": 487080, "num_env_steps_sampled": 487080, "num_env_steps_trained": 487080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4450599354382, "num_env_steps_trained_throughput_per_sec": 161.4450599354382, "timesteps_total": 487080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 487080, "timers": {"training_iteration_time_ms": 2227.804, "sample_time_ms": 2222.422, "load_time_ms": 0.218, "load_throughput": 1653832.903, "learn_time_ms": 4.603, "learn_throughput": 78203.711, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 487080, "num_env_steps_trained": 487080, "num_agent_steps_sampled": 487080, "num_agent_steps_trained": 487080}, "done": false, "episodes_total": 1353, "training_iteration": 271, "trial_id": "a960d_00000", "date": "2023-07-25_16-40-11", "timestamp": 1690292411, "time_this_iter_s": 11.151664018630981, "time_total_s": 3029.333332300186, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2189.4540803432465, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 25.15, "ram_util_percent": 75.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -1762721224704.0, "vf_loss": 2481730240.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2951.0, "diff_num_grad_updates_vs_sampler_policy": 2950.0}}, "num_env_steps_sampled": 488880, "num_env_steps_trained": 488880, "num_agent_steps_sampled": 488880, "num_agent_steps_trained": 488880}, "sampler_results": {"episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29882.255452898415, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406650015706037, "mean_inference_ms": 0.2494886758915257, "mean_action_processing_ms": 0.05909060061819147, "mean_env_wait_ms": 1.4617057409388847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025458335876464844, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.04543876647949219}}, "episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29882.255452898415, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29924.76009388079, -29985.733932570794, -29922.157893833457, -29997.71521215233, -29811.915207358532, -30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406650015706037, "mean_inference_ms": 0.2494886758915257, "mean_action_processing_ms": 0.05909060061819147, "mean_env_wait_ms": 1.4617057409388847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025458335876464844, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.04543876647949219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488880, "num_agent_steps_trained": 488880, "num_env_steps_sampled": 488880, "num_env_steps_trained": 488880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.04595644131817, "num_env_steps_trained_throughput_per_sec": 162.04595644131817, "timesteps_total": 488880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 488880, "timers": {"training_iteration_time_ms": 2225.716, "sample_time_ms": 2220.383, "load_time_ms": 0.217, "load_throughput": 1657099.912, "learn_time_ms": 4.557, "learn_throughput": 78992.082, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 488880, "num_env_steps_trained": 488880, "num_agent_steps_sampled": 488880, "num_agent_steps_trained": 488880}, "done": false, "episodes_total": 1358, "training_iteration": 272, "trial_id": "a960d_00000", "date": "2023-07-25_16-40-22", "timestamp": 1690292422, "time_this_iter_s": 11.110049962997437, "time_total_s": 3040.4433822631836, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2200.564130306244, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 24.474999999999998, "ram_util_percent": 75.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -1485562315434.6667, "vf_loss": 2490937493.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2966.0, "diff_num_grad_updates_vs_sampler_policy": 2965.0}}, "num_env_steps_sampled": 490680, "num_env_steps_trained": 490680, "num_agent_steps_sampled": 490680, "num_agent_steps_trained": 490680}, "sampler_results": {"episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29878.780522214493, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406607397797435, "mean_inference_ms": 0.2494877375564588, "mean_action_processing_ms": 0.059090433652210936, "mean_env_wait_ms": 1.4616813900886667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025436878204345703, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.04547405242919922}}, "episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29878.780522214493, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30122.123998393854, -29905.502154802944, -29886.471318407977, -29932.661818963195, -29751.56388425773, -29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406607397797435, "mean_inference_ms": 0.2494877375564588, "mean_action_processing_ms": 0.059090433652210936, "mean_env_wait_ms": 1.4616813900886667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025436878204345703, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.04547405242919922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 490680, "num_agent_steps_trained": 490680, "num_env_steps_sampled": 490680, "num_env_steps_trained": 490680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.52480568984947, "num_env_steps_trained_throughput_per_sec": 158.52480568984947, "timesteps_total": 490680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 490680, "timers": {"training_iteration_time_ms": 2246.255, "sample_time_ms": 2240.881, "load_time_ms": 0.215, "load_throughput": 1678094.51, "learn_time_ms": 4.608, "learn_throughput": 78126.022, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 490680, "num_env_steps_trained": 490680, "num_agent_steps_sampled": 490680, "num_agent_steps_trained": 490680}, "done": false, "episodes_total": 1363, "training_iteration": 273, "trial_id": "a960d_00000", "date": "2023-07-25_16-40-33", "timestamp": 1690292433, "time_this_iter_s": 11.356957197189331, "time_total_s": 3051.800339460373, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2211.9210875034332, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 28.33125, "ram_util_percent": 76.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -2655561536853.3335, "vf_loss": 2514116202.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2981.0, "diff_num_grad_updates_vs_sampler_policy": 2980.0}}, "num_env_steps_sampled": 492480, "num_env_steps_trained": 492480, "num_agent_steps_sampled": 492480, "num_agent_steps_trained": 492480}, "sampler_results": {"episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29880.232337576348, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406588024587006, "mean_inference_ms": 0.24948771535771463, "mean_action_processing_ms": 0.05909042253087943, "mean_env_wait_ms": 1.4616580165967243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025377273559570312, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.04551196098327637}}, "episode_reward_max": -29510.964284092424, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29880.232337576348, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29767.540489807365, -29668.231158765768, -29510.964284092424, -29765.972034414124, -30066.745655647304, -29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406588024587006, "mean_inference_ms": 0.24948771535771463, "mean_action_processing_ms": 0.05909042253087943, "mean_env_wait_ms": 1.4616580165967243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025377273559570312, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.04551196098327637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492480, "num_agent_steps_trained": 492480, "num_env_steps_sampled": 492480, "num_env_steps_trained": 492480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.95346084747266, "num_env_steps_trained_throughput_per_sec": 158.95346084747266, "timesteps_total": 492480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 492480, "timers": {"training_iteration_time_ms": 2267.866, "sample_time_ms": 2262.517, "load_time_ms": 0.215, "load_throughput": 1676045.554, "learn_time_ms": 4.575, "learn_throughput": 78680.491, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 492480, "num_env_steps_trained": 492480, "num_agent_steps_sampled": 492480, "num_agent_steps_trained": 492480}, "done": false, "episodes_total": 1368, "training_iteration": 274, "trial_id": "a960d_00000", "date": "2023-07-25_16-40-45", "timestamp": 1690292445, "time_this_iter_s": 11.3262619972229, "time_total_s": 3063.126601457596, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2223.247349500656, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 26.225, "ram_util_percent": 76.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282796223958, "policy_loss": -2536160783018.6665, "vf_loss": 2483995456.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 2996.0, "diff_num_grad_updates_vs_sampler_policy": 2995.0}}, "num_env_steps_sampled": 494280, "num_env_steps_trained": 494280, "num_agent_steps_sampled": 494280, "num_agent_steps_trained": 494280}, "sampler_results": {"episode_reward_max": -29560.316544624275, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29885.424048597975, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406597025843921, "mean_inference_ms": 0.24948957537739833, "mean_action_processing_ms": 0.05909073895994298, "mean_env_wait_ms": 1.4616352806058521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025496482849121094, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.04555654525756836}}, "episode_reward_max": -29560.316544624275, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29885.424048597975, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29834.26610110903, -29935.055778487396, -29938.446401568384, -29902.38101396972, -29791.356279229367, -29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406597025843921, "mean_inference_ms": 0.24948957537739833, "mean_action_processing_ms": 0.05909073895994298, "mean_env_wait_ms": 1.4616352806058521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025496482849121094, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.04555654525756836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 494280, "num_agent_steps_trained": 494280, "num_env_steps_sampled": 494280, "num_env_steps_trained": 494280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 156.61441648088567, "num_env_steps_trained_throughput_per_sec": 156.61441648088567, "timesteps_total": 494280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 494280, "timers": {"training_iteration_time_ms": 2281.717, "sample_time_ms": 2276.362, "load_time_ms": 0.218, "load_throughput": 1648596.397, "learn_time_ms": 4.572, "learn_throughput": 78745.323, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 494280, "num_env_steps_trained": 494280, "num_agent_steps_sampled": 494280, "num_agent_steps_trained": 494280}, "done": false, "episodes_total": 1373, "training_iteration": 275, "trial_id": "a960d_00000", "date": "2023-07-25_16-40-56", "timestamp": 1690292456, "time_this_iter_s": 11.495412111282349, "time_total_s": 3074.622013568878, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2234.7427616119385, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 31.48823529411765, "ram_util_percent": 77.08823529411767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -2299722055680.0, "vf_loss": 2510306432.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3011.0, "diff_num_grad_updates_vs_sampler_policy": 3010.0}}, "num_env_steps_sampled": 496080, "num_env_steps_trained": 496080, "num_agent_steps_sampled": 496080, "num_agent_steps_trained": 496080}, "sampler_results": {"episode_reward_max": -29560.316544624275, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29887.98461389055, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406621537663683, "mean_inference_ms": 0.24949157442171205, "mean_action_processing_ms": 0.05909118717101138, "mean_env_wait_ms": 1.4616098786202656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025360584259033203, "StateBufferConnector_ms": 0.001722574234008789, "ViewRequirementAgentConnector_ms": 0.04548978805541992}}, "episode_reward_max": -29560.316544624275, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29887.98461389055, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29920.925321833813, -29821.83832794513, -29967.977241216846, -29887.533681151694, -30152.834381878278, -30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406621537663683, "mean_inference_ms": 0.24949157442171205, "mean_action_processing_ms": 0.05909118717101138, "mean_env_wait_ms": 1.4616098786202656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025360584259033203, "StateBufferConnector_ms": 0.001722574234008789, "ViewRequirementAgentConnector_ms": 0.04548978805541992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496080, "num_agent_steps_trained": 496080, "num_env_steps_sampled": 496080, "num_env_steps_trained": 496080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.1068692939606, "num_env_steps_trained_throughput_per_sec": 160.1068692939606, "timesteps_total": 496080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 496080, "timers": {"training_iteration_time_ms": 2273.559, "sample_time_ms": 2268.265, "load_time_ms": 0.218, "load_throughput": 1648596.397, "learn_time_ms": 4.541, "learn_throughput": 79280.333, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 496080, "num_env_steps_trained": 496080, "num_agent_steps_sampled": 496080, "num_agent_steps_trained": 496080}, "done": false, "episodes_total": 1378, "training_iteration": 276, "trial_id": "a960d_00000", "date": "2023-07-25_16-41-07", "timestamp": 1690292467, "time_this_iter_s": 11.24455189704895, "time_total_s": 3085.866565465927, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2245.9873135089874, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 32.587500000000006, "ram_util_percent": 79.7375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528564453125, "policy_loss": -1154959024128.0, "vf_loss": 2424648426.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3026.0, "diff_num_grad_updates_vs_sampler_policy": 3025.0}}, "num_env_steps_sampled": 497880, "num_env_steps_trained": 497880, "num_agent_steps_sampled": 497880, "num_agent_steps_trained": 497880}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29886.372382166235, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406661173465628, "mean_inference_ms": 0.2494943248745644, "mean_action_processing_ms": 0.059091858006582204, "mean_env_wait_ms": 1.4615861307771068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.04535508155822754}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30237.28801755391, "episode_reward_mean": -29886.372382166235, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30237.28801755391, -29738.62419755066, -29989.09168853073, -29926.378937794238, -29812.015005767546, -29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406661173465628, "mean_inference_ms": 0.2494943248745644, "mean_action_processing_ms": 0.059091858006582204, "mean_env_wait_ms": 1.4615861307771068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.04535508155822754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 497880, "num_agent_steps_trained": 497880, "num_env_steps_sampled": 497880, "num_env_steps_trained": 497880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.52783925850838, "num_env_steps_trained_throughput_per_sec": 159.52783925850838, "timesteps_total": 497880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 497880, "timers": {"training_iteration_time_ms": 2252.57, "sample_time_ms": 2247.173, "load_time_ms": 0.222, "load_throughput": 1622380.402, "learn_time_ms": 4.618, "learn_throughput": 77959.833, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 497880, "num_env_steps_trained": 497880, "num_agent_steps_sampled": 497880, "num_agent_steps_trained": 497880}, "done": false, "episodes_total": 1383, "training_iteration": 277, "trial_id": "a960d_00000", "date": "2023-07-25_16-41-19", "timestamp": 1690292479, "time_this_iter_s": 11.285351037979126, "time_total_s": 3097.1519165039062, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2257.2726645469666, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 27.5875, "ram_util_percent": 80.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.528076171875, "policy_loss": -714832699392.0, "vf_loss": 2506781546.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3041.0, "diff_num_grad_updates_vs_sampler_policy": 3040.0}}, "num_env_steps_sampled": 499680, "num_env_steps_trained": 499680, "num_agent_steps_sampled": 499680, "num_agent_steps_trained": 499680}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30199.855354711926, "episode_reward_mean": -29882.71013974946, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406715925577251, "mean_inference_ms": 0.24949966375348392, "mean_action_processing_ms": 0.05909304338677433, "mean_env_wait_ms": 1.4615730708131514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002572774887084961, "StateBufferConnector_ms": 0.0017294883728027344, "ViewRequirementAgentConnector_ms": 0.04559636116027832}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30199.855354711926, "episode_reward_mean": -29882.71013974946, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29962.066030110236, -29962.157240364657, -29750.06277950007, -30095.909063033505, -29923.51756257143, -29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406715925577251, "mean_inference_ms": 0.24949966375348392, "mean_action_processing_ms": 0.05909304338677433, "mean_env_wait_ms": 1.4615730708131514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002572774887084961, "StateBufferConnector_ms": 0.0017294883728027344, "ViewRequirementAgentConnector_ms": 0.04559636116027832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 499680, "num_agent_steps_trained": 499680, "num_env_steps_sampled": 499680, "num_env_steps_trained": 499680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.477551790168, "num_env_steps_trained_throughput_per_sec": 159.477551790168, "timesteps_total": 499680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 499680, "timers": {"training_iteration_time_ms": 2257.006, "sample_time_ms": 2251.391, "load_time_ms": 0.226, "load_throughput": 1591934.043, "learn_time_ms": 4.811, "learn_throughput": 74832.955, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 499680, "num_env_steps_trained": 499680, "num_agent_steps_sampled": 499680, "num_agent_steps_trained": 499680}, "done": false, "episodes_total": 1388, "training_iteration": 278, "trial_id": "a960d_00000", "date": "2023-07-25_16-41-30", "timestamp": 1690292490, "time_this_iter_s": 11.288903951644897, "time_total_s": 3108.440820455551, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2268.5615684986115, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 26.99375, "ram_util_percent": 78.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5286865234375, "policy_loss": -1039653112490.6666, "vf_loss": 2433584106.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3056.0, "diff_num_grad_updates_vs_sampler_policy": 3055.0}}, "num_env_steps_sampled": 501480, "num_env_steps_trained": 501480, "num_agent_steps_sampled": 501480, "num_agent_steps_trained": 501480}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29882.8904104201, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406800188885956, "mean_inference_ms": 0.2495067776189211, "mean_action_processing_ms": 0.059094573060618265, "mean_env_wait_ms": 1.4615594743387057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025818347930908203, "StateBufferConnector_ms": 0.001735687255859375, "ViewRequirementAgentConnector_ms": 0.045743465423583984}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29882.8904104201, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29777.796324066534, -30029.742845220055, -30061.472947503895, -29847.67286177926, -29978.770827689066, -29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406800188885956, "mean_inference_ms": 0.2495067776189211, "mean_action_processing_ms": 0.059094573060618265, "mean_env_wait_ms": 1.4615594743387057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025818347930908203, "StateBufferConnector_ms": 0.001735687255859375, "ViewRequirementAgentConnector_ms": 0.045743465423583984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 501480, "num_agent_steps_trained": 501480, "num_env_steps_sampled": 501480, "num_env_steps_trained": 501480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.5147011515378, "num_env_steps_trained_throughput_per_sec": 157.5147011515378, "timesteps_total": 501480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 501480, "timers": {"training_iteration_time_ms": 2271.426, "sample_time_ms": 2265.793, "load_time_ms": 0.23, "load_throughput": 1568615.666, "learn_time_ms": 4.823, "learn_throughput": 74638.753, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 501480, "num_env_steps_trained": 501480, "num_agent_steps_sampled": 501480, "num_agent_steps_trained": 501480}, "done": false, "episodes_total": 1393, "training_iteration": 279, "trial_id": "a960d_00000", "date": "2023-07-25_16-41-41", "timestamp": 1690292501, "time_this_iter_s": 11.42953085899353, "time_total_s": 3119.8703513145447, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2279.991099357605, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 27.61875, "ram_util_percent": 79.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -3980566806528.0, "vf_loss": 2524204330.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3071.0, "diff_num_grad_updates_vs_sampler_policy": 3070.0}}, "num_env_steps_sampled": 503280, "num_env_steps_trained": 503280, "num_agent_steps_sampled": 503280, "num_agent_steps_trained": 503280}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29881.996565287936, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406904285522034, "mean_inference_ms": 0.24951864118265285, "mean_action_processing_ms": 0.05909698493404521, "mean_env_wait_ms": 1.461558974087572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002594470977783203, "StateBufferConnector_ms": 0.0017440319061279297, "ViewRequirementAgentConnector_ms": 0.04587554931640625}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29881.996565287936, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29944.748204533502, -29710.9113966674, -29935.049573405606, -29842.778626802778, -29718.503063842185, -29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406904285522034, "mean_inference_ms": 0.24951864118265285, "mean_action_processing_ms": 0.05909698493404521, "mean_env_wait_ms": 1.461558974087572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002594470977783203, "StateBufferConnector_ms": 0.0017440319061279297, "ViewRequirementAgentConnector_ms": 0.04587554931640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 503280, "num_agent_steps_trained": 503280, "num_env_steps_sampled": 503280, "num_env_steps_trained": 503280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.56654346637424, "num_env_steps_trained_throughput_per_sec": 157.56654346637424, "timesteps_total": 503280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 503280, "timers": {"training_iteration_time_ms": 2285.115, "sample_time_ms": 2279.625, "load_time_ms": 0.227, "load_throughput": 1587749.148, "learn_time_ms": 4.664, "learn_throughput": 77181.968, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 503280, "num_env_steps_trained": 503280, "num_agent_steps_sampled": 503280, "num_agent_steps_trained": 503280}, "done": false, "episodes_total": 1398, "training_iteration": 280, "trial_id": "a960d_00000", "date": "2023-07-25_16-41-53", "timestamp": 1690292513, "time_this_iter_s": 11.425936698913574, "time_total_s": 3131.2962880134583, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2291.4170360565186, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 32.3, "ram_util_percent": 78.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281168619792, "policy_loss": -4493072083626.667, "vf_loss": 2509687381.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3086.0, "diff_num_grad_updates_vs_sampler_policy": 3085.0}}, "num_env_steps_sampled": 505080, "num_env_steps_trained": 505080, "num_agent_steps_sampled": 505080, "num_agent_steps_trained": 505080}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29884.344451817546, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407001736237728, "mean_inference_ms": 0.24953166411110111, "mean_action_processing_ms": 0.05909955205860563, "mean_env_wait_ms": 1.4615581339196169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002611875534057617, "StateBufferConnector_ms": 0.0017399787902832031, "ViewRequirementAgentConnector_ms": 0.045966148376464844}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29884.344451817546, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29892.694037271678, -29712.61591984211, -29937.900519699066, -29906.96647381181, -30111.949741630062, -29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407001736237728, "mean_inference_ms": 0.24953166411110111, "mean_action_processing_ms": 0.05909955205860563, "mean_env_wait_ms": 1.4615581339196169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002611875534057617, "StateBufferConnector_ms": 0.0017399787902832031, "ViewRequirementAgentConnector_ms": 0.045966148376464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 505080, "num_agent_steps_trained": 505080, "num_env_steps_sampled": 505080, "num_env_steps_trained": 505080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.5483656160928, "num_env_steps_trained_throughput_per_sec": 161.5483656160928, "timesteps_total": 505080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 505080, "timers": {"training_iteration_time_ms": 2256.583, "sample_time_ms": 2251.263, "load_time_ms": 0.218, "load_throughput": 1655101.874, "learn_time_ms": 4.542, "learn_throughput": 79267.847, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 505080, "num_env_steps_trained": 505080, "num_agent_steps_sampled": 505080, "num_agent_steps_trained": 505080}, "done": false, "episodes_total": 1403, "training_iteration": 281, "trial_id": "a960d_00000", "date": "2023-07-25_16-42-04", "timestamp": 1690292524, "time_this_iter_s": 11.14418625831604, "time_total_s": 3142.4404742717743, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2302.5612223148346, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 26.95, "ram_util_percent": 78.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5281575520833, "policy_loss": -2528104458922.6665, "vf_loss": 2508045248.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3101.0, "diff_num_grad_updates_vs_sampler_policy": 3100.0}}, "num_env_steps_sampled": 506880, "num_env_steps_trained": 506880, "num_agent_steps_sampled": 506880, "num_agent_steps_trained": 506880}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29885.969397499604, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407107819966063, "mean_inference_ms": 0.24954908156867645, "mean_action_processing_ms": 0.0591027626353758, "mean_env_wait_ms": 1.4615647432139718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002627134323120117, "StateBufferConnector_ms": 0.0017342567443847656, "ViewRequirementAgentConnector_ms": 0.04613685607910156}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29885.969397499604, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29975.10334910015, -30075.74219832292, -29732.039486643964, -29905.52680392692, -29752.106260189346, -29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407107819966063, "mean_inference_ms": 0.24954908156867645, "mean_action_processing_ms": 0.0591027626353758, "mean_env_wait_ms": 1.4615647432139718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002627134323120117, "StateBufferConnector_ms": 0.0017342567443847656, "ViewRequirementAgentConnector_ms": 0.04613685607910156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 506880, "num_agent_steps_trained": 506880, "num_env_steps_sampled": 506880, "num_env_steps_trained": 506880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.91341179175734, "num_env_steps_trained_throughput_per_sec": 158.91341179175734, "timesteps_total": 506880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 506880, "timers": {"training_iteration_time_ms": 2246.899, "sample_time_ms": 2241.476, "load_time_ms": 0.222, "load_throughput": 1622206.102, "learn_time_ms": 4.624, "learn_throughput": 77862.948, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 506880, "num_env_steps_trained": 506880, "num_agent_steps_sampled": 506880, "num_agent_steps_trained": 506880}, "done": false, "episodes_total": 1408, "training_iteration": 282, "trial_id": "a960d_00000", "date": "2023-07-25_16-42-15", "timestamp": 1690292535, "time_this_iter_s": 11.329251050949097, "time_total_s": 3153.7697253227234, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2313.8904733657837, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 28.512500000000003, "ram_util_percent": 77.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -2947129111893.3335, "vf_loss": 2483446314.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3116.0, "diff_num_grad_updates_vs_sampler_policy": 3115.0}}, "num_env_steps_sampled": 508680, "num_env_steps_trained": 508680, "num_agent_steps_sampled": 508680, "num_agent_steps_trained": 508680}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29880.989127676414, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4073053681351215, "mean_inference_ms": 0.24957391962914635, "mean_action_processing_ms": 0.05910733058513479, "mean_env_wait_ms": 1.461597707641513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026154518127441406, "StateBufferConnector_ms": 0.0017440319061279297, "ViewRequirementAgentConnector_ms": 0.04620981216430664}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29880.989127676414, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29610.070688562348, -29714.062181403675, -29842.259282688938, -29927.358273655725, -29839.599611507863, -29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4073053681351215, "mean_inference_ms": 0.24957391962914635, "mean_action_processing_ms": 0.05910733058513479, "mean_env_wait_ms": 1.461597707641513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026154518127441406, "StateBufferConnector_ms": 0.0017440319061279297, "ViewRequirementAgentConnector_ms": 0.04620981216430664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508680, "num_agent_steps_trained": 508680, "num_env_steps_sampled": 508680, "num_env_steps_trained": 508680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 148.5162143235879, "num_env_steps_trained_throughput_per_sec": 148.5162143235879, "timesteps_total": 508680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 508680, "timers": {"training_iteration_time_ms": 2344.668, "sample_time_ms": 2338.922, "load_time_ms": 0.255, "load_throughput": 1410376.835, "learn_time_ms": 4.841, "learn_throughput": 74368.557, "synch_weights_time_ms": 0.604}, "counters": {"num_env_steps_sampled": 508680, "num_env_steps_trained": 508680, "num_agent_steps_sampled": 508680, "num_agent_steps_trained": 508680}, "done": false, "episodes_total": 1413, "training_iteration": 283, "trial_id": "a960d_00000", "date": "2023-07-25_16-42-28", "timestamp": 1690292548, "time_this_iter_s": 12.122724294662476, "time_total_s": 3165.892449617386, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2326.013197660446, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 29.11111111111111, "ram_util_percent": 79.55555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284016927083, "policy_loss": -3738355577514.6665, "vf_loss": 2486195157.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3131.0, "diff_num_grad_updates_vs_sampler_policy": 3130.0}}, "num_env_steps_sampled": 510480, "num_env_steps_trained": 510480, "num_agent_steps_sampled": 510480, "num_agent_steps_trained": 510480}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29884.354984253998, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407541985522372, "mean_inference_ms": 0.24960501430783621, "mean_action_processing_ms": 0.0591131557572892, "mean_env_wait_ms": 1.461648214874246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026302337646484375, "StateBufferConnector_ms": 0.0017480850219726562, "ViewRequirementAgentConnector_ms": 0.046396732330322266}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29884.354984253998, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29932.433983718212, -29795.502781512543, -29926.882899725075, -29708.347084956637, -29778.77107967, -29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407541985522372, "mean_inference_ms": 0.24960501430783621, "mean_action_processing_ms": 0.0591131557572892, "mean_env_wait_ms": 1.461648214874246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026302337646484375, "StateBufferConnector_ms": 0.0017480850219726562, "ViewRequirementAgentConnector_ms": 0.046396732330322266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 510480, "num_agent_steps_trained": 510480, "num_env_steps_sampled": 510480, "num_env_steps_trained": 510480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.76850980609214, "num_env_steps_trained_throughput_per_sec": 154.76850980609214, "timesteps_total": 510480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 510480, "timers": {"training_iteration_time_ms": 2375.004, "sample_time_ms": 2369.229, "load_time_ms": 0.259, "load_throughput": 1387948.745, "learn_time_ms": 4.895, "learn_throughput": 73543.781, "synch_weights_time_ms": 0.576}, "counters": {"num_env_steps_sampled": 510480, "num_env_steps_trained": 510480, "num_agent_steps_sampled": 510480, "num_agent_steps_trained": 510480}, "done": false, "episodes_total": 1418, "training_iteration": 284, "trial_id": "a960d_00000", "date": "2023-07-25_16-42-39", "timestamp": 1690292559, "time_this_iter_s": 11.632285833358765, "time_total_s": 3177.5247354507446, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2337.645483493805, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 36.162499999999994, "ram_util_percent": 81.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5282389322917, "policy_loss": -2613628622165.3335, "vf_loss": 2485089941.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3146.0, "diff_num_grad_updates_vs_sampler_policy": 3145.0}}, "num_env_steps_sampled": 512280, "num_env_steps_trained": 512280, "num_agent_steps_sampled": 512280, "num_agent_steps_trained": 512280}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29886.677936060223, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407765908162488, "mean_inference_ms": 0.24963573893013447, "mean_action_processing_ms": 0.05911895103680354, "mean_env_wait_ms": 1.4616904304483074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002634286880493164, "StateBufferConnector_ms": 0.001748800277709961, "ViewRequirementAgentConnector_ms": 0.04643607139587402}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30207.442862326017, "episode_reward_mean": -29886.677936060223, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29875.032848722683, -29931.72089775906, -29985.567283950266, -29994.76959599945, -30024.86665876183, -29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407765908162488, "mean_inference_ms": 0.24963573893013447, "mean_action_processing_ms": 0.05911895103680354, "mean_env_wait_ms": 1.4616904304483074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002634286880493164, "StateBufferConnector_ms": 0.001748800277709961, "ViewRequirementAgentConnector_ms": 0.04643607139587402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512280, "num_agent_steps_trained": 512280, "num_env_steps_sampled": 512280, "num_env_steps_trained": 512280, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.0972957723073, "num_env_steps_trained_throughput_per_sec": 162.0972957723073, "timesteps_total": 512280, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 512280, "timers": {"training_iteration_time_ms": 2273.461, "sample_time_ms": 2268.011, "load_time_ms": 0.225, "load_throughput": 1601728.482, "learn_time_ms": 4.673, "learn_throughput": 77039.809, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 512280, "num_env_steps_trained": 512280, "num_agent_steps_sampled": 512280, "num_agent_steps_trained": 512280}, "done": false, "episodes_total": 1423, "training_iteration": 285, "trial_id": "a960d_00000", "date": "2023-07-25_16-42-50", "timestamp": 1690292570, "time_this_iter_s": 11.10661005973816, "time_total_s": 3188.631345510483, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2348.752093553543, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 23.31875, "ram_util_percent": 80.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5277099609375, "policy_loss": -1731130403498.6667, "vf_loss": 2522411114.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3161.0, "diff_num_grad_updates_vs_sampler_policy": 3160.0}}, "num_env_steps_sampled": 514080, "num_env_steps_trained": 514080, "num_agent_steps_sampled": 514080, "num_agent_steps_trained": 514080}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30209.65979235925, "episode_reward_mean": -29889.04410412414, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566, -30209.65979235925, -29668.221173923812, -30065.45282685471, -29925.914862583173, -30179.325435862946], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40799373872453, "mean_inference_ms": 0.24966920037354837, "mean_action_processing_ms": 0.059125182343514986, "mean_env_wait_ms": 1.4617351438974981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002641439437866211, "StateBufferConnector_ms": 0.001756906509399414, "ViewRequirementAgentConnector_ms": 0.04651069641113281}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30209.65979235925, "episode_reward_mean": -29889.04410412414, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29907.226402045744, -29878.835888067166, -30056.524172249883, -29807.362741233308, -29815.676406706905, -29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566, -30209.65979235925, -29668.221173923812, -30065.45282685471, -29925.914862583173, -30179.325435862946], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40799373872453, "mean_inference_ms": 0.24966920037354837, "mean_action_processing_ms": 0.059125182343514986, "mean_env_wait_ms": 1.4617351438974981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002641439437866211, "StateBufferConnector_ms": 0.001756906509399414, "ViewRequirementAgentConnector_ms": 0.04651069641113281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 514080, "num_agent_steps_trained": 514080, "num_env_steps_sampled": 514080, "num_env_steps_trained": 514080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.87609293792005, "num_env_steps_trained_throughput_per_sec": 159.87609293792005, "timesteps_total": 514080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 514080, "timers": {"training_iteration_time_ms": 2236.303, "sample_time_ms": 2230.921, "load_time_ms": 0.216, "load_throughput": 1667715.308, "learn_time_ms": 4.607, "learn_throughput": 78141.386, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 514080, "num_env_steps_trained": 514080, "num_agent_steps_sampled": 514080, "num_agent_steps_trained": 514080}, "done": false, "episodes_total": 1428, "training_iteration": 286, "trial_id": "a960d_00000", "date": "2023-07-25_16-43-02", "timestamp": 1690292582, "time_this_iter_s": 11.260731935501099, "time_total_s": 3199.892077445984, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2360.012825489044, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 28.48125, "ram_util_percent": 80.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5280354817708, "policy_loss": -3331216624298.6665, "vf_loss": 2509806634.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3176.0, "diff_num_grad_updates_vs_sampler_policy": 3175.0}}, "num_env_steps_sampled": 515880, "num_env_steps_trained": 515880, "num_agent_steps_sampled": 515880, "num_agent_steps_trained": 515880}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30209.65979235925, "episode_reward_mean": -29887.47124082708, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566, -30209.65979235925, -29668.221173923812, -30065.45282685471, -29925.914862583173, -30179.325435862946, -29912.00481245658, -29919.959558110113, -29607.023939902407, -29900.53100117004, -29968.819968957887], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4082488796557575, "mean_inference_ms": 0.24971205836845556, "mean_action_processing_ms": 0.059133001795460396, "mean_env_wait_ms": 1.4618059400978844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002687692642211914, "StateBufferConnector_ms": 0.0017788410186767578, "ViewRequirementAgentConnector_ms": 0.047402143478393555}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30209.65979235925, "episode_reward_mean": -29887.47124082708, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29791.794777607633, -29903.561356952832, -29812.178364863194, -30015.46860635439, -29701.67362153941, -29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566, -30209.65979235925, -29668.221173923812, -30065.45282685471, -29925.914862583173, -30179.325435862946, -29912.00481245658, -29919.959558110113, -29607.023939902407, -29900.53100117004, -29968.819968957887], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4082488796557575, "mean_inference_ms": 0.24971205836845556, "mean_action_processing_ms": 0.059133001795460396, "mean_env_wait_ms": 1.4618059400978844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002687692642211914, "StateBufferConnector_ms": 0.0017788410186767578, "ViewRequirementAgentConnector_ms": 0.047402143478393555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 515880, "num_agent_steps_trained": 515880, "num_env_steps_sampled": 515880, "num_env_steps_trained": 515880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.5226592246608, "num_env_steps_trained_throughput_per_sec": 154.5226592246608, "timesteps_total": 515880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 515880, "timers": {"training_iteration_time_ms": 2290.734, "sample_time_ms": 2285.222, "load_time_ms": 0.22, "load_throughput": 1635383.342, "learn_time_ms": 4.699, "learn_throughput": 76615.289, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 515880, "num_env_steps_trained": 515880, "num_agent_steps_sampled": 515880, "num_agent_steps_trained": 515880}, "done": false, "episodes_total": 1433, "training_iteration": 287, "trial_id": "a960d_00000", "date": "2023-07-25_16-43-13", "timestamp": 1690292593, "time_this_iter_s": 11.65125584602356, "time_total_s": 3211.5433332920074, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2371.6640813350677, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 33.99411764705882, "ram_util_percent": 81.34117647058825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5284830729167, "policy_loss": -2578101802325.3335, "vf_loss": 2449616170.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3191.0, "diff_num_grad_updates_vs_sampler_policy": 3190.0}}, "num_env_steps_sampled": 517680, "num_env_steps_trained": 517680, "num_agent_steps_sampled": 517680, "num_agent_steps_trained": 517680}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30209.65979235925, "episode_reward_mean": -29885.407327071185, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566, -30209.65979235925, -29668.221173923812, -30065.45282685471, -29925.914862583173, -30179.325435862946, -29912.00481245658, -29919.959558110113, -29607.023939902407, -29900.53100117004, -29968.819968957887, -29927.543200882305, -29879.276766141895, -29737.319461260497, -29802.720175202117, -29671.425748242153], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408572082801401, "mean_inference_ms": 0.24975616741545476, "mean_action_processing_ms": 0.059141043537562395, "mean_env_wait_ms": 1.4618844000427134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027146339416503906, "StateBufferConnector_ms": 0.0017893314361572266, "ViewRequirementAgentConnector_ms": 0.04784893989562988}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30209.65979235925, "episode_reward_mean": -29885.407327071185, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29836.944822420082, -30199.855354711926, -29800.651376410668, -29957.162129184526, -29807.65915130359, -29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566, -30209.65979235925, -29668.221173923812, -30065.45282685471, -29925.914862583173, -30179.325435862946, -29912.00481245658, -29919.959558110113, -29607.023939902407, -29900.53100117004, -29968.819968957887, -29927.543200882305, -29879.276766141895, -29737.319461260497, -29802.720175202117, -29671.425748242153], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408572082801401, "mean_inference_ms": 0.24975616741545476, "mean_action_processing_ms": 0.059141043537562395, "mean_env_wait_ms": 1.4618844000427134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027146339416503906, "StateBufferConnector_ms": 0.0017893314361572266, "ViewRequirementAgentConnector_ms": 0.04784893989562988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 517680, "num_agent_steps_trained": 517680, "num_env_steps_sampled": 517680, "num_env_steps_trained": 517680, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.3095564798633, "num_env_steps_trained_throughput_per_sec": 154.3095564798633, "timesteps_total": 517680, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 517680, "timers": {"training_iteration_time_ms": 2331.352, "sample_time_ms": 2325.646, "load_time_ms": 0.236, "load_throughput": 1525972.148, "learn_time_ms": 4.84, "learn_throughput": 74382.479, "synch_weights_time_ms": 0.594}, "counters": {"num_env_steps_sampled": 517680, "num_env_steps_trained": 517680, "num_agent_steps_sampled": 517680, "num_agent_steps_trained": 517680}, "done": false, "episodes_total": 1438, "training_iteration": 288, "trial_id": "a960d_00000", "date": "2023-07-25_16-43-25", "timestamp": 1690292605, "time_this_iter_s": 11.667277097702026, "time_total_s": 3223.2106103897095, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2383.33135843277, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 30.768749999999997, "ram_util_percent": 78.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1873.5283203125, "policy_loss": -1672798115157.3333, "vf_loss": 2494110357.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 3206.0, "diff_num_grad_updates_vs_sampler_policy": 3205.0}}, "num_env_steps_sampled": 519480, "num_env_steps_trained": 519480, "num_agent_steps_sampled": 519480, "num_agent_steps_trained": 519480}, "sampler_results": {"episode_reward_max": -29512.152933658195, "episode_reward_min": -30209.65979235925, "episode_reward_mean": -29883.84964850511, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566, -30209.65979235925, -29668.221173923812, -30065.45282685471, -29925.914862583173, -30179.325435862946, -29912.00481245658, -29919.959558110113, -29607.023939902407, -29900.53100117004, -29968.819968957887, -29927.543200882305, -29879.276766141895, -29737.319461260497, -29802.720175202117, -29671.425748242153, -29975.59385549177, -29953.7467072546, -29723.438754913688, -29855.742887104105, -29937.98277265926], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408929802420373, "mean_inference_ms": 0.24980767115609606, "mean_action_processing_ms": 0.05915031948379527, "mean_env_wait_ms": 1.4620170313977134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027434825897216797, "StateBufferConnector_ms": 0.0018095970153808594, "ViewRequirementAgentConnector_ms": 0.04809117317199707}}, "episode_reward_max": -29512.152933658195, "episode_reward_min": -30209.65979235925, "episode_reward_mean": -29883.84964850511, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29955.361113050454, -29560.316544624275, -29942.415344520894, -29891.45850001934, -29675.75050091882, -29693.522919377094, -30185.27186073978, -29934.372760711954, -29971.141230695, -29805.005233067975, -29789.734928020487, -29864.915713811646, -29632.766786371132, -29884.577870698602, -29839.238008504213, -29815.75126493811, -29974.375904704422, -29786.739627327304, -29815.38308686434, -29902.53938756953, -29871.41350385027, -29968.91573959566, -29961.43570392214, -29915.79161475749, -30025.948148886226, -30027.92403588644, -29699.746013126467, -29933.21672792479, -29784.111762200053, -29853.626185752113, -29900.144312369383, -29953.5694472099, -29934.914856646563, -29849.08996348259, -30019.843523912587, -29928.614626992945, -30087.95689022498, -29960.171804671427, -30100.989526047208, -29512.152933658195, -30010.45698597867, -29756.840126827043, -29687.985900675267, -29803.08831188204, -30078.80228015643, -30083.817402705605, -30207.442862326017, -29929.661522374663, -29911.069568296243, -29579.748386941606, -29929.817043101066, -29877.441715104163, -29899.220365183315, -29856.91819175243, -30042.67397790108, -29784.32343676603, -29988.563783720492, -29973.256895659546, -29654.567614482807, -29986.067787583288, -29748.59774796238, -30039.717355465276, -29764.599137943682, -30139.273192584977, -30032.433826504268, -29908.832285292265, -29747.637931066263, -29722.615582973525, -29706.217190031097, -29857.188126501464, -29770.90663502009, -29762.794254151682, -29815.839320036506, -30018.624068260437, -29901.771418108354, -29914.0612803424, -29934.950450606044, -29827.195494614552, -29806.229409459695, -29891.796375182566, -30209.65979235925, -29668.221173923812, -30065.45282685471, -29925.914862583173, -30179.325435862946, -29912.00481245658, -29919.959558110113, -29607.023939902407, -29900.53100117004, -29968.819968957887, -29927.543200882305, -29879.276766141895, -29737.319461260497, -29802.720175202117, -29671.425748242153, -29975.59385549177, -29953.7467072546, -29723.438754913688, -29855.742887104105, -29937.98277265926], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408929802420373, "mean_inference_ms": 0.24980767115609606, "mean_action_processing_ms": 0.05915031948379527, "mean_env_wait_ms": 1.4620170313977134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027434825897216797, "StateBufferConnector_ms": 0.0018095970153808594, "ViewRequirementAgentConnector_ms": 0.04809117317199707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 519480, "num_agent_steps_trained": 519480, "num_env_steps_sampled": 519480, "num_env_steps_trained": 519480, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 153.02917303954857, "num_env_steps_trained_throughput_per_sec": 153.02917303954857, "timesteps_total": 519480, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 519480, "timers": {"training_iteration_time_ms": 2342.722, "sample_time_ms": 2337.061, "load_time_ms": 0.236, "load_throughput": 1526126.38, "learn_time_ms": 4.812, "learn_throughput": 74814.416, "synch_weights_time_ms": 0.576}, "counters": {"num_env_steps_sampled": 519480, "num_env_steps_trained": 519480, "num_agent_steps_sampled": 519480, "num_agent_steps_trained": 519480}, "done": false, "episodes_total": 1443, "training_iteration": 289, "trial_id": "a960d_00000", "date": "2023-07-25_16-43-37", "timestamp": 1690292617, "time_this_iter_s": 11.764456987380981, "time_total_s": 3234.9750673770905, "pid": 68464, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[134640, 0.003], [140040, 0.001], [145440, 0.00075], [150840, 0.0005], [156240, 0.00025], [161640, 0.0001], [167040, 7.5e-05], [172440, 5e-05], [177840, 2.5e-05], [183240, 1e-05], [188640, 7.5e-06], [194040, 5e-06], [199440, 2.5e-06], [204840, 1e-06], [210240, 5e-07], [215640, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f23a310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2395.0958154201508, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 34.4, "ram_util_percent": 79.77058823529413}}
