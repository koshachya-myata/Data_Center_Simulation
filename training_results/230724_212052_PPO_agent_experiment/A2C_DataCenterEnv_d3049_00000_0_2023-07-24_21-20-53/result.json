{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00048, "entropy_coeff": 0.1, "policy_entropy": 282.9615783691406, "policy_loss": -252924.46875, "vf_loss": 26317782.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 600, "num_env_steps_trained": 600, "num_agent_steps_sampled": 600, "num_agent_steps_trained": 600}, "sampler_results": {"episode_reward_max": -1172.4608305374131, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1441.6909503613938, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387], "episode_lengths": [120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.055814879507869, "mean_inference_ms": 0.27988833714642264, "mean_action_processing_ms": 0.06508787539159994, "mean_env_wait_ms": 4.841810454941431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00301361083984375, "StateBufferConnector_ms": 0.00186920166015625, "ViewRequirementAgentConnector_ms": 0.048236846923828125}}, "episode_reward_max": -1172.4608305374131, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1441.6909503613938, "episode_len_mean": 120.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387], "episode_lengths": [120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.055814879507869, "mean_inference_ms": 0.27988833714642264, "mean_action_processing_ms": 0.06508787539159994, "mean_env_wait_ms": 4.841810454941431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00301361083984375, "StateBufferConnector_ms": 0.00186920166015625, "ViewRequirementAgentConnector_ms": 0.048236846923828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600, "num_agent_steps_trained": 600, "num_env_steps_sampled": 600, "num_env_steps_trained": 600, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 600, "num_env_steps_sampled_throughput_per_sec": 54.51472887105155, "num_env_steps_trained_throughput_per_sec": 54.51472887105155, "timesteps_total": 600, "num_steps_trained_this_iter": 600, "agent_timesteps_total": 600, "timers": {"training_iteration_time_ms": 2201.23, "sample_time_ms": 2196.799, "load_time_ms": 0.191, "load_throughput": 628046.519, "learn_time_ms": 3.671, "learn_throughput": 32687.558, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 600, "num_env_steps_trained": 600, "num_agent_steps_sampled": 600, "num_agent_steps_trained": 600}, "done": false, "episodes_total": 5, "training_iteration": 1, "trial_id": "d3049_00000", "date": "2023-07-24_21-21-08", "timestamp": 1690222868, "time_this_iter_s": 11.008095979690552, "time_total_s": 11.008095979690552, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.008095979690552, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.556250000000006, "ram_util_percent": 78.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00045, "entropy_coeff": 0.1, "policy_entropy": 288.026123046875, "policy_loss": -203978.09375, "vf_loss": 15940637.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 1320, "num_env_steps_trained": 1320, "num_agent_steps_sampled": 1320, "num_agent_steps_trained": 1320}, "sampler_results": {"episode_reward_max": -1122.024322025968, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1416.4640647804697, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041167594596574, "mean_inference_ms": 0.27651663057175735, "mean_action_processing_ms": 0.06435221170680717, "mean_env_wait_ms": 3.939421649781018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030907717618075285, "StateBufferConnector_ms": 0.0019962137395685368, "ViewRequirementAgentConnector_ms": 0.04915974356911399}}, "episode_reward_max": -1122.024322025968, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1416.4640647804697, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041167594596574, "mean_inference_ms": 0.27651663057175735, "mean_action_processing_ms": 0.06435221170680717, "mean_env_wait_ms": 3.939421649781018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030907717618075285, "StateBufferConnector_ms": 0.0019962137395685368, "ViewRequirementAgentConnector_ms": 0.04915974356911399}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320, "num_agent_steps_trained": 1320, "num_env_steps_sampled": 1320, "num_env_steps_trained": 1320, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.79006128549413, "num_env_steps_trained_throughput_per_sec": 65.79006128549413, "timesteps_total": 1320, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 1320, "timers": {"training_iteration_time_ms": 1828.01, "sample_time_ms": 1825.379, "load_time_ms": 0.146, "load_throughput": 820803.131, "learn_time_ms": 1.93, "learn_throughput": 62184.667, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 1320, "num_env_steps_trained": 1320, "num_agent_steps_sampled": 1320, "num_agent_steps_trained": 1320}, "done": false, "episodes_total": 11, "training_iteration": 2, "trial_id": "d3049_00000", "date": "2023-07-24_21-21-19", "timestamp": 1690222879, "time_this_iter_s": 10.945827960968018, "time_total_s": 21.95392394065857, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 21.95392394065857, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.4375, "ram_util_percent": 78.54375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00042, "entropy_coeff": 0.1, "policy_entropy": 283.48944091796875, "policy_loss": -147809.71875, "vf_loss": 9008338.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 2040, "num_env_steps_trained": 2040, "num_agent_steps_sampled": 2040, "num_agent_steps_trained": 2040}, "sampler_results": {"episode_reward_max": -1053.8013345353393, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1354.2124421606256, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.043438911750812, "mean_inference_ms": 0.2741204936911977, "mean_action_processing_ms": 0.06389886526573568, "mean_env_wait_ms": 3.492492653012613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028862672693589155, "StateBufferConnector_ms": 0.0019185683306525735, "ViewRequirementAgentConnector_ms": 0.04804835600011489}}, "episode_reward_max": -1053.8013345353393, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1354.2124421606256, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.043438911750812, "mean_inference_ms": 0.2741204936911977, "mean_action_processing_ms": 0.06389886526573568, "mean_env_wait_ms": 3.492492653012613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028862672693589155, "StateBufferConnector_ms": 0.0019185683306525735, "ViewRequirementAgentConnector_ms": 0.04804835600011489}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040, "num_agent_steps_trained": 2040, "num_env_steps_sampled": 2040, "num_env_steps_trained": 2040, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.79305122376232, "num_env_steps_trained_throughput_per_sec": 65.79305122376232, "timesteps_total": 2040, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 2040, "timers": {"training_iteration_time_ms": 1827.603, "sample_time_ms": 1824.853, "load_time_ms": 0.145, "load_throughput": 828913.834, "learn_time_ms": 1.914, "learn_throughput": 62696.689, "synch_weights_time_ms": 0.662}, "counters": {"num_env_steps_sampled": 2040, "num_env_steps_trained": 2040, "num_agent_steps_sampled": 2040, "num_agent_steps_trained": 2040}, "done": false, "episodes_total": 17, "training_iteration": 3, "trial_id": "d3049_00000", "date": "2023-07-24_21-21-30", "timestamp": 1690222890, "time_this_iter_s": 10.945276975631714, "time_total_s": 32.89920091629028, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 32.89920091629028, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.720000000000002, "ram_util_percent": 77.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00039, "entropy_coeff": 0.1, "policy_entropy": 282.91180419921875, "policy_loss": -145393.9375, "vf_loss": 8497470.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 2760, "num_env_steps_trained": 2760, "num_agent_steps_sampled": 2760, "num_agent_steps_trained": 2760}, "sampler_results": {"episode_reward_max": -791.603221341987, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1235.3528314483124, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.043873009086116, "mean_inference_ms": 0.27286501290310217, "mean_action_processing_ms": 0.06361477897487532, "mean_env_wait_ms": 3.215510596413174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002809192823327106, "StateBufferConnector_ms": 0.0019353369007939878, "ViewRequirementAgentConnector_ms": 0.04796463510264521}}, "episode_reward_max": -791.603221341987, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1235.3528314483124, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.043873009086116, "mean_inference_ms": 0.27286501290310217, "mean_action_processing_ms": 0.06361477897487532, "mean_env_wait_ms": 3.215510596413174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002809192823327106, "StateBufferConnector_ms": 0.0019353369007939878, "ViewRequirementAgentConnector_ms": 0.04796463510264521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760, "num_agent_steps_trained": 2760, "num_env_steps_sampled": 2760, "num_env_steps_trained": 2760, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.93487451147062, "num_env_steps_trained_throughput_per_sec": 65.93487451147062, "timesteps_total": 2760, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 2760, "timers": {"training_iteration_time_ms": 1820.748, "sample_time_ms": 1818.188, "load_time_ms": 0.144, "load_throughput": 832065.598, "learn_time_ms": 1.868, "learn_throughput": 64241.14, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 2760, "num_env_steps_trained": 2760, "num_agent_steps_sampled": 2760, "num_agent_steps_trained": 2760}, "done": false, "episodes_total": 23, "training_iteration": 4, "trial_id": "d3049_00000", "date": "2023-07-24_21-21-41", "timestamp": 1690222901, "time_this_iter_s": 10.92167615890503, "time_total_s": 43.82087707519531, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 43.82087707519531, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.1625, "ram_util_percent": 78.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00035999999999999997, "entropy_coeff": 0.1, "policy_entropy": 289.6344299316406, "policy_loss": -170972.5, "vf_loss": 11074705.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 3480, "num_env_steps_trained": 3480, "num_agent_steps_sampled": 3480, "num_agent_steps_trained": 3480}, "sampler_results": {"episode_reward_max": -791.603221341987, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1190.322083025703, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.04426162210844, "mean_inference_ms": 0.2717253288468052, "mean_action_processing_ms": 0.06335809985073212, "mean_env_wait_ms": 3.0252129265509744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002909528798070447, "StateBufferConnector_ms": 0.0019196806282832705, "ViewRequirementAgentConnector_ms": 0.04780374724289466}}, "episode_reward_max": -791.603221341987, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1190.322083025703, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.04426162210844, "mean_inference_ms": 0.2717253288468052, "mean_action_processing_ms": 0.06335809985073212, "mean_env_wait_ms": 3.0252129265509744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002909528798070447, "StateBufferConnector_ms": 0.0019196806282832705, "ViewRequirementAgentConnector_ms": 0.04780374724289466}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480, "num_agent_steps_trained": 3480, "num_env_steps_sampled": 3480, "num_env_steps_trained": 3480, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.7817192754341, "num_env_steps_trained_throughput_per_sec": 65.7817192754341, "timesteps_total": 3480, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 3480, "timers": {"training_iteration_time_ms": 1818.123, "sample_time_ms": 1815.492, "load_time_ms": 0.145, "load_throughput": 827959.335, "learn_time_ms": 1.929, "learn_throughput": 62197.731, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 3480, "num_env_steps_trained": 3480, "num_agent_steps_sampled": 3480, "num_agent_steps_trained": 3480}, "done": false, "episodes_total": 29, "training_iteration": 5, "trial_id": "d3049_00000", "date": "2023-07-24_21-21-52", "timestamp": 1690222912, "time_this_iter_s": 10.949366092681885, "time_total_s": 54.7702431678772, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.7702431678772, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.933333333333337, "ram_util_percent": 78.00666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00033, "entropy_coeff": 0.1, "policy_entropy": 292.96527099609375, "policy_loss": -90997.484375, "vf_loss": 3641113.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200}, "sampler_results": {"episode_reward_max": -729.4711584044984, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1130.4732278527279, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.047380833401789, "mean_inference_ms": 0.2707539707411491, "mean_action_processing_ms": 0.06315316806623192, "mean_env_wait_ms": 2.885623766558054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002914156232561384, "StateBufferConnector_ms": 0.0019025802612304688, "ViewRequirementAgentConnector_ms": 0.048473903111049106}}, "episode_reward_max": -729.4711584044984, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1130.4732278527279, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.047380833401789, "mean_inference_ms": 0.2707539707411491, "mean_action_processing_ms": 0.06315316806623192, "mean_env_wait_ms": 2.885623766558054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002914156232561384, "StateBufferConnector_ms": 0.0019025802612304688, "ViewRequirementAgentConnector_ms": 0.048473903111049106}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200, "num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.2737067883859, "num_env_steps_trained_throughput_per_sec": 65.2737067883859, "timesteps_total": 4200, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 4200, "timers": {"training_iteration_time_ms": 1834.554, "sample_time_ms": 1831.93, "load_time_ms": 0.147, "load_throughput": 813901.164, "learn_time_ms": 1.916, "learn_throughput": 62629.595, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200}, "done": false, "episodes_total": 35, "training_iteration": 6, "trial_id": "d3049_00000", "date": "2023-07-24_21-22-03", "timestamp": 1690222923, "time_this_iter_s": 11.032372236251831, "time_total_s": 65.80261540412903, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 65.80261540412903, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.09375, "ram_util_percent": 78.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00030000000000000003, "entropy_coeff": 0.1, "policy_entropy": 308.2238464355469, "policy_loss": -141807.1875, "vf_loss": 6842427.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 4920, "num_env_steps_trained": 4920, "num_agent_steps_sampled": 4920, "num_agent_steps_trained": 4920}, "sampler_results": {"episode_reward_max": -729.4711584044984, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1091.12654916959, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.048173529316717, "mean_inference_ms": 0.2699428530597779, "mean_action_processing_ms": 0.0629768002340297, "mean_env_wait_ms": 2.7776435224685465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028732346325385863, "StateBufferConnector_ms": 0.0018829252661728278, "ViewRequirementAgentConnector_ms": 0.04816462353962224}}, "episode_reward_max": -729.4711584044984, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1091.12654916959, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.048173529316717, "mean_inference_ms": 0.2699428530597779, "mean_action_processing_ms": 0.0629768002340297, "mean_env_wait_ms": 2.7776435224685465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028732346325385863, "StateBufferConnector_ms": 0.0018829252661728278, "ViewRequirementAgentConnector_ms": 0.04816462353962224}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920, "num_agent_steps_trained": 4920, "num_env_steps_sampled": 4920, "num_env_steps_trained": 4920, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.89327942413455, "num_env_steps_trained_throughput_per_sec": 65.89327942413455, "timesteps_total": 4920, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 4920, "timers": {"training_iteration_time_ms": 1825.091, "sample_time_ms": 1821.212, "load_time_ms": 0.15, "load_throughput": 802481.633, "learn_time_ms": 1.881, "learn_throughput": 63780.379, "synch_weights_time_ms": 1.818}, "counters": {"num_env_steps_sampled": 4920, "num_env_steps_trained": 4920, "num_agent_steps_sampled": 4920, "num_agent_steps_trained": 4920}, "done": false, "episodes_total": 41, "training_iteration": 7, "trial_id": "d3049_00000", "date": "2023-07-24_21-22-14", "timestamp": 1690222934, "time_this_iter_s": 10.931311130523682, "time_total_s": 76.73392653465271, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 76.73392653465271, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.6, "ram_util_percent": 78.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00027, "entropy_coeff": 0.1, "policy_entropy": 324.0232849121094, "policy_loss": -145115.21875, "vf_loss": 6083947.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 5640, "num_env_steps_trained": 5640, "num_agent_steps_sampled": 5640, "num_agent_steps_trained": 5640}, "sampler_results": {"episode_reward_max": -678.0141823164032, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1056.44036584276, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.047490362370809, "mean_inference_ms": 0.2695209383542318, "mean_action_processing_ms": 0.0628674998361353, "mean_env_wait_ms": 2.691719954523195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002892473910717254, "StateBufferConnector_ms": 0.0018784340391767786, "ViewRequirementAgentConnector_ms": 0.04825896405159159}}, "episode_reward_max": -678.0141823164032, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1056.44036584276, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.047490362370809, "mean_inference_ms": 0.2695209383542318, "mean_action_processing_ms": 0.0628674998361353, "mean_env_wait_ms": 2.691719954523195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002892473910717254, "StateBufferConnector_ms": 0.0018784340391767786, "ViewRequirementAgentConnector_ms": 0.04825896405159159}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640, "num_agent_steps_trained": 5640, "num_env_steps_sampled": 5640, "num_env_steps_trained": 5640, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.87777958184228, "num_env_steps_trained_throughput_per_sec": 65.87777958184228, "timesteps_total": 5640, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 5640, "timers": {"training_iteration_time_ms": 1821.227, "sample_time_ms": 1817.294, "load_time_ms": 0.152, "load_throughput": 790259.821, "learn_time_ms": 1.936, "learn_throughput": 61977.156, "synch_weights_time_ms": 1.815}, "counters": {"num_env_steps_sampled": 5640, "num_env_steps_trained": 5640, "num_agent_steps_sampled": 5640, "num_agent_steps_trained": 5640}, "done": false, "episodes_total": 47, "training_iteration": 8, "trial_id": "d3049_00000", "date": "2023-07-24_21-22-25", "timestamp": 1690222945, "time_this_iter_s": 10.931230068206787, "time_total_s": 87.6651566028595, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 87.6651566028595, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.68, "ram_util_percent": 78.31333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000244, "entropy_coeff": 0.1, "policy_entropy": 328.2945861816406, "policy_loss": -151038.484375, "vf_loss": 7178071.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 6360, "num_env_steps_trained": 6360, "num_agent_steps_sampled": 6360, "num_agent_steps_trained": 6360}, "sampler_results": {"episode_reward_max": -678.0141823164032, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1030.3345730828617, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.046977176798588, "mean_inference_ms": 0.26950699979975673, "mean_action_processing_ms": 0.06283495530961472, "mean_env_wait_ms": 2.6221308832503816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002960438998240345, "StateBufferConnector_ms": 0.001889354777785967, "ViewRequirementAgentConnector_ms": 0.048792137289946934}}, "episode_reward_max": -678.0141823164032, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1030.3345730828617, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.046977176798588, "mean_inference_ms": 0.26950699979975673, "mean_action_processing_ms": 0.06283495530961472, "mean_env_wait_ms": 2.6221308832503816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002960438998240345, "StateBufferConnector_ms": 0.001889354777785967, "ViewRequirementAgentConnector_ms": 0.048792137289946934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6360, "num_agent_steps_trained": 6360, "num_env_steps_sampled": 6360, "num_env_steps_trained": 6360, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.27628171082586, "num_env_steps_trained_throughput_per_sec": 65.27628171082586, "timesteps_total": 6360, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 6360, "timers": {"training_iteration_time_ms": 1825.055, "sample_time_ms": 1822.377, "load_time_ms": 0.152, "load_throughput": 787909.33, "learn_time_ms": 1.973, "learn_throughput": 60825.214, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 6360, "num_env_steps_trained": 6360, "num_agent_steps_sampled": 6360, "num_agent_steps_trained": 6360}, "done": false, "episodes_total": 53, "training_iteration": 9, "trial_id": "d3049_00000", "date": "2023-07-24_21-22-36", "timestamp": 1690222956, "time_this_iter_s": 11.03196907043457, "time_total_s": 98.69712567329407, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 98.69712567329407, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.831249999999997, "ram_util_percent": 78.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000226, "entropy_coeff": 0.1, "policy_entropy": 335.12286376953125, "policy_loss": -152961.25, "vf_loss": 6065605.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 7080, "num_env_steps_trained": 7080, "num_agent_steps_sampled": 7080, "num_agent_steps_trained": 7080}, "sampler_results": {"episode_reward_max": -604.7311953682939, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1008.3040739362303, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.046047013411394, "mean_inference_ms": 0.2694498999087263, "mean_action_processing_ms": 0.06279700686999444, "mean_env_wait_ms": 2.5638078735067653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002909918962898901, "StateBufferConnector_ms": 0.001878253484176377, "ViewRequirementAgentConnector_ms": 0.04846160694704217}}, "episode_reward_max": -604.7311953682939, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -1008.3040739362303, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.046047013411394, "mean_inference_ms": 0.2694498999087263, "mean_action_processing_ms": 0.06279700686999444, "mean_env_wait_ms": 2.5638078735067653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002909918962898901, "StateBufferConnector_ms": 0.001878253484176377, "ViewRequirementAgentConnector_ms": 0.04846160694704217}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7080, "num_agent_steps_trained": 7080, "num_env_steps_sampled": 7080, "num_env_steps_trained": 7080, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.91283748093565, "num_env_steps_trained_throughput_per_sec": 65.91283748093565, "timesteps_total": 7080, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 7080, "timers": {"training_iteration_time_ms": 1818.074, "sample_time_ms": 1815.489, "load_time_ms": 0.147, "load_throughput": 816674.477, "learn_time_ms": 1.894, "learn_throughput": 63366.043, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 7080, "num_env_steps_trained": 7080, "num_agent_steps_sampled": 7080, "num_agent_steps_trained": 7080}, "done": false, "episodes_total": 59, "training_iteration": 10, "trial_id": "d3049_00000", "date": "2023-07-24_21-22-47", "timestamp": 1690222967, "time_this_iter_s": 10.925650835037231, "time_total_s": 109.6227765083313, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 109.6227765083313, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.90625, "ram_util_percent": 78.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000208, "entropy_coeff": 0.1, "policy_entropy": 338.563720703125, "policy_loss": -103315.65625, "vf_loss": 3110666.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 7800, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 7800, "num_agent_steps_trained": 7800}, "sampler_results": {"episode_reward_max": -604.7311953682939, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -983.4200386169894, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.045013436228817, "mean_inference_ms": 0.2694721996545224, "mean_action_processing_ms": 0.06276845295328322, "mean_env_wait_ms": 2.5144867994639073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029083398672250602, "StateBufferConnector_ms": 0.0018659004798302283, "ViewRequirementAgentConnector_ms": 0.048261055579552285}}, "episode_reward_max": -604.7311953682939, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -983.4200386169894, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.045013436228817, "mean_inference_ms": 0.2694721996545224, "mean_action_processing_ms": 0.06276845295328322, "mean_env_wait_ms": 2.5144867994639073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029083398672250602, "StateBufferConnector_ms": 0.0018659004798302283, "ViewRequirementAgentConnector_ms": 0.048261055579552285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7800, "num_agent_steps_trained": 7800, "num_env_steps_sampled": 7800, "num_env_steps_trained": 7800, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.60924514752874, "num_env_steps_trained_throughput_per_sec": 65.60924514752874, "timesteps_total": 7800, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 7800, "timers": {"training_iteration_time_ms": 1827.459, "sample_time_ms": 1824.848, "load_time_ms": 0.15, "load_throughput": 799803.718, "learn_time_ms": 1.91, "learn_throughput": 62812.49, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 7800, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 7800, "num_agent_steps_trained": 7800}, "done": false, "episodes_total": 65, "training_iteration": 11, "trial_id": "d3049_00000", "date": "2023-07-24_21-22-58", "timestamp": 1690222978, "time_this_iter_s": 10.976157903671265, "time_total_s": 120.59893441200256, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 120.59893441200256, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.459999999999997, "ram_util_percent": 78.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00019, "entropy_coeff": 0.1, "policy_entropy": 340.5490417480469, "policy_loss": -128806.078125, "vf_loss": 4551930.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 8520, "num_env_steps_trained": 8520, "num_agent_steps_sampled": 8520, "num_agent_steps_trained": 8520}, "sampler_results": {"episode_reward_max": -604.7311953682939, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -959.4802758950743, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.043677327867448, "mean_inference_ms": 0.2696079017024835, "mean_action_processing_ms": 0.06275528154767884, "mean_env_wait_ms": 2.4720391937757933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029231461001114106, "StateBufferConnector_ms": 0.0018559711080201914, "ViewRequirementAgentConnector_ms": 0.04807525957134408}}, "episode_reward_max": -604.7311953682939, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -959.4802758950743, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.043677327867448, "mean_inference_ms": 0.2696079017024835, "mean_action_processing_ms": 0.06275528154767884, "mean_env_wait_ms": 2.4720391937757933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029231461001114106, "StateBufferConnector_ms": 0.0018559711080201914, "ViewRequirementAgentConnector_ms": 0.04807525957134408}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8520, "num_agent_steps_trained": 8520, "num_env_steps_sampled": 8520, "num_env_steps_trained": 8520, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.79534187805235, "num_env_steps_trained_throughput_per_sec": 65.79534187805235, "timesteps_total": 8520, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 8520, "timers": {"training_iteration_time_ms": 1823.667, "sample_time_ms": 1821.02, "load_time_ms": 0.149, "load_throughput": 803250.048, "learn_time_ms": 1.946, "learn_throughput": 61669.605, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 8520, "num_env_steps_trained": 8520, "num_agent_steps_sampled": 8520, "num_agent_steps_trained": 8520}, "done": false, "episodes_total": 71, "training_iteration": 12, "trial_id": "d3049_00000", "date": "2023-07-24_21-23-08", "timestamp": 1690222988, "time_this_iter_s": 10.94498085975647, "time_total_s": 131.54391527175903, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 131.54391527175903, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.393750000000004, "ram_util_percent": 78.60625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000172, "entropy_coeff": 0.1, "policy_entropy": 339.27886962890625, "policy_loss": -106529.3515625, "vf_loss": 3241811.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 9240, "num_env_steps_trained": 9240, "num_agent_steps_sampled": 9240, "num_agent_steps_trained": 9240}, "sampler_results": {"episode_reward_max": -513.9779087637024, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -935.8327114213832, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.042830386989325, "mean_inference_ms": 0.2696697504905038, "mean_action_processing_ms": 0.06273569364392897, "mean_env_wait_ms": 2.4344746666898276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029152089899236507, "StateBufferConnector_ms": 0.0018674057799500305, "ViewRequirementAgentConnector_ms": 0.0483698659128957}}, "episode_reward_max": -513.9779087637024, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -935.8327114213832, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.042830386989325, "mean_inference_ms": 0.2696697504905038, "mean_action_processing_ms": 0.06273569364392897, "mean_env_wait_ms": 2.4344746666898276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029152089899236507, "StateBufferConnector_ms": 0.0018674057799500305, "ViewRequirementAgentConnector_ms": 0.0483698659128957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9240, "num_agent_steps_trained": 9240, "num_env_steps_sampled": 9240, "num_env_steps_trained": 9240, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.86890958831731, "num_env_steps_trained_throughput_per_sec": 65.86890958831731, "timesteps_total": 9240, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 9240, "timers": {"training_iteration_time_ms": 1820.305, "sample_time_ms": 1817.632, "load_time_ms": 0.147, "load_throughput": 818933.42, "learn_time_ms": 1.959, "learn_throughput": 61250.089, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 9240, "num_env_steps_trained": 9240, "num_agent_steps_sampled": 9240, "num_agent_steps_trained": 9240}, "done": false, "episodes_total": 77, "training_iteration": 13, "trial_id": "d3049_00000", "date": "2023-07-24_21-23-19", "timestamp": 1690222999, "time_this_iter_s": 10.932682514190674, "time_total_s": 142.4765977859497, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 142.4765977859497, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.753333333333334, "ram_util_percent": 78.41333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000154, "entropy_coeff": 0.1, "policy_entropy": 333.8098449707031, "policy_loss": -85812.328125, "vf_loss": 2148147.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -900.0854657017716, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.042084637390223, "mean_inference_ms": 0.2697183375751836, "mean_action_processing_ms": 0.06271651455834633, "mean_env_wait_ms": 2.4008697005564157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029515071087572948, "StateBufferConnector_ms": 0.00186483544039439, "ViewRequirementAgentConnector_ms": 0.04819128886762872}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -900.0854657017716, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.042084637390223, "mean_inference_ms": 0.2697183375751836, "mean_action_processing_ms": 0.06271651455834633, "mean_env_wait_ms": 2.4008697005564157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029515071087572948, "StateBufferConnector_ms": 0.00186483544039439, "ViewRequirementAgentConnector_ms": 0.04819128886762872}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960, "num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.12210907250893, "num_env_steps_trained_throughput_per_sec": 66.12210907250893, "timesteps_total": 9960, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 9960, "timers": {"training_iteration_time_ms": 1819.678, "sample_time_ms": 1817.045, "load_time_ms": 0.15, "load_throughput": 800185.183, "learn_time_ms": 1.91, "learn_throughput": 62836.015, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960}, "done": false, "episodes_total": 83, "training_iteration": 14, "trial_id": "d3049_00000", "date": "2023-07-24_21-23-30", "timestamp": 1690223010, "time_this_iter_s": 10.89101505279541, "time_total_s": 153.36761283874512, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 153.36761283874512, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.175, "ram_util_percent": 78.45625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000136, "entropy_coeff": 0.1, "policy_entropy": 333.6747131347656, "policy_loss": -71640.6640625, "vf_loss": 1575677.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}}, "num_env_steps_sampled": 10680, "num_env_steps_trained": 10680, "num_agent_steps_sampled": 10680, "num_agent_steps_trained": 10680}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -871.4562153787984, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041159406232293, "mean_inference_ms": 0.2697813809405181, "mean_action_processing_ms": 0.06269878791426228, "mean_env_wait_ms": 2.3706632702980306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002945942825145936, "StateBufferConnector_ms": 0.0018642189797390713, "ViewRequirementAgentConnector_ms": 0.048103761137201544}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -871.4562153787984, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041159406232293, "mean_inference_ms": 0.2697813809405181, "mean_action_processing_ms": 0.06269878791426228, "mean_env_wait_ms": 2.3706632702980306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002945942825145936, "StateBufferConnector_ms": 0.0018642189797390713, "ViewRequirementAgentConnector_ms": 0.048103761137201544}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10680, "num_agent_steps_trained": 10680, "num_env_steps_sampled": 10680, "num_env_steps_trained": 10680, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.30151196220318, "num_env_steps_trained_throughput_per_sec": 66.30151196220318, "timesteps_total": 10680, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 10680, "timers": {"training_iteration_time_ms": 1812.772, "sample_time_ms": 1810.201, "load_time_ms": 0.15, "load_throughput": 799168.752, "learn_time_ms": 1.869, "learn_throughput": 64195.255, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 10680, "num_env_steps_trained": 10680, "num_agent_steps_sampled": 10680, "num_agent_steps_trained": 10680}, "done": false, "episodes_total": 89, "training_iteration": 15, "trial_id": "d3049_00000", "date": "2023-07-24_21-23-41", "timestamp": 1690223021, "time_this_iter_s": 10.86149287223816, "time_total_s": 164.22910571098328, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 164.22910571098328, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.386666666666663, "ram_util_percent": 78.11999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000118, "entropy_coeff": 0.1, "policy_entropy": 341.62091064453125, "policy_loss": -65424.54296875, "vf_loss": 1225785.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -844.9144253582249, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.040067906679344, "mean_inference_ms": 0.26985198762998225, "mean_action_processing_ms": 0.06268500623766698, "mean_env_wait_ms": 2.3434479906559855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029194982428299753, "StateBufferConnector_ms": 0.0018564023469623766, "ViewRequirementAgentConnector_ms": 0.04801925859953228}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -844.9144253582249, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172.4608305374131, -1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.040067906679344, "mean_inference_ms": 0.26985198762998225, "mean_action_processing_ms": 0.06268500623766698, "mean_env_wait_ms": 2.3434479906559855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029194982428299753, "StateBufferConnector_ms": 0.0018564023469623766, "ViewRequirementAgentConnector_ms": 0.04801925859953228}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.23625433809902, "num_env_steps_trained_throughput_per_sec": 66.23625433809902, "timesteps_total": 11400, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 11400, "timers": {"training_iteration_time_ms": 1807.516, "sample_time_ms": 1804.949, "load_time_ms": 0.149, "load_throughput": 805822.094, "learn_time_ms": 1.873, "learn_throughput": 64057.18, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400}, "done": false, "episodes_total": 95, "training_iteration": 16, "trial_id": "d3049_00000", "date": "2023-07-24_21-23-52", "timestamp": 1690223032, "time_this_iter_s": 10.872271060943604, "time_total_s": 175.10137677192688, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 175.10137677192688, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 23.237499999999997, "ram_util_percent": 78.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0001, "entropy_coeff": 0.1, "policy_entropy": 349.159423828125, "policy_loss": -81775.09375, "vf_loss": 1884260.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 12120, "num_env_steps_trained": 12120, "num_agent_steps_sampled": 12120, "num_agent_steps_trained": 12120}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -824.948514697035, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.038432579852204, "mean_inference_ms": 0.2697847839510381, "mean_action_processing_ms": 0.06264457996698772, "mean_env_wait_ms": 2.29334857180093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002902507781982422, "StateBufferConnector_ms": 0.001852273941040039, "ViewRequirementAgentConnector_ms": 0.04801607131958008}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1830.6914864943387, "episode_reward_mean": -824.948514697035, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1253.0285081048196, -1635.568067177484, -1316.7058594929138, -1830.6914864943387, -1268.7731978772988, -1519.5707732008182, -1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.038432579852204, "mean_inference_ms": 0.2697847839510381, "mean_action_processing_ms": 0.06264457996698772, "mean_env_wait_ms": 2.29334857180093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002902507781982422, "StateBufferConnector_ms": 0.001852273941040039, "ViewRequirementAgentConnector_ms": 0.04801607131958008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12120, "num_agent_steps_trained": 12120, "num_env_steps_sampled": 12120, "num_env_steps_trained": 12120, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.89467172079479, "num_env_steps_trained_throughput_per_sec": 66.89467172079479, "timesteps_total": 12120, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 12120, "timers": {"training_iteration_time_ms": 1799.96, "sample_time_ms": 1797.393, "load_time_ms": 0.146, "load_throughput": 820134.398, "learn_time_ms": 1.864, "learn_throughput": 64365.19, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 12120, "num_env_steps_trained": 12120, "num_agent_steps_sampled": 12120, "num_agent_steps_trained": 12120}, "done": false, "episodes_total": 101, "training_iteration": 17, "trial_id": "d3049_00000", "date": "2023-07-24_21-24-03", "timestamp": 1690223043, "time_this_iter_s": 10.765213012695312, "time_total_s": 185.8665897846222, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 185.8665897846222, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 21.28666666666667, "ram_util_percent": 78.38666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.400000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 355.1755065917969, "policy_loss": -103618.7265625, "vf_loss": 2739854.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}}, "num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1693.3371879639267, "episode_reward_mean": -772.4936885550517, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.036460514191736, "mean_inference_ms": 0.2693093105194946, "mean_action_processing_ms": 0.06250580097435947, "mean_env_wait_ms": 2.1507336897264637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002910614013671875, "StateBufferConnector_ms": 0.0018448829650878906, "ViewRequirementAgentConnector_ms": 0.048157691955566406}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1693.3371879639267, "episode_reward_mean": -772.4936885550517, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1122.024322025968, -1693.3371879639267, -1330.101533126777, -1438.8429465834092, -1357.4156055984329, -1194.267876798605, -1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.036460514191736, "mean_inference_ms": 0.2693093105194946, "mean_action_processing_ms": 0.06250580097435947, "mean_env_wait_ms": 2.1507336897264637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002910614013671875, "StateBufferConnector_ms": 0.0018448829650878906, "ViewRequirementAgentConnector_ms": 0.048157691955566406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840, "num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.26858278815176, "num_env_steps_trained_throughput_per_sec": 66.26858278815176, "timesteps_total": 12840, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 12840, "timers": {"training_iteration_time_ms": 1803.902, "sample_time_ms": 1801.273, "load_time_ms": 0.146, "load_throughput": 820134.398, "learn_time_ms": 1.915, "learn_throughput": 62677.17, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840}, "done": false, "episodes_total": 107, "training_iteration": 18, "trial_id": "d3049_00000", "date": "2023-07-24_21-24-14", "timestamp": 1690223054, "time_this_iter_s": 10.866939783096313, "time_total_s": 196.7335295677185, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 196.7335295677185, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 23.92, "ram_util_percent": 78.38000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.8e-05, "entropy_coeff": 0.1, "policy_entropy": 360.8891296386719, "policy_loss": -146715.015625, "vf_loss": 5523169.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 13560, "num_env_steps_trained": 13560, "num_agent_steps_sampled": 13560, "num_agent_steps_trained": 13560}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1370.4737465973083, "episode_reward_mean": -733.1597835993547, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.035426459248443, "mean_inference_ms": 0.2691553527068343, "mean_action_processing_ms": 0.06243352561561135, "mean_env_wait_ms": 2.084042955289555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029413700103759766, "StateBufferConnector_ms": 0.0018436908721923828, "ViewRequirementAgentConnector_ms": 0.048143863677978516}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1370.4737465973083, "episode_reward_mean": -733.1597835993547, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1252.6199064894251, -1211.928334126358, -1370.4737465973083, -1053.8013345353393, -1001.6105737292177, -817.7268771410853, -842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.035426459248443, "mean_inference_ms": 0.2691553527068343, "mean_action_processing_ms": 0.06243352561561135, "mean_env_wait_ms": 2.084042955289555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029413700103759766, "StateBufferConnector_ms": 0.0018436908721923828, "ViewRequirementAgentConnector_ms": 0.048143863677978516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13560, "num_agent_steps_trained": 13560, "num_env_steps_sampled": 13560, "num_env_steps_trained": 13560, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.71580860635213, "num_env_steps_trained_throughput_per_sec": 65.71580860635213, "timesteps_total": 13560, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 13560, "timers": {"training_iteration_time_ms": 1822.378, "sample_time_ms": 1819.746, "load_time_ms": 0.148, "load_throughput": 811931.731, "learn_time_ms": 1.918, "learn_throughput": 62550.205, "synch_weights_time_ms": 0.537}, "counters": {"num_env_steps_sampled": 13560, "num_env_steps_trained": 13560, "num_agent_steps_sampled": 13560, "num_agent_steps_trained": 13560}, "done": false, "episodes_total": 113, "training_iteration": 19, "trial_id": "d3049_00000", "date": "2023-07-24_21-24-25", "timestamp": 1690223065, "time_this_iter_s": 10.958310842514038, "time_total_s": 207.69184041023254, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 207.69184041023254, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.950000000000003, "ram_util_percent": 78.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.2e-05, "entropy_coeff": 0.1, "policy_entropy": 363.76336669921875, "policy_loss": -110561.3125, "vf_loss": 3072637.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 118.0}}, "num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1180.7824457266854, "episode_reward_mean": -711.5182257631377, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.034026513525118, "mean_inference_ms": 0.2691462392833461, "mean_action_processing_ms": 0.062389460036103926, "mean_env_wait_ms": 2.042293279561245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029516220092773438, "StateBufferConnector_ms": 0.0018389225006103516, "ViewRequirementAgentConnector_ms": 0.04827117919921875}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1180.7824457266854, "episode_reward_mean": -711.5182257631377, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-842.4017745016646, -886.0779431593475, -791.603221341987, -1052.0832167072529, -916.5881805995556, -997.6038984221128, -1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.034026513525118, "mean_inference_ms": 0.2691462392833461, "mean_action_processing_ms": 0.062389460036103926, "mean_env_wait_ms": 2.042293279561245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029516220092773438, "StateBufferConnector_ms": 0.0018389225006103516, "ViewRequirementAgentConnector_ms": 0.04827117919921875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280, "num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.56811528563361, "num_env_steps_trained_throughput_per_sec": 65.56811528563361, "timesteps_total": 14280, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 14280, "timers": {"training_iteration_time_ms": 1822.836, "sample_time_ms": 1820.309, "load_time_ms": 0.146, "load_throughput": 824163.223, "learn_time_ms": 1.841, "learn_throughput": 65182.082, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280}, "done": false, "episodes_total": 119, "training_iteration": 20, "trial_id": "d3049_00000", "date": "2023-07-24_21-24-36", "timestamp": 1690223076, "time_this_iter_s": 10.982878923416138, "time_total_s": 218.67471933364868, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 218.67471933364868, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.075, "ram_util_percent": 78.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.6e-05, "entropy_coeff": 0.1, "policy_entropy": 366.83941650390625, "policy_loss": -159607.796875, "vf_loss": 5730650.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 125.0, "diff_num_grad_updates_vs_sampler_policy": 124.0}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1180.7824457266854, "episode_reward_mean": -706.3598120644374, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.032591281343805, "mean_inference_ms": 0.2691619067162558, "mean_action_processing_ms": 0.06235995565923438, "mean_env_wait_ms": 2.0123805218098556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002939939498901367, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.048159122467041016}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1180.7824457266854, "episode_reward_mean": -706.3598120644374, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1051.9810385010837, -962.2484792793582, -997.0212419054053, -1180.7824457266854, -828.144090628464, -850.8420703238216, -736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.032591281343805, "mean_inference_ms": 0.2691619067162558, "mean_action_processing_ms": 0.06235995565923438, "mean_env_wait_ms": 2.0123805218098556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002939939498901367, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.048159122467041016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.39978950122172, "num_env_steps_trained_throughput_per_sec": 66.39978950122172, "timesteps_total": 15000, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 1815.479, "sample_time_ms": 1812.821, "load_time_ms": 0.146, "load_throughput": 821338.903, "learn_time_ms": 1.922, "learn_throughput": 62442.34, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "done": false, "episodes_total": 125, "training_iteration": 21, "trial_id": "d3049_00000", "date": "2023-07-24_21-24-47", "timestamp": 1690223087, "time_this_iter_s": 10.845501899719238, "time_total_s": 229.52022123336792, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 229.52022123336792, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 24.999999999999996, "ram_util_percent": 78.43333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.000000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 370.6576843261719, "policy_loss": -175405.75, "vf_loss": 6858030.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1072.2439585931318, "episode_reward_mean": -703.1843062503051, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03038701431481, "mean_inference_ms": 0.2692785893280043, "mean_action_processing_ms": 0.06235083293652803, "mean_env_wait_ms": 1.989152969104077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029401779174804688, "StateBufferConnector_ms": 0.0018317699432373047, "ViewRequirementAgentConnector_ms": 0.04827594757080078}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1072.2439585931318, "episode_reward_mean": -703.1843062503051, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-736.513869280418, -1014.7510213434442, -887.5003571194343, -729.4711584044984, -832.9465260576769, -803.8670808207826, -901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03038701431481, "mean_inference_ms": 0.2692785893280043, "mean_action_processing_ms": 0.06235083293652803, "mean_env_wait_ms": 1.989152969104077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029401779174804688, "StateBufferConnector_ms": 0.0018317699432373047, "ViewRequirementAgentConnector_ms": 0.04827594757080078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720, "num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.69117568466085, "num_env_steps_trained_throughput_per_sec": 66.69117568466085, "timesteps_total": 15720, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 15720, "timers": {"training_iteration_time_ms": 1803.477, "sample_time_ms": 1800.849, "load_time_ms": 0.149, "load_throughput": 806855.531, "learn_time_ms": 1.91, "learn_throughput": 62827.387, "synch_weights_time_ms": 0.541}, "counters": {"num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720}, "done": false, "episodes_total": 131, "training_iteration": 22, "trial_id": "d3049_00000", "date": "2023-07-24_21-24-57", "timestamp": 1690223097, "time_this_iter_s": 10.798136949539185, "time_total_s": 240.3183581829071, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 240.3183581829071, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 23.926666666666666, "ram_util_percent": 78.41333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.400000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 371.99658203125, "policy_loss": -169545.65625, "vf_loss": 5849493.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 137.0, "diff_num_grad_updates_vs_sampler_policy": 136.0}}, "num_env_steps_sampled": 16440, "num_env_steps_trained": 16440, "num_agent_steps_sampled": 16440, "num_agent_steps_trained": 16440}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1072.2439585931318, "episode_reward_mean": -707.51952297049, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.027634424243729, "mean_inference_ms": 0.26944324288991217, "mean_action_processing_ms": 0.062351366528922744, "mean_env_wait_ms": 1.970163704476864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029463768005371094, "StateBufferConnector_ms": 0.0018374919891357422, "ViewRequirementAgentConnector_ms": 0.048439979553222656}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1072.2439585931318, "episode_reward_mean": -707.51952297049, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-901.3208565121251, -819.94858212608, -846.2543767936327, -965.2881187974174, -812.5401816018287, -678.0141823164032, -813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.027634424243729, "mean_inference_ms": 0.26944324288991217, "mean_action_processing_ms": 0.062351366528922744, "mean_env_wait_ms": 1.970163704476864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029463768005371094, "StateBufferConnector_ms": 0.0018374919891357422, "ViewRequirementAgentConnector_ms": 0.048439979553222656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16440, "num_agent_steps_trained": 16440, "num_env_steps_sampled": 16440, "num_env_steps_trained": 16440, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.29232231493165, "num_env_steps_trained_throughput_per_sec": 66.29232231493165, "timesteps_total": 16440, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 16440, "timers": {"training_iteration_time_ms": 1804.929, "sample_time_ms": 1802.378, "load_time_ms": 0.148, "load_throughput": 811408.157, "learn_time_ms": 1.856, "learn_throughput": 64637.97, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 16440, "num_env_steps_trained": 16440, "num_agent_steps_sampled": 16440, "num_agent_steps_trained": 16440}, "done": false, "episodes_total": 137, "training_iteration": 23, "trial_id": "d3049_00000", "date": "2023-07-24_21-25-08", "timestamp": 1690223108, "time_this_iter_s": 10.862879991531372, "time_total_s": 251.18123817443848, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 251.18123817443848, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.775000000000002, "ram_util_percent": 78.48125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.800000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 370.07147216796875, "policy_loss": -184200.828125, "vf_loss": 8030189.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1072.2439585931318, "episode_reward_mean": -710.0695806264389, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02514910393163, "mean_inference_ms": 0.2696161177931677, "mean_action_processing_ms": 0.06235673314478169, "mean_env_wait_ms": 1.95418998490436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002918720245361328, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.04826688766479492}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1072.2439585931318, "episode_reward_mean": -710.0695806264389, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-813.1067445204518, -915.6244314879735, -793.6078625897555, -903.6152761401161, -726.7250422723899, -820.9991132210346, -865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02514910393163, "mean_inference_ms": 0.2696161177931677, "mean_action_processing_ms": 0.06235673314478169, "mean_env_wait_ms": 1.95418998490436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002918720245361328, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.04826688766479492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160, "num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.67979286884754, "num_env_steps_trained_throughput_per_sec": 66.67979286884754, "timesteps_total": 17160, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 17160, "timers": {"training_iteration_time_ms": 1801.771, "sample_time_ms": 1799.193, "load_time_ms": 0.151, "load_throughput": 797017.387, "learn_time_ms": 1.882, "learn_throughput": 63774.722, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160}, "done": false, "episodes_total": 143, "training_iteration": 24, "trial_id": "d3049_00000", "date": "2023-07-24_21-25-19", "timestamp": 1690223119, "time_this_iter_s": 10.799998998641968, "time_total_s": 261.98123717308044, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 261.98123717308044, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.64666666666667, "ram_util_percent": 78.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.2000000000000004e-05, "entropy_coeff": 0.1, "policy_entropy": 368.94366455078125, "policy_loss": -121921.6640625, "vf_loss": 3922979.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 149.0, "diff_num_grad_updates_vs_sampler_policy": 148.0}}, "num_env_steps_sampled": 17880, "num_env_steps_trained": 17880, "num_agent_steps_sampled": 17880, "num_agent_steps_trained": 17880}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1102.656080993699, "episode_reward_mean": -714.6515905178329, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.022803036074379, "mean_inference_ms": 0.2696712425496168, "mean_action_processing_ms": 0.0623455708942461, "mean_env_wait_ms": 1.9401784700521454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028846263885498047, "StateBufferConnector_ms": 0.0018186569213867188, "ViewRequirementAgentConnector_ms": 0.04784226417541504}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1102.656080993699, "episode_reward_mean": -714.6515905178329, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-865.8161126293217, -737.8404036153976, -879.6078803115362, -924.0466267322664, -604.7311953682939, -817.0880069064607, -900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.022803036074379, "mean_inference_ms": 0.2696712425496168, "mean_action_processing_ms": 0.0623455708942461, "mean_env_wait_ms": 1.9401784700521454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028846263885498047, "StateBufferConnector_ms": 0.0018186569213867188, "ViewRequirementAgentConnector_ms": 0.04784226417541504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17880, "num_agent_steps_trained": 17880, "num_env_steps_sampled": 17880, "num_env_steps_trained": 17880, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.58063543202744, "num_env_steps_trained_throughput_per_sec": 66.58063543202744, "timesteps_total": 17880, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 17880, "timers": {"training_iteration_time_ms": 1803.178, "sample_time_ms": 1800.697, "load_time_ms": 0.147, "load_throughput": 818400.78, "learn_time_ms": 1.809, "learn_throughput": 66331.459, "synch_weights_time_ms": 0.497}, "counters": {"num_env_steps_sampled": 17880, "num_env_steps_trained": 17880, "num_agent_steps_sampled": 17880, "num_agent_steps_trained": 17880}, "done": false, "episodes_total": 149, "training_iteration": 25, "trial_id": "d3049_00000", "date": "2023-07-24_21-25-30", "timestamp": 1690223130, "time_this_iter_s": 10.816078901290894, "time_total_s": 272.79731607437134, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 272.79731607437134, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 22.33125, "ram_util_percent": 78.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.8e-05, "entropy_coeff": 0.1, "policy_entropy": 369.01239013671875, "policy_loss": -152590.609375, "vf_loss": 5480006.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 155.0, "diff_num_grad_updates_vs_sampler_policy": 154.0}}, "num_env_steps_sampled": 18600, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18600, "num_agent_steps_trained": 18600}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1159.3466766463278, "episode_reward_mean": -722.9510487557985, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.020491689671308, "mean_inference_ms": 0.2696070773943095, "mean_action_processing_ms": 0.06231521939692881, "mean_env_wait_ms": 1.9275039590665834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028946399688720703, "StateBufferConnector_ms": 0.001825571060180664, "ViewRequirementAgentConnector_ms": 0.04793548583984375}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1159.3466766463278, "episode_reward_mean": -722.9510487557985, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-900.3902228944557, -759.1627137955177, -957.4864514168659, -843.3493984643326, -696.2187897786231, -616.9915500017119, -979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.020491689671308, "mean_inference_ms": 0.2696070773943095, "mean_action_processing_ms": 0.06231521939692881, "mean_env_wait_ms": 1.9275039590665834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028946399688720703, "StateBufferConnector_ms": 0.001825571060180664, "ViewRequirementAgentConnector_ms": 0.04793548583984375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18600, "num_agent_steps_trained": 18600, "num_env_steps_sampled": 18600, "num_env_steps_trained": 18600, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.34906400745946, "num_env_steps_trained_throughput_per_sec": 66.34906400745946, "timesteps_total": 18600, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 18600, "timers": {"training_iteration_time_ms": 1807.69, "sample_time_ms": 1805.149, "load_time_ms": 0.151, "load_throughput": 794752.061, "learn_time_ms": 1.853, "learn_throughput": 64746.064, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 18600, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18600, "num_agent_steps_trained": 18600}, "done": false, "episodes_total": 155, "training_iteration": 26, "trial_id": "d3049_00000", "date": "2023-07-24_21-25-41", "timestamp": 1690223141, "time_this_iter_s": 10.85375714302063, "time_total_s": 283.65107321739197, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 283.65107321739197, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 22.633333333333333, "ram_util_percent": 78.62000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-05, "entropy_coeff": 0.1, "policy_entropy": 369.7436828613281, "policy_loss": -154543.953125, "vf_loss": 5469056.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 161.0, "diff_num_grad_updates_vs_sampler_policy": 160.0}}, "num_env_steps_sampled": 19320, "num_env_steps_trained": 19320, "num_agent_steps_sampled": 19320, "num_agent_steps_trained": 19320}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1159.3466766463278, "episode_reward_mean": -728.0212053654498, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.018353600576548, "mean_inference_ms": 0.269541200991529, "mean_action_processing_ms": 0.06228945210573334, "mean_env_wait_ms": 1.9160005953990922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029010772705078125, "StateBufferConnector_ms": 0.0018208026885986328, "ViewRequirementAgentConnector_ms": 0.04812002182006836}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1159.3466766463278, "episode_reward_mean": -728.0212053654498, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-979.4284282119776, -689.7116570363505, -758.1096301659542, -691.9020926721053, -678.7947982772492, -689.6965114225679, -708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.018353600576548, "mean_inference_ms": 0.269541200991529, "mean_action_processing_ms": 0.06228945210573334, "mean_env_wait_ms": 1.9160005953990922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029010772705078125, "StateBufferConnector_ms": 0.0018208026885986328, "ViewRequirementAgentConnector_ms": 0.04812002182006836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19320, "num_agent_steps_trained": 19320, "num_env_steps_sampled": 19320, "num_env_steps_trained": 19320, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.46275591851402, "num_env_steps_trained_throughput_per_sec": 66.46275591851402, "timesteps_total": 19320, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 19320, "timers": {"training_iteration_time_ms": 1806.408, "sample_time_ms": 1803.883, "load_time_ms": 0.15, "load_throughput": 802353.706, "learn_time_ms": 1.841, "learn_throughput": 65165.203, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 19320, "num_env_steps_trained": 19320, "num_agent_steps_sampled": 19320, "num_agent_steps_trained": 19320}, "done": false, "episodes_total": 161, "training_iteration": 27, "trial_id": "d3049_00000", "date": "2023-07-24_21-25-52", "timestamp": 1690223152, "time_this_iter_s": 10.835206031799316, "time_total_s": 294.4862792491913, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 294.4862792491913, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 23.50625, "ram_util_percent": 78.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.2000000000000004e-05, "entropy_coeff": 0.1, "policy_entropy": 369.6712646484375, "policy_loss": -185062.640625, "vf_loss": 8246458.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 166.0}}, "num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_agent_steps_sampled": 20040, "num_agent_steps_trained": 20040}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -741.561637554062, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.01643351627793, "mean_inference_ms": 0.269407580774142, "mean_action_processing_ms": 0.06225792043954584, "mean_env_wait_ms": 1.9051407289865716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002889394760131836, "StateBufferConnector_ms": 0.0018267631530761719, "ViewRequirementAgentConnector_ms": 0.04805755615234375}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -741.561637554062, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-708.3047633437134, -652.8462184492327, -663.9606084676318, -807.1941784855744, -750.7853241722299, -661.7543640191379, -527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.01643351627793, "mean_inference_ms": 0.269407580774142, "mean_action_processing_ms": 0.06225792043954584, "mean_env_wait_ms": 1.9051407289865716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002889394760131836, "StateBufferConnector_ms": 0.0018267631530761719, "ViewRequirementAgentConnector_ms": 0.04805755615234375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20040, "num_agent_steps_trained": 20040, "num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.63991889076568, "num_env_steps_trained_throughput_per_sec": 66.63991889076568, "timesteps_total": 20040, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 20040, "timers": {"training_iteration_time_ms": 1805.171, "sample_time_ms": 1802.647, "load_time_ms": 0.148, "load_throughput": 813375.048, "learn_time_ms": 1.836, "learn_throughput": 65364.079, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_agent_steps_sampled": 20040, "num_agent_steps_trained": 20040}, "done": false, "episodes_total": 167, "training_iteration": 28, "trial_id": "d3049_00000", "date": "2023-07-24_21-26-03", "timestamp": 1690223163, "time_this_iter_s": 10.806490659713745, "time_total_s": 305.29276990890503, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 305.29276990890503, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.633333333333333, "ram_util_percent": 78.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.9e-05, "entropy_coeff": 0.1, "policy_entropy": 369.77618408203125, "policy_loss": -192754.625, "vf_loss": 8628823.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 20760, "num_env_steps_trained": 20760, "num_agent_steps_sampled": 20760, "num_agent_steps_trained": 20760}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -759.506145975735, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.01458642608663, "mean_inference_ms": 0.2692376472832673, "mean_action_processing_ms": 0.062224298815273714, "mean_env_wait_ms": 1.8950954558475683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002886533737182617, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.04803800582885742}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -759.506145975735, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-527.9465733026432, -513.9779087637024, -807.6402389877522, -673.9147816507653, -465.25098400768195, -595.094394701428, -247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.01458642608663, "mean_inference_ms": 0.2692376472832673, "mean_action_processing_ms": 0.062224298815273714, "mean_env_wait_ms": 1.8950954558475683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002886533737182617, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.04803800582885742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20760, "num_agent_steps_trained": 20760, "num_env_steps_sampled": 20760, "num_env_steps_trained": 20760, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.49853600332574, "num_env_steps_trained_throughput_per_sec": 66.49853600332574, "timesteps_total": 20760, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 20760, "timers": {"training_iteration_time_ms": 1804.035, "sample_time_ms": 1801.483, "load_time_ms": 0.149, "load_throughput": 805822.094, "learn_time_ms": 1.858, "learn_throughput": 64578.257, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 20760, "num_env_steps_trained": 20760, "num_agent_steps_sampled": 20760, "num_agent_steps_trained": 20760}, "done": false, "episodes_total": 173, "training_iteration": 29, "trial_id": "d3049_00000", "date": "2023-07-24_21-26-13", "timestamp": 1690223173, "time_this_iter_s": 10.829826831817627, "time_total_s": 316.12259674072266, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 316.12259674072266, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.3, "ram_util_percent": 78.44666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.6e-05, "entropy_coeff": 0.1, "policy_entropy": 369.27239990234375, "policy_loss": -178223.140625, "vf_loss": 8272677.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 179.0, "diff_num_grad_updates_vs_sampler_policy": 178.0}}, "num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480}, "sampler_results": {"episode_reward_max": -247.03288305377902, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -784.4074349547976, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.01270703785131, "mean_inference_ms": 0.2690824266244568, "mean_action_processing_ms": 0.06219356939071995, "mean_env_wait_ms": 1.8859397048308029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002863168716430664, "StateBufferConnector_ms": 0.0018095970153808594, "ViewRequirementAgentConnector_ms": 0.047689199447631836}}, "episode_reward_max": -247.03288305377902, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -784.4074349547976, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-247.03288305377902, -362.4610522021326, -487.1862942300241, -490.9492656054776, -647.28186842452, -455.3367430175481, -500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.01270703785131, "mean_inference_ms": 0.2690824266244568, "mean_action_processing_ms": 0.06219356939071995, "mean_env_wait_ms": 1.8859397048308029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002863168716430664, "StateBufferConnector_ms": 0.0018095970153808594, "ViewRequirementAgentConnector_ms": 0.047689199447631836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480, "num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.36735627662269, "num_env_steps_trained_throughput_per_sec": 66.36735627662269, "timesteps_total": 21480, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 21480, "timers": {"training_iteration_time_ms": 1805.983, "sample_time_ms": 1803.333, "load_time_ms": 0.154, "load_throughput": 777082.723, "learn_time_ms": 1.914, "learn_throughput": 62682.634, "synch_weights_time_ms": 0.551}, "counters": {"num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480}, "done": false, "episodes_total": 179, "training_iteration": 30, "trial_id": "d3049_00000", "date": "2023-07-24_21-26-24", "timestamp": 1690223184, "time_this_iter_s": 10.850742816925049, "time_total_s": 326.9733395576477, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 326.9733395576477, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 24.0875, "ram_util_percent": 78.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.3e-05, "entropy_coeff": 0.1, "policy_entropy": 369.8416748046875, "policy_loss": -155468.234375, "vf_loss": 6023950.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 185.0, "diff_num_grad_updates_vs_sampler_policy": 184.0}}, "num_env_steps_sampled": 22200, "num_env_steps_trained": 22200, "num_agent_steps_sampled": 22200, "num_agent_steps_trained": 22200}, "sampler_results": {"episode_reward_max": -288.99891811488436, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -812.9038476827845, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.010902438896714, "mean_inference_ms": 0.2689019473275414, "mean_action_processing_ms": 0.062161247608711945, "mean_env_wait_ms": 1.8776485461017003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028693675994873047, "StateBufferConnector_ms": 0.0018124580383300781, "ViewRequirementAgentConnector_ms": 0.04766678810119629}}, "episode_reward_max": -288.99891811488436, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -812.9038476827845, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-500.2947727299262, -531.2818287319983, -288.99891811488436, -429.3153844471479, -425.76688146619625, -496.4472362568342, -354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.010902438896714, "mean_inference_ms": 0.2689019473275414, "mean_action_processing_ms": 0.062161247608711945, "mean_env_wait_ms": 1.8776485461017003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028693675994873047, "StateBufferConnector_ms": 0.0018124580383300781, "ViewRequirementAgentConnector_ms": 0.04766678810119629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22200, "num_agent_steps_trained": 22200, "num_env_steps_sampled": 22200, "num_env_steps_trained": 22200, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.45728868201739, "num_env_steps_trained_throughput_per_sec": 66.45728868201739, "timesteps_total": 22200, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 22200, "timers": {"training_iteration_time_ms": 1804.763, "sample_time_ms": 1802.085, "load_time_ms": 0.151, "load_throughput": 793874.574, "learn_time_ms": 1.932, "learn_throughput": 62115.598, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 22200, "num_env_steps_trained": 22200, "num_agent_steps_sampled": 22200, "num_agent_steps_trained": 22200}, "done": false, "episodes_total": 185, "training_iteration": 31, "trial_id": "d3049_00000", "date": "2023-07-24_21-26-35", "timestamp": 1690223195, "time_this_iter_s": 10.836056232452393, "time_total_s": 337.8093957901001, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 337.8093957901001, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.646666666666665, "ram_util_percent": 78.81333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3e-05, "entropy_coeff": 0.1, "policy_entropy": 369.7666931152344, "policy_loss": -185945.5625, "vf_loss": 7588758.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 22920, "num_env_steps_trained": 22920, "num_agent_steps_sampled": 22920, "num_agent_steps_trained": 22920}, "sampler_results": {"episode_reward_max": -354.74066371735, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -843.6899514514022, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00933886491683, "mean_inference_ms": 0.268695861195036, "mean_action_processing_ms": 0.0621274932502833, "mean_env_wait_ms": 1.8699537032531544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028738975524902344, "StateBufferConnector_ms": 0.0018088817596435547, "ViewRequirementAgentConnector_ms": 0.047644615173339844}}, "episode_reward_max": -354.74066371735, "episode_reward_min": -1164.7135068022105, "episode_reward_mean": -843.6899514514022, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-354.74066371735, -535.565929013557, -434.0556959026003, -460.6908339617622, -422.19026069484966, -764.2348816602749, -436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00933886491683, "mean_inference_ms": 0.268695861195036, "mean_action_processing_ms": 0.0621274932502833, "mean_env_wait_ms": 1.8699537032531544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028738975524902344, "StateBufferConnector_ms": 0.0018088817596435547, "ViewRequirementAgentConnector_ms": 0.047644615173339844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22920, "num_agent_steps_trained": 22920, "num_env_steps_sampled": 22920, "num_env_steps_trained": 22920, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.57797712842039, "num_env_steps_trained_throughput_per_sec": 66.57797712842039, "timesteps_total": 22920, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 22920, "timers": {"training_iteration_time_ms": 1799.932, "sample_time_ms": 1797.259, "load_time_ms": 0.151, "load_throughput": 795254.353, "learn_time_ms": 1.931, "learn_throughput": 62158.557, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 22920, "num_env_steps_trained": 22920, "num_agent_steps_sampled": 22920, "num_agent_steps_trained": 22920}, "done": false, "episodes_total": 191, "training_iteration": 32, "trial_id": "d3049_00000", "date": "2023-07-24_21-26-46", "timestamp": 1690223206, "time_this_iter_s": 10.816378831863403, "time_total_s": 348.6257746219635, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 348.6257746219635, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.13125, "ram_util_percent": 78.44375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.7e-05, "entropy_coeff": 0.1, "policy_entropy": 369.5425109863281, "policy_loss": -189500.9375, "vf_loss": 8542642.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 197.0, "diff_num_grad_updates_vs_sampler_policy": 196.0}}, "num_env_steps_sampled": 23640, "num_env_steps_trained": 23640, "num_agent_steps_sampled": 23640, "num_agent_steps_trained": 23640}, "sampler_results": {"episode_reward_max": -430.33538223834023, "episode_reward_min": -1188.1688433349107, "episode_reward_mean": -876.9094284225298, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00795851546854, "mean_inference_ms": 0.26847860609396285, "mean_action_processing_ms": 0.06209205914309626, "mean_env_wait_ms": 1.8627273412105152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028755664825439453, "StateBufferConnector_ms": 0.0018126964569091797, "ViewRequirementAgentConnector_ms": 0.04767036437988281}}, "episode_reward_max": -430.33538223834023, "episode_reward_min": -1188.1688433349107, "episode_reward_mean": -876.9094284225298, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-436.2792188105567, -577.4264752902408, -713.8219870428939, -486.4890677107642, -560.168677673513, -778.1046690278203, -663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00795851546854, "mean_inference_ms": 0.26847860609396285, "mean_action_processing_ms": 0.06209205914309626, "mean_env_wait_ms": 1.8627273412105152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028755664825439453, "StateBufferConnector_ms": 0.0018126964569091797, "ViewRequirementAgentConnector_ms": 0.04767036437988281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23640, "num_agent_steps_trained": 23640, "num_env_steps_sampled": 23640, "num_env_steps_trained": 23640, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 67.05270959080802, "num_env_steps_trained_throughput_per_sec": 67.05270959080802, "timesteps_total": 23640, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 23640, "timers": {"training_iteration_time_ms": 1794.162, "sample_time_ms": 1791.604, "load_time_ms": 0.152, "load_throughput": 787539.477, "learn_time_ms": 1.873, "learn_throughput": 64073.489, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 23640, "num_env_steps_trained": 23640, "num_agent_steps_sampled": 23640, "num_agent_steps_trained": 23640}, "done": false, "episodes_total": 197, "training_iteration": 33, "trial_id": "d3049_00000", "date": "2023-07-24_21-26-57", "timestamp": 1690223217, "time_this_iter_s": 10.739861011505127, "time_total_s": 359.3656356334686, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 359.3656356334686, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.57333333333333, "ram_util_percent": 78.52666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.44e-05, "entropy_coeff": 0.1, "policy_entropy": 368.9636535644531, "policy_loss": -183580.421875, "vf_loss": 8188620.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 24360, "num_env_steps_trained": 24360, "num_agent_steps_sampled": 24360, "num_agent_steps_trained": 24360}, "sampler_results": {"episode_reward_max": -430.33538223834023, "episode_reward_min": -1188.1688433349107, "episode_reward_mean": -899.6575788918054, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00691067211771, "mean_inference_ms": 0.2682981928178439, "mean_action_processing_ms": 0.06206161822340896, "mean_env_wait_ms": 1.8561119117352864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002869129180908203, "StateBufferConnector_ms": 0.0018129348754882812, "ViewRequirementAgentConnector_ms": 0.04767012596130371}}, "episode_reward_max": -430.33538223834023, "episode_reward_min": -1188.1688433349107, "episode_reward_mean": -899.6575788918054, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-663.6760285072371, -622.4238253909526, -430.33538223834023, -524.1466953114577, -729.9023362560331, -654.9046706785942, -793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00691067211771, "mean_inference_ms": 0.2682981928178439, "mean_action_processing_ms": 0.06206161822340896, "mean_env_wait_ms": 1.8561119117352864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002869129180908203, "StateBufferConnector_ms": 0.0018129348754882812, "ViewRequirementAgentConnector_ms": 0.04767012596130371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24360, "num_agent_steps_trained": 24360, "num_env_steps_sampled": 24360, "num_env_steps_trained": 24360, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.40002163569838, "num_env_steps_trained_throughput_per_sec": 66.40002163569838, "timesteps_total": 24360, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 24360, "timers": {"training_iteration_time_ms": 1798.483, "sample_time_ms": 1795.935, "load_time_ms": 0.151, "load_throughput": 795254.353, "learn_time_ms": 1.869, "learn_throughput": 64210.816, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 24360, "num_env_steps_trained": 24360, "num_agent_steps_sampled": 24360, "num_agent_steps_trained": 24360}, "done": false, "episodes_total": 203, "training_iteration": 34, "trial_id": "d3049_00000", "date": "2023-07-24_21-27-08", "timestamp": 1690223228, "time_this_iter_s": 10.845455169677734, "time_total_s": 370.21109080314636, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 370.21109080314636, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.506666666666668, "ram_util_percent": 78.40666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.26e-05, "entropy_coeff": 0.1, "policy_entropy": 368.32879638671875, "policy_loss": -122050.046875, "vf_loss": 3584743.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 209.0, "diff_num_grad_updates_vs_sampler_policy": 208.0}}, "num_env_steps_sampled": 25080, "num_env_steps_trained": 25080, "num_agent_steps_sampled": 25080, "num_agent_steps_trained": 25080}, "sampler_results": {"episode_reward_max": -556.5635658454702, "episode_reward_min": -1188.1688433349107, "episode_reward_mean": -916.4613266365781, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0056370822977, "mean_inference_ms": 0.2681530451914307, "mean_action_processing_ms": 0.06203613056881323, "mean_env_wait_ms": 1.849939603549423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028557777404785156, "StateBufferConnector_ms": 0.0018138885498046875, "ViewRequirementAgentConnector_ms": 0.047472238540649414}}, "episode_reward_max": -556.5635658454702, "episode_reward_min": -1188.1688433349107, "episode_reward_mean": -916.4613266365781, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-793.2393349779003, -556.5635658454702, -658.4240260869998, -809.565042682409, -741.1116354309337, -748.0114254226903, -823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0056370822977, "mean_inference_ms": 0.2681530451914307, "mean_action_processing_ms": 0.06203613056881323, "mean_env_wait_ms": 1.849939603549423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028557777404785156, "StateBufferConnector_ms": 0.0018138885498046875, "ViewRequirementAgentConnector_ms": 0.047472238540649414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25080, "num_agent_steps_trained": 25080, "num_env_steps_sampled": 25080, "num_env_steps_trained": 25080, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.79279308171587, "num_env_steps_trained_throughput_per_sec": 66.79279308171587, "timesteps_total": 25080, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 25080, "timers": {"training_iteration_time_ms": 1796.403, "sample_time_ms": 1793.802, "load_time_ms": 0.151, "load_throughput": 796134.894, "learn_time_ms": 1.884, "learn_throughput": 63679.51, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 25080, "num_env_steps_trained": 25080, "num_agent_steps_sampled": 25080, "num_agent_steps_trained": 25080}, "done": false, "episodes_total": 209, "training_iteration": 35, "trial_id": "d3049_00000", "date": "2023-07-24_21-27-18", "timestamp": 1690223238, "time_this_iter_s": 10.781543016433716, "time_total_s": 380.9926338195801, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 380.9926338195801, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 23.8375, "ram_util_percent": 78.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.08e-05, "entropy_coeff": 0.1, "policy_entropy": 367.68670654296875, "policy_loss": -157862.859375, "vf_loss": 6120551.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 215.0, "diff_num_grad_updates_vs_sampler_policy": 214.0}}, "num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800}, "sampler_results": {"episode_reward_max": -628.9655655424153, "episode_reward_min": -1188.1688433349107, "episode_reward_mean": -932.597890660736, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004143112417378, "mean_inference_ms": 0.268036449477051, "mean_action_processing_ms": 0.062014348860516544, "mean_env_wait_ms": 1.8440827305943193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002827882766723633, "StateBufferConnector_ms": 0.001813650131225586, "ViewRequirementAgentConnector_ms": 0.04737734794616699}}, "episode_reward_max": -628.9655655424153, "episode_reward_min": -1188.1688433349107, "episode_reward_mean": -932.597890660736, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-823.9723214180689, -812.0196024212273, -789.9244387617022, -628.9655655424153, -789.1507674064507, -643.8857841360301, -813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004143112417378, "mean_inference_ms": 0.268036449477051, "mean_action_processing_ms": 0.062014348860516544, "mean_env_wait_ms": 1.8440827305943193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002827882766723633, "StateBufferConnector_ms": 0.001813650131225586, "ViewRequirementAgentConnector_ms": 0.04737734794616699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.19831355245417, "num_env_steps_trained_throughput_per_sec": 66.19831355245417, "timesteps_total": 25800, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 25800, "timers": {"training_iteration_time_ms": 1803.893, "sample_time_ms": 1801.237, "load_time_ms": 0.151, "load_throughput": 792749.22, "learn_time_ms": 1.908, "learn_throughput": 62892.548, "synch_weights_time_ms": 0.567}, "counters": {"num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800}, "done": false, "episodes_total": 215, "training_iteration": 36, "trial_id": "d3049_00000", "date": "2023-07-24_21-27-29", "timestamp": 1690223249, "time_this_iter_s": 10.87853741645813, "time_total_s": 391.8711712360382, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 391.8711712360382, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 27.88, "ram_util_percent": 78.50666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9e-05, "entropy_coeff": 0.1, "policy_entropy": 367.77276611328125, "policy_loss": -168371.921875, "vf_loss": 7002867.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 220.0}}, "num_env_steps_sampled": 26520, "num_env_steps_trained": 26520, "num_agent_steps_sampled": 26520, "num_agent_steps_trained": 26520}, "sampler_results": {"episode_reward_max": -644.1545087121541, "episode_reward_min": -1268.2927846785105, "episode_reward_mean": -949.485644909652, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.002621973225327, "mean_inference_ms": 0.26795942920976723, "mean_action_processing_ms": 0.06199843736307217, "mean_env_wait_ms": 1.8385228066529362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028395652770996094, "StateBufferConnector_ms": 0.0018270015716552734, "ViewRequirementAgentConnector_ms": 0.04749655723571777}}, "episode_reward_max": -644.1545087121541, "episode_reward_min": -1268.2927846785105, "episode_reward_mean": -949.485644909652, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-813.1494658183401, -961.3334755391404, -883.9847825841335, -879.0125893778089, -992.427232009408, -1063.7226064598567, -934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.002621973225327, "mean_inference_ms": 0.26795942920976723, "mean_action_processing_ms": 0.06199843736307217, "mean_env_wait_ms": 1.8385228066529362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028395652770996094, "StateBufferConnector_ms": 0.0018270015716552734, "ViewRequirementAgentConnector_ms": 0.04749655723571777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26520, "num_agent_steps_trained": 26520, "num_env_steps_sampled": 26520, "num_env_steps_trained": 26520, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.96318750823339, "num_env_steps_trained_throughput_per_sec": 65.96318750823339, "timesteps_total": 26520, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 26520, "timers": {"training_iteration_time_ms": 1813.247, "sample_time_ms": 1810.614, "load_time_ms": 0.148, "load_throughput": 811669.86, "learn_time_ms": 1.888, "learn_throughput": 63570.127, "synch_weights_time_ms": 0.568}, "counters": {"num_env_steps_sampled": 26520, "num_env_steps_trained": 26520, "num_agent_steps_sampled": 26520, "num_agent_steps_trained": 26520}, "done": false, "episodes_total": 221, "training_iteration": 37, "trial_id": "d3049_00000", "date": "2023-07-24_21-27-40", "timestamp": 1690223260, "time_this_iter_s": 10.917607069015503, "time_total_s": 402.7887783050537, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 402.7887783050537, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 27.11875, "ram_util_percent": 78.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.72e-05, "entropy_coeff": 0.1, "policy_entropy": 367.8011169433594, "policy_loss": -247017.21875, "vf_loss": 13725030.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 227.0, "diff_num_grad_updates_vs_sampler_policy": 226.0}}, "num_env_steps_sampled": 27240, "num_env_steps_trained": 27240, "num_agent_steps_sampled": 27240, "num_agent_steps_trained": 27240}, "sampler_results": {"episode_reward_max": -644.1545087121541, "episode_reward_min": -1311.4473829493659, "episode_reward_mean": -958.0408696985533, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.001208133288173, "mean_inference_ms": 0.26789419609124676, "mean_action_processing_ms": 0.06198441887065601, "mean_env_wait_ms": 1.8332162703300268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028247833251953125, "StateBufferConnector_ms": 0.0018117427825927734, "ViewRequirementAgentConnector_ms": 0.04717302322387695}}, "episode_reward_max": -644.1545087121541, "episode_reward_min": -1311.4473829493659, "episode_reward_mean": -958.0408696985533, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-934.0976091454492, -757.1765391553544, -733.8008395883998, -1072.2439585931318, -897.2185737587429, -722.5133276016965, -980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.001208133288173, "mean_inference_ms": 0.26789419609124676, "mean_action_processing_ms": 0.06198441887065601, "mean_env_wait_ms": 1.8332162703300268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028247833251953125, "StateBufferConnector_ms": 0.0018117427825927734, "ViewRequirementAgentConnector_ms": 0.04717302322387695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27240, "num_agent_steps_trained": 27240, "num_env_steps_sampled": 27240, "num_env_steps_trained": 27240, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.91709151209815, "num_env_steps_trained_throughput_per_sec": 66.91709151209815, "timesteps_total": 27240, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 27240, "timers": {"training_iteration_time_ms": 1805.27, "sample_time_ms": 1802.701, "load_time_ms": 0.147, "load_throughput": 815087.417, "learn_time_ms": 1.861, "learn_throughput": 64486.416, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 27240, "num_env_steps_trained": 27240, "num_agent_steps_sampled": 27240, "num_agent_steps_trained": 27240}, "done": false, "episodes_total": 227, "training_iteration": 38, "trial_id": "d3049_00000", "date": "2023-07-24_21-27-51", "timestamp": 1690223271, "time_this_iter_s": 10.76175308227539, "time_total_s": 413.5505313873291, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 413.5505313873291, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 25.073333333333334, "ram_util_percent": 77.75333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.54e-05, "entropy_coeff": 0.1, "policy_entropy": 367.616455078125, "policy_loss": -193850.40625, "vf_loss": 9174141.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 27960, "num_env_steps_trained": 27960, "num_agent_steps_sampled": 27960, "num_agent_steps_trained": 27960}, "sampler_results": {"episode_reward_max": -644.1545087121541, "episode_reward_min": -1311.4473829493659, "episode_reward_mean": -965.053055890001, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.999847879433577, "mean_inference_ms": 0.26783752702410224, "mean_action_processing_ms": 0.06197199375941938, "mean_env_wait_ms": 1.8281221099321823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028181076049804688, "StateBufferConnector_ms": 0.0018315315246582031, "ViewRequirementAgentConnector_ms": 0.04709625244140625}}, "episode_reward_max": -644.1545087121541, "episode_reward_min": -1311.4473829493659, "episode_reward_mean": -965.053055890001, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-980.5734546467841, -934.2408384382508, -981.6465649100278, -922.3789256892145, -967.2521748103314, -861.1574592313892, -772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.999847879433577, "mean_inference_ms": 0.26783752702410224, "mean_action_processing_ms": 0.06197199375941938, "mean_env_wait_ms": 1.8281221099321823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028181076049804688, "StateBufferConnector_ms": 0.0018315315246582031, "ViewRequirementAgentConnector_ms": 0.04709625244140625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27960, "num_agent_steps_trained": 27960, "num_env_steps_sampled": 27960, "num_env_steps_trained": 27960, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 67.15450667970664, "num_env_steps_trained_throughput_per_sec": 67.15450667970664, "timesteps_total": 27960, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 27960, "timers": {"training_iteration_time_ms": 1788.435, "sample_time_ms": 1785.809, "load_time_ms": 0.153, "load_throughput": 785205.117, "learn_time_ms": 1.915, "learn_throughput": 62668.586, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 27960, "num_env_steps_trained": 27960, "num_agent_steps_sampled": 27960, "num_agent_steps_trained": 27960}, "done": false, "episodes_total": 233, "training_iteration": 39, "trial_id": "d3049_00000", "date": "2023-07-24_21-28-02", "timestamp": 1690223282, "time_this_iter_s": 10.723963022232056, "time_total_s": 424.27449440956116, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 424.27449440956116, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 23.78666666666667, "ram_util_percent": 77.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.36e-05, "entropy_coeff": 0.1, "policy_entropy": 367.7354736328125, "policy_loss": -184961.453125, "vf_loss": 8095580.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 238.0}}, "num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680}, "sampler_results": {"episode_reward_max": -644.1545087121541, "episode_reward_min": -1311.4473829493659, "episode_reward_mean": -965.8756503283308, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.998497758226268, "mean_inference_ms": 0.2677970089524888, "mean_action_processing_ms": 0.06196182756933309, "mean_env_wait_ms": 1.8232536777312465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028247833251953125, "StateBufferConnector_ms": 0.0018317699432373047, "ViewRequirementAgentConnector_ms": 0.047040700912475586}}, "episode_reward_max": -644.1545087121541, "episode_reward_min": -1311.4473829493659, "episode_reward_mean": -965.8756503283308, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-772.2303656426295, -1009.4708056090329, -705.488473263644, -962.7727851853575, -813.6098676090104, -1102.656080993699, -1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.998497758226268, "mean_inference_ms": 0.2677970089524888, "mean_action_processing_ms": 0.06196182756933309, "mean_env_wait_ms": 1.8232536777312465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028247833251953125, "StateBufferConnector_ms": 0.0018317699432373047, "ViewRequirementAgentConnector_ms": 0.047040700912475586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680, "num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.85270819205982, "num_env_steps_trained_throughput_per_sec": 66.85270819205982, "timesteps_total": 28680, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 28680, "timers": {"training_iteration_time_ms": 1793.753, "sample_time_ms": 1791.101, "load_time_ms": 0.152, "load_throughput": 787539.477, "learn_time_ms": 1.94, "learn_throughput": 61849.207, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680}, "done": false, "episodes_total": 239, "training_iteration": 40, "trial_id": "d3049_00000", "date": "2023-07-24_21-28-12", "timestamp": 1690223292, "time_this_iter_s": 10.772318840026855, "time_total_s": 435.046813249588, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 435.046813249588, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 23.3, "ram_util_percent": 77.26875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.18e-05, "entropy_coeff": 0.1, "policy_entropy": 367.5504455566406, "policy_loss": -206299.75, "vf_loss": 8780626.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 245.0, "diff_num_grad_updates_vs_sampler_policy": 244.0}}, "num_env_steps_sampled": 29400, "num_env_steps_trained": 29400, "num_agent_steps_sampled": 29400, "num_agent_steps_trained": 29400}, "sampler_results": {"episode_reward_max": -644.1545087121541, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -977.0210640879586, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.99740451987457, "mean_inference_ms": 0.26775467563660127, "mean_action_processing_ms": 0.06195190398286211, "mean_env_wait_ms": 1.818550947258406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028710365295410156, "StateBufferConnector_ms": 0.001882791519165039, "ViewRequirementAgentConnector_ms": 0.04758429527282715}}, "episode_reward_max": -644.1545087121541, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -977.0210640879586, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1099.1360518486144, -858.7783745884499, -822.2546843569296, -735.4443999744117, -904.5872429845213, -799.1212896093058, -980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.99740451987457, "mean_inference_ms": 0.26775467563660127, "mean_action_processing_ms": 0.06195190398286211, "mean_env_wait_ms": 1.818550947258406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028710365295410156, "StateBufferConnector_ms": 0.001882791519165039, "ViewRequirementAgentConnector_ms": 0.04758429527282715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29400, "num_agent_steps_trained": 29400, "num_env_steps_sampled": 29400, "num_env_steps_trained": 29400, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.64265714671649, "num_env_steps_trained_throughput_per_sec": 66.64265714671649, "timesteps_total": 29400, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 29400, "timers": {"training_iteration_time_ms": 1797.926, "sample_time_ms": 1795.339, "load_time_ms": 0.15, "load_throughput": 801459.363, "learn_time_ms": 1.896, "learn_throughput": 63301.49, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 29400, "num_env_steps_trained": 29400, "num_agent_steps_sampled": 29400, "num_agent_steps_trained": 29400}, "done": false, "episodes_total": 245, "training_iteration": 41, "trial_id": "d3049_00000", "date": "2023-07-24_21-28-23", "timestamp": 1690223303, "time_this_iter_s": 10.805991172790527, "time_total_s": 445.85280442237854, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 445.85280442237854, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 25.160000000000004, "ram_util_percent": 78.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.1, "policy_entropy": 366.9599609375, "policy_loss": -140116.171875, "vf_loss": 4905612.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 250.0}}, "num_env_steps_sampled": 30120, "num_env_steps_trained": 30120, "num_agent_steps_sampled": 30120, "num_agent_steps_trained": 30120}, "sampler_results": {"episode_reward_max": -644.1545087121541, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -977.278851678083, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.996494102070237, "mean_inference_ms": 0.26772489486909384, "mean_action_processing_ms": 0.0619442737475748, "mean_env_wait_ms": 1.8140602156634653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002857685089111328, "StateBufferConnector_ms": 0.0018718242645263672, "ViewRequirementAgentConnector_ms": 0.04744076728820801}}, "episode_reward_max": -644.1545087121541, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -977.278851678083, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-980.307070769442, -1011.5186081973295, -1159.3466766463278, -804.1951611529157, -917.6652671181771, -1088.7332604905266, -879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.996494102070237, "mean_inference_ms": 0.26772489486909384, "mean_action_processing_ms": 0.0619442737475748, "mean_env_wait_ms": 1.8140602156634653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002857685089111328, "StateBufferConnector_ms": 0.0018718242645263672, "ViewRequirementAgentConnector_ms": 0.04744076728820801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30120, "num_agent_steps_trained": 30120, "num_env_steps_sampled": 30120, "num_env_steps_trained": 30120, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.3148905520625, "num_env_steps_trained_throughput_per_sec": 66.3148905520625, "timesteps_total": 30120, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 30120, "timers": {"training_iteration_time_ms": 1805.601, "sample_time_ms": 1803.021, "load_time_ms": 0.151, "load_throughput": 796891.197, "learn_time_ms": 1.885, "learn_throughput": 63652.934, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 30120, "num_env_steps_trained": 30120, "num_agent_steps_sampled": 30120, "num_agent_steps_trained": 30120}, "done": false, "episodes_total": 251, "training_iteration": 42, "trial_id": "d3049_00000", "date": "2023-07-24_21-28-34", "timestamp": 1690223314, "time_this_iter_s": 10.8593909740448, "time_total_s": 456.71219539642334, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 456.71219539642334, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 25.499999999999996, "ram_util_percent": 78.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.7e-06, "entropy_coeff": 0.1, "policy_entropy": 366.76611328125, "policy_loss": -226184.390625, "vf_loss": 13725682.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 257.0, "diff_num_grad_updates_vs_sampler_policy": 256.0}}, "num_env_steps_sampled": 30840, "num_env_steps_trained": 30840, "num_agent_steps_sampled": 30840, "num_agent_steps_trained": 30840}, "sampler_results": {"episode_reward_max": -644.1545087121541, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -978.3263086900827, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.995528783273322, "mean_inference_ms": 0.26771557100270077, "mean_action_processing_ms": 0.06193951131909074, "mean_env_wait_ms": 1.8097483423353193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028595924377441406, "StateBufferConnector_ms": 0.0018677711486816406, "ViewRequirementAgentConnector_ms": 0.04749035835266113}}, "episode_reward_max": -644.1545087121541, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -978.3263086900827, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-879.6532364712808, -781.8867293420407, -842.3924847932888, -770.28380910132, -1008.3035551324718, -748.8981046887102, -956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.995528783273322, "mean_inference_ms": 0.26771557100270077, "mean_action_processing_ms": 0.06193951131909074, "mean_env_wait_ms": 1.8097483423353193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028595924377441406, "StateBufferConnector_ms": 0.0018677711486816406, "ViewRequirementAgentConnector_ms": 0.04749035835266113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30840, "num_agent_steps_trained": 30840, "num_env_steps_sampled": 30840, "num_env_steps_trained": 30840, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.84884871802636, "num_env_steps_trained_throughput_per_sec": 66.84884871802636, "timesteps_total": 30840, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 30840, "timers": {"training_iteration_time_ms": 1797.052, "sample_time_ms": 1794.503, "load_time_ms": 0.148, "load_throughput": 811538.987, "learn_time_ms": 1.858, "learn_throughput": 64590.688, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 30840, "num_env_steps_trained": 30840, "num_agent_steps_sampled": 30840, "num_agent_steps_trained": 30840}, "done": false, "episodes_total": 257, "training_iteration": 43, "trial_id": "d3049_00000", "date": "2023-07-24_21-28-45", "timestamp": 1690223325, "time_this_iter_s": 10.772802829742432, "time_total_s": 467.48499822616577, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 467.48499822616577, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 23.48125, "ram_util_percent": 78.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.400000000000001e-06, "entropy_coeff": 0.1, "policy_entropy": 366.71539306640625, "policy_loss": -151373.65625, "vf_loss": 5365653.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 262.0}}, "num_env_steps_sampled": 31560, "num_env_steps_trained": 31560, "num_agent_steps_sampled": 31560, "num_agent_steps_trained": 31560}, "sampler_results": {"episode_reward_max": -644.1545087121541, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -984.4174730521876, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.99455148901587, "mean_inference_ms": 0.267712969375185, "mean_action_processing_ms": 0.06193548557370157, "mean_env_wait_ms": 1.8056792402755943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028684139251708984, "StateBufferConnector_ms": 0.0018737316131591797, "ViewRequirementAgentConnector_ms": 0.04742288589477539}}, "episode_reward_max": -644.1545087121541, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -984.4174730521876, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-956.139185326332, -854.1817327007204, -1164.7135068022105, -1109.4502519970038, -644.1545087121541, -1031.7856684099468, -1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.99455148901587, "mean_inference_ms": 0.267712969375185, "mean_action_processing_ms": 0.06193548557370157, "mean_env_wait_ms": 1.8056792402755943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028684139251708984, "StateBufferConnector_ms": 0.0018737316131591797, "ViewRequirementAgentConnector_ms": 0.04742288589477539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31560, "num_agent_steps_trained": 31560, "num_env_steps_sampled": 31560, "num_env_steps_trained": 31560, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.66056724126467, "num_env_steps_trained_throughput_per_sec": 66.66056724126467, "timesteps_total": 31560, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 31560, "timers": {"training_iteration_time_ms": 1801.506, "sample_time_ms": 1798.715, "load_time_ms": 0.145, "load_throughput": 825108.984, "learn_time_ms": 1.847, "learn_throughput": 64987.667, "synch_weights_time_ms": 0.77}, "counters": {"num_env_steps_sampled": 31560, "num_env_steps_trained": 31560, "num_agent_steps_sampled": 31560, "num_agent_steps_trained": 31560}, "done": false, "episodes_total": 263, "training_iteration": 44, "trial_id": "d3049_00000", "date": "2023-07-24_21-28-56", "timestamp": 1690223336, "time_this_iter_s": 10.80304217338562, "time_total_s": 478.2880403995514, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 478.2880403995514, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.3, "ram_util_percent": 78.37999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.100000000000001e-06, "entropy_coeff": 0.1, "policy_entropy": 366.13128662109375, "policy_loss": -150458.875, "vf_loss": 5646935.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 269.0, "diff_num_grad_updates_vs_sampler_policy": 268.0}}, "num_env_steps_sampled": 32280, "num_env_steps_trained": 32280, "num_agent_steps_sampled": 32280, "num_agent_steps_trained": 32280}, "sampler_results": {"episode_reward_max": -656.4844851617173, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -984.509272973786, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.993519422851062, "mean_inference_ms": 0.2677022748648984, "mean_action_processing_ms": 0.06193045541038005, "mean_env_wait_ms": 1.8018837726192425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028696060180664062, "StateBufferConnector_ms": 0.0018703937530517578, "ViewRequirementAgentConnector_ms": 0.047525644302368164}}, "episode_reward_max": -656.4844851617173, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -984.509272973786, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1144.753185913056, -1103.4245127156669, -962.2490064595879, -1152.9294168943927, -993.2168199502787, -849.3299050057354, -1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.993519422851062, "mean_inference_ms": 0.2677022748648984, "mean_action_processing_ms": 0.06193045541038005, "mean_env_wait_ms": 1.8018837726192425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028696060180664062, "StateBufferConnector_ms": 0.0018703937530517578, "ViewRequirementAgentConnector_ms": 0.047525644302368164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32280, "num_agent_steps_trained": 32280, "num_env_steps_sampled": 32280, "num_env_steps_trained": 32280, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.82059401779885, "num_env_steps_trained_throughput_per_sec": 66.82059401779885, "timesteps_total": 32280, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 32280, "timers": {"training_iteration_time_ms": 1799.634, "sample_time_ms": 1796.916, "load_time_ms": 0.155, "load_throughput": 775406.686, "learn_time_ms": 1.925, "learn_throughput": 62324.04, "synch_weights_time_ms": 0.607}, "counters": {"num_env_steps_sampled": 32280, "num_env_steps_trained": 32280, "num_agent_steps_sampled": 32280, "num_agent_steps_trained": 32280}, "done": false, "episodes_total": 269, "training_iteration": 45, "trial_id": "d3049_00000", "date": "2023-07-24_21-29-07", "timestamp": 1690223347, "time_this_iter_s": 10.782633781433105, "time_total_s": 489.0706741809845, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 489.0706741809845, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 23.60666666666667, "ram_util_percent": 78.48666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.8e-06, "entropy_coeff": 0.1, "policy_entropy": 365.30364990234375, "policy_loss": -149638.5, "vf_loss": 5334083.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 274.0}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 33000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 33000}, "sampler_results": {"episode_reward_max": -656.4844851617173, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -973.9782728817657, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.992464179381468, "mean_inference_ms": 0.2676837686832007, "mean_action_processing_ms": 0.061924613344918784, "mean_env_wait_ms": 1.7983156807034442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00286865234375, "StateBufferConnector_ms": 0.0018672943115234375, "ViewRequirementAgentConnector_ms": 0.04755234718322754}}, "episode_reward_max": -656.4844851617173, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -973.9782728817657, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1060.008681008835, -1129.0016749540478, -1017.090844703324, -1025.3058536979909, -804.8977518217141, -1110.4228219952133, -957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.992464179381468, "mean_inference_ms": 0.2676837686832007, "mean_action_processing_ms": 0.061924613344918784, "mean_env_wait_ms": 1.7983156807034442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00286865234375, "StateBufferConnector_ms": 0.0018672943115234375, "ViewRequirementAgentConnector_ms": 0.04755234718322754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 33000, "num_env_steps_sampled": 33000, "num_env_steps_trained": 33000, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.61241940151237, "num_env_steps_trained_throughput_per_sec": 66.61241940151237, "timesteps_total": 33000, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 1797.223, "sample_time_ms": 1794.516, "load_time_ms": 0.155, "load_throughput": 773143.594, "learn_time_ms": 1.914, "learn_throughput": 62681.073, "synch_weights_time_ms": 0.606}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 33000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 33000}, "done": false, "episodes_total": 275, "training_iteration": 46, "trial_id": "d3049_00000", "date": "2023-07-24_21-29-17", "timestamp": 1690223357, "time_this_iter_s": 10.810839653015137, "time_total_s": 499.88151383399963, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 499.88151383399963, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 26.3625, "ram_util_percent": 78.41875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.5e-06, "entropy_coeff": 0.1, "policy_entropy": 365.0960693359375, "policy_loss": -122306.7109375, "vf_loss": 4020423.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 281.0, "diff_num_grad_updates_vs_sampler_policy": 280.0}}, "num_env_steps_sampled": 33720, "num_env_steps_trained": 33720, "num_agent_steps_sampled": 33720, "num_agent_steps_trained": 33720}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -966.4845375393821, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.99123155017919, "mean_inference_ms": 0.2676731380962741, "mean_action_processing_ms": 0.061920396144801285, "mean_env_wait_ms": 1.7949885725055363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028824806213378906, "StateBufferConnector_ms": 0.0018711090087890625, "ViewRequirementAgentConnector_ms": 0.04769420623779297}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -966.4845375393821, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-957.8548543356065, -1000.4399159075998, -791.2568762857401, -875.0171589863129, -802.0177859396354, -885.4814863827538, -1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.99123155017919, "mean_inference_ms": 0.2676731380962741, "mean_action_processing_ms": 0.061920396144801285, "mean_env_wait_ms": 1.7949885725055363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028824806213378906, "StateBufferConnector_ms": 0.0018711090087890625, "ViewRequirementAgentConnector_ms": 0.04769420623779297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33720, "num_agent_steps_trained": 33720, "num_env_steps_sampled": 33720, "num_env_steps_trained": 33720, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.89256614412224, "num_env_steps_trained_throughput_per_sec": 66.89256614412224, "timesteps_total": 33720, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 33720, "timers": {"training_iteration_time_ms": 1796.934, "sample_time_ms": 1794.394, "load_time_ms": 0.15, "load_throughput": 801459.363, "learn_time_ms": 1.846, "learn_throughput": 65010.331, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 33720, "num_env_steps_trained": 33720, "num_agent_steps_sampled": 33720, "num_agent_steps_trained": 33720}, "done": false, "episodes_total": 281, "training_iteration": 47, "trial_id": "d3049_00000", "date": "2023-07-24_21-29-28", "timestamp": 1690223368, "time_this_iter_s": 10.765635013580322, "time_total_s": 510.64714884757996, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 510.64714884757996, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 23.740000000000002, "ram_util_percent": 77.68666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.200000000000001e-06, "entropy_coeff": 0.1, "policy_entropy": 365.1936950683594, "policy_loss": -239803.09375, "vf_loss": 13811316.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 287.0, "diff_num_grad_updates_vs_sampler_policy": 286.0}}, "num_env_steps_sampled": 34440, "num_env_steps_trained": 34440, "num_agent_steps_sampled": 34440, "num_agent_steps_trained": 34440}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -973.4205566767785, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98996888628433, "mean_inference_ms": 0.2676812049982564, "mean_action_processing_ms": 0.06191894961051674, "mean_env_wait_ms": 1.7918580362209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029485225677490234, "StateBufferConnector_ms": 0.0019078254699707031, "ViewRequirementAgentConnector_ms": 0.04864096641540527}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -973.4205566767785, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1003.5922539763119, -1058.1547164065696, -1054.6834649476416, -946.7856909558498, -1062.3593928517043, -896.8688614334989, -1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98996888628433, "mean_inference_ms": 0.2676812049982564, "mean_action_processing_ms": 0.06191894961051674, "mean_env_wait_ms": 1.7918580362209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029485225677490234, "StateBufferConnector_ms": 0.0019078254699707031, "ViewRequirementAgentConnector_ms": 0.04864096641540527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34440, "num_agent_steps_trained": 34440, "num_env_steps_sampled": 34440, "num_env_steps_trained": 34440, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.59200937929141, "num_env_steps_trained_throughput_per_sec": 66.59200937929141, "timesteps_total": 34440, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 34440, "timers": {"training_iteration_time_ms": 1798.662, "sample_time_ms": 1796.107, "load_time_ms": 0.149, "load_throughput": 806338.481, "learn_time_ms": 1.87, "learn_throughput": 64161.703, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 34440, "num_env_steps_trained": 34440, "num_agent_steps_sampled": 34440, "num_agent_steps_trained": 34440}, "done": false, "episodes_total": 287, "training_iteration": 48, "trial_id": "d3049_00000", "date": "2023-07-24_21-29-39", "timestamp": 1690223379, "time_this_iter_s": 10.814247369766235, "time_total_s": 521.4613962173462, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 521.4613962173462, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 23.5625, "ram_util_percent": 77.89375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.9e-06, "entropy_coeff": 0.1, "policy_entropy": 365.1897888183594, "policy_loss": -209275.125, "vf_loss": 10917496.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 35160, "num_env_steps_trained": 35160, "num_agent_steps_sampled": 35160, "num_agent_steps_trained": 35160}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -976.7000705465248, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98879416848446, "mean_inference_ms": 0.2676931677177972, "mean_action_processing_ms": 0.06191883649017501, "mean_env_wait_ms": 1.7889462616360736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002980470657348633, "StateBufferConnector_ms": 0.0019211769104003906, "ViewRequirementAgentConnector_ms": 0.0490107536315918}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -976.7000705465248, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1153.8682510185386, -1188.1688433349107, -967.6307032450811, -1024.5299101794185, -1107.9564585329292, -895.6459639056293, -909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98879416848446, "mean_inference_ms": 0.2676931677177972, "mean_action_processing_ms": 0.06191883649017501, "mean_env_wait_ms": 1.7889462616360736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002980470657348633, "StateBufferConnector_ms": 0.0019211769104003906, "ViewRequirementAgentConnector_ms": 0.0490107536315918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35160, "num_agent_steps_trained": 35160, "num_env_steps_sampled": 35160, "num_env_steps_trained": 35160, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.44065702417645, "num_env_steps_trained_throughput_per_sec": 66.44065702417645, "timesteps_total": 35160, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 35160, "timers": {"training_iteration_time_ms": 1806.095, "sample_time_ms": 1803.525, "load_time_ms": 0.147, "load_throughput": 816541.986, "learn_time_ms": 1.879, "learn_throughput": 63867.787, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 35160, "num_env_steps_trained": 35160, "num_agent_steps_sampled": 35160, "num_agent_steps_trained": 35160}, "done": false, "episodes_total": 293, "training_iteration": 49, "trial_id": "d3049_00000", "date": "2023-07-24_21-29-50", "timestamp": 1690223390, "time_this_iter_s": 10.838808059692383, "time_total_s": 532.3002042770386, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 532.3002042770386, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 23.76, "ram_util_percent": 77.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.6e-06, "entropy_coeff": 0.1, "policy_entropy": 364.9661560058594, "policy_loss": -187050.53125, "vf_loss": 8823569.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 299.0, "diff_num_grad_updates_vs_sampler_policy": 298.0}}, "num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -973.0730409285821, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987733186264263, "mean_inference_ms": 0.26770476559165024, "mean_action_processing_ms": 0.06191880928053619, "mean_env_wait_ms": 1.7862271501638434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029897689819335938, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.04906606674194336}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -973.0730409285821, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-909.5565983277907, -975.9696010318922, -964.7236123809026, -973.2529083042207, -1117.228122830217, -656.559606085185, -990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987733186264263, "mean_inference_ms": 0.26770476559165024, "mean_action_processing_ms": 0.06191880928053619, "mean_env_wait_ms": 1.7862271501638434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029897689819335938, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.04906606674194336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880, "num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.53197558908546, "num_env_steps_trained_throughput_per_sec": 66.53197558908546, "timesteps_total": 35880, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 35880, "timers": {"training_iteration_time_ms": 1807.473, "sample_time_ms": 1804.802, "load_time_ms": 0.151, "load_throughput": 795631.489, "learn_time_ms": 1.949, "learn_throughput": 61557.976, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880}, "done": false, "episodes_total": 299, "training_iteration": 50, "trial_id": "d3049_00000", "date": "2023-07-24_21-30-01", "timestamp": 1690223401, "time_this_iter_s": 10.823898077011108, "time_total_s": 543.1241023540497, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 543.1241023540497, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.279999999999998, "ram_util_percent": 77.75333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.3e-06, "entropy_coeff": 0.1, "policy_entropy": 364.8196105957031, "policy_loss": -171296.53125, "vf_loss": 7675373.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 305.0, "diff_num_grad_updates_vs_sampler_policy": 304.0}}, "num_env_steps_sampled": 36600, "num_env_steps_trained": 36600, "num_agent_steps_sampled": 36600, "num_agent_steps_trained": 36600}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -972.1107510777024, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986679849822478, "mean_inference_ms": 0.2677118311353117, "mean_action_processing_ms": 0.061918151470170345, "mean_env_wait_ms": 1.7836368284633684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029959678649902344, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.04912590980529785}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -972.1107510777024, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-990.6960781939976, -872.9094205423504, -939.3120454560943, -729.0584397520137, -1043.7094892249315, -1010.0076304402882, -1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986679849822478, "mean_inference_ms": 0.2677118311353117, "mean_action_processing_ms": 0.061918151470170345, "mean_env_wait_ms": 1.7836368284633684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029959678649902344, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.04912590980529785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36600, "num_agent_steps_trained": 36600, "num_env_steps_sampled": 36600, "num_env_steps_trained": 36600, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.67207449754342, "num_env_steps_trained_throughput_per_sec": 66.67207449754342, "timesteps_total": 36600, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 36600, "timers": {"training_iteration_time_ms": 1802.351, "sample_time_ms": 1799.754, "load_time_ms": 0.149, "load_throughput": 808021.32, "learn_time_ms": 1.902, "learn_throughput": 63080.936, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 36600, "num_env_steps_trained": 36600, "num_agent_steps_sampled": 36600, "num_agent_steps_trained": 36600}, "done": false, "episodes_total": 305, "training_iteration": 51, "trial_id": "d3049_00000", "date": "2023-07-24_21-30-12", "timestamp": 1690223412, "time_this_iter_s": 10.80149507522583, "time_total_s": 553.9255974292755, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 553.9255974292755, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.18125, "ram_util_percent": 77.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-06, "entropy_coeff": 0.1, "policy_entropy": 364.7485656738281, "policy_loss": -156355.890625, "vf_loss": 5633131.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 37320, "num_env_steps_trained": 37320, "num_agent_steps_sampled": 37320, "num_agent_steps_trained": 37320}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -969.4890121719152, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98600597546335, "mean_inference_ms": 0.26770528131913474, "mean_action_processing_ms": 0.06191654740178997, "mean_env_wait_ms": 1.7811641489235819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029861927032470703, "StateBufferConnector_ms": 0.0019087791442871094, "ViewRequirementAgentConnector_ms": 0.04913043975830078}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -969.4890121719152, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1076.7836698727353, -871.4244089589561, -1016.7763171006309, -901.8699172646394, -807.0239441127322, -954.7858626734472, -1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98600597546335, "mean_inference_ms": 0.26770528131913474, "mean_action_processing_ms": 0.06191654740178997, "mean_env_wait_ms": 1.7811641489235819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029861927032470703, "StateBufferConnector_ms": 0.0019087791442871094, "ViewRequirementAgentConnector_ms": 0.04913043975830078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37320, "num_agent_steps_trained": 37320, "num_env_steps_sampled": 37320, "num_env_steps_trained": 37320, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.40558059099342, "num_env_steps_trained_throughput_per_sec": 65.40558059099342, "timesteps_total": 37320, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 37320, "timers": {"training_iteration_time_ms": 1820.502, "sample_time_ms": 1817.787, "load_time_ms": 0.154, "load_throughput": 780335.628, "learn_time_ms": 2.001, "learn_throughput": 59980.751, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 37320, "num_env_steps_trained": 37320, "num_agent_steps_sampled": 37320, "num_agent_steps_trained": 37320}, "done": false, "episodes_total": 311, "training_iteration": 52, "trial_id": "d3049_00000", "date": "2023-07-24_21-30-23", "timestamp": 1690223423, "time_this_iter_s": 11.010448932647705, "time_total_s": 564.9360463619232, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 564.9360463619232, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 31.40666666666666, "ram_util_percent": 77.74666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.7e-06, "entropy_coeff": 0.1, "policy_entropy": 364.54840087890625, "policy_loss": -179225.46875, "vf_loss": 7997391.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 317.0, "diff_num_grad_updates_vs_sampler_policy": 316.0}}, "num_env_steps_sampled": 38040, "num_env_steps_trained": 38040, "num_agent_steps_sampled": 38040, "num_agent_steps_trained": 38040}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -967.5252102786842, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985352809338904, "mean_inference_ms": 0.26767502308560387, "mean_action_processing_ms": 0.06191179717796084, "mean_env_wait_ms": 1.7788050622059268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029888153076171875, "StateBufferConnector_ms": 0.0019168853759765625, "ViewRequirementAgentConnector_ms": 0.049303531646728516}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -967.5252102786842, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1053.3195451238475, -1127.9834721262469, -1268.2927846785105, -965.2882958627252, -974.8372885367824, -1136.4157258495006, -1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985352809338904, "mean_inference_ms": 0.26767502308560387, "mean_action_processing_ms": 0.06191179717796084, "mean_env_wait_ms": 1.7788050622059268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029888153076171875, "StateBufferConnector_ms": 0.0019168853759765625, "ViewRequirementAgentConnector_ms": 0.049303531646728516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38040, "num_agent_steps_trained": 38040, "num_env_steps_sampled": 38040, "num_env_steps_trained": 38040, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.06019076765672, "num_env_steps_trained_throughput_per_sec": 66.06019076765672, "timesteps_total": 38040, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 38040, "timers": {"training_iteration_time_ms": 1829.62, "sample_time_ms": 1826.912, "load_time_ms": 0.152, "load_throughput": 791751.581, "learn_time_ms": 1.993, "learn_throughput": 60204.6, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 38040, "num_env_steps_trained": 38040, "num_agent_steps_sampled": 38040, "num_agent_steps_trained": 38040}, "done": false, "episodes_total": 317, "training_iteration": 53, "trial_id": "d3049_00000", "date": "2023-07-24_21-30-34", "timestamp": 1690223434, "time_this_iter_s": 10.901266098022461, "time_total_s": 575.8373124599457, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 575.8373124599457, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.362500000000004, "ram_util_percent": 78.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.4000000000000006e-06, "entropy_coeff": 0.1, "policy_entropy": 364.50592041015625, "policy_loss": -175587.125, "vf_loss": 7320459.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 322.0}}, "num_env_steps_sampled": 38760, "num_env_steps_trained": 38760, "num_agent_steps_sampled": 38760, "num_agent_steps_trained": 38760}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -956.4283627132713, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98462507562991, "mean_inference_ms": 0.2676403085390377, "mean_action_processing_ms": 0.061906571005555765, "mean_env_wait_ms": 1.7766182879766785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00302886962890625, "StateBufferConnector_ms": 0.001912832260131836, "ViewRequirementAgentConnector_ms": 0.04917573928833008}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -956.4283627132713, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1224.4082006510084, -820.845794463686, -981.1982382284666, -1311.4473829493659, -656.4844851617173, -930.6963239187365, -1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98462507562991, "mean_inference_ms": 0.2676403085390377, "mean_action_processing_ms": 0.061906571005555765, "mean_env_wait_ms": 1.7766182879766785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00302886962890625, "StateBufferConnector_ms": 0.001912832260131836, "ViewRequirementAgentConnector_ms": 0.04917573928833008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38760, "num_agent_steps_trained": 38760, "num_env_steps_sampled": 38760, "num_env_steps_trained": 38760, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.31815849125617, "num_env_steps_trained_throughput_per_sec": 66.31815849125617, "timesteps_total": 38760, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 38760, "timers": {"training_iteration_time_ms": 1810.828, "sample_time_ms": 1808.188, "load_time_ms": 0.149, "load_throughput": 806726.206, "learn_time_ms": 1.927, "learn_throughput": 62260.821, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 38760, "num_env_steps_trained": 38760, "num_agent_steps_sampled": 38760, "num_agent_steps_trained": 38760}, "done": false, "episodes_total": 323, "training_iteration": 54, "trial_id": "d3049_00000", "date": "2023-07-24_21-30-44", "timestamp": 1690223444, "time_this_iter_s": 10.85880184173584, "time_total_s": 586.6961143016815, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 586.6961143016815, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 22.853333333333335, "ram_util_percent": 78.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.1e-06, "entropy_coeff": 0.1, "policy_entropy": 364.4029846191406, "policy_loss": -139931.21875, "vf_loss": 5070734.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 329.0, "diff_num_grad_updates_vs_sampler_policy": 328.0}}, "num_env_steps_sampled": 39480, "num_env_steps_trained": 39480, "num_agent_steps_sampled": 39480, "num_agent_steps_trained": 39480}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -951.3315333265222, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984291318662834, "mean_inference_ms": 0.2676092392022908, "mean_action_processing_ms": 0.061901668029038986, "mean_env_wait_ms": 1.7745980924016775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003033876419067383, "StateBufferConnector_ms": 0.0018978118896484375, "ViewRequirementAgentConnector_ms": 0.0490727424621582}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1329.4875946242223, "episode_reward_mean": -951.3315333265222, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1033.5210354685282, -997.8897761398514, -1107.522321527318, -1092.155524771417, -749.2147486266708, -869.495770630962, -1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984291318662834, "mean_inference_ms": 0.2676092392022908, "mean_action_processing_ms": 0.061901668029038986, "mean_env_wait_ms": 1.7745980924016775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003033876419067383, "StateBufferConnector_ms": 0.0018978118896484375, "ViewRequirementAgentConnector_ms": 0.0490727424621582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39480, "num_agent_steps_trained": 39480, "num_env_steps_sampled": 39480, "num_env_steps_trained": 39480, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.38618220725247, "num_env_steps_trained_throughput_per_sec": 65.38618220725247, "timesteps_total": 39480, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 39480, "timers": {"training_iteration_time_ms": 1822.494, "sample_time_ms": 1819.605, "load_time_ms": 0.154, "load_throughput": 778886.537, "learn_time_ms": 1.921, "learn_throughput": 62459.387, "synch_weights_time_ms": 0.758}, "counters": {"num_env_steps_sampled": 39480, "num_env_steps_trained": 39480, "num_agent_steps_sampled": 39480, "num_agent_steps_trained": 39480}, "done": false, "episodes_total": 329, "training_iteration": 55, "trial_id": "d3049_00000", "date": "2023-07-24_21-30-55", "timestamp": 1690223455, "time_this_iter_s": 11.013769149780273, "time_total_s": 597.7098834514618, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 597.7098834514618, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 26.68125, "ram_util_percent": 77.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.8e-06, "entropy_coeff": 0.1, "policy_entropy": 364.4658203125, "policy_loss": -234534.15625, "vf_loss": 14053116.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 335.0, "diff_num_grad_updates_vs_sampler_policy": 334.0}}, "num_env_steps_sampled": 40200, "num_env_steps_trained": 40200, "num_agent_steps_sampled": 40200, "num_agent_steps_trained": 40200}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -948.9502032920241, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984272551421292, "mean_inference_ms": 0.26757768097478135, "mean_action_processing_ms": 0.061897087586690415, "mean_env_wait_ms": 1.7727070396098055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030307769775390625, "StateBufferConnector_ms": 0.0018978118896484375, "ViewRequirementAgentConnector_ms": 0.04908180236816406}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -948.9502032920241, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1170.869517291896, -1076.7013947338544, -844.6825257232732, -1018.5449045523196, -1329.4875946242223, -1104.2163188246707, -878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984272551421292, "mean_inference_ms": 0.26757768097478135, "mean_action_processing_ms": 0.061897087586690415, "mean_env_wait_ms": 1.7727070396098055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030307769775390625, "StateBufferConnector_ms": 0.0018978118896484375, "ViewRequirementAgentConnector_ms": 0.04908180236816406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40200, "num_agent_steps_trained": 40200, "num_env_steps_sampled": 40200, "num_env_steps_trained": 40200, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.90447581447347, "num_env_steps_trained_throughput_per_sec": 65.90447581447347, "timesteps_total": 40200, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 40200, "timers": {"training_iteration_time_ms": 1832.094, "sample_time_ms": 1829.15, "load_time_ms": 0.155, "load_throughput": 775884.816, "learn_time_ms": 1.956, "learn_throughput": 61365.091, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 40200, "num_env_steps_trained": 40200, "num_agent_steps_sampled": 40200, "num_agent_steps_trained": 40200}, "done": false, "episodes_total": 335, "training_iteration": 56, "trial_id": "d3049_00000", "date": "2023-07-24_21-31-06", "timestamp": 1690223466, "time_this_iter_s": 10.926844120025635, "time_total_s": 608.6367275714874, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 608.6367275714874, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 25.533333333333335, "ram_util_percent": 77.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.5e-06, "entropy_coeff": 0.1, "policy_entropy": 364.38427734375, "policy_loss": -116205.9375, "vf_loss": 3153485.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 341.0, "diff_num_grad_updates_vs_sampler_policy": 340.0}}, "num_env_steps_sampled": 40920, "num_env_steps_trained": 40920, "num_agent_steps_sampled": 40920, "num_agent_steps_trained": 40920}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -935.7066690814099, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984399524041692, "mean_inference_ms": 0.26754032085755475, "mean_action_processing_ms": 0.06189160591097957, "mean_env_wait_ms": 1.770934836485116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029942989349365234, "StateBufferConnector_ms": 0.0018694400787353516, "ViewRequirementAgentConnector_ms": 0.04870414733886719}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -935.7066690814099, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-878.094181751639, -1044.1768909727573, -1089.0255987593578, -1035.7691693335125, -1044.8502621230944, -897.2678941683532, -684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984399524041692, "mean_inference_ms": 0.26754032085755475, "mean_action_processing_ms": 0.06189160591097957, "mean_env_wait_ms": 1.770934836485116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029942989349365234, "StateBufferConnector_ms": 0.0018694400787353516, "ViewRequirementAgentConnector_ms": 0.04870414733886719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40920, "num_agent_steps_trained": 40920, "num_env_steps_sampled": 40920, "num_env_steps_trained": 40920, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.20230145319795, "num_env_steps_trained_throughput_per_sec": 66.20230145319795, "timesteps_total": 40920, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 40920, "timers": {"training_iteration_time_ms": 1812.587, "sample_time_ms": 1809.919, "load_time_ms": 0.154, "load_throughput": 781425.99, "learn_time_ms": 1.955, "learn_throughput": 61390.54, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 40920, "num_env_steps_trained": 40920, "num_agent_steps_sampled": 40920, "num_agent_steps_trained": 40920}, "done": false, "episodes_total": 341, "training_iteration": 57, "trial_id": "d3049_00000", "date": "2023-07-24_21-31-17", "timestamp": 1690223477, "time_this_iter_s": 10.878045797348022, "time_total_s": 619.5147733688354, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 619.5147733688354, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 25.106250000000003, "ram_util_percent": 77.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.2e-06, "entropy_coeff": 0.1, "policy_entropy": 364.00958251953125, "policy_loss": -150878.125, "vf_loss": 5735388.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 346.0}}, "num_env_steps_sampled": 41640, "num_env_steps_trained": 41640, "num_agent_steps_sampled": 41640, "num_agent_steps_trained": 41640}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -930.5646838168591, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98454965522485, "mean_inference_ms": 0.2675078420945184, "mean_action_processing_ms": 0.06188671889339309, "mean_env_wait_ms": 1.7692848697506094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029916763305664062, "StateBufferConnector_ms": 0.001848459243774414, "ViewRequirementAgentConnector_ms": 0.04854416847229004}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -930.5646838168591, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-684.4297416871109, -934.7608687127014, -881.0916935638104, -802.700342119579, -1061.5381241028065, -1047.663680057933, -883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98454965522485, "mean_inference_ms": 0.2675078420945184, "mean_action_processing_ms": 0.06188671889339309, "mean_env_wait_ms": 1.7692848697506094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029916763305664062, "StateBufferConnector_ms": 0.001848459243774414, "ViewRequirementAgentConnector_ms": 0.04854416847229004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41640, "num_agent_steps_trained": 41640, "num_env_steps_sampled": 41640, "num_env_steps_trained": 41640, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.2456159069912, "num_env_steps_trained_throughput_per_sec": 66.2456159069912, "timesteps_total": 41640, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 41640, "timers": {"training_iteration_time_ms": 1810.934, "sample_time_ms": 1808.196, "load_time_ms": 0.157, "load_throughput": 763642.057, "learn_time_ms": 1.996, "learn_throughput": 60119.743, "synch_weights_time_ms": 0.555}, "counters": {"num_env_steps_sampled": 41640, "num_env_steps_trained": 41640, "num_agent_steps_sampled": 41640, "num_agent_steps_trained": 41640}, "done": false, "episodes_total": 347, "training_iteration": 58, "trial_id": "d3049_00000", "date": "2023-07-24_21-31-28", "timestamp": 1690223488, "time_this_iter_s": 10.87069296836853, "time_total_s": 630.385466337204, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 630.385466337204, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 24.220000000000002, "ram_util_percent": 77.57333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.9000000000000005e-06, "entropy_coeff": 0.1, "policy_entropy": 363.90557861328125, "policy_loss": -160349.125, "vf_loss": 6728414.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 42360, "num_env_steps_trained": 42360, "num_agent_steps_sampled": 42360, "num_agent_steps_trained": 42360}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -931.8746493105159, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984777874252751, "mean_inference_ms": 0.267469423566547, "mean_action_processing_ms": 0.061880382736232364, "mean_env_wait_ms": 1.7676868437884463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002997875213623047, "StateBufferConnector_ms": 0.0018591880798339844, "ViewRequirementAgentConnector_ms": 0.048593997955322266}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -931.8746493105159, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-883.5596272565472, -986.8300795746005, -890.7889536123939, -1196.1312809703998, -947.3548812362121, -910.8990792104249, -1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984777874252751, "mean_inference_ms": 0.267469423566547, "mean_action_processing_ms": 0.061880382736232364, "mean_env_wait_ms": 1.7676868437884463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002997875213623047, "StateBufferConnector_ms": 0.0018591880798339844, "ViewRequirementAgentConnector_ms": 0.048593997955322266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42360, "num_agent_steps_trained": 42360, "num_env_steps_sampled": 42360, "num_env_steps_trained": 42360, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.21108581704475, "num_env_steps_trained_throughput_per_sec": 66.21108581704475, "timesteps_total": 42360, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 42360, "timers": {"training_iteration_time_ms": 1812.46, "sample_time_ms": 1809.398, "load_time_ms": 0.16, "load_throughput": 750322.719, "learn_time_ms": 2.155, "learn_throughput": 55688.922, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 42360, "num_env_steps_trained": 42360, "num_agent_steps_sampled": 42360, "num_agent_steps_trained": 42360}, "done": false, "episodes_total": 353, "training_iteration": 59, "trial_id": "d3049_00000", "date": "2023-07-24_21-31-39", "timestamp": 1690223499, "time_this_iter_s": 10.876802206039429, "time_total_s": 641.2622685432434, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 641.2622685432434, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 24.925, "ram_util_percent": 77.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.6e-06, "entropy_coeff": 0.1, "policy_entropy": 363.7176208496094, "policy_loss": -146250.203125, "vf_loss": 5143269.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 359.0, "diff_num_grad_updates_vs_sampler_policy": 358.0}}, "num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -928.4961120469582, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985086973315726, "mean_inference_ms": 0.2674324918821013, "mean_action_processing_ms": 0.06187519227366354, "mean_env_wait_ms": 1.766230966152063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002996683120727539, "StateBufferConnector_ms": 0.0018644332885742188, "ViewRequirementAgentConnector_ms": 0.04871487617492676}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -928.4961120469582, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1200.1299229697079, -811.7532246347058, -888.3056048987928, -882.0916427897782, -1174.109344765848, -1132.1369271829858, -726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985086973315726, "mean_inference_ms": 0.2674324918821013, "mean_action_processing_ms": 0.06187519227366354, "mean_env_wait_ms": 1.766230966152063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002996683120727539, "StateBufferConnector_ms": 0.0018644332885742188, "ViewRequirementAgentConnector_ms": 0.04871487617492676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080, "num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.22696948551611, "num_env_steps_trained_throughput_per_sec": 66.22696948551611, "timesteps_total": 43080, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 43080, "timers": {"training_iteration_time_ms": 1813.319, "sample_time_ms": 1810.349, "load_time_ms": 0.151, "load_throughput": 792250.087, "learn_time_ms": 2.09, "learn_throughput": 57422.788, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080}, "done": false, "episodes_total": 359, "training_iteration": 60, "trial_id": "d3049_00000", "date": "2023-07-24_21-31-50", "timestamp": 1690223510, "time_this_iter_s": 10.873861074447632, "time_total_s": 652.136129617691, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 652.136129617691, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 25.160000000000004, "ram_util_percent": 77.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.3e-06, "entropy_coeff": 0.1, "policy_entropy": 363.3638000488281, "policy_loss": -140247.671875, "vf_loss": 4957265.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 364.0}}, "num_env_steps_sampled": 43800, "num_env_steps_trained": 43800, "num_agent_steps_sampled": 43800, "num_agent_steps_trained": 43800}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -920.2887676577097, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985473672901826, "mean_inference_ms": 0.2674010083966865, "mean_action_processing_ms": 0.061870954735669524, "mean_env_wait_ms": 1.7649004381582052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029931068420410156, "StateBufferConnector_ms": 0.0018680095672607422, "ViewRequirementAgentConnector_ms": 0.04882097244262695}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -920.2887676577097, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.867409898278, -931.8335845621534, -983.1182083039766, -821.5393713949821, -829.2123244462078, -943.1095301298791, -836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985473672901826, "mean_inference_ms": 0.2674010083966865, "mean_action_processing_ms": 0.061870954735669524, "mean_env_wait_ms": 1.7649004381582052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029931068420410156, "StateBufferConnector_ms": 0.0018680095672607422, "ViewRequirementAgentConnector_ms": 0.04882097244262695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43800, "num_agent_steps_trained": 43800, "num_env_steps_sampled": 43800, "num_env_steps_trained": 43800, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.18521694037983, "num_env_steps_trained_throughput_per_sec": 66.18521694037983, "timesteps_total": 43800, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 43800, "timers": {"training_iteration_time_ms": 1813.117, "sample_time_ms": 1810.544, "load_time_ms": 0.149, "load_throughput": 802737.608, "learn_time_ms": 1.876, "learn_throughput": 63969.253, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 43800, "num_env_steps_trained": 43800, "num_agent_steps_sampled": 43800, "num_agent_steps_trained": 43800}, "done": false, "episodes_total": 365, "training_iteration": 61, "trial_id": "d3049_00000", "date": "2023-07-24_21-32-01", "timestamp": 1690223521, "time_this_iter_s": 10.880640029907227, "time_total_s": 663.0167696475983, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 663.0167696475983, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 24.275000000000002, "ram_util_percent": 77.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.000000000000001e-06, "entropy_coeff": 0.1, "policy_entropy": 363.1971435546875, "policy_loss": -131704.296875, "vf_loss": 4300321.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 371.0, "diff_num_grad_updates_vs_sampler_policy": 370.0}}, "num_env_steps_sampled": 44520, "num_env_steps_trained": 44520, "num_agent_steps_sampled": 44520, "num_agent_steps_trained": 44520}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -921.7145402886907, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98586260588872, "mean_inference_ms": 0.26737502013008196, "mean_action_processing_ms": 0.06186726145687457, "mean_env_wait_ms": 1.7636249848129284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030062198638916016, "StateBufferConnector_ms": 0.001886129379272461, "ViewRequirementAgentConnector_ms": 0.0488896369934082}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -921.7145402886907, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-836.7206063494082, -869.7536146688766, -869.6194447366036, -804.3873174056966, -873.8326934202607, -1014.3913884544614, -1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98586260588872, "mean_inference_ms": 0.26737502013008196, "mean_action_processing_ms": 0.06186726145687457, "mean_env_wait_ms": 1.7636249848129284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030062198638916016, "StateBufferConnector_ms": 0.001886129379272461, "ViewRequirementAgentConnector_ms": 0.0488896369934082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44520, "num_agent_steps_trained": 44520, "num_env_steps_sampled": 44520, "num_env_steps_trained": 44520, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.82447832509767, "num_env_steps_trained_throughput_per_sec": 66.82447832509767, "timesteps_total": 44520, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 44520, "timers": {"training_iteration_time_ms": 1805.416, "sample_time_ms": 1802.817, "load_time_ms": 0.15, "load_throughput": 799422.618, "learn_time_ms": 1.907, "learn_throughput": 62938.162, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 44520, "num_env_steps_trained": 44520, "num_agent_steps_sampled": 44520, "num_agent_steps_trained": 44520}, "done": false, "episodes_total": 371, "training_iteration": 62, "trial_id": "d3049_00000", "date": "2023-07-24_21-32-12", "timestamp": 1690223532, "time_this_iter_s": 10.776659965515137, "time_total_s": 673.7934296131134, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 673.7934296131134, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 22.839999999999996, "ram_util_percent": 77.64000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.7e-06, "entropy_coeff": 0.1, "policy_entropy": 363.146728515625, "policy_loss": -137704.0, "vf_loss": 4857332.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 377.0, "diff_num_grad_updates_vs_sampler_policy": 376.0}}, "num_env_steps_sampled": 45240, "num_env_steps_trained": 45240, "num_agent_steps_sampled": 45240, "num_agent_steps_trained": 45240}, "sampler_results": {"episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -920.7628288154743, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986258722898903, "mean_inference_ms": 0.2673559133782827, "mean_action_processing_ms": 0.06186411622412652, "mean_env_wait_ms": 1.7624011166649902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030012130737304688, "StateBufferConnector_ms": 0.0018815994262695312, "ViewRequirementAgentConnector_ms": 0.04881453514099121}}, "episode_reward_max": -560.2942266599451, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -920.7628288154743, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1103.9400502171113, -560.2942266599451, -1093.985780655231, -750.9099545357619, -1016.2193939758827, -1099.1682594173276, -680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986258722898903, "mean_inference_ms": 0.2673559133782827, "mean_action_processing_ms": 0.06186411622412652, "mean_env_wait_ms": 1.7624011166649902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030012130737304688, "StateBufferConnector_ms": 0.0018815994262695312, "ViewRequirementAgentConnector_ms": 0.04881453514099121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45240, "num_agent_steps_trained": 45240, "num_env_steps_sampled": 45240, "num_env_steps_trained": 45240, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.71310555022802, "num_env_steps_trained_throughput_per_sec": 66.71310555022802, "timesteps_total": 45240, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 45240, "timers": {"training_iteration_time_ms": 1797.958, "sample_time_ms": 1795.348, "load_time_ms": 0.15, "load_throughput": 801714.686, "learn_time_ms": 1.907, "learn_throughput": 62916.133, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 45240, "num_env_steps_trained": 45240, "num_agent_steps_sampled": 45240, "num_agent_steps_trained": 45240}, "done": false, "episodes_total": 377, "training_iteration": 63, "trial_id": "d3049_00000", "date": "2023-07-24_21-32-22", "timestamp": 1690223542, "time_this_iter_s": 10.794518947601318, "time_total_s": 684.5879485607147, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 684.5879485607147, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 23.856250000000003, "ram_util_percent": 77.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.4000000000000005e-06, "entropy_coeff": 0.1, "policy_entropy": 363.2257995605469, "policy_loss": -184040.609375, "vf_loss": 9752247.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 382.0}}, "num_env_steps_sampled": 45960, "num_env_steps_trained": 45960, "num_agent_steps_sampled": 45960, "num_agent_steps_trained": 45960}, "sampler_results": {"episode_reward_max": -644.998541963221, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -923.6990168882631, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986767017419085, "mean_inference_ms": 0.2673387230032842, "mean_action_processing_ms": 0.06186103350564513, "mean_env_wait_ms": 1.761231859392826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030226707458496094, "StateBufferConnector_ms": 0.0019114017486572266, "ViewRequirementAgentConnector_ms": 0.04909849166870117}}, "episode_reward_max": -644.998541963221, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -923.6990168882631, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-680.4104567064217, -936.4746386284654, -960.0883007082513, -1313.3089421409284, -1080.9906170612342, -1058.1788738621954, -1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986767017419085, "mean_inference_ms": 0.2673387230032842, "mean_action_processing_ms": 0.06186103350564513, "mean_env_wait_ms": 1.761231859392826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030226707458496094, "StateBufferConnector_ms": 0.0019114017486572266, "ViewRequirementAgentConnector_ms": 0.04909849166870117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45960, "num_agent_steps_trained": 45960, "num_env_steps_sampled": 45960, "num_env_steps_trained": 45960, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.31372413304858, "num_env_steps_trained_throughput_per_sec": 66.31372413304858, "timesteps_total": 45960, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 45960, "timers": {"training_iteration_time_ms": 1803.681, "sample_time_ms": 1801.024, "load_time_ms": 0.152, "load_throughput": 788403.008, "learn_time_ms": 1.954, "learn_throughput": 61421.256, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 45960, "num_env_steps_trained": 45960, "num_agent_steps_sampled": 45960, "num_agent_steps_trained": 45960}, "done": false, "episodes_total": 383, "training_iteration": 64, "trial_id": "d3049_00000", "date": "2023-07-24_21-32-33", "timestamp": 1690223553, "time_this_iter_s": 10.859718084335327, "time_total_s": 695.44766664505, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 695.44766664505, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 26.779999999999998, "ram_util_percent": 78.17333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1e-06, "entropy_coeff": 0.1, "policy_entropy": 363.39581298828125, "policy_loss": -162017.90625, "vf_loss": 6554693.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 389.0, "diff_num_grad_updates_vs_sampler_policy": 388.0}}, "num_env_steps_sampled": 46680, "num_env_steps_trained": 46680, "num_agent_steps_sampled": 46680, "num_agent_steps_trained": 46680}, "sampler_results": {"episode_reward_max": -644.998541963221, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -920.4464397564636, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987284510181608, "mean_inference_ms": 0.26731645582049807, "mean_action_processing_ms": 0.061856997513637414, "mean_env_wait_ms": 1.7600783612282427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002946615219116211, "StateBufferConnector_ms": 0.0018765926361083984, "ViewRequirementAgentConnector_ms": 0.04818224906921387}}, "episode_reward_max": -644.998541963221, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -920.4464397564636, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1021.0133024238135, -1130.0326372663335, -918.9649465976966, -1141.2153903349297, -1036.9669531008367, -1015.3594342441528, -1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987284510181608, "mean_inference_ms": 0.26731645582049807, "mean_action_processing_ms": 0.061856997513637414, "mean_env_wait_ms": 1.7600783612282427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002946615219116211, "StateBufferConnector_ms": 0.0018765926361083984, "ViewRequirementAgentConnector_ms": 0.04818224906921387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46680, "num_agent_steps_trained": 46680, "num_env_steps_sampled": 46680, "num_env_steps_trained": 46680, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.67566921375516, "num_env_steps_trained_throughput_per_sec": 66.67566921375516, "timesteps_total": 46680, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 46680, "timers": {"training_iteration_time_ms": 1800.762, "sample_time_ms": 1798.134, "load_time_ms": 0.153, "load_throughput": 783737.901, "learn_time_ms": 1.925, "learn_throughput": 62337.162, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 46680, "num_env_steps_trained": 46680, "num_agent_steps_sampled": 46680, "num_agent_steps_trained": 46680}, "done": false, "episodes_total": 389, "training_iteration": 65, "trial_id": "d3049_00000", "date": "2023-07-24_21-32-44", "timestamp": 1690223564, "time_this_iter_s": 10.800581932067871, "time_total_s": 706.2482485771179, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 706.2482485771179, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 23.52, "ram_util_percent": 78.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8000000000000003e-06, "entropy_coeff": 0.1, "policy_entropy": 363.4773864746094, "policy_loss": -154060.359375, "vf_loss": 5842087.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 395.0, "diff_num_grad_updates_vs_sampler_policy": 394.0}}, "num_env_steps_sampled": 47400, "num_env_steps_trained": 47400, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47400}, "sampler_results": {"episode_reward_max": -644.998541963221, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -915.700959491936, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987785718426467, "mean_inference_ms": 0.26729640080864675, "mean_action_processing_ms": 0.06185326154572815, "mean_env_wait_ms": 1.7589405483684077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002930879592895508, "StateBufferConnector_ms": 0.0018846988677978516, "ViewRequirementAgentConnector_ms": 0.04787397384643555}}, "episode_reward_max": -644.998541963221, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -915.700959491936, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1007.0258289736433, -862.6477422227598, -1070.1462372436422, -982.9509726372415, -874.968969525825, -712.2005844629302, -969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987785718426467, "mean_inference_ms": 0.26729640080864675, "mean_action_processing_ms": 0.06185326154572815, "mean_env_wait_ms": 1.7589405483684077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002930879592895508, "StateBufferConnector_ms": 0.0018846988677978516, "ViewRequirementAgentConnector_ms": 0.04787397384643555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47400, "num_env_steps_sampled": 47400, "num_env_steps_trained": 47400, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.65586481773292, "num_env_steps_trained_throughput_per_sec": 66.65586481773292, "timesteps_total": 47400, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 47400, "timers": {"training_iteration_time_ms": 1801.326, "sample_time_ms": 1798.754, "load_time_ms": 0.15, "load_throughput": 801714.686, "learn_time_ms": 1.878, "learn_throughput": 63892.109, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 47400, "num_env_steps_trained": 47400, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47400}, "done": false, "episodes_total": 395, "training_iteration": 66, "trial_id": "d3049_00000", "date": "2023-07-24_21-32-55", "timestamp": 1690223575, "time_this_iter_s": 10.803930044174194, "time_total_s": 717.0521786212921, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 717.0521786212921, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 24.106250000000003, "ram_util_percent": 78.39375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.1, "policy_entropy": 363.4646911621094, "policy_loss": -171235.203125, "vf_loss": 7691706.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 400.0}}, "num_env_steps_sampled": 48120, "num_env_steps_trained": 48120, "num_agent_steps_sampled": 48120, "num_agent_steps_trained": 48120}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -912.7137055001017, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988328570021586, "mean_inference_ms": 0.2672720696539896, "mean_action_processing_ms": 0.06184917902457596, "mean_env_wait_ms": 1.7578442756477972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029175281524658203, "StateBufferConnector_ms": 0.00188446044921875, "ViewRequirementAgentConnector_ms": 0.047782182693481445}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -912.7137055001017, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-969.8648896883888, -982.1924960961293, -990.5015954479423, -971.3329286509871, -819.9959370795575, -751.0233085618731, -1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988328570021586, "mean_inference_ms": 0.2672720696539896, "mean_action_processing_ms": 0.06184917902457596, "mean_env_wait_ms": 1.7578442756477972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029175281524658203, "StateBufferConnector_ms": 0.00188446044921875, "ViewRequirementAgentConnector_ms": 0.047782182693481445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48120, "num_agent_steps_trained": 48120, "num_env_steps_sampled": 48120, "num_env_steps_trained": 48120, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.41286601916792, "num_env_steps_trained_throughput_per_sec": 66.41286601916792, "timesteps_total": 48120, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 48120, "timers": {"training_iteration_time_ms": 1799.687, "sample_time_ms": 1797.117, "load_time_ms": 0.147, "load_throughput": 813769.572, "learn_time_ms": 1.872, "learn_throughput": 64103.683, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 48120, "num_env_steps_trained": 48120, "num_agent_steps_sampled": 48120, "num_agent_steps_trained": 48120}, "done": false, "episodes_total": 401, "training_iteration": 67, "trial_id": "d3049_00000", "date": "2023-07-24_21-33-06", "timestamp": 1690223586, "time_this_iter_s": 10.84352731704712, "time_total_s": 727.8957059383392, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 727.8957059383392, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 23.09333333333333, "ram_util_percent": 78.30666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3200000000000002e-06, "entropy_coeff": 0.1, "policy_entropy": 363.4581604003906, "policy_loss": -196677.609375, "vf_loss": 9117472.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 407.0, "diff_num_grad_updates_vs_sampler_policy": 406.0}}, "num_env_steps_sampled": 48840, "num_env_steps_trained": 48840, "num_agent_steps_sampled": 48840, "num_agent_steps_trained": 48840}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -912.9252454064734, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988786592636918, "mean_inference_ms": 0.2672414072236143, "mean_action_processing_ms": 0.0618444937453307, "mean_env_wait_ms": 1.7567700333376626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002912759780883789, "StateBufferConnector_ms": 0.0018935203552246094, "ViewRequirementAgentConnector_ms": 0.04784893989562988}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -912.9252454064734, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1053.931116170246, -941.5457758196152, -862.3075773984004, -894.7154980012533, -753.4201955901207, -967.8056022465773, -1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988786592636918, "mean_inference_ms": 0.2672414072236143, "mean_action_processing_ms": 0.0618444937453307, "mean_env_wait_ms": 1.7567700333376626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002912759780883789, "StateBufferConnector_ms": 0.0018935203552246094, "ViewRequirementAgentConnector_ms": 0.04784893989562988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48840, "num_agent_steps_trained": 48840, "num_env_steps_sampled": 48840, "num_env_steps_trained": 48840, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.68990909905187, "num_env_steps_trained_throughput_per_sec": 66.68990909905187, "timesteps_total": 48840, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 48840, "timers": {"training_iteration_time_ms": 1800.122, "sample_time_ms": 1797.539, "load_time_ms": 0.149, "load_throughput": 806080.205, "learn_time_ms": 1.88, "learn_throughput": 63842.673, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 48840, "num_env_steps_trained": 48840, "num_agent_steps_sampled": 48840, "num_agent_steps_trained": 48840}, "done": false, "episodes_total": 407, "training_iteration": 68, "trial_id": "d3049_00000", "date": "2023-07-24_21-33-17", "timestamp": 1690223597, "time_this_iter_s": 10.798522233963013, "time_total_s": 738.6942281723022, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 738.6942281723022, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 22.05333333333333, "ram_util_percent": 78.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1400000000000003e-06, "entropy_coeff": 0.1, "policy_entropy": 363.37615966796875, "policy_loss": -174672.84375, "vf_loss": 6806464.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 412.0}}, "num_env_steps_sampled": 49560, "num_env_steps_trained": 49560, "num_agent_steps_sampled": 49560, "num_agent_steps_trained": 49560}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -914.7505693550745, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988998606029162, "mean_inference_ms": 0.26720870306072636, "mean_action_processing_ms": 0.06183925578017238, "mean_env_wait_ms": 1.7557034022006701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029180049896240234, "StateBufferConnector_ms": 0.0018856525421142578, "ViewRequirementAgentConnector_ms": 0.04782867431640625}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -914.7505693550745, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1020.007862484877, -882.7512556592135, -875.2267570290353, -933.0722576502278, -830.9709262867443, -877.6201570717925, -1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988998606029162, "mean_inference_ms": 0.26720870306072636, "mean_action_processing_ms": 0.06183925578017238, "mean_env_wait_ms": 1.7557034022006701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029180049896240234, "StateBufferConnector_ms": 0.0018856525421142578, "ViewRequirementAgentConnector_ms": 0.04782867431640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49560, "num_agent_steps_trained": 49560, "num_env_steps_sampled": 49560, "num_env_steps_trained": 49560, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.74012481042242, "num_env_steps_trained_throughput_per_sec": 66.74012481042242, "timesteps_total": 49560, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 49560, "timers": {"training_iteration_time_ms": 1800.855, "sample_time_ms": 1798.248, "load_time_ms": 0.149, "load_throughput": 804148.394, "learn_time_ms": 1.891, "learn_throughput": 63465.12, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 49560, "num_env_steps_trained": 49560, "num_agent_steps_sampled": 49560, "num_agent_steps_trained": 49560}, "done": false, "episodes_total": 413, "training_iteration": 69, "trial_id": "d3049_00000", "date": "2023-07-24_21-33-27", "timestamp": 1690223607, "time_this_iter_s": 10.790150880813599, "time_total_s": 749.4843790531158, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 749.4843790531158, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 25.5, "ram_util_percent": 78.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9600000000000003e-06, "entropy_coeff": 0.1, "policy_entropy": 363.31689453125, "policy_loss": -145512.984375, "vf_loss": 5106227.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 418.0}}, "num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -912.4805958708406, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.989143447203505, "mean_inference_ms": 0.26718456530971635, "mean_action_processing_ms": 0.061835388021183275, "mean_env_wait_ms": 1.754690268422421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002933025360107422, "StateBufferConnector_ms": 0.0018849372863769531, "ViewRequirementAgentConnector_ms": 0.048000335693359375}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -912.4805958708406, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1072.4685168965907, -700.7489696486724, -948.5718947440762, -986.0718909884522, -921.671979920915, -853.8597049931591, -950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.989143447203505, "mean_inference_ms": 0.26718456530971635, "mean_action_processing_ms": 0.061835388021183275, "mean_env_wait_ms": 1.754690268422421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002933025360107422, "StateBufferConnector_ms": 0.0018849372863769531, "ViewRequirementAgentConnector_ms": 0.048000335693359375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280, "num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.25127074521245, "num_env_steps_trained_throughput_per_sec": 66.25127074521245, "timesteps_total": 50280, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 50280, "timers": {"training_iteration_time_ms": 1805.178, "sample_time_ms": 1802.546, "load_time_ms": 0.151, "load_throughput": 792374.811, "learn_time_ms": 1.907, "learn_throughput": 62912.987, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280}, "done": false, "episodes_total": 419, "training_iteration": 70, "trial_id": "d3049_00000", "date": "2023-07-24_21-33-38", "timestamp": 1690223618, "time_this_iter_s": 10.870115041732788, "time_total_s": 760.3544940948486, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 760.3544940948486, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 25.973333333333333, "ram_util_percent": 78.37999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7800000000000001e-06, "entropy_coeff": 0.1, "policy_entropy": 363.34222412109375, "policy_loss": -205367.625, "vf_loss": 10344437.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 425.0, "diff_num_grad_updates_vs_sampler_policy": 424.0}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 51000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 51000}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -915.5539873972459, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.989188453856041, "mean_inference_ms": 0.2671567315459089, "mean_action_processing_ms": 0.061831145944462866, "mean_env_wait_ms": 1.7536448658837864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002862691879272461, "StateBufferConnector_ms": 0.0018758773803710938, "ViewRequirementAgentConnector_ms": 0.04777026176452637}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -915.5539873972459, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-950.684713000739, -831.1514718197865, -982.4167523787517, -875.6128645847266, -838.1233414228076, -1008.7264793300945, -863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.989188453856041, "mean_inference_ms": 0.2671567315459089, "mean_action_processing_ms": 0.061831145944462866, "mean_env_wait_ms": 1.7536448658837864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002862691879272461, "StateBufferConnector_ms": 0.0018758773803710938, "ViewRequirementAgentConnector_ms": 0.04777026176452637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 51000, "num_env_steps_sampled": 51000, "num_env_steps_trained": 51000, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.78195889101085, "num_env_steps_trained_throughput_per_sec": 66.78195889101085, "timesteps_total": 51000, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 1800.672, "sample_time_ms": 1798.036, "load_time_ms": 0.155, "load_throughput": 773381.192, "learn_time_ms": 1.918, "learn_throughput": 62565.756, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 51000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 51000}, "done": false, "episodes_total": 425, "training_iteration": 71, "trial_id": "d3049_00000", "date": "2023-07-24_21-33-49", "timestamp": 1690223629, "time_this_iter_s": 10.78422498703003, "time_total_s": 771.1387190818787, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 771.1387190818787, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 26.013333333333335, "ram_util_percent": 78.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6000000000000001e-06, "entropy_coeff": 0.1, "policy_entropy": 363.3291015625, "policy_loss": -228965.125, "vf_loss": 13212915.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 431.0, "diff_num_grad_updates_vs_sampler_policy": 430.0}}, "num_env_steps_sampled": 51720, "num_env_steps_trained": 51720, "num_agent_steps_sampled": 51720, "num_agent_steps_trained": 51720}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -918.2547519449388, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.989051204049343, "mean_inference_ms": 0.2671248751995383, "mean_action_processing_ms": 0.06182632620258387, "mean_env_wait_ms": 1.7526195649857055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028486251831054688, "StateBufferConnector_ms": 0.0018703937530517578, "ViewRequirementAgentConnector_ms": 0.0476226806640625}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1343.5184751179374, "episode_reward_mean": -918.2547519449388, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-863.5520528850191, -871.6256402983455, -686.1201846607231, -1343.5184751179374, -870.6238619885146, -765.292437382873, -1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.989051204049343, "mean_inference_ms": 0.2671248751995383, "mean_action_processing_ms": 0.06182632620258387, "mean_env_wait_ms": 1.7526195649857055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028486251831054688, "StateBufferConnector_ms": 0.0018703937530517578, "ViewRequirementAgentConnector_ms": 0.0476226806640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51720, "num_agent_steps_trained": 51720, "num_env_steps_sampled": 51720, "num_env_steps_trained": 51720, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.38681007313323, "num_env_steps_trained_throughput_per_sec": 66.38681007313323, "timesteps_total": 51720, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 51720, "timers": {"training_iteration_time_ms": 1804.921, "sample_time_ms": 1802.289, "load_time_ms": 0.154, "load_throughput": 776962.766, "learn_time_ms": 1.917, "learn_throughput": 62596.881, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 51720, "num_env_steps_trained": 51720, "num_agent_steps_sampled": 51720, "num_agent_steps_trained": 51720}, "done": false, "episodes_total": 431, "training_iteration": 72, "trial_id": "d3049_00000", "date": "2023-07-24_21-34-00", "timestamp": 1690223640, "time_this_iter_s": 10.847584009170532, "time_total_s": 781.9863030910492, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 781.9863030910492, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.56875, "ram_util_percent": 78.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4200000000000002e-06, "entropy_coeff": 0.1, "policy_entropy": 363.3350524902344, "policy_loss": -145649.125, "vf_loss": 5155778.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 437.0, "diff_num_grad_updates_vs_sampler_policy": 436.0}}, "num_env_steps_sampled": 52440, "num_env_steps_trained": 52440, "num_agent_steps_sampled": 52440, "num_agent_steps_trained": 52440}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -913.3052142292294, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98883080985525, "mean_inference_ms": 0.26708956220184327, "mean_action_processing_ms": 0.061820936847001934, "mean_env_wait_ms": 1.7516091026879794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028619766235351562, "StateBufferConnector_ms": 0.001875162124633789, "ViewRequirementAgentConnector_ms": 0.047766923904418945}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -913.3052142292294, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1038.7991452904828, -951.8512591779723, -948.583588885756, -644.998541963221, -1073.9185439657965, -853.6421673292145, -911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98883080985525, "mean_inference_ms": 0.26708956220184327, "mean_action_processing_ms": 0.061820936847001934, "mean_env_wait_ms": 1.7516091026879794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028619766235351562, "StateBufferConnector_ms": 0.001875162124633789, "ViewRequirementAgentConnector_ms": 0.047766923904418945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52440, "num_agent_steps_trained": 52440, "num_env_steps_sampled": 52440, "num_env_steps_trained": 52440, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.45663788044288, "num_env_steps_trained_throughput_per_sec": 66.45663788044288, "timesteps_total": 52440, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 52440, "timers": {"training_iteration_time_ms": 1806.132, "sample_time_ms": 1803.512, "load_time_ms": 0.151, "load_throughput": 794501.152, "learn_time_ms": 1.908, "learn_throughput": 62876.834, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 52440, "num_env_steps_trained": 52440, "num_agent_steps_sampled": 52440, "num_agent_steps_trained": 52440}, "done": false, "episodes_total": 437, "training_iteration": 73, "trial_id": "d3049_00000", "date": "2023-07-24_21-34-11", "timestamp": 1690223651, "time_this_iter_s": 10.836230039596558, "time_total_s": 792.8225331306458, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 792.8225331306458, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 23.353333333333335, "ram_util_percent": 77.82666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.24e-06, "entropy_coeff": 0.1, "policy_entropy": 363.2823181152344, "policy_loss": -163525.53125, "vf_loss": 6520970.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 442.0}}, "num_env_steps_sampled": 53160, "num_env_steps_trained": 53160, "num_agent_steps_sampled": 53160, "num_agent_steps_trained": 53160}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -915.5468590777117, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988511857895428, "mean_inference_ms": 0.2670499488583348, "mean_action_processing_ms": 0.061814927122848, "mean_env_wait_ms": 1.75058525682352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028731822967529297, "StateBufferConnector_ms": 0.0018889904022216797, "ViewRequirementAgentConnector_ms": 0.04795503616333008}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -915.5468590777117, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-911.5659947881537, -1107.2436685019788, -727.4557723587999, -801.1593237096757, -1072.26431355082, -911.2621187541687, -774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988511857895428, "mean_inference_ms": 0.2670499488583348, "mean_action_processing_ms": 0.061814927122848, "mean_env_wait_ms": 1.75058525682352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028731822967529297, "StateBufferConnector_ms": 0.0018889904022216797, "ViewRequirementAgentConnector_ms": 0.04795503616333008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53160, "num_agent_steps_trained": 53160, "num_env_steps_sampled": 53160, "num_env_steps_trained": 53160, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 67.00457510133117, "num_env_steps_trained_throughput_per_sec": 67.00457510133117, "timesteps_total": 53160, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 53160, "timers": {"training_iteration_time_ms": 1795.898, "sample_time_ms": 1793.301, "load_time_ms": 0.149, "load_throughput": 806726.206, "learn_time_ms": 1.898, "learn_throughput": 63228.331, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 53160, "num_env_steps_trained": 53160, "num_agent_steps_sampled": 53160, "num_agent_steps_trained": 53160}, "done": false, "episodes_total": 443, "training_iteration": 74, "trial_id": "d3049_00000", "date": "2023-07-24_21-34-22", "timestamp": 1690223662, "time_this_iter_s": 10.74756908416748, "time_total_s": 803.5701022148132, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 803.5701022148132, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 22.613333333333333, "ram_util_percent": 78.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.06e-06, "entropy_coeff": 0.1, "policy_entropy": 363.17559814453125, "policy_loss": -135584.09375, "vf_loss": 4781916.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 449.0, "diff_num_grad_updates_vs_sampler_policy": 448.0}}, "num_env_steps_sampled": 53880, "num_env_steps_trained": 53880, "num_agent_steps_sampled": 53880, "num_agent_steps_trained": 53880}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -910.4963581963877, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988296457484875, "mean_inference_ms": 0.2670049099742682, "mean_action_processing_ms": 0.061807836609533186, "mean_env_wait_ms": 1.7495641698523627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028662681579589844, "StateBufferConnector_ms": 0.001894235610961914, "ViewRequirementAgentConnector_ms": 0.0480196475982666}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -910.4963581963877, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-774.6833434083712, -946.0253145181013, -865.6832579473, -973.2626514308745, -747.2262323802854, -963.2507018359869, -944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988296457484875, "mean_inference_ms": 0.2670049099742682, "mean_action_processing_ms": 0.061807836609533186, "mean_env_wait_ms": 1.7495641698523627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028662681579589844, "StateBufferConnector_ms": 0.001894235610961914, "ViewRequirementAgentConnector_ms": 0.0480196475982666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53880, "num_agent_steps_trained": 53880, "num_env_steps_sampled": 53880, "num_env_steps_trained": 53880, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.87413387337389, "num_env_steps_trained_throughput_per_sec": 65.87413387337389, "timesteps_total": 53880, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 53880, "timers": {"training_iteration_time_ms": 1810.178, "sample_time_ms": 1807.597, "load_time_ms": 0.145, "load_throughput": 826192.515, "learn_time_ms": 1.876, "learn_throughput": 63979.011, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 53880, "num_env_steps_trained": 53880, "num_agent_steps_sampled": 53880, "num_agent_steps_trained": 53880}, "done": false, "episodes_total": 449, "training_iteration": 75, "trial_id": "d3049_00000", "date": "2023-07-24_21-34-33", "timestamp": 1690223673, "time_this_iter_s": 10.93209719657898, "time_total_s": 814.5021994113922, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 814.5021994113922, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 24.5625, "ram_util_percent": 78.38125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.8e-07, "entropy_coeff": 0.1, "policy_entropy": 363.1105041503906, "policy_loss": -159563.0625, "vf_loss": 6753128.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 454.0}}, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -911.8235470378463, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988001597057178, "mean_inference_ms": 0.26697100086626857, "mean_action_processing_ms": 0.0618024936678601, "mean_env_wait_ms": 1.7485843278239281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028815269470214844, "StateBufferConnector_ms": 0.0018968582153320312, "ViewRequirementAgentConnector_ms": 0.04813385009765625}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -911.8235470378463, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-944.429214319037, -1018.2752560224968, -973.0663177871799, -831.4624531598228, -1010.5308222777169, -721.3977793806338, -1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.988001597057178, "mean_inference_ms": 0.26697100086626857, "mean_action_processing_ms": 0.0618024936678601, "mean_env_wait_ms": 1.7485843278239281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028815269470214844, "StateBufferConnector_ms": 0.0018968582153320312, "ViewRequirementAgentConnector_ms": 0.04813385009765625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.50212960382187, "num_env_steps_trained_throughput_per_sec": 66.50212960382187, "timesteps_total": 54600, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 54600, "timers": {"training_iteration_time_ms": 1812.23, "sample_time_ms": 1809.444, "load_time_ms": 0.148, "load_throughput": 810885.259, "learn_time_ms": 1.948, "learn_throughput": 61595.643, "synch_weights_time_ms": 0.66}, "counters": {"num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600}, "done": false, "episodes_total": 455, "training_iteration": 76, "trial_id": "d3049_00000", "date": "2023-07-24_21-34-43", "timestamp": 1690223683, "time_this_iter_s": 10.828863382339478, "time_total_s": 825.3310627937317, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 825.3310627937317, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 23.666666666666664, "ram_util_percent": 78.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-07, "entropy_coeff": 0.1, "policy_entropy": 363.14056396484375, "policy_loss": -156079.671875, "vf_loss": 5761534.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 461.0, "diff_num_grad_updates_vs_sampler_policy": 460.0}}, "num_env_steps_sampled": 55320, "num_env_steps_trained": 55320, "num_agent_steps_sampled": 55320, "num_agent_steps_trained": 55320}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -912.3828712702046, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987690886042456, "mean_inference_ms": 0.26693209690766523, "mean_action_processing_ms": 0.06179571591689362, "mean_env_wait_ms": 1.7475684820001114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002877950668334961, "StateBufferConnector_ms": 0.0018939971923828125, "ViewRequirementAgentConnector_ms": 0.0480496883392334}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -912.3828712702046, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1064.9664995512471, -864.8856454333405, -779.0504482707386, -826.9610334032957, -1100.5892276438594, -770.6681049056909, -970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987690886042456, "mean_inference_ms": 0.26693209690766523, "mean_action_processing_ms": 0.06179571591689362, "mean_env_wait_ms": 1.7475684820001114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002877950668334961, "StateBufferConnector_ms": 0.0018939971923828125, "ViewRequirementAgentConnector_ms": 0.0480496883392334}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55320, "num_agent_steps_trained": 55320, "num_env_steps_sampled": 55320, "num_env_steps_trained": 55320, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.67399398655503, "num_env_steps_trained_throughput_per_sec": 66.67399398655503, "timesteps_total": 55320, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 55320, "timers": {"training_iteration_time_ms": 1798.979, "sample_time_ms": 1796.193, "load_time_ms": 0.151, "load_throughput": 794250.402, "learn_time_ms": 1.947, "learn_throughput": 61643.925, "synch_weights_time_ms": 0.658}, "counters": {"num_env_steps_sampled": 55320, "num_env_steps_trained": 55320, "num_agent_steps_sampled": 55320, "num_agent_steps_trained": 55320}, "done": false, "episodes_total": 461, "training_iteration": 77, "trial_id": "d3049_00000", "date": "2023-07-24_21-34-54", "timestamp": 1690223694, "time_this_iter_s": 10.80108904838562, "time_total_s": 836.1321518421173, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 836.1321518421173, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 24.566666666666666, "ram_util_percent": 78.52666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.2e-07, "entropy_coeff": 0.1, "policy_entropy": 363.165771484375, "policy_loss": -201040.1875, "vf_loss": 9680487.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 467.0, "diff_num_grad_updates_vs_sampler_policy": 466.0}}, "num_env_steps_sampled": 56040, "num_env_steps_trained": 56040, "num_agent_steps_sampled": 56040, "num_agent_steps_trained": 56040}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -915.5746968442124, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987401512763954, "mean_inference_ms": 0.26688923610360216, "mean_action_processing_ms": 0.06178823673812912, "mean_env_wait_ms": 1.7465540190269226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028772354125976562, "StateBufferConnector_ms": 0.001888275146484375, "ViewRequirementAgentConnector_ms": 0.048012495040893555}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -915.5746968442124, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-970.6716348914985, -831.6975892910069, -1000.0529869877984, -704.5781481137262, -910.9161065780229, -833.750378884446, -921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987401512763954, "mean_inference_ms": 0.26688923610360216, "mean_action_processing_ms": 0.06178823673812912, "mean_env_wait_ms": 1.7465540190269226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028772354125976562, "StateBufferConnector_ms": 0.001888275146484375, "ViewRequirementAgentConnector_ms": 0.048012495040893555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56040, "num_agent_steps_trained": 56040, "num_env_steps_sampled": 56040, "num_env_steps_trained": 56040, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.47124815349015, "num_env_steps_trained_throughput_per_sec": 66.47124815349015, "timesteps_total": 56040, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 56040, "timers": {"training_iteration_time_ms": 1804.564, "sample_time_ms": 1801.91, "load_time_ms": 0.152, "load_throughput": 788526.524, "learn_time_ms": 1.931, "learn_throughput": 62151.649, "synch_weights_time_ms": 0.543}, "counters": {"num_env_steps_sampled": 56040, "num_env_steps_trained": 56040, "num_agent_steps_sampled": 56040, "num_agent_steps_trained": 56040}, "done": false, "episodes_total": 467, "training_iteration": 78, "trial_id": "d3049_00000", "date": "2023-07-24_21-35-05", "timestamp": 1690223705, "time_this_iter_s": 10.833829164505005, "time_total_s": 846.9659810066223, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 846.9659810066223, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 22.90625, "ram_util_percent": 78.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.9e-07, "entropy_coeff": 0.1, "policy_entropy": 363.1807556152344, "policy_loss": -197816.28125, "vf_loss": 9845140.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 56760, "num_env_steps_trained": 56760, "num_agent_steps_sampled": 56760, "num_agent_steps_trained": 56760}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -923.5547085249514, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987120988776205, "mean_inference_ms": 0.266849701745412, "mean_action_processing_ms": 0.06178124848295455, "mean_env_wait_ms": 1.7455852503891751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002933502197265625, "StateBufferConnector_ms": 0.001913309097290039, "ViewRequirementAgentConnector_ms": 0.04849553108215332}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -923.5547085249514, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-921.1467636973784, -818.1234820382398, -882.6264179747, -806.9707685408848, -1047.9088450624336, -855.6501715089079, -992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.987120988776205, "mean_inference_ms": 0.266849701745412, "mean_action_processing_ms": 0.06178124848295455, "mean_env_wait_ms": 1.7455852503891751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002933502197265625, "StateBufferConnector_ms": 0.001913309097290039, "ViewRequirementAgentConnector_ms": 0.04849553108215332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56760, "num_agent_steps_trained": 56760, "num_env_steps_sampled": 56760, "num_env_steps_trained": 56760, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.72552143101075, "num_env_steps_trained_throughput_per_sec": 66.72552143101075, "timesteps_total": 56760, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 56760, "timers": {"training_iteration_time_ms": 1804.538, "sample_time_ms": 1801.809, "load_time_ms": 0.163, "load_throughput": 736812.297, "learn_time_ms": 1.976, "learn_throughput": 60730.538, "synch_weights_time_ms": 0.56}, "counters": {"num_env_steps_sampled": 56760, "num_env_steps_trained": 56760, "num_agent_steps_sampled": 56760, "num_agent_steps_trained": 56760}, "done": false, "episodes_total": 473, "training_iteration": 79, "trial_id": "d3049_00000", "date": "2023-07-24_21-35-16", "timestamp": 1690223716, "time_this_iter_s": 10.792563915252686, "time_total_s": 857.758544921875, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 857.758544921875, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 23.253333333333337, "ram_util_percent": 78.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.6e-07, "entropy_coeff": 0.1, "policy_entropy": 363.1889343261719, "policy_loss": -154427.375, "vf_loss": 5903308.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 479.0, "diff_num_grad_updates_vs_sampler_policy": 478.0}}, "num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -920.1924323942752, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986822548145799, "mean_inference_ms": 0.2668069572314094, "mean_action_processing_ms": 0.0617738433952146, "mean_env_wait_ms": 1.7446358239010504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002914905548095703, "StateBufferConnector_ms": 0.0018951892852783203, "ViewRequirementAgentConnector_ms": 0.04820895195007324}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -920.1924323942752, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-992.1444197067127, -940.2563640104338, -936.6934162068051, -1145.483256244832, -964.080271108806, -973.0719293901501, -1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986822548145799, "mean_inference_ms": 0.2668069572314094, "mean_action_processing_ms": 0.0617738433952146, "mean_env_wait_ms": 1.7446358239010504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002914905548095703, "StateBufferConnector_ms": 0.0018951892852783203, "ViewRequirementAgentConnector_ms": 0.04820895195007324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480, "num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.82228844881865, "num_env_steps_trained_throughput_per_sec": 66.82228844881865, "timesteps_total": 57480, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 57480, "timers": {"training_iteration_time_ms": 1799.106, "sample_time_ms": 1796.446, "load_time_ms": 0.16, "load_throughput": 749317.374, "learn_time_ms": 1.926, "learn_throughput": 62305.524, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480}, "done": false, "episodes_total": 479, "training_iteration": 80, "trial_id": "d3049_00000", "date": "2023-07-24_21-35-27", "timestamp": 1690223727, "time_this_iter_s": 10.77736234664917, "time_total_s": 868.5359072685242, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 868.5359072685242, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 20.540000000000003, "ram_util_percent": 78.25333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.3e-07, "entropy_coeff": 0.1, "policy_entropy": 363.1934814453125, "policy_loss": -165113.96875, "vf_loss": 6897612.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 485.0, "diff_num_grad_updates_vs_sampler_policy": 484.0}}, "num_env_steps_sampled": 58200, "num_env_steps_trained": 58200, "num_agent_steps_sampled": 58200, "num_agent_steps_trained": 58200}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -911.2318428595685, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986534450730682, "mean_inference_ms": 0.2667628220497212, "mean_action_processing_ms": 0.06176634280573195, "mean_env_wait_ms": 1.7437149367617635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002897500991821289, "StateBufferConnector_ms": 0.0018756389617919922, "ViewRequirementAgentConnector_ms": 0.048063039779663086}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -911.2318428595685, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1151.7348170052417, -893.3464123302977, -864.1581041001448, -857.8025819929242, -1110.5117290702472, -993.5601106982429, -826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986534450730682, "mean_inference_ms": 0.2667628220497212, "mean_action_processing_ms": 0.06176634280573195, "mean_env_wait_ms": 1.7437149367617635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002897500991821289, "StateBufferConnector_ms": 0.0018756389617919922, "ViewRequirementAgentConnector_ms": 0.048063039779663086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58200, "num_agent_steps_trained": 58200, "num_env_steps_sampled": 58200, "num_env_steps_trained": 58200, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.40052386930303, "num_env_steps_trained_throughput_per_sec": 66.40052386930303, "timesteps_total": 58200, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 58200, "timers": {"training_iteration_time_ms": 1802.59, "sample_time_ms": 1800.001, "load_time_ms": 0.153, "load_throughput": 782397.762, "learn_time_ms": 1.877, "learn_throughput": 63930.252, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 58200, "num_env_steps_trained": 58200, "num_agent_steps_sampled": 58200, "num_agent_steps_trained": 58200}, "done": false, "episodes_total": 485, "training_iteration": 81, "trial_id": "d3049_00000", "date": "2023-07-24_21-35-38", "timestamp": 1690223738, "time_this_iter_s": 10.845266103744507, "time_total_s": 879.3811733722687, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 879.3811733722687, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.7875, "ram_util_percent": 78.35625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2173156738281, "policy_loss": -159781.96875, "vf_loss": 6533271.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 490.0}}, "num_env_steps_sampled": 58920, "num_env_steps_trained": 58920, "num_agent_steps_sampled": 58920, "num_agent_steps_trained": 58920}, "sampler_results": {"episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -907.8277819245932, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986264547433525, "mean_inference_ms": 0.26672242444593314, "mean_action_processing_ms": 0.06175944031078496, "mean_env_wait_ms": 1.7428453456795823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002896547317504883, "StateBufferConnector_ms": 0.0019016265869140625, "ViewRequirementAgentConnector_ms": 0.04803657531738281}}, "episode_reward_max": -561.5834979460654, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -907.8277819245932, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-826.0687882094566, -1126.8214164958679, -865.1090952173034, -866.9334978238863, -561.5834979460654, -784.613284192176, -766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.986264547433525, "mean_inference_ms": 0.26672242444593314, "mean_action_processing_ms": 0.06175944031078496, "mean_env_wait_ms": 1.7428453456795823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002896547317504883, "StateBufferConnector_ms": 0.0019016265869140625, "ViewRequirementAgentConnector_ms": 0.04803657531738281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58920, "num_agent_steps_trained": 58920, "num_env_steps_sampled": 58920, "num_env_steps_trained": 58920, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.44954131448239, "num_env_steps_trained_throughput_per_sec": 66.44954131448239, "timesteps_total": 58920, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 58920, "timers": {"training_iteration_time_ms": 1806.816, "sample_time_ms": 1804.259, "load_time_ms": 0.149, "load_throughput": 804405.434, "learn_time_ms": 1.854, "learn_throughput": 64721.087, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 58920, "num_env_steps_trained": 58920, "num_agent_steps_sampled": 58920, "num_agent_steps_trained": 58920}, "done": false, "episodes_total": 491, "training_iteration": 82, "trial_id": "d3049_00000", "date": "2023-07-24_21-35-48", "timestamp": 1690223748, "time_this_iter_s": 10.837374925613403, "time_total_s": 890.2185482978821, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 890.2185482978821, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 22.779999999999998, "ram_util_percent": 78.30666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.7e-07, "entropy_coeff": 0.1, "policy_entropy": 363.21624755859375, "policy_loss": -171640.65625, "vf_loss": 7289663.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 497.0, "diff_num_grad_updates_vs_sampler_policy": 496.0}}, "num_env_steps_sampled": 59640, "num_env_steps_trained": 59640, "num_agent_steps_sampled": 59640, "num_agent_steps_trained": 59640}, "sampler_results": {"episode_reward_max": -606.4098574539995, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -911.607309479483, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985968617813812, "mean_inference_ms": 0.2666855010769426, "mean_action_processing_ms": 0.061752903042378925, "mean_env_wait_ms": 1.74203656069602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029129981994628906, "StateBufferConnector_ms": 0.001898050308227539, "ViewRequirementAgentConnector_ms": 0.048331499099731445}}, "episode_reward_max": -606.4098574539995, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -911.607309479483, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-766.9037934323285, -1185.7932577609367, -915.0406442830201, -997.2804582680848, -1110.623572397191, -910.261685951512, -623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985968617813812, "mean_inference_ms": 0.2666855010769426, "mean_action_processing_ms": 0.061752903042378925, "mean_env_wait_ms": 1.74203656069602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029129981994628906, "StateBufferConnector_ms": 0.001898050308227539, "ViewRequirementAgentConnector_ms": 0.048331499099731445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59640, "num_agent_steps_trained": 59640, "num_env_steps_sampled": 59640, "num_env_steps_trained": 59640, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.53407904817301, "num_env_steps_trained_throughput_per_sec": 66.53407904817301, "timesteps_total": 59640, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 59640, "timers": {"training_iteration_time_ms": 1806.285, "sample_time_ms": 1803.689, "load_time_ms": 0.15, "load_throughput": 798915.048, "learn_time_ms": 1.886, "learn_throughput": 63642.471, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 59640, "num_env_steps_trained": 59640, "num_agent_steps_sampled": 59640, "num_agent_steps_trained": 59640}, "done": false, "episodes_total": 497, "training_iteration": 83, "trial_id": "d3049_00000", "date": "2023-07-24_21-35-59", "timestamp": 1690223759, "time_this_iter_s": 10.823637962341309, "time_total_s": 901.0421862602234, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 901.0421862602234, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 23.380000000000003, "ram_util_percent": 78.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.4e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2118835449219, "policy_loss": -93916.5390625, "vf_loss": 2188391.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 502.0}}, "num_env_steps_sampled": 60360, "num_env_steps_trained": 60360, "num_agent_steps_sampled": 60360, "num_agent_steps_trained": 60360}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -900.560695946015, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985759303472465, "mean_inference_ms": 0.2666501198657016, "mean_action_processing_ms": 0.06174684811941377, "mean_env_wait_ms": 1.7412395397298954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002913951873779297, "StateBufferConnector_ms": 0.0019016265869140625, "ViewRequirementAgentConnector_ms": 0.04831504821777344}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1252.1183225821242, "episode_reward_mean": -900.560695946015, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-623.6196176014653, -939.7910936924085, -889.2042444908325, -1032.5649320286361, -860.4578615359434, -1010.2877561811289, -993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985759303472465, "mean_inference_ms": 0.2666501198657016, "mean_action_processing_ms": 0.06174684811941377, "mean_env_wait_ms": 1.7412395397298954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002913951873779297, "StateBufferConnector_ms": 0.0019016265869140625, "ViewRequirementAgentConnector_ms": 0.04831504821777344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60360, "num_agent_steps_trained": 60360, "num_env_steps_sampled": 60360, "num_env_steps_trained": 60360, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.05734266823379, "num_env_steps_trained_throughput_per_sec": 66.05734266823379, "timesteps_total": 60360, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 60360, "timers": {"training_iteration_time_ms": 1812.134, "sample_time_ms": 1809.557, "load_time_ms": 0.151, "load_throughput": 796134.894, "learn_time_ms": 1.851, "learn_throughput": 64823.615, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 60360, "num_env_steps_trained": 60360, "num_agent_steps_sampled": 60360, "num_agent_steps_trained": 60360}, "done": false, "episodes_total": 503, "training_iteration": 84, "trial_id": "d3049_00000", "date": "2023-07-24_21-36-10", "timestamp": 1690223770, "time_this_iter_s": 10.901777029037476, "time_total_s": 911.9439632892609, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 911.9439632892609, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 25.30625, "ram_util_percent": 78.18125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.1e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2138671875, "policy_loss": -223018.90625, "vf_loss": 12195044.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 509.0, "diff_num_grad_updates_vs_sampler_policy": 508.0}}, "num_env_steps_sampled": 61080, "num_env_steps_trained": 61080, "num_agent_steps_sampled": 61080, "num_agent_steps_trained": 61080}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -914.3295989694317, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985751219375846, "mean_inference_ms": 0.26661923100933493, "mean_action_processing_ms": 0.06174141124696805, "mean_env_wait_ms": 1.7404778689996419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029091835021972656, "StateBufferConnector_ms": 0.001894235610961914, "ViewRequirementAgentConnector_ms": 0.048192501068115234}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -914.3295989694317, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-993.7641850514092, -981.4761657791776, -897.6230949111961, -912.6490966274439, -926.0886307216982, -910.5724883165341, -821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985751219375846, "mean_inference_ms": 0.26661923100933493, "mean_action_processing_ms": 0.06174141124696805, "mean_env_wait_ms": 1.7404778689996419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029091835021972656, "StateBufferConnector_ms": 0.001894235610961914, "ViewRequirementAgentConnector_ms": 0.048192501068115234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61080, "num_agent_steps_trained": 61080, "num_env_steps_sampled": 61080, "num_env_steps_trained": 61080, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.42940459501396, "num_env_steps_trained_throughput_per_sec": 65.42940459501396, "timesteps_total": 61080, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 61080, "timers": {"training_iteration_time_ms": 1824.631, "sample_time_ms": 1822.018, "load_time_ms": 0.148, "load_throughput": 808151.06, "learn_time_ms": 1.907, "learn_throughput": 62919.279, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 61080, "num_env_steps_trained": 61080, "num_agent_steps_sampled": 61080, "num_agent_steps_trained": 61080}, "done": false, "episodes_total": 509, "training_iteration": 85, "trial_id": "d3049_00000", "date": "2023-07-24_21-36-21", "timestamp": 1690223781, "time_this_iter_s": 11.006484270095825, "time_total_s": 922.9504475593567, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 922.9504475593567, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 28.07333333333333, "ram_util_percent": 78.15333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.800000000000001e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2431945800781, "policy_loss": -197527.203125, "vf_loss": 9757003.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 515.0, "diff_num_grad_updates_vs_sampler_policy": 514.0}}, "num_env_steps_sampled": 61800, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 61800, "num_agent_steps_trained": 61800}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -910.4502724997667, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985771213201893, "mean_inference_ms": 0.2665872182163133, "mean_action_processing_ms": 0.06173603308051717, "mean_env_wait_ms": 1.7397401090491014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028908252716064453, "StateBufferConnector_ms": 0.0018939971923828125, "ViewRequirementAgentConnector_ms": 0.04796743392944336}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -910.4502724997667, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-821.3444550795166, -705.9257719749279, -1025.3408960718339, -803.3796255940064, -1073.5052956499412, -1151.6861654902464, -692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985771213201893, "mean_inference_ms": 0.2665872182163133, "mean_action_processing_ms": 0.06173603308051717, "mean_env_wait_ms": 1.7397401090491014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028908252716064453, "StateBufferConnector_ms": 0.0018939971923828125, "ViewRequirementAgentConnector_ms": 0.04796743392944336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61800, "num_agent_steps_trained": 61800, "num_env_steps_sampled": 61800, "num_env_steps_trained": 61800, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.42044852327552, "num_env_steps_trained_throughput_per_sec": 66.42044852327552, "timesteps_total": 61800, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 61800, "timers": {"training_iteration_time_ms": 1812.284, "sample_time_ms": 1809.673, "load_time_ms": 0.149, "load_throughput": 807632.349, "learn_time_ms": 1.915, "learn_throughput": 62669.366, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 61800, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 61800, "num_agent_steps_trained": 61800}, "done": false, "episodes_total": 515, "training_iteration": 86, "trial_id": "d3049_00000", "date": "2023-07-24_21-36-32", "timestamp": 1690223792, "time_this_iter_s": 10.842196941375732, "time_total_s": 933.7926445007324, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 933.7926445007324, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 23.775, "ram_util_percent": 78.48125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.5e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2783203125, "policy_loss": -150457.25, "vf_loss": 5844515.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 521.0, "diff_num_grad_updates_vs_sampler_policy": 520.0}}, "num_env_steps_sampled": 62520, "num_env_steps_trained": 62520, "num_agent_steps_sampled": 62520, "num_agent_steps_trained": 62520}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -907.0665492158406, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98574074605263, "mean_inference_ms": 0.2665490483839148, "mean_action_processing_ms": 0.06172980107842906, "mean_env_wait_ms": 1.7390033428562923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002911806106567383, "StateBufferConnector_ms": 0.0018990039825439453, "ViewRequirementAgentConnector_ms": 0.048200368881225586}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -907.0665492158406, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-692.5517186850652, -864.2666710191718, -808.8239972390296, -1199.8982617489448, -936.5937152187493, -1050.474003484029, -1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98574074605263, "mean_inference_ms": 0.2665490483839148, "mean_action_processing_ms": 0.06172980107842906, "mean_env_wait_ms": 1.7390033428562923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002911806106567383, "StateBufferConnector_ms": 0.0018990039825439453, "ViewRequirementAgentConnector_ms": 0.048200368881225586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62520, "num_agent_steps_trained": 62520, "num_env_steps_sampled": 62520, "num_env_steps_trained": 62520, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.9196657467933, "num_env_steps_trained_throughput_per_sec": 66.9196657467933, "timesteps_total": 62520, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 62520, "timers": {"training_iteration_time_ms": 1795.359, "sample_time_ms": 1792.759, "load_time_ms": 0.148, "load_throughput": 808670.437, "learn_time_ms": 1.906, "learn_throughput": 62951.544, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 62520, "num_env_steps_trained": 62520, "num_agent_steps_sampled": 62520, "num_agent_steps_trained": 62520}, "done": false, "episodes_total": 521, "training_iteration": 87, "trial_id": "d3049_00000", "date": "2023-07-24_21-36-43", "timestamp": 1690223803, "time_this_iter_s": 10.761052131652832, "time_total_s": 944.5536966323853, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 944.5536966323853, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.466666666666665, "ram_util_percent": 77.14000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.2e-07, "entropy_coeff": 0.1, "policy_entropy": 363.33203125, "policy_loss": -188695.875, "vf_loss": 8884993.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 526.0}}, "num_env_steps_sampled": 63240, "num_env_steps_trained": 63240, "num_agent_steps_sampled": 63240, "num_agent_steps_trained": 63240}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -905.0136673593465, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985635609450982, "mean_inference_ms": 0.26651565619044415, "mean_action_processing_ms": 0.06172450415709939, "mean_env_wait_ms": 1.738303022226522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029168128967285156, "StateBufferConnector_ms": 0.0018987655639648438, "ViewRequirementAgentConnector_ms": 0.048295021057128906}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -905.0136673593465, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1045.9369682976326, -714.9437631223009, -756.7253046013324, -1252.1183225821242, -916.8950703867641, -844.1438578796339, -839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985635609450982, "mean_inference_ms": 0.26651565619044415, "mean_action_processing_ms": 0.06172450415709939, "mean_env_wait_ms": 1.738303022226522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029168128967285156, "StateBufferConnector_ms": 0.0018987655639648438, "ViewRequirementAgentConnector_ms": 0.048295021057128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63240, "num_agent_steps_trained": 63240, "num_env_steps_sampled": 63240, "num_env_steps_trained": 63240, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 67.0354973723203, "num_env_steps_trained_throughput_per_sec": 67.0354973723203, "timesteps_total": 63240, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 63240, "timers": {"training_iteration_time_ms": 1793.274, "sample_time_ms": 1790.577, "load_time_ms": 0.152, "load_throughput": 790632.234, "learn_time_ms": 1.958, "learn_throughput": 61285.888, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 63240, "num_env_steps_trained": 63240, "num_agent_steps_sampled": 63240, "num_agent_steps_trained": 63240}, "done": false, "episodes_total": 527, "training_iteration": 88, "trial_id": "d3049_00000", "date": "2023-07-24_21-36-54", "timestamp": 1690223814, "time_this_iter_s": 10.746259927749634, "time_total_s": 955.2999565601349, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 955.2999565601349, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 23.737499999999997, "ram_util_percent": 77.16874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.9e-07, "entropy_coeff": 0.1, "policy_entropy": 363.36883544921875, "policy_loss": -137988.359375, "vf_loss": 4594588.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 532.0}}, "num_env_steps_sampled": 63960, "num_env_steps_trained": 63960, "num_agent_steps_sampled": 63960, "num_agent_steps_trained": 63960}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -905.3593890402118, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.9855061107081, "mean_inference_ms": 0.26648654428843327, "mean_action_processing_ms": 0.061719753732459026, "mean_env_wait_ms": 1.7376231352298959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002914905548095703, "StateBufferConnector_ms": 0.0018897056579589844, "ViewRequirementAgentConnector_ms": 0.04832959175109863}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -905.3593890402118, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-839.8238720190828, -606.4098574539995, -847.6016281525608, -850.9045948704262, -1031.162286463516, -1137.3251205882925, -1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.9855061107081, "mean_inference_ms": 0.26648654428843327, "mean_action_processing_ms": 0.061719753732459026, "mean_env_wait_ms": 1.7376231352298959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002914905548095703, "StateBufferConnector_ms": 0.0018897056579589844, "ViewRequirementAgentConnector_ms": 0.04832959175109863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63960, "num_agent_steps_trained": 63960, "num_env_steps_sampled": 63960, "num_env_steps_trained": 63960, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.52237612314788, "num_env_steps_trained_throughput_per_sec": 66.52237612314788, "timesteps_total": 63960, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 63960, "timers": {"training_iteration_time_ms": 1795.428, "sample_time_ms": 1792.804, "load_time_ms": 0.152, "load_throughput": 787046.88, "learn_time_ms": 1.9, "learn_throughput": 63153.755, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 63960, "num_env_steps_trained": 63960, "num_agent_steps_sampled": 63960, "num_agent_steps_trained": 63960}, "done": false, "episodes_total": 533, "training_iteration": 89, "trial_id": "d3049_00000", "date": "2023-07-24_21-37-04", "timestamp": 1690223824, "time_this_iter_s": 10.825568675994873, "time_total_s": 966.1255252361298, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 966.1255252361298, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 24.000000000000004, "ram_util_percent": 77.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.599999999999999e-07, "entropy_coeff": 0.1, "policy_entropy": 363.3758850097656, "policy_loss": -178348.265625, "vf_loss": 7500311.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 539.0, "diff_num_grad_updates_vs_sampler_policy": 538.0}}, "num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -911.6184352669703, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985333190406719, "mean_inference_ms": 0.26645819907935264, "mean_action_processing_ms": 0.061715058169139976, "mean_env_wait_ms": 1.7369560717039823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002919435501098633, "StateBufferConnector_ms": 0.0018985271453857422, "ViewRequirementAgentConnector_ms": 0.04853558540344238}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -911.6184352669703, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1051.40064446113, -748.663981408491, -857.0018336338088, -910.403864905461, -730.8232221297696, -704.7900405313183, -1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985333190406719, "mean_inference_ms": 0.26645819907935264, "mean_action_processing_ms": 0.061715058169139976, "mean_env_wait_ms": 1.7369560717039823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002919435501098633, "StateBufferConnector_ms": 0.0018985271453857422, "ViewRequirementAgentConnector_ms": 0.04853558540344238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680, "num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 67.0076928072799, "num_env_steps_trained_throughput_per_sec": 67.0076928072799, "timesteps_total": 64680, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 64680, "timers": {"training_iteration_time_ms": 1796.771, "sample_time_ms": 1794.168, "load_time_ms": 0.149, "load_throughput": 807891.621, "learn_time_ms": 1.895, "learn_throughput": 63311.842, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680}, "done": false, "episodes_total": 539, "training_iteration": 90, "trial_id": "d3049_00000", "date": "2023-07-24_21-37-15", "timestamp": 1690223835, "time_this_iter_s": 10.74764895439148, "time_total_s": 976.8731741905212, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 976.8731741905212, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 22.686666666666664, "ram_util_percent": 78.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.3e-07, "entropy_coeff": 0.1, "policy_entropy": 363.37091064453125, "policy_loss": -202215.234375, "vf_loss": 10085718.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 545.0, "diff_num_grad_updates_vs_sampler_policy": 544.0}}, "num_env_steps_sampled": 65400, "num_env_steps_trained": 65400, "num_agent_steps_sampled": 65400, "num_agent_steps_trained": 65400}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -918.2852756744034, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985174409826858, "mean_inference_ms": 0.2664355169956161, "mean_action_processing_ms": 0.06171135833184391, "mean_env_wait_ms": 1.73633187569399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003006458282470703, "StateBufferConnector_ms": 0.001905202865600586, "ViewRequirementAgentConnector_ms": 0.04922223091125488}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -918.2852756744034, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1094.0887963734885, -931.4508483774335, -716.7637333672536, -847.9844627519412, -925.1437906357027, -782.7574376124189, -938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985174409826858, "mean_inference_ms": 0.2664355169956161, "mean_action_processing_ms": 0.06171135833184391, "mean_env_wait_ms": 1.73633187569399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003006458282470703, "StateBufferConnector_ms": 0.001905202865600586, "ViewRequirementAgentConnector_ms": 0.04922223091125488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65400, "num_agent_steps_trained": 65400, "num_env_steps_sampled": 65400, "num_env_steps_trained": 65400, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.3657417184758, "num_env_steps_trained_throughput_per_sec": 66.3657417184758, "timesteps_total": 65400, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 65400, "timers": {"training_iteration_time_ms": 1802.498, "sample_time_ms": 1799.882, "load_time_ms": 0.149, "load_throughput": 805951.129, "learn_time_ms": 1.902, "learn_throughput": 63092.797, "synch_weights_time_ms": 0.537}, "counters": {"num_env_steps_sampled": 65400, "num_env_steps_trained": 65400, "num_agent_steps_sampled": 65400, "num_agent_steps_trained": 65400}, "done": false, "episodes_total": 545, "training_iteration": 91, "trial_id": "d3049_00000", "date": "2023-07-24_21-37-26", "timestamp": 1690223846, "time_this_iter_s": 10.850926160812378, "time_total_s": 987.7241003513336, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 987.7241003513336, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 24.212500000000002, "ram_util_percent": 78.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.1, "policy_entropy": 363.3487243652344, "policy_loss": -187924.078125, "vf_loss": 8221101.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 551.0, "diff_num_grad_updates_vs_sampler_policy": 550.0}}, "num_env_steps_sampled": 66120, "num_env_steps_trained": 66120, "num_agent_steps_sampled": 66120, "num_agent_steps_trained": 66120}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -924.8961184851195, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984974165657967, "mean_inference_ms": 0.2664064519632396, "mean_action_processing_ms": 0.06170689242705693, "mean_env_wait_ms": 1.7357216992456594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030031204223632812, "StateBufferConnector_ms": 0.0019071102142333984, "ViewRequirementAgentConnector_ms": 0.049098968505859375}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -924.8961184851195, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-938.9235921229564, -852.2385525448833, -985.983053459417, -917.8039592913849, -1111.9509077916277, -1142.6465214138623, -818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984974165657967, "mean_inference_ms": 0.2664064519632396, "mean_action_processing_ms": 0.06170689242705693, "mean_env_wait_ms": 1.7357216992456594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030031204223632812, "StateBufferConnector_ms": 0.0019071102142333984, "ViewRequirementAgentConnector_ms": 0.049098968505859375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66120, "num_agent_steps_trained": 66120, "num_env_steps_sampled": 66120, "num_env_steps_trained": 66120, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.37294147429262, "num_env_steps_trained_throughput_per_sec": 66.37294147429262, "timesteps_total": 66120, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 66120, "timers": {"training_iteration_time_ms": 1807.932, "sample_time_ms": 1805.369, "load_time_ms": 0.148, "load_throughput": 810363.033, "learn_time_ms": 1.868, "learn_throughput": 64228.023, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 66120, "num_env_steps_trained": 66120, "num_agent_steps_sampled": 66120, "num_agent_steps_trained": 66120}, "done": false, "episodes_total": 551, "training_iteration": 92, "trial_id": "d3049_00000", "date": "2023-07-24_21-37-37", "timestamp": 1690223857, "time_this_iter_s": 10.849941968917847, "time_total_s": 998.5740423202515, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 998.5740423202515, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 22.95333333333333, "ram_util_percent": 78.66000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.7e-07, "entropy_coeff": 0.1, "policy_entropy": 363.321533203125, "policy_loss": -181092.953125, "vf_loss": 8334967.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 557.0, "diff_num_grad_updates_vs_sampler_policy": 556.0}}, "num_env_steps_sampled": 66840, "num_env_steps_trained": 66840, "num_agent_steps_sampled": 66840, "num_agent_steps_trained": 66840}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -923.222270888073, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984808436352864, "mean_inference_ms": 0.26636749695131884, "mean_action_processing_ms": 0.0617007068749684, "mean_env_wait_ms": 1.7350929328078712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002996683120727539, "StateBufferConnector_ms": 0.0019025802612304688, "ViewRequirementAgentConnector_ms": 0.04899120330810547}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -923.222270888073, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-818.7207522439087, -1009.9517385823641, -612.9148491033371, -858.9094970476124, -945.1714542501879, -924.6597061271879, -1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984808436352864, "mean_inference_ms": 0.26636749695131884, "mean_action_processing_ms": 0.0617007068749684, "mean_env_wait_ms": 1.7350929328078712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002996683120727539, "StateBufferConnector_ms": 0.0019025802612304688, "ViewRequirementAgentConnector_ms": 0.04899120330810547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66840, "num_agent_steps_trained": 66840, "num_env_steps_sampled": 66840, "num_env_steps_trained": 66840, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.71764359885076, "num_env_steps_trained_throughput_per_sec": 66.71764359885076, "timesteps_total": 66840, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 66840, "timers": {"training_iteration_time_ms": 1802.181, "sample_time_ms": 1799.589, "load_time_ms": 0.152, "load_throughput": 791876.149, "learn_time_ms": 1.901, "learn_throughput": 63139.494, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 66840, "num_env_steps_trained": 66840, "num_agent_steps_sampled": 66840, "num_agent_steps_trained": 66840}, "done": false, "episodes_total": 557, "training_iteration": 93, "trial_id": "d3049_00000", "date": "2023-07-24_21-37-48", "timestamp": 1690223868, "time_this_iter_s": 10.793830871582031, "time_total_s": 1009.3678731918335, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1009.3678731918335, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 23.85, "ram_util_percent": 78.54374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.3999999999999997e-07, "entropy_coeff": 0.1, "policy_entropy": 363.30596923828125, "policy_loss": -216661.125, "vf_loss": 10433564.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 562.0}}, "num_env_steps_sampled": 67560, "num_env_steps_trained": 67560, "num_agent_steps_sampled": 67560, "num_agent_steps_trained": 67560}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -925.8264537005167, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984656916434421, "mean_inference_ms": 0.2663296654394554, "mean_action_processing_ms": 0.06169462939635093, "mean_env_wait_ms": 1.734493153915886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029935836791992188, "StateBufferConnector_ms": 0.001890420913696289, "ViewRequirementAgentConnector_ms": 0.04894566535949707}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -925.8264537005167, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1074.5761645427788, -956.2710502768209, -752.6643184996797, -1072.960822912307, -947.1316486788745, -882.9741181646262, -1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984656916434421, "mean_inference_ms": 0.2663296654394554, "mean_action_processing_ms": 0.06169462939635093, "mean_env_wait_ms": 1.734493153915886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029935836791992188, "StateBufferConnector_ms": 0.001890420913696289, "ViewRequirementAgentConnector_ms": 0.04894566535949707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67560, "num_agent_steps_trained": 67560, "num_env_steps_sampled": 67560, "num_env_steps_trained": 67560, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.36599111663662, "num_env_steps_trained_throughput_per_sec": 66.36599111663662, "timesteps_total": 67560, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 67560, "timers": {"training_iteration_time_ms": 1805.534, "sample_time_ms": 1802.365, "load_time_ms": 0.158, "load_throughput": 757778.5, "learn_time_ms": 1.988, "learn_throughput": 60364.898, "synch_weights_time_ms": 0.992}, "counters": {"num_env_steps_sampled": 67560, "num_env_steps_trained": 67560, "num_agent_steps_sampled": 67560, "num_agent_steps_trained": 67560}, "done": false, "episodes_total": 563, "training_iteration": 94, "trial_id": "d3049_00000", "date": "2023-07-24_21-37-59", "timestamp": 1690223879, "time_this_iter_s": 10.856547832489014, "time_total_s": 1020.2244210243225, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1020.2244210243225, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 23.473333333333333, "ram_util_percent": 78.62666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.1e-07, "entropy_coeff": 0.1, "policy_entropy": 363.272705078125, "policy_loss": -179987.71875, "vf_loss": 7814794.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 569.0, "diff_num_grad_updates_vs_sampler_policy": 568.0}}, "num_env_steps_sampled": 68280, "num_env_steps_trained": 68280, "num_agent_steps_sampled": 68280, "num_agent_steps_trained": 68280}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -923.3329582799716, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984503731148184, "mean_inference_ms": 0.26629447793432987, "mean_action_processing_ms": 0.06168911723670793, "mean_env_wait_ms": 1.7338916684099632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029985904693603516, "StateBufferConnector_ms": 0.0018987655639648438, "ViewRequirementAgentConnector_ms": 0.049013614654541016}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -923.3329582799716, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1055.8779644586727, -1076.5544223689585, -1011.0136868341449, -1076.1161723151201, -726.4170819938739, -788.7579008032401, -939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984503731148184, "mean_inference_ms": 0.26629447793432987, "mean_action_processing_ms": 0.06168911723670793, "mean_env_wait_ms": 1.7338916684099632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029985904693603516, "StateBufferConnector_ms": 0.0018987655639648438, "ViewRequirementAgentConnector_ms": 0.049013614654541016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68280, "num_agent_steps_trained": 68280, "num_env_steps_sampled": 68280, "num_env_steps_trained": 68280, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.70507152006047, "num_env_steps_trained_throughput_per_sec": 66.70507152006047, "timesteps_total": 68280, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 68280, "timers": {"training_iteration_time_ms": 1799.373, "sample_time_ms": 1796.69, "load_time_ms": 0.153, "load_throughput": 782762.799, "learn_time_ms": 1.917, "learn_throughput": 62602.331, "synch_weights_time_ms": 0.581}, "counters": {"num_env_steps_sampled": 68280, "num_env_steps_trained": 68280, "num_agent_steps_sampled": 68280, "num_agent_steps_trained": 68280}, "done": false, "episodes_total": 569, "training_iteration": 95, "trial_id": "d3049_00000", "date": "2023-07-24_21-38-09", "timestamp": 1690223889, "time_this_iter_s": 10.795812845230103, "time_total_s": 1031.0202338695526, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1031.0202338695526, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 23.839999999999996, "ram_util_percent": 78.46666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.7999999999999996e-07, "entropy_coeff": 0.1, "policy_entropy": 363.25164794921875, "policy_loss": -123202.875, "vf_loss": 3763593.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 575.0, "diff_num_grad_updates_vs_sampler_policy": 574.0}}, "num_env_steps_sampled": 69000, "num_env_steps_trained": 69000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 69000}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -917.9182472944242, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984434014224664, "mean_inference_ms": 0.2662661412786004, "mean_action_processing_ms": 0.06168498587166261, "mean_env_wait_ms": 1.7333275991985826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002927541732788086, "StateBufferConnector_ms": 0.0018725395202636719, "ViewRequirementAgentConnector_ms": 0.0483858585357666}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -917.9182472944242, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-939.411310405876, -873.5251142233553, -747.6612855091719, -920.426142819394, -1014.0986596147471, -868.4553650839998, -695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984434014224664, "mean_inference_ms": 0.2662661412786004, "mean_action_processing_ms": 0.06168498587166261, "mean_env_wait_ms": 1.7333275991985826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002927541732788086, "StateBufferConnector_ms": 0.0018725395202636719, "ViewRequirementAgentConnector_ms": 0.0483858585357666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 69000, "num_env_steps_sampled": 69000, "num_env_steps_trained": 69000, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.034302470192, "num_env_steps_trained_throughput_per_sec": 66.034302470192, "timesteps_total": 69000, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 69000, "timers": {"training_iteration_time_ms": 1810.195, "sample_time_ms": 1807.627, "load_time_ms": 0.15, "load_throughput": 800312.419, "learn_time_ms": 1.878, "learn_throughput": 63896.976, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 69000, "num_env_steps_trained": 69000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 69000}, "done": false, "episodes_total": 575, "training_iteration": 96, "trial_id": "d3049_00000", "date": "2023-07-24_21-38-20", "timestamp": 1690223900, "time_this_iter_s": 10.905652046203613, "time_total_s": 1041.9258859157562, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1041.9258859157562, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 25.8875, "ram_util_percent": 78.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.5e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2395935058594, "policy_loss": -174227.734375, "vf_loss": 8255023.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 580.0}}, "num_env_steps_sampled": 69720, "num_env_steps_trained": 69720, "num_agent_steps_sampled": 69720, "num_agent_steps_trained": 69720}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -921.3125169312195, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984488791187337, "mean_inference_ms": 0.26624359391878843, "mean_action_processing_ms": 0.06168186560328241, "mean_env_wait_ms": 1.732750685181741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029561519622802734, "StateBufferConnector_ms": 0.0018773078918457031, "ViewRequirementAgentConnector_ms": 0.048699378967285156}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -921.3125169312195, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-695.3740362032959, -682.4174484095889, -855.934152609343, -939.3910412760854, -1015.4794525293878, -891.5520769891355, -833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984488791187337, "mean_inference_ms": 0.26624359391878843, "mean_action_processing_ms": 0.06168186560328241, "mean_env_wait_ms": 1.732750685181741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029561519622802734, "StateBufferConnector_ms": 0.0018773078918457031, "ViewRequirementAgentConnector_ms": 0.048699378967285156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69720, "num_agent_steps_trained": 69720, "num_env_steps_sampled": 69720, "num_env_steps_trained": 69720, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.99122344154924, "num_env_steps_trained_throughput_per_sec": 65.99122344154924, "timesteps_total": 69720, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 69720, "timers": {"training_iteration_time_ms": 1817.006, "sample_time_ms": 1814.42, "load_time_ms": 0.149, "load_throughput": 805177.54, "learn_time_ms": 1.892, "learn_throughput": 63434.725, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 69720, "num_env_steps_trained": 69720, "num_agent_steps_sampled": 69720, "num_agent_steps_trained": 69720}, "done": false, "episodes_total": 581, "training_iteration": 97, "trial_id": "d3049_00000", "date": "2023-07-24_21-38-31", "timestamp": 1690223911, "time_this_iter_s": 10.912549257278442, "time_total_s": 1052.8384351730347, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1052.8384351730347, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 31.886666666666667, "ram_util_percent": 78.48666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.2e-07, "entropy_coeff": 0.1, "policy_entropy": 363.24603271484375, "policy_loss": -113359.6953125, "vf_loss": 3398528.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 587.0, "diff_num_grad_updates_vs_sampler_policy": 586.0}}, "num_env_steps_sampled": 70440, "num_env_steps_trained": 70440, "num_agent_steps_sampled": 70440, "num_agent_steps_trained": 70440}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -924.6874268054997, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984504798236621, "mean_inference_ms": 0.266226671151067, "mean_action_processing_ms": 0.06167972241923534, "mean_env_wait_ms": 1.7321972058404882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029642581939697266, "StateBufferConnector_ms": 0.0018832683563232422, "ViewRequirementAgentConnector_ms": 0.04875969886779785}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -924.6874268054997, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-833.3630958585861, -861.0851212400121, -995.5800933722821, -933.6478217101769, -757.1261703862941, -872.4366719754707, -883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984504798236621, "mean_inference_ms": 0.266226671151067, "mean_action_processing_ms": 0.06167972241923534, "mean_env_wait_ms": 1.7321972058404882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029642581939697266, "StateBufferConnector_ms": 0.0018832683563232422, "ViewRequirementAgentConnector_ms": 0.04875969886779785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70440, "num_agent_steps_trained": 70440, "num_env_steps_sampled": 70440, "num_env_steps_trained": 70440, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.56293991283445, "num_env_steps_trained_throughput_per_sec": 66.56293991283445, "timesteps_total": 70440, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 70440, "timers": {"training_iteration_time_ms": 1811.806, "sample_time_ms": 1809.161, "load_time_ms": 0.15, "load_throughput": 799549.611, "learn_time_ms": 1.913, "learn_throughput": 62712.313, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 70440, "num_env_steps_trained": 70440, "num_agent_steps_sampled": 70440, "num_agent_steps_trained": 70440}, "done": false, "episodes_total": 587, "training_iteration": 98, "trial_id": "d3049_00000", "date": "2023-07-24_21-38-42", "timestamp": 1690223922, "time_this_iter_s": 10.819215059280396, "time_total_s": 1063.657650232315, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1063.657650232315, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 24.64375, "ram_util_percent": 78.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2546691894531, "policy_loss": -186448.5, "vf_loss": 8897472.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 592.0}}, "num_env_steps_sampled": 71160, "num_env_steps_trained": 71160, "num_agent_steps_sampled": 71160, "num_agent_steps_trained": 71160}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -931.2477387754267, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984485298012656, "mean_inference_ms": 0.2662146089167869, "mean_action_processing_ms": 0.06167848879564713, "mean_env_wait_ms": 1.731654288514742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002943277359008789, "StateBufferConnector_ms": 0.001847982406616211, "ViewRequirementAgentConnector_ms": 0.04850435256958008}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -931.2477387754267, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-883.7295971892363, -815.4827784299754, -1070.1869142588548, -1010.1202031339039, -931.9718396674511, -1095.963726338962, -836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984485298012656, "mean_inference_ms": 0.2662146089167869, "mean_action_processing_ms": 0.06167848879564713, "mean_env_wait_ms": 1.731654288514742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002943277359008789, "StateBufferConnector_ms": 0.001847982406616211, "ViewRequirementAgentConnector_ms": 0.04850435256958008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71160, "num_agent_steps_trained": 71160, "num_env_steps_sampled": 71160, "num_env_steps_trained": 71160, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.7206123089335, "num_env_steps_trained_throughput_per_sec": 66.7206123089335, "timesteps_total": 71160, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 71160, "timers": {"training_iteration_time_ms": 1799.544, "sample_time_ms": 1796.923, "load_time_ms": 0.151, "load_throughput": 797269.888, "learn_time_ms": 1.896, "learn_throughput": 63306.268, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 71160, "num_env_steps_trained": 71160, "num_agent_steps_sampled": 71160, "num_agent_steps_trained": 71160}, "done": false, "episodes_total": 593, "training_iteration": 99, "trial_id": "d3049_00000", "date": "2023-07-24_21-38-53", "timestamp": 1690223933, "time_this_iter_s": 10.793246984481812, "time_total_s": 1074.4508972167969, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1074.4508972167969, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 23.473333333333336, "ram_util_percent": 78.43999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.6e-07, "entropy_coeff": 0.1, "policy_entropy": 363.24969482421875, "policy_loss": -130063.6484375, "vf_loss": 4377188.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 599.0, "diff_num_grad_updates_vs_sampler_policy": 598.0}}, "num_env_steps_sampled": 71880, "num_env_steps_trained": 71880, "num_agent_steps_sampled": 71880, "num_agent_steps_trained": 71880}, "sampler_results": {"episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -930.5313062214741, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984492875376908, "mean_inference_ms": 0.2662027998838747, "mean_action_processing_ms": 0.06167722047728063, "mean_env_wait_ms": 1.7311322030059726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029456615447998047, "StateBufferConnector_ms": 0.0018401145935058594, "ViewRequirementAgentConnector_ms": 0.048410654067993164}}, "episode_reward_max": -509.54206211050285, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -930.5313062214741, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-836.2402970900835, -733.9514085705214, -673.5727249687685, -509.54206211050285, -979.2040533904393, -1122.8418516119311, -1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984492875376908, "mean_inference_ms": 0.2662027998838747, "mean_action_processing_ms": 0.06167722047728063, "mean_env_wait_ms": 1.7311322030059726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029456615447998047, "StateBufferConnector_ms": 0.0018401145935058594, "ViewRequirementAgentConnector_ms": 0.048410654067993164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71880, "num_agent_steps_trained": 71880, "num_env_steps_sampled": 71880, "num_env_steps_trained": 71880, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.10708892677502, "num_env_steps_trained_throughput_per_sec": 66.10708892677502, "timesteps_total": 71880, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 71880, "timers": {"training_iteration_time_ms": 1809.003, "sample_time_ms": 1806.407, "load_time_ms": 0.151, "load_throughput": 796765.047, "learn_time_ms": 1.886, "learn_throughput": 63616.73, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 71880, "num_env_steps_trained": 71880, "num_agent_steps_sampled": 71880, "num_agent_steps_trained": 71880}, "done": false, "episodes_total": 599, "training_iteration": 100, "trial_id": "d3049_00000", "date": "2023-07-24_21-39-04", "timestamp": 1690223944, "time_this_iter_s": 10.893785238265991, "time_total_s": 1085.3446824550629, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1085.3446824550629, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.081249999999997, "ram_util_percent": 78.36250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.38e-07, "entropy_coeff": 0.1, "policy_entropy": 363.251708984375, "policy_loss": -197902.03125, "vf_loss": 9177160.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 605.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 72600, "num_env_steps_trained": 72600, "num_agent_steps_sampled": 72600, "num_agent_steps_trained": 72600}, "sampler_results": {"episode_reward_max": -645.6260238808354, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -941.7047599829731, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984371177704604, "mean_inference_ms": 0.2661912474947118, "mean_action_processing_ms": 0.061675809006441575, "mean_env_wait_ms": 1.7305866918120179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002966642379760742, "StateBufferConnector_ms": 0.0018584728240966797, "ViewRequirementAgentConnector_ms": 0.04857826232910156}}, "episode_reward_max": -645.6260238808354, "episode_reward_min": -1375.0617341500601, "episode_reward_mean": -941.7047599829731, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1136.3544347408838, -1375.0617341500601, -925.1490148420947, -1194.2047191366398, -757.8728012983581, -959.2161007802565, -675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984371177704604, "mean_inference_ms": 0.2661912474947118, "mean_action_processing_ms": 0.061675809006441575, "mean_env_wait_ms": 1.7305866918120179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002966642379760742, "StateBufferConnector_ms": 0.0018584728240966797, "ViewRequirementAgentConnector_ms": 0.04857826232910156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72600, "num_agent_steps_trained": 72600, "num_env_steps_sampled": 72600, "num_env_steps_trained": 72600, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.95162587491191, "num_env_steps_trained_throughput_per_sec": 66.95162587491191, "timesteps_total": 72600, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 72600, "timers": {"training_iteration_time_ms": 1802.985, "sample_time_ms": 1800.331, "load_time_ms": 0.152, "load_throughput": 787786.007, "learn_time_ms": 1.912, "learn_throughput": 62762.361, "synch_weights_time_ms": 0.56}, "counters": {"num_env_steps_sampled": 72600, "num_env_steps_trained": 72600, "num_agent_steps_sampled": 72600, "num_agent_steps_trained": 72600}, "done": false, "episodes_total": 605, "training_iteration": 101, "trial_id": "d3049_00000", "date": "2023-07-24_21-39-15", "timestamp": 1690223955, "time_this_iter_s": 10.756401777267456, "time_total_s": 1096.1010842323303, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1096.1010842323303, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 24.279999999999998, "ram_util_percent": 78.46000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1999999999999998e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2535400390625, "policy_loss": -171633.4375, "vf_loss": 6846390.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 611.0, "diff_num_grad_updates_vs_sampler_policy": 610.0}}, "num_env_steps_sampled": 73320, "num_env_steps_trained": 73320, "num_agent_steps_sampled": 73320, "num_agent_steps_trained": 73320}, "sampler_results": {"episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -935.9292722560588, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984139229804692, "mean_inference_ms": 0.26618173744676155, "mean_action_processing_ms": 0.06167491254041102, "mean_env_wait_ms": 1.7300305491995693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029811859130859375, "StateBufferConnector_ms": 0.0018732547760009766, "ViewRequirementAgentConnector_ms": 0.04885268211364746}}, "episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -935.9292722560588, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-675.9877587029821, -817.9071040752701, -941.2293373799625, -1082.0279122041718, -1018.9239777058162, -656.7079719337926, -920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984139229804692, "mean_inference_ms": 0.26618173744676155, "mean_action_processing_ms": 0.06167491254041102, "mean_env_wait_ms": 1.7300305491995693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029811859130859375, "StateBufferConnector_ms": 0.0018732547760009766, "ViewRequirementAgentConnector_ms": 0.04885268211364746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73320, "num_agent_steps_trained": 73320, "num_env_steps_sampled": 73320, "num_env_steps_trained": 73320, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.58658252192734, "num_env_steps_trained_throughput_per_sec": 66.58658252192734, "timesteps_total": 73320, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 73320, "timers": {"training_iteration_time_ms": 1798.739, "sample_time_ms": 1796.03, "load_time_ms": 0.156, "load_throughput": 770657.602, "learn_time_ms": 1.954, "learn_throughput": 61402.523, "synch_weights_time_ms": 0.57}, "counters": {"num_env_steps_sampled": 73320, "num_env_steps_trained": 73320, "num_agent_steps_sampled": 73320, "num_agent_steps_trained": 73320}, "done": false, "episodes_total": 611, "training_iteration": 102, "trial_id": "d3049_00000", "date": "2023-07-24_21-39-25", "timestamp": 1690223965, "time_this_iter_s": 10.815212965011597, "time_total_s": 1106.916297197342, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1106.916297197342, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 27.406666666666663, "ram_util_percent": 78.24666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0199999999999998e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2537841796875, "policy_loss": -167506.84375, "vf_loss": 7142222.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 617.0, "diff_num_grad_updates_vs_sampler_policy": 616.0}}, "num_env_steps_sampled": 74040, "num_env_steps_trained": 74040, "num_agent_steps_sampled": 74040, "num_agent_steps_trained": 74040}, "sampler_results": {"episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -935.9269739824161, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.983960752647235, "mean_inference_ms": 0.26618522911942644, "mean_action_processing_ms": 0.06167542179582141, "mean_env_wait_ms": 1.7295332392781466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002995014190673828, "StateBufferConnector_ms": 0.001893758773803711, "ViewRequirementAgentConnector_ms": 0.04934406280517578}}, "episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -935.9269739824161, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-920.2507860824732, -983.8858897669987, -781.4944176317285, -881.5468383470507, -693.6242781286116, -869.2414858414629, -997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.983960752647235, "mean_inference_ms": 0.26618522911942644, "mean_action_processing_ms": 0.06167542179582141, "mean_env_wait_ms": 1.7295332392781466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002995014190673828, "StateBufferConnector_ms": 0.001893758773803711, "ViewRequirementAgentConnector_ms": 0.04934406280517578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74040, "num_agent_steps_trained": 74040, "num_env_steps_sampled": 74040, "num_env_steps_trained": 74040, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.76895168577347, "num_env_steps_trained_throughput_per_sec": 65.76895168577347, "timesteps_total": 74040, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 74040, "timers": {"training_iteration_time_ms": 1817.609, "sample_time_ms": 1814.964, "load_time_ms": 0.154, "load_throughput": 781425.99, "learn_time_ms": 1.921, "learn_throughput": 62472.567, "synch_weights_time_ms": 0.541}, "counters": {"num_env_steps_sampled": 74040, "num_env_steps_trained": 74040, "num_agent_steps_sampled": 74040, "num_agent_steps_trained": 74040}, "done": false, "episodes_total": 617, "training_iteration": 103, "trial_id": "d3049_00000", "date": "2023-07-24_21-39-36", "timestamp": 1690223976, "time_this_iter_s": 10.949422121047974, "time_total_s": 1117.86571931839, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1117.86571931839, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 24.6, "ram_util_percent": 78.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.84e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2462158203125, "policy_loss": -163110.359375, "vf_loss": 6485418.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 623.0, "diff_num_grad_updates_vs_sampler_policy": 622.0}}, "num_env_steps_sampled": 74760, "num_env_steps_trained": 74760, "num_agent_steps_sampled": 74760, "num_agent_steps_trained": 74760}, "sampler_results": {"episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -941.8103764409394, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599, -765.5186236596943, -1209.1177556205612, -817.5777086096615, -909.3613355096895, -1020.9989337628552, -995.8095844882024], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.983926920467015, "mean_inference_ms": 0.2662041346364322, "mean_action_processing_ms": 0.06167766129171016, "mean_env_wait_ms": 1.7290669901351094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030214786529541016, "StateBufferConnector_ms": 0.0018954277038574219, "ViewRequirementAgentConnector_ms": 0.04933667182922363}}, "episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -941.8103764409394, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-997.2948682058586, -831.5322309191217, -912.4097038196031, -1043.2176148309075, -987.7299784411607, -1081.1141651690289, -792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599, -765.5186236596943, -1209.1177556205612, -817.5777086096615, -909.3613355096895, -1020.9989337628552, -995.8095844882024], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.983926920467015, "mean_inference_ms": 0.2662041346364322, "mean_action_processing_ms": 0.06167766129171016, "mean_env_wait_ms": 1.7290669901351094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030214786529541016, "StateBufferConnector_ms": 0.0018954277038574219, "ViewRequirementAgentConnector_ms": 0.04933667182922363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74760, "num_agent_steps_trained": 74760, "num_env_steps_sampled": 74760, "num_env_steps_trained": 74760, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.68175705540303, "num_env_steps_trained_throughput_per_sec": 65.68175705540303, "timesteps_total": 74760, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 74760, "timers": {"training_iteration_time_ms": 1825.321, "sample_time_ms": 1822.711, "load_time_ms": 0.149, "load_throughput": 805435.238, "learn_time_ms": 1.908, "learn_throughput": 62894.119, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 74760, "num_env_steps_trained": 74760, "num_agent_steps_sampled": 74760, "num_agent_steps_trained": 74760}, "done": false, "episodes_total": 623, "training_iteration": 104, "trial_id": "d3049_00000", "date": "2023-07-24_21-39-47", "timestamp": 1690223987, "time_this_iter_s": 10.964111089706421, "time_total_s": 1128.8298304080963, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1128.8298304080963, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 30.359999999999996, "ram_util_percent": 78.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6599999999999998e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2353820800781, "policy_loss": -165782.9375, "vf_loss": 6443492.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 629.0, "diff_num_grad_updates_vs_sampler_policy": 628.0}}, "num_env_steps_sampled": 75480, "num_env_steps_trained": 75480, "num_agent_steps_sampled": 75480, "num_agent_steps_trained": 75480}, "sampler_results": {"episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -936.6320780784836, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599, -765.5186236596943, -1209.1177556205612, -817.5777086096615, -909.3613355096895, -1020.9989337628552, -995.8095844882024, -1091.878486115082, -791.630485667509, -703.3092111699536, -682.523426786636, -1106.1247350721055, -960.002380328811], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984001947770077, "mean_inference_ms": 0.26622405384279346, "mean_action_processing_ms": 0.061680035864055356, "mean_env_wait_ms": 1.7286142665912692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030121803283691406, "StateBufferConnector_ms": 0.0019049644470214844, "ViewRequirementAgentConnector_ms": 0.049259185791015625}}, "episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -936.6320780784836, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-792.9334658565394, -1027.22518938509, -836.8226678872401, -839.5099882172696, -877.5146511906458, -944.355774411563, -1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599, -765.5186236596943, -1209.1177556205612, -817.5777086096615, -909.3613355096895, -1020.9989337628552, -995.8095844882024, -1091.878486115082, -791.630485667509, -703.3092111699536, -682.523426786636, -1106.1247350721055, -960.002380328811], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984001947770077, "mean_inference_ms": 0.26622405384279346, "mean_action_processing_ms": 0.061680035864055356, "mean_env_wait_ms": 1.7286142665912692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030121803283691406, "StateBufferConnector_ms": 0.0019049644470214844, "ViewRequirementAgentConnector_ms": 0.049259185791015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75480, "num_agent_steps_trained": 75480, "num_env_steps_sampled": 75480, "num_env_steps_trained": 75480, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.06656267178975, "num_env_steps_trained_throughput_per_sec": 66.06656267178975, "timesteps_total": 75480, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 75480, "timers": {"training_iteration_time_ms": 1826.002, "sample_time_ms": 1823.289, "load_time_ms": 0.158, "load_throughput": 759722.989, "learn_time_ms": 1.975, "learn_throughput": 60761.33, "synch_weights_time_ms": 0.549}, "counters": {"num_env_steps_sampled": 75480, "num_env_steps_trained": 75480, "num_agent_steps_sampled": 75480, "num_agent_steps_trained": 75480}, "done": false, "episodes_total": 629, "training_iteration": 105, "trial_id": "d3049_00000", "date": "2023-07-24_21-39-58", "timestamp": 1690223998, "time_this_iter_s": 10.900079011917114, "time_total_s": 1139.7299094200134, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1139.7299094200134, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 27.587500000000002, "ram_util_percent": 78.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.48e-07, "entropy_coeff": 0.1, "policy_entropy": 363.22601318359375, "policy_loss": -205658.609375, "vf_loss": 10770666.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 634.0}}, "num_env_steps_sampled": 76200, "num_env_steps_trained": 76200, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 76200}, "sampler_results": {"episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -941.6447640953639, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599, -765.5186236596943, -1209.1177556205612, -817.5777086096615, -909.3613355096895, -1020.9989337628552, -995.8095844882024, -1091.878486115082, -791.630485667509, -703.3092111699536, -682.523426786636, -1106.1247350721055, -960.002380328811, -962.0767647875693, -800.3912072044744, -972.8047369652464, -1071.724475906998, -905.2424208393026, -1107.390732932772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984131137486127, "mean_inference_ms": 0.26624620759546963, "mean_action_processing_ms": 0.061682854235976955, "mean_env_wait_ms": 1.728193643308768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003020048141479492, "StateBufferConnector_ms": 0.0019218921661376953, "ViewRequirementAgentConnector_ms": 0.04916644096374512}}, "episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -941.6447640953639, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1178.4663133088309, -951.6161496191861, -1061.7359711946688, -925.4431224988209, -908.2730071908061, -821.7879110196916, -777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599, -765.5186236596943, -1209.1177556205612, -817.5777086096615, -909.3613355096895, -1020.9989337628552, -995.8095844882024, -1091.878486115082, -791.630485667509, -703.3092111699536, -682.523426786636, -1106.1247350721055, -960.002380328811, -962.0767647875693, -800.3912072044744, -972.8047369652464, -1071.724475906998, -905.2424208393026, -1107.390732932772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.984131137486127, "mean_inference_ms": 0.26624620759546963, "mean_action_processing_ms": 0.061682854235976955, "mean_env_wait_ms": 1.728193643308768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003020048141479492, "StateBufferConnector_ms": 0.0019218921661376953, "ViewRequirementAgentConnector_ms": 0.04916644096374512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 76200, "num_env_steps_sampled": 76200, "num_env_steps_trained": 76200, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.07672499832286, "num_env_steps_trained_throughput_per_sec": 66.07672499832286, "timesteps_total": 76200, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 76200, "timers": {"training_iteration_time_ms": 1817.163, "sample_time_ms": 1814.156, "load_time_ms": 0.159, "load_throughput": 754371.223, "learn_time_ms": 2.226, "learn_throughput": 53907.321, "synch_weights_time_ms": 0.589}, "counters": {"num_env_steps_sampled": 76200, "num_env_steps_trained": 76200, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 76200}, "done": false, "episodes_total": 635, "training_iteration": 106, "trial_id": "d3049_00000", "date": "2023-07-24_21-40-09", "timestamp": 1690224009, "time_this_iter_s": 10.898531198501587, "time_total_s": 1150.628440618515, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1150.628440618515, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 25.625, "ram_util_percent": 77.95625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3e-07, "entropy_coeff": 0.1, "policy_entropy": 363.2249450683594, "policy_loss": -168973.171875, "vf_loss": 7620602.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 641.0, "diff_num_grad_updates_vs_sampler_policy": 640.0}}, "num_env_steps_sampled": 76920, "num_env_steps_trained": 76920, "num_agent_steps_sampled": 76920, "num_agent_steps_trained": 76920}, "sampler_results": {"episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -945.249336250046, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599, -765.5186236596943, -1209.1177556205612, -817.5777086096615, -909.3613355096895, -1020.9989337628552, -995.8095844882024, -1091.878486115082, -791.630485667509, -703.3092111699536, -682.523426786636, -1106.1247350721055, -960.002380328811, -962.0767647875693, -800.3912072044744, -972.8047369652464, -1071.724475906998, -905.2424208393026, -1107.390732932772, -1121.412329592982, -868.9869259844127, -807.1836900877025, -1135.578489467001, -1327.7893250683567, -946.8289300997739], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98432296379979, "mean_inference_ms": 0.2662676390203109, "mean_action_processing_ms": 0.06168566896694552, "mean_env_wait_ms": 1.7277716446641636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003021717071533203, "StateBufferConnector_ms": 0.0019228458404541016, "ViewRequirementAgentConnector_ms": 0.04916048049926758}}, "episode_reward_max": -645.6260238808354, "episode_reward_min": -1355.2887913378254, "episode_reward_mean": -945.249336250046, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-777.7159271822171, -919.5818879502679, -1064.3722908456791, -1178.0366036246387, -869.7424927344446, -878.6055075926495, -1018.7786952403669, -1198.7222091445037, -991.7912371393573, -1001.6332083385157, -1355.2887913378254, -771.0041477369135, -978.2556947292074, -957.8381143413341, -768.7459286432327, -951.0291501309978, -980.2963416931409, -859.6489350277704, -946.5523355365483, -680.0770784908117, -776.2959720682351, -1187.875615782438, -739.348335261996, -933.2851085656915, -875.0441041566198, -979.787368203184, -935.0444546979369, -974.7192101351579, -1091.5949589089266, -886.0317267843621, -851.6181258920843, -946.7316551922505, -722.0717200068522, -695.2179434347731, -894.8029396161561, -1056.8854272985047, -1219.452621355658, -904.5956219271002, -650.2133352611734, -977.0548958774976, -875.8257870608993, -1190.5807690967001, -865.8299083219971, -827.5609870861666, -1012.2157199982678, -645.6260238808354, -1169.9782754790936, -770.5947960300765, -1073.6706179821513, -785.6752975420397, -1042.7324544676226, -1066.618730034517, -956.0953557949218, -1153.595214591899, -1085.9329630199577, -784.3520715722011, -1054.9443056582224, -700.891892985925, -1073.4624660942172, -1147.7596218341594, -811.9926663397813, -1123.4085998895087, -733.8703639600631, -1082.2040557744253, -953.0365952266997, -997.4610074174793, -1102.3052806453395, -996.0913051419149, -834.4478767383715, -886.9679670870523, -791.4943064419671, -890.8583941801862, -845.6861896336418, -877.1565552804952, -879.5283911806674, -907.8303979207599, -765.5186236596943, -1209.1177556205612, -817.5777086096615, -909.3613355096895, -1020.9989337628552, -995.8095844882024, -1091.878486115082, -791.630485667509, -703.3092111699536, -682.523426786636, -1106.1247350721055, -960.002380328811, -962.0767647875693, -800.3912072044744, -972.8047369652464, -1071.724475906998, -905.2424208393026, -1107.390732932772, -1121.412329592982, -868.9869259844127, -807.1836900877025, -1135.578489467001, -1327.7893250683567, -946.8289300997739], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.98432296379979, "mean_inference_ms": 0.2662676390203109, "mean_action_processing_ms": 0.06168566896694552, "mean_env_wait_ms": 1.7277716446641636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003021717071533203, "StateBufferConnector_ms": 0.0019228458404541016, "ViewRequirementAgentConnector_ms": 0.04916048049926758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76920, "num_agent_steps_trained": 76920, "num_env_steps_sampled": 76920, "num_env_steps_trained": 76920, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.43509257809151, "num_env_steps_trained_throughput_per_sec": 66.43509257809151, "timesteps_total": 76920, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 76920, "timers": {"training_iteration_time_ms": 1808.395, "sample_time_ms": 1805.455, "load_time_ms": 0.151, "load_throughput": 793999.811, "learn_time_ms": 2.194, "learn_throughput": 54701.773, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 76920, "num_env_steps_trained": 76920, "num_agent_steps_sampled": 76920, "num_agent_steps_trained": 76920}, "done": false, "episodes_total": 641, "training_iteration": 107, "trial_id": "d3049_00000", "date": "2023-07-24_21-40-20", "timestamp": 1690224020, "time_this_iter_s": 10.839781284332275, "time_total_s": 1161.4682219028473, "pid": 41565, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [6000, 0.00025], [12000, 0.0001], [18000, 5e-05], [24000, 2.5e-05], [30000, 1e-05], [36000, 7.5e-06], [42000, 5e-06], [48000, 2.5e-06], [54000, 1e-06], [60000, 7.5e-07], [66000, 5e-07], [72000, 2.5e-07], [78000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177f7e430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1161.4682219028473, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 24.92, "ram_util_percent": 77.95333333333335}}
