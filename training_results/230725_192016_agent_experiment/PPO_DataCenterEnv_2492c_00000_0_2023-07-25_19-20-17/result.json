{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6074395100275676, "cur_kl_coeff": 0.20000000000000007, "cur_lr": 0.0020000000000000005, "total_loss": 9.476425743103027, "policy_loss": 0.8408867557843526, "vf_loss": 10.0, "vf_explained_var": -2.384185791015625e-07, "kl": 0.05424431583087429, "entropy": 4.584365749359131, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 120, "num_env_steps_trained": 120, "num_agent_steps_sampled": 120, "num_agent_steps_trained": 120}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -3701.422946165961, "episode_reward_mean": -3701.422946165961, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961], "episode_lengths": [120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08015501794736, "mean_inference_ms": 0.47173381836946343, "mean_action_processing_ms": 0.09921168492845266, "mean_env_wait_ms": 27.563910838986228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032901763916015625, "StateBufferConnector_ms": 0.0031232833862304688, "ViewRequirementAgentConnector_ms": 0.06895065307617188}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -3701.422946165961, "episode_reward_mean": -3701.422946165961, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961], "episode_lengths": [120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08015501794736, "mean_inference_ms": 0.47173381836946343, "mean_action_processing_ms": 0.09921168492845266, "mean_env_wait_ms": 27.563910838986228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032901763916015625, "StateBufferConnector_ms": 0.0031232833862304688, "ViewRequirementAgentConnector_ms": 0.06895065307617188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120, "num_agent_steps_trained": 120, "num_env_steps_sampled": 120, "num_env_steps_trained": 120, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 19.779752029057875, "num_env_steps_trained_throughput_per_sec": 19.779752029057875, "timesteps_total": 120, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 120, "timers": {"training_iteration_time_ms": 6066.785, "sample_time_ms": 5960.933, "load_time_ms": 0.563, "load_throughput": 213179.365, "learn_time_ms": 104.205, "learn_throughput": 1151.575, "synch_weights_time_ms": 0.832}, "counters": {"num_env_steps_sampled": 120, "num_env_steps_trained": 120, "num_agent_steps_sampled": 120, "num_agent_steps_trained": 120}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-29", "timestamp": 1690302029, "time_this_iter_s": 6.0693700313568115, "time_total_s": 6.0693700313568115, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6.0693700313568115, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.9, "ram_util_percent": 78.2888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6607803499093279, "cur_kl_coeff": 0.3000000000000001, "cur_lr": 0.0019666666666666665, "total_loss": 8.7099596341451, "policy_loss": 0.6015505691369375, "vf_loss": 10.0, "vf_explained_var": -2.5033950805664062e-06, "kl": 10.214384861096429, "entropy": 16.519688367843628, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 240, "num_env_steps_trained": 240, "num_agent_steps_sampled": 240, "num_agent_steps_trained": 240}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -4356.1733646595885, "episode_reward_mean": -4028.7981554127746, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885], "episode_lengths": [120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.247610225463607, "mean_inference_ms": 0.4678813278223359, "mean_action_processing_ms": 0.0988249343624045, "mean_env_wait_ms": 21.35811929312603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.06889104843139648}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -4356.1733646595885, "episode_reward_mean": -4028.7981554127746, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885], "episode_lengths": [120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.247610225463607, "mean_inference_ms": 0.4678813278223359, "mean_action_processing_ms": 0.0988249343624045, "mean_env_wait_ms": 21.35811929312603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.06889104843139648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240, "num_agent_steps_trained": 240, "num_env_steps_sampled": 240, "num_env_steps_trained": 240, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 38.86786024338067, "num_env_steps_trained_throughput_per_sec": 38.86786024338067, "timesteps_total": 240, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 240, "timers": {"training_iteration_time_ms": 4577.058, "sample_time_ms": 4479.481, "load_time_ms": 0.4, "load_throughput": 299950.226, "learn_time_ms": 95.99, "learn_throughput": 1250.136, "synch_weights_time_ms": 0.912}, "counters": {"num_env_steps_sampled": 240, "num_env_steps_trained": 240, "num_agent_steps_sampled": 240, "num_agent_steps_trained": 240}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-33", "timestamp": 1690302033, "time_this_iter_s": 3.0940020084381104, "time_total_s": 9.163372039794922, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9.163372039794922, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.74, "ram_util_percent": 78.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.314398642381032, "cur_kl_coeff": 0.4499999999999999, "cur_lr": 0.0019333333333333336, "total_loss": 3.9728466192881267, "policy_loss": 0.6245652695496877, "vf_loss": 10.0, "vf_explained_var": 5.364418029785156e-07, "kl": 1.7694674218694368, "entropy": 24.826595751444497, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 360, "num_env_steps_trained": 360, "num_agent_steps_sampled": 360, "num_agent_steps_trained": 360}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -9741.433348946648, "episode_reward_mean": -5933.009886590732, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.425352685597307, "mean_inference_ms": 0.4666069914238398, "mean_action_processing_ms": 0.098777568512476, "mean_env_wait_ms": 17.9029537860013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035047531127929688, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.0690460205078125}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -9741.433348946648, "episode_reward_mean": -5933.009886590732, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.425352685597307, "mean_inference_ms": 0.4666069914238398, "mean_action_processing_ms": 0.098777568512476, "mean_env_wait_ms": 17.9029537860013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035047531127929688, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.0690460205078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360, "num_agent_steps_trained": 360, "num_env_steps_sampled": 360, "num_env_steps_trained": 360, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.731777452623916, "num_env_steps_trained_throughput_per_sec": 37.731777452623916, "timesteps_total": 360, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 360, "timers": {"training_iteration_time_ms": 4111.48, "sample_time_ms": 4016.577, "load_time_ms": 0.347, "load_throughput": 345526.188, "learn_time_ms": 93.402, "learn_throughput": 1284.773, "synch_weights_time_ms": 0.897}, "counters": {"num_env_steps_sampled": 360, "num_env_steps_trained": 360, "num_agent_steps_sampled": 360, "num_agent_steps_trained": 360}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-36", "timestamp": 1690302036, "time_this_iter_s": 3.183014154434204, "time_total_s": 12.346386194229126, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.346386194229126, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.275, "ram_util_percent": 77.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7122767210006713, "cur_kl_coeff": 0.6750000000000003, "cur_lr": 0.0018999999999999998, "total_loss": 3.277233187357585, "policy_loss": 0.7627096315224965, "vf_loss": 10.0, "vf_explained_var": 4.76837158203125e-07, "kl": 0.20482994820922612, "entropy": 25.412454477945964, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 480, "num_env_steps_trained": 480, "num_agent_steps_sampled": 480, "num_agent_steps_trained": 480}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -10210.581128632315, "episode_reward_mean": -7002.402697101128, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315], "episode_lengths": [120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.502077515691884, "mean_inference_ms": 0.4654044837705953, "mean_action_processing_ms": 0.09867486320415128, "mean_env_wait_ms": 15.677395514552597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036001205444335938, "StateBufferConnector_ms": 0.0029265880584716797, "ViewRequirementAgentConnector_ms": 0.07029175758361816}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -10210.581128632315, "episode_reward_mean": -7002.402697101128, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315], "episode_lengths": [120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.502077515691884, "mean_inference_ms": 0.4654044837705953, "mean_action_processing_ms": 0.09867486320415128, "mean_env_wait_ms": 15.677395514552597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036001205444335938, "StateBufferConnector_ms": 0.0029265880584716797, "ViewRequirementAgentConnector_ms": 0.07029175758361816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480, "num_agent_steps_trained": 480, "num_env_steps_sampled": 480, "num_env_steps_trained": 480, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 38.61384443203986, "num_env_steps_trained_throughput_per_sec": 38.61384443203986, "timesteps_total": 480, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 480, "timers": {"training_iteration_time_ms": 3860.529, "sample_time_ms": 3767.965, "load_time_ms": 0.315, "load_throughput": 380723.51, "learn_time_ms": 91.132, "learn_throughput": 1316.766, "synch_weights_time_ms": 0.868}, "counters": {"num_env_steps_sampled": 480, "num_env_steps_trained": 480, "num_agent_steps_sampled": 480, "num_agent_steps_trained": 480}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-39", "timestamp": 1690302039, "time_this_iter_s": 3.110322952270508, "time_total_s": 15.456709146499634, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15.456709146499634, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.26, "ram_util_percent": 78.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7983289837837217, "cur_kl_coeff": 1.0125, "cur_lr": 0.001866666666666667, "total_loss": 2.9895366430282593, "policy_loss": 0.6856422225634257, "vf_loss": 10.0, "vf_explained_var": -4.76837158203125e-07, "kl": 0.18675904509921867, "entropy": 26.283995819091796, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 600, "num_env_steps_trained": 600, "num_agent_steps_sampled": 600, "num_agent_steps_trained": 600}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -10729.562351905548, "episode_reward_mean": -7747.834628062012, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548], "episode_lengths": [120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.55191357692214, "mean_inference_ms": 0.4642307359648029, "mean_action_processing_ms": 0.09855939907493252, "mean_env_wait_ms": 14.085687819012241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004172325134277344, "StateBufferConnector_ms": 0.0028944015502929688, "ViewRequirementAgentConnector_ms": 0.06953716278076172}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -10729.562351905548, "episode_reward_mean": -7747.834628062012, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548], "episode_lengths": [120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.55191357692214, "mean_inference_ms": 0.4642307359648029, "mean_action_processing_ms": 0.09855939907493252, "mean_env_wait_ms": 14.085687819012241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004172325134277344, "StateBufferConnector_ms": 0.0028944015502929688, "ViewRequirementAgentConnector_ms": 0.06953716278076172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600, "num_agent_steps_trained": 600, "num_env_steps_sampled": 600, "num_env_steps_trained": 600, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 38.86579231149685, "num_env_steps_trained_throughput_per_sec": 38.86579231149685, "timesteps_total": 600, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 600, "timers": {"training_iteration_time_ms": 3705.929, "sample_time_ms": 3614.24, "load_time_ms": 0.297, "load_throughput": 403816.175, "learn_time_ms": 90.264, "learn_throughput": 1329.439, "synch_weights_time_ms": 0.884}, "counters": {"num_env_steps_sampled": 600, "num_env_steps_trained": 600, "num_agent_steps_sampled": 600, "num_agent_steps_trained": 600}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-42", "timestamp": 1690302042, "time_this_iter_s": 3.0902509689331055, "time_total_s": 18.54696011543274, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 18.54696011543274, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.3, "ram_util_percent": 77.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.530676754315694, "cur_kl_coeff": 1.5187499999999996, "cur_lr": 0.001833333333333333, "total_loss": 2.9066662232081097, "policy_loss": 0.7462051749229431, "vf_loss": 10.0, "vf_explained_var": -8.344650268554688e-07, "kl": 0.04940359636675566, "entropy": 26.381901041666666, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 165.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 720, "num_env_steps_trained": 720, "num_agent_steps_sampled": 720, "num_agent_steps_trained": 720}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -8460.412469811812, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081], "episode_lengths": [120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.613541144914475, "mean_inference_ms": 0.4632691251406183, "mean_action_processing_ms": 0.09845127812526411, "mean_env_wait_ms": 12.891784654914353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004065036773681641, "StateBufferConnector_ms": 0.0028928120930989585, "ViewRequirementAgentConnector_ms": 0.06934404373168945}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -8460.412469811812, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081], "episode_lengths": [120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.613541144914475, "mean_inference_ms": 0.4632691251406183, "mean_action_processing_ms": 0.09845127812526411, "mean_env_wait_ms": 12.891784654914353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004065036773681641, "StateBufferConnector_ms": 0.0028928120930989585, "ViewRequirementAgentConnector_ms": 0.06934404373168945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720, "num_agent_steps_trained": 720, "num_env_steps_sampled": 720, "num_env_steps_trained": 720, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.023725376957664, "num_env_steps_trained_throughput_per_sec": 37.023725376957664, "timesteps_total": 720, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 720, "timers": {"training_iteration_time_ms": 3628.465, "sample_time_ms": 3537.822, "load_time_ms": 0.285, "load_throughput": 421126.604, "learn_time_ms": 89.22, "learn_throughput": 1344.986, "synch_weights_time_ms": 0.898}, "counters": {"num_env_steps_sampled": 720, "num_env_steps_trained": 720, "num_agent_steps_sampled": 720, "num_agent_steps_trained": 720}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-45", "timestamp": 1690302045, "time_this_iter_s": 3.243781805038452, "time_total_s": 21.79074192047119, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 21.79074192047119, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.94, "ram_util_percent": 78.38}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.280072077115377, "cur_kl_coeff": 2.2781250000000006, "cur_lr": 0.0018000000000000006, "total_loss": 2.8578954458236696, "policy_loss": 0.74685773452123, "vf_loss": 10.0, "vf_explained_var": -1.6689300537109375e-06, "kl": 0.040891871496569365, "entropy": 26.607062657674152, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 195.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 840, "num_env_steps_trained": 840, "num_agent_steps_sampled": 840, "num_agent_steps_trained": 840}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -8739.834969394376, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.672986672206775, "mean_inference_ms": 0.4622463191943906, "mean_action_processing_ms": 0.09832512363842598, "mean_env_wait_ms": 11.959576038454504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.06913117000034877}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -8739.834969394376, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.672986672206775, "mean_inference_ms": 0.4622463191943906, "mean_action_processing_ms": 0.09832512363842598, "mean_env_wait_ms": 11.959576038454504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.06913117000034877}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840, "num_agent_steps_trained": 840, "num_env_steps_sampled": 840, "num_env_steps_trained": 840, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 36.990651438942876, "num_env_steps_trained_throughput_per_sec": 36.990651438942876, "timesteps_total": 840, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 840, "timers": {"training_iteration_time_ms": 3573.548, "sample_time_ms": 3482.926, "load_time_ms": 0.276, "load_throughput": 434160.858, "learn_time_ms": 89.214, "learn_throughput": 1345.077, "synch_weights_time_ms": 0.896}, "counters": {"num_env_steps_sampled": 840, "num_env_steps_trained": 840, "num_agent_steps_sampled": 840, "num_agent_steps_trained": 840}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-49", "timestamp": 1690302049, "time_this_iter_s": 3.2466180324554443, "time_total_s": 25.037359952926636, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 25.037359952926636, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.175, "ram_util_percent": 77.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.867588011423747, "cur_kl_coeff": 3.4171874999999994, "cur_lr": 0.0017666666666666668, "total_loss": 2.758739391962687, "policy_loss": 0.7220353464285533, "vf_loss": 10.0, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.027093814709223805, "entropy": 26.852934646606446, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 960, "num_env_steps_trained": 960, "num_agent_steps_sampled": 960, "num_agent_steps_trained": 960}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -8940.706120756502, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.701661995484102, "mean_inference_ms": 0.4615183385866177, "mean_action_processing_ms": 0.09824006928458708, "mean_env_wait_ms": 11.202698867399214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039577484130859375, "StateBufferConnector_ms": 0.002872943878173828, "ViewRequirementAgentConnector_ms": 0.0690460205078125}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -8940.706120756502, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.701661995484102, "mean_inference_ms": 0.4615183385866177, "mean_action_processing_ms": 0.09824006928458708, "mean_env_wait_ms": 11.202698867399214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039577484130859375, "StateBufferConnector_ms": 0.002872943878173828, "ViewRequirementAgentConnector_ms": 0.0690460205078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960, "num_agent_steps_trained": 960, "num_env_steps_sampled": 960, "num_env_steps_trained": 960, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 40.00384049728081, "num_env_steps_trained_throughput_per_sec": 40.00384049728081, "timesteps_total": 960, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 960, "timers": {"training_iteration_time_ms": 3501.816, "sample_time_ms": 3411.681, "load_time_ms": 0.269, "load_throughput": 446202.553, "learn_time_ms": 88.739, "learn_throughput": 1352.287, "synch_weights_time_ms": 0.895}, "counters": {"num_env_steps_sampled": 960, "num_env_steps_trained": 960, "num_agent_steps_sampled": 960, "num_agent_steps_trained": 960}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-52", "timestamp": 1690302052, "time_this_iter_s": 3.002429962158203, "time_total_s": 28.03978991508484, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 28.03978991508484, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.019999999999996, "ram_util_percent": 77.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.833075777689617, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.001733333333333334, "total_loss": 2.7350050767262775, "policy_loss": 0.7544131676355997, "vf_loss": 10.0, "vf_explained_var": 4.76837158203125e-07, "kl": 0.0152461739606224, "entropy": 26.99185415903727, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 255.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1080, "num_env_steps_trained": 1080, "num_agent_steps_sampled": 1080, "num_agent_steps_trained": 1080}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9126.50348240853, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.734359734969914, "mean_inference_ms": 0.461223732256821, "mean_action_processing_ms": 0.0981984174308716, "mean_env_wait_ms": 10.578561712578214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038968192206488717, "StateBufferConnector_ms": 0.0028689702351888022, "ViewRequirementAgentConnector_ms": 0.06884998745388454}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9126.50348240853, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.734359734969914, "mean_inference_ms": 0.461223732256821, "mean_action_processing_ms": 0.0981984174308716, "mean_env_wait_ms": 10.578561712578214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038968192206488717, "StateBufferConnector_ms": 0.0028689702351888022, "ViewRequirementAgentConnector_ms": 0.06884998745388454}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080, "num_agent_steps_trained": 1080, "num_env_steps_sampled": 1080, "num_env_steps_trained": 1080, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 36.881124150856955, "num_env_steps_trained_throughput_per_sec": 36.881124150856955, "timesteps_total": 1080, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 1080, "timers": {"training_iteration_time_ms": 3474.245, "sample_time_ms": 3384.485, "load_time_ms": 0.263, "load_throughput": 455948.497, "learn_time_ms": 88.376, "learn_throughput": 1357.839, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 1080, "num_env_steps_trained": 1080, "num_agent_steps_sampled": 1080, "num_agent_steps_trained": 1080}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-55", "timestamp": 1690302055, "time_this_iter_s": 3.2563059329986572, "time_total_s": 31.296095848083496, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 31.296095848083496, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.75, "ram_util_percent": 77.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.414131943384806, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.0017000000000000001, "total_loss": 2.698358694712321, "policy_loss": 0.7690425038337707, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.014511866588145494, "entropy": 27.150226593017578, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 285.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1200, "num_env_steps_trained": 1200, "num_agent_steps_sampled": 1200, "num_agent_steps_trained": 1200}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9386.732047378635, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.768066704919505, "mean_inference_ms": 0.4608080865537357, "mean_action_processing_ms": 0.09812973675966344, "mean_env_wait_ms": 10.055190048859682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150867462158203, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.06865501403808594}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9386.732047378635, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.768066704919505, "mean_inference_ms": 0.4608080865537357, "mean_action_processing_ms": 0.09812973675966344, "mean_env_wait_ms": 10.055190048859682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150867462158203, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.06865501403808594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200, "num_agent_steps_trained": 1200, "num_env_steps_sampled": 1200, "num_env_steps_trained": 1200, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 36.72399693434347, "num_env_steps_trained_throughput_per_sec": 36.72399693434347, "timesteps_total": 1200, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 1200, "timers": {"training_iteration_time_ms": 3453.581, "sample_time_ms": 3364.056, "load_time_ms": 0.258, "load_throughput": 464485.493, "learn_time_ms": 88.154, "learn_throughput": 1361.253, "synch_weights_time_ms": 0.884}, "counters": {"num_env_steps_sampled": 1200, "num_env_steps_trained": 1200, "num_agent_steps_sampled": 1200, "num_agent_steps_trained": 1200}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "2492c_00000", "date": "2023-07-25_19-20-58", "timestamp": 1690302058, "time_this_iter_s": 3.270217180252075, "time_total_s": 34.56631302833557, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 34.56631302833557, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.68, "ram_util_percent": 77.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.024535862604777, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.0016666666666666661, "total_loss": 2.652517477671305, "policy_loss": 0.7671582678953807, "vf_loss": 10.0, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.008779746420926434, "entropy": 27.198811594645182, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1320, "num_env_steps_trained": 1320, "num_agent_steps_sampled": 1320, "num_agent_steps_trained": 1320}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9445.71004436655, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.784602254878255, "mean_inference_ms": 0.4608814593902519, "mean_action_processing_ms": 0.09813854703203817, "mean_env_wait_ms": 9.60559444891441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004111636768687855, "StateBufferConnector_ms": 0.0028241764415394177, "ViewRequirementAgentConnector_ms": 0.06897449493408203}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9445.71004436655, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.784602254878255, "mean_inference_ms": 0.4608814593902519, "mean_action_processing_ms": 0.09813854703203817, "mean_env_wait_ms": 9.60559444891441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004111636768687855, "StateBufferConnector_ms": 0.0028241764415394177, "ViewRequirementAgentConnector_ms": 0.06897449493408203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320, "num_agent_steps_trained": 1320, "num_env_steps_sampled": 1320, "num_env_steps_trained": 1320, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 40.25484247979306, "num_env_steps_trained_throughput_per_sec": 40.25484247979306, "timesteps_total": 1320, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 1320, "timers": {"training_iteration_time_ms": 3145.001, "sample_time_ms": 3057.669, "load_time_ms": 0.224, "load_throughput": 535785.054, "learn_time_ms": 85.973, "learn_throughput": 1395.783, "synch_weights_time_ms": 0.906}, "counters": {"num_env_steps_sampled": 1320, "num_env_steps_trained": 1320, "num_agent_steps_sampled": 1320, "num_agent_steps_trained": 1320}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-01", "timestamp": 1690302061, "time_this_iter_s": 2.9838478565216064, "time_total_s": 37.55016088485718, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 37.55016088485718, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 36.599999999999994, "ram_util_percent": 77.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9499550382296245, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.0016333333333333334, "total_loss": 2.627734875679016, "policy_loss": 0.7735568145910899, "vf_loss": 10.0, "vf_explained_var": 1.8477439880371094e-06, "kl": 0.007257467799354345, "entropy": 27.276738993326823, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9565.806713073287, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.799526467256673, "mean_inference_ms": 0.46095951372008104, "mean_action_processing_ms": 0.09813882831089127, "mean_env_wait_ms": 9.216995444029378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004023313522338867, "StateBufferConnector_ms": 0.0028113524119059243, "ViewRequirementAgentConnector_ms": 0.06870428721110027}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9565.806713073287, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.799526467256673, "mean_inference_ms": 0.46095951372008104, "mean_action_processing_ms": 0.09813882831089127, "mean_env_wait_ms": 9.216995444029378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004023313522338867, "StateBufferConnector_ms": 0.0028113524119059243, "ViewRequirementAgentConnector_ms": 0.06870428721110027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.6863707094315, "num_env_steps_trained_throughput_per_sec": 37.6863707094315, "timesteps_total": 1440, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 1440, "timers": {"training_iteration_time_ms": 3154.684, "sample_time_ms": 3067.672, "load_time_ms": 0.222, "load_throughput": 540155.055, "learn_time_ms": 85.679, "learn_throughput": 1400.571, "synch_weights_time_ms": 0.89}, "counters": {"num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-04", "timestamp": 1690302064, "time_this_iter_s": 3.186833143234253, "time_total_s": 40.73699402809143, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 40.73699402809143, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.740000000000002, "ram_util_percent": 77.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.123959231376648, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.0015999999999999996, "total_loss": 2.5635958830515544, "policy_loss": 0.7436583360036214, "vf_loss": 10.0, "vf_explained_var": -1.430511474609375e-06, "kl": 0.012210530368611217, "entropy": 27.47550188700358, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1560, "num_env_steps_trained": 1560, "num_agent_steps_sampled": 1560, "num_agent_steps_trained": 1560}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9614.2006387096, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.816172827139983, "mean_inference_ms": 0.46090284730417125, "mean_action_processing_ms": 0.0981150817464182, "mean_env_wait_ms": 8.87827241905891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003998096172626202, "StateBufferConnector_ms": 0.0028280111459585335, "ViewRequirementAgentConnector_ms": 0.06884978367732121}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9614.2006387096, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.816172827139983, "mean_inference_ms": 0.46090284730417125, "mean_action_processing_ms": 0.0981150817464182, "mean_env_wait_ms": 8.87827241905891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003998096172626202, "StateBufferConnector_ms": 0.0028280111459585335, "ViewRequirementAgentConnector_ms": 0.06884978367732121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560, "num_agent_steps_trained": 1560, "num_env_steps_sampled": 1560, "num_env_steps_trained": 1560, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 36.78031311422591, "num_env_steps_trained_throughput_per_sec": 36.78031311422591, "timesteps_total": 1560, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 1560, "timers": {"training_iteration_time_ms": 3162.911, "sample_time_ms": 3076.387, "load_time_ms": 0.22, "load_throughput": 545955.613, "learn_time_ms": 85.201, "learn_throughput": 1408.435, "synch_weights_time_ms": 0.884}, "counters": {"num_env_steps_sampled": 1560, "num_env_steps_trained": 1560, "num_agent_steps_sampled": 1560, "num_agent_steps_trained": 1560}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-08", "timestamp": 1690302068, "time_this_iter_s": 3.2653110027313232, "time_total_s": 44.002305030822754, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 44.002305030822754, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 15.799999999999999, "ram_util_percent": 77.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.100878898302714, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.001566666666666667, "total_loss": 2.5393896818161013, "policy_loss": 0.7746242801348369, "vf_loss": 10.0, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.007621325540821999, "entropy": 27.58099784851074, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9755.10078126498, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.822459867903294, "mean_inference_ms": 0.46094893086969985, "mean_action_processing_ms": 0.09810843947214291, "mean_env_wait_ms": 8.578740568163594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039441244942801336, "StateBufferConnector_ms": 0.002815042223249163, "ViewRequirementAgentConnector_ms": 0.06869179861886161}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9755.10078126498, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.822459867903294, "mean_inference_ms": 0.46094893086969985, "mean_action_processing_ms": 0.09810843947214291, "mean_env_wait_ms": 8.578740568163594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039441244942801336, "StateBufferConnector_ms": 0.002815042223249163, "ViewRequirementAgentConnector_ms": 0.06869179861886161}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 40.3432518802522, "num_env_steps_trained_throughput_per_sec": 40.3432518802522, "timesteps_total": 1680, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 1680, "timers": {"training_iteration_time_ms": 3149.589, "sample_time_ms": 3063.108, "load_time_ms": 0.219, "load_throughput": 547440.157, "learn_time_ms": 85.155, "learn_throughput": 1409.191, "synch_weights_time_ms": 0.889}, "counters": {"num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-11", "timestamp": 1690302071, "time_this_iter_s": 2.9769692420959473, "time_total_s": 46.9792742729187, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 46.9792742729187, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.9, "ram_util_percent": 77.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.589662837982178, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.001533333333333333, "total_loss": 2.486673140525818, "policy_loss": 0.7913624028364817, "vf_loss": 10.0, "vf_explained_var": -3.5762786865234375e-07, "kl": 0.005920685267968414, "entropy": 27.7834566116333, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 435.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1800, "num_env_steps_trained": 1800, "num_agent_steps_sampled": 1800, "num_agent_steps_trained": 1800}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9851.962170281313, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.82983386979823, "mean_inference_ms": 0.4610254713960318, "mean_action_processing_ms": 0.09810327296120305, "mean_env_wait_ms": 8.311057942575893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038989384969075522, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06860097249348958}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9851.962170281313, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.82983386979823, "mean_inference_ms": 0.4610254713960318, "mean_action_processing_ms": 0.09810327296120305, "mean_env_wait_ms": 8.311057942575893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038989384969075522, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06860097249348958}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800, "num_agent_steps_trained": 1800, "num_env_steps_sampled": 1800, "num_env_steps_trained": 1800, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.731788767075265, "num_env_steps_trained_throughput_per_sec": 37.731788767075265, "timesteps_total": 1800, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 1800, "timers": {"training_iteration_time_ms": 3158.869, "sample_time_ms": 3072.851, "load_time_ms": 0.218, "load_throughput": 550734.741, "learn_time_ms": 84.696, "learn_throughput": 1416.831, "synch_weights_time_ms": 0.887}, "counters": {"num_env_steps_sampled": 1800, "num_env_steps_trained": 1800, "num_agent_steps_sampled": 1800, "num_agent_steps_trained": 1800}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-14", "timestamp": 1690302074, "time_this_iter_s": 3.183910846710205, "time_total_s": 50.163185119628906, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 50.163185119628906, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.925, "ram_util_percent": 77.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.080455629030864, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.0015000000000000005, "total_loss": 2.484649149576823, "policy_loss": 0.794625602165858, "vf_loss": 10.0, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.005373901699203998, "entropy": 27.79173838297526, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1920, "num_env_steps_trained": 1920, "num_agent_steps_sampled": 1920, "num_agent_steps_trained": 1920}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9986.003443834907, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.845934297258296, "mean_inference_ms": 0.4610216692322403, "mean_action_processing_ms": 0.09808561512922329, "mean_env_wait_ms": 8.07011894210431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003884732723236084, "StateBufferConnector_ms": 0.002796947956085205, "ViewRequirementAgentConnector_ms": 0.06875544786453247}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9986.003443834907, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.845934297258296, "mean_inference_ms": 0.4610216692322403, "mean_action_processing_ms": 0.09808561512922329, "mean_env_wait_ms": 8.07011894210431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003884732723236084, "StateBufferConnector_ms": 0.002796947956085205, "ViewRequirementAgentConnector_ms": 0.06875544786453247}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920, "num_agent_steps_trained": 1920, "num_env_steps_sampled": 1920, "num_env_steps_trained": 1920, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 35.05139530697171, "num_env_steps_trained_throughput_per_sec": 35.05139530697171, "timesteps_total": 1920, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 1920, "timers": {"training_iteration_time_ms": 3177.106, "sample_time_ms": 3091.185, "load_time_ms": 0.218, "load_throughput": 551156.899, "learn_time_ms": 84.604, "learn_throughput": 1418.376, "synch_weights_time_ms": 0.882}, "counters": {"num_env_steps_sampled": 1920, "num_env_steps_trained": 1920, "num_agent_steps_sampled": 1920, "num_agent_steps_trained": 1920}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-17", "timestamp": 1690302077, "time_this_iter_s": 3.4268181324005127, "time_total_s": 53.59000325202942, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 53.59000325202942, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 30.4, "ram_util_percent": 78.12}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.33979509671529, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.0014800000000000002, "total_loss": 2.455989782015483, "policy_loss": 0.7690449019273122, "vf_loss": 10.0, "vf_explained_var": 2.980232238769531e-07, "kl": 0.00801957914900413, "entropy": 27.847204462687174, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2040, "num_env_steps_trained": 2040, "num_agent_steps_sampled": 2040, "num_agent_steps_trained": 2040}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9998.80758259036, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.85552554276159, "mean_inference_ms": 0.4610477509825727, "mean_action_processing_ms": 0.09807196697862783, "mean_env_wait_ms": 7.851857729744042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038679908303653494, "StateBufferConnector_ms": 0.0028063269222483914, "ViewRequirementAgentConnector_ms": 0.06881461423986099}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -9998.80758259036, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.85552554276159, "mean_inference_ms": 0.4610477509825727, "mean_action_processing_ms": 0.09807196697862783, "mean_env_wait_ms": 7.851857729744042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038679908303653494, "StateBufferConnector_ms": 0.0028063269222483914, "ViewRequirementAgentConnector_ms": 0.06881461423986099}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040, "num_agent_steps_trained": 2040, "num_env_steps_sampled": 2040, "num_env_steps_trained": 2040, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 40.18478166797232, "num_env_steps_trained_throughput_per_sec": 40.18478166797232, "timesteps_total": 2040, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 2040, "timers": {"training_iteration_time_ms": 3151.32, "sample_time_ms": 3065.949, "load_time_ms": 0.217, "load_throughput": 554191.235, "learn_time_ms": 84.064, "learn_throughput": 1427.492, "synch_weights_time_ms": 0.875}, "counters": {"num_env_steps_sampled": 2040, "num_env_steps_trained": 2040, "num_agent_steps_sampled": 2040, "num_agent_steps_trained": 2040}, "done": false, "episodes_total": 17, "training_iteration": 17, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-20", "timestamp": 1690302080, "time_this_iter_s": 2.988805055618286, "time_total_s": 56.578808307647705, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 56.578808307647705, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 39.9, "ram_util_percent": 78.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8352452288071315, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.0014600000000000006, "total_loss": 2.4444042921066282, "policy_loss": 0.769975479443868, "vf_loss": 10.0, "vf_explained_var": 2.384185791015625e-07, "kl": 0.005488167220513181, "entropy": 27.84567330678304, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2160, "num_env_steps_trained": 2160, "num_agent_steps_sampled": 2160, "num_agent_steps_trained": 2160}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10060.18436709354, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.859470071175238, "mean_inference_ms": 0.46103356444038623, "mean_action_processing_ms": 0.09805302972666752, "mean_env_wait_ms": 7.652820323630577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038345654805501304, "StateBufferConnector_ms": 0.0028000937567816842, "ViewRequirementAgentConnector_ms": 0.06869104173448351}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10060.18436709354, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.859470071175238, "mean_inference_ms": 0.46103356444038623, "mean_action_processing_ms": 0.09805302972666752, "mean_env_wait_ms": 7.652820323630577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038345654805501304, "StateBufferConnector_ms": 0.0028000937567816842, "ViewRequirementAgentConnector_ms": 0.06869104173448351}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160, "num_agent_steps_trained": 2160, "num_env_steps_sampled": 2160, "num_env_steps_trained": 2160, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 40.76956617920023, "num_env_steps_trained_throughput_per_sec": 40.76956617920023, "timesteps_total": 2160, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 2160, "timers": {"training_iteration_time_ms": 3145.686, "sample_time_ms": 3060.716, "load_time_ms": 0.217, "load_throughput": 553338.259, "learn_time_ms": 83.668, "learn_throughput": 1434.232, "synch_weights_time_ms": 0.868}, "counters": {"num_env_steps_sampled": 2160, "num_env_steps_trained": 2160, "num_agent_steps_sampled": 2160, "num_agent_steps_trained": 2160}, "done": false, "episodes_total": 18, "training_iteration": 18, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-23", "timestamp": 1690302083, "time_this_iter_s": 2.945902109146118, "time_total_s": 59.52471041679382, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 59.52471041679382, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.859999999999996, "ram_util_percent": 77.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.285514752070109, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.0014399999999999994, "total_loss": 2.381657878557841, "policy_loss": 0.7583737293879191, "vf_loss": 10.0, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.005090736675386628, "entropy": 28.009364954630534, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2280, "num_env_steps_trained": 2280, "num_agent_steps_sampled": 2280, "num_agent_steps_trained": 2280}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10053.718347102133, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.861785434432544, "mean_inference_ms": 0.46099050760170374, "mean_action_processing_ms": 0.09803066344674749, "mean_env_wait_ms": 7.4706863399556225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003810932761744449, "StateBufferConnector_ms": 0.002804555391010485, "ViewRequirementAgentConnector_ms": 0.06873356668572676}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10053.718347102133, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.861785434432544, "mean_inference_ms": 0.46099050760170374, "mean_action_processing_ms": 0.09803066344674749, "mean_env_wait_ms": 7.4706863399556225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003810932761744449, "StateBufferConnector_ms": 0.002804555391010485, "ViewRequirementAgentConnector_ms": 0.06873356668572676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280, "num_agent_steps_trained": 2280, "num_env_steps_sampled": 2280, "num_env_steps_trained": 2280, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 39.068121146486455, "num_env_steps_trained_throughput_per_sec": 39.068121146486455, "timesteps_total": 2280, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 2280, "timers": {"training_iteration_time_ms": 3127.472, "sample_time_ms": 3042.55, "load_time_ms": 0.217, "load_throughput": 553642.592, "learn_time_ms": 83.624, "learn_throughput": 1434.997, "synch_weights_time_ms": 0.866}, "counters": {"num_env_steps_sampled": 2280, "num_env_steps_trained": 2280, "num_agent_steps_sampled": 2280, "num_agent_steps_trained": 2280}, "done": false, "episodes_total": 19, "training_iteration": 19, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-26", "timestamp": 1690302086, "time_this_iter_s": 3.0742249488830566, "time_total_s": 62.59893536567688, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 62.59893536567688, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.824999999999996, "ram_util_percent": 76.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9293971717357636, "cur_kl_coeff": 5.125781249999998, "cur_lr": 0.0014199999999999996, "total_loss": 2.395525558789571, "policy_loss": 0.7974426905314128, "vf_loss": 10.0, "vf_explained_var": -9.5367431640625e-07, "kl": 0.004737055942920658, "entropy": 28.087326304117838, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 2400, "num_agent_steps_trained": 2400}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10075.642010291089, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.861755322783786, "mean_inference_ms": 0.4611088334897466, "mean_action_processing_ms": 0.09803384530918413, "mean_env_wait_ms": 7.303774306945819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003851652145385742, "StateBufferConnector_ms": 0.002830028533935547, "ViewRequirementAgentConnector_ms": 0.06963253021240234}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10075.642010291089, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.861755322783786, "mean_inference_ms": 0.4611088334897466, "mean_action_processing_ms": 0.09803384530918413, "mean_env_wait_ms": 7.303774306945819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003851652145385742, "StateBufferConnector_ms": 0.002830028533935547, "ViewRequirementAgentConnector_ms": 0.06963253021240234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400, "num_agent_steps_trained": 2400, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 39.345025659418, "num_env_steps_trained_throughput_per_sec": 39.345025659418, "timesteps_total": 2400, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 2400, "timers": {"training_iteration_time_ms": 3105.704, "sample_time_ms": 3021.205, "load_time_ms": 0.216, "load_throughput": 554557.602, "learn_time_ms": 83.196, "learn_throughput": 1442.372, "synch_weights_time_ms": 0.868}, "counters": {"num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 2400, "num_agent_steps_trained": 2400}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-29", "timestamp": 1690302089, "time_this_iter_s": 3.052510976791382, "time_total_s": 65.65144634246826, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 65.65144634246826, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.724999999999998, "ram_util_percent": 78.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2389853835105895, "cur_kl_coeff": 2.562890624999999, "cur_lr": 0.0013999999999999996, "total_loss": 2.3584747393925984, "policy_loss": 0.7616796175638835, "vf_loss": 10.0, "vf_explained_var": -1.7881393432617188e-06, "kl": 0.024391383724287154, "entropy": 28.21905663808187, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2520, "num_env_steps_trained": 2520, "num_agent_steps_sampled": 2520, "num_agent_steps_trained": 2520}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10126.262036140075, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86152383822102, "mean_inference_ms": 0.4612106246586716, "mean_action_processing_ms": 0.09803649230650688, "mean_env_wait_ms": 7.149579590465924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038249152047293527, "StateBufferConnector_ms": 0.0028292338053385415, "ViewRequirementAgentConnector_ms": 0.06953194027855283}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10126.262036140075, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86152383822102, "mean_inference_ms": 0.4612106246586716, "mean_action_processing_ms": 0.09803649230650688, "mean_env_wait_ms": 7.149579590465924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038249152047293527, "StateBufferConnector_ms": 0.0028292338053385415, "ViewRequirementAgentConnector_ms": 0.06953194027855283}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520, "num_agent_steps_trained": 2520, "num_env_steps_sampled": 2520, "num_env_steps_trained": 2520, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 38.6753054311629, "num_env_steps_trained_throughput_per_sec": 38.6753054311629, "timesteps_total": 2520, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 2520, "timers": {"training_iteration_time_ms": 3117.879, "sample_time_ms": 3032.694, "load_time_ms": 0.217, "load_throughput": 552366.637, "learn_time_ms": 83.906, "learn_throughput": 1430.167, "synch_weights_time_ms": 0.847}, "counters": {"num_env_steps_sampled": 2520, "num_env_steps_trained": 2520, "num_agent_steps_sampled": 2520, "num_agent_steps_trained": 2520}, "done": false, "episodes_total": 21, "training_iteration": 21, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-33", "timestamp": 1690302093, "time_this_iter_s": 3.1056320667266846, "time_total_s": 68.75707840919495, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 68.75707840919495, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 34.14, "ram_util_percent": 79.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7795416474342347, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0013799999999999997, "total_loss": 2.3265109141667684, "policy_loss": 0.7769162893295288, "vf_loss": 10.0, "vf_explained_var": -3.5762786865234375e-07, "kl": 0.010268699212853486, "entropy": 28.29960479736328, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 645.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2640, "num_env_steps_trained": 2640, "num_agent_steps_sampled": 2640, "num_agent_steps_trained": 2640}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10122.741797724499, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.862795969532485, "mean_inference_ms": 0.4613309113633179, "mean_action_processing_ms": 0.09804193510584272, "mean_env_wait_ms": 7.006712307729754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003813613544810902, "StateBufferConnector_ms": 0.0028285113247958097, "ViewRequirementAgentConnector_ms": 0.06944916465065697}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10122.741797724499, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.862795969532485, "mean_inference_ms": 0.4613309113633179, "mean_action_processing_ms": 0.09804193510584272, "mean_env_wait_ms": 7.006712307729754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003813613544810902, "StateBufferConnector_ms": 0.0028285113247958097, "ViewRequirementAgentConnector_ms": 0.06944916465065697}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640, "num_agent_steps_trained": 2640, "num_env_steps_sampled": 2640, "num_env_steps_trained": 2640, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.50570838608527, "num_env_steps_trained_throughput_per_sec": 37.50570838608527, "timesteps_total": 2640, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 2640, "timers": {"training_iteration_time_ms": 3119.413, "sample_time_ms": 3034.35, "load_time_ms": 0.219, "load_throughput": 548872.933, "learn_time_ms": 83.782, "learn_throughput": 1432.295, "synch_weights_time_ms": 0.846}, "counters": {"num_env_steps_sampled": 2640, "num_env_steps_trained": 2640, "num_agent_steps_sampled": 2640, "num_agent_steps_trained": 2640}, "done": false, "episodes_total": 22, "training_iteration": 22, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-36", "timestamp": 1690302096, "time_this_iter_s": 3.2023112773895264, "time_total_s": 71.95938968658447, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 71.95938968658447, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.924999999999997, "ram_util_percent": 77.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.276814000805219, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0013599999999999999, "total_loss": 2.192940894762675, "policy_loss": 0.7241772731145223, "vf_loss": 10.0, "vf_explained_var": -8.344650268554688e-07, "kl": 0.014448225041754388, "entropy": 28.62259972890218, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2760, "num_env_steps_trained": 2760, "num_agent_steps_sampled": 2760, "num_agent_steps_trained": 2760}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10134.409386942769, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86403411464753, "mean_inference_ms": 0.4614117396212729, "mean_action_processing_ms": 0.09804263712683008, "mean_env_wait_ms": 6.8743564048925005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038105508555536685, "StateBufferConnector_ms": 0.0028330346812372622, "ViewRequirementAgentConnector_ms": 0.06942334382430367}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10134.409386942769, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86403411464753, "mean_inference_ms": 0.4614117396212729, "mean_action_processing_ms": 0.09804263712683008, "mean_env_wait_ms": 6.8743564048925005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038105508555536685, "StateBufferConnector_ms": 0.0028330346812372622, "ViewRequirementAgentConnector_ms": 0.06942334382430367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760, "num_agent_steps_trained": 2760, "num_env_steps_sampled": 2760, "num_env_steps_trained": 2760, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 38.09511584078231, "num_env_steps_trained_throughput_per_sec": 38.09511584078231, "timesteps_total": 2760, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 2760, "timers": {"training_iteration_time_ms": 3108.153, "sample_time_ms": 3022.65, "load_time_ms": 0.218, "load_throughput": 549472.14, "learn_time_ms": 84.217, "learn_throughput": 1424.887, "synch_weights_time_ms": 0.849}, "counters": {"num_env_steps_sampled": 2760, "num_env_steps_trained": 2760, "num_agent_steps_sampled": 2760, "num_agent_steps_trained": 2760}, "done": false, "episodes_total": 23, "training_iteration": 23, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-39", "timestamp": 1690302099, "time_this_iter_s": 3.152712821960449, "time_total_s": 75.11210250854492, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 75.11210250854492, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.54, "ram_util_percent": 77.47999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2856681903203326, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0013400000000000003, "total_loss": 2.205250954627991, "policy_loss": 0.7742257217566172, "vf_loss": 10.0, "vf_explained_var": -4.76837158203125e-07, "kl": 0.006343106304605802, "entropy": 28.64453125, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 705.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2880, "num_env_steps_trained": 2880, "num_agent_steps_sampled": 2880, "num_agent_steps_trained": 2880}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10167.869069597922, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86438429470732, "mean_inference_ms": 0.46144710558206187, "mean_action_processing_ms": 0.09803576628008574, "mean_env_wait_ms": 6.750848315771705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395973523457845, "StateBufferConnector_ms": 0.0028252601623535156, "ViewRequirementAgentConnector_ms": 0.06938278675079346}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10167.869069597922, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86438429470732, "mean_inference_ms": 0.46144710558206187, "mean_action_processing_ms": 0.09803576628008574, "mean_env_wait_ms": 6.750848315771705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395973523457845, "StateBufferConnector_ms": 0.0028252601623535156, "ViewRequirementAgentConnector_ms": 0.06938278675079346}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880, "num_agent_steps_trained": 2880, "num_env_steps_sampled": 2880, "num_env_steps_trained": 2880, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 39.31737031102201, "num_env_steps_trained_throughput_per_sec": 39.31737031102201, "timesteps_total": 2880, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 2880, "timers": {"training_iteration_time_ms": 3115.914, "sample_time_ms": 3030.338, "load_time_ms": 0.22, "load_throughput": 546489.121, "learn_time_ms": 84.286, "learn_throughput": 1423.722, "synch_weights_time_ms": 0.851}, "counters": {"num_env_steps_sampled": 2880, "num_env_steps_trained": 2880, "num_agent_steps_sampled": 2880, "num_agent_steps_trained": 2880}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-42", "timestamp": 1690302102, "time_this_iter_s": 3.0547940731048584, "time_total_s": 78.16689658164978, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 78.16689658164978, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.799999999999997, "ram_util_percent": 78.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.221551692485809, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0013200000000000004, "total_loss": 2.181014625231425, "policy_loss": 0.7790886501471201, "vf_loss": 10.0, "vf_explained_var": -9.5367431640625e-07, "kl": 0.013341900311449233, "entropy": 28.831214396158853, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 735.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 3000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 3000}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10177.724690109062, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.866143404696995, "mean_inference_ms": 0.461447684677403, "mean_action_processing_ms": 0.09802369802017016, "mean_env_wait_ms": 6.635759689305465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931999206542969, "StateBufferConnector_ms": 0.0028209686279296875, "ViewRequirementAgentConnector_ms": 0.06925010681152344}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10177.724690109062, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.866143404696995, "mean_inference_ms": 0.461447684677403, "mean_action_processing_ms": 0.09802369802017016, "mean_env_wait_ms": 6.635759689305465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931999206542969, "StateBufferConnector_ms": 0.0028209686279296875, "ViewRequirementAgentConnector_ms": 0.06925010681152344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 3000, "num_env_steps_sampled": 3000, "num_env_steps_trained": 3000, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 36.977715502934096, "num_env_steps_trained_throughput_per_sec": 36.977715502934096, "timesteps_total": 3000, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 3122.399, "sample_time_ms": 3036.75, "load_time_ms": 0.222, "load_throughput": 541025.992, "learn_time_ms": 84.349, "learn_throughput": 1422.66, "synch_weights_time_ms": 0.859}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 3000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 3000}, "done": false, "episodes_total": 25, "training_iteration": 25, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-45", "timestamp": 1690302105, "time_this_iter_s": 3.2479889392852783, "time_total_s": 81.41488552093506, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.41488552093506, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 22.3, "ram_util_percent": 78.24000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.331663195292155, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0013000000000000004, "total_loss": 2.152406271298726, "policy_loss": 0.7544749975204468, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.011610809191673373, "entropy": 28.82234764099121, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 765.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3120, "num_env_steps_trained": 3120, "num_agent_steps_sampled": 3120, "num_agent_steps_trained": 3120}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10164.402300604186, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86831300370939, "mean_inference_ms": 0.46141984493156074, "mean_action_processing_ms": 0.09800772436339576, "mean_env_wait_ms": 6.52830831221422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003907313713660607, "StateBufferConnector_ms": 0.0028142562279334436, "ViewRequirementAgentConnector_ms": 0.06918632067166842}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10164.402300604186, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86831300370939, "mean_inference_ms": 0.46141984493156074, "mean_action_processing_ms": 0.09800772436339576, "mean_env_wait_ms": 6.52830831221422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003907313713660607, "StateBufferConnector_ms": 0.0028142562279334436, "ViewRequirementAgentConnector_ms": 0.06918632067166842}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120, "num_agent_steps_trained": 3120, "num_env_steps_sampled": 3120, "num_env_steps_trained": 3120, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.56166015161488, "num_env_steps_trained_throughput_per_sec": 37.56166015161488, "timesteps_total": 3120, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 3120, "timers": {"training_iteration_time_ms": 3099.519, "sample_time_ms": 3013.68, "load_time_ms": 0.221, "load_throughput": 542308.458, "learn_time_ms": 84.512, "learn_throughput": 1419.918, "synch_weights_time_ms": 0.878}, "counters": {"num_env_steps_sampled": 3120, "num_env_steps_trained": 3120, "num_agent_steps_sampled": 3120, "num_agent_steps_trained": 3120}, "done": false, "episodes_total": 26, "training_iteration": 26, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-49", "timestamp": 1690302109, "time_this_iter_s": 3.1993510723114014, "time_total_s": 84.61423659324646, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 84.61423659324646, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.0, "ram_util_percent": 78.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.423927664756775, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0012800000000000005, "total_loss": 2.1179484764734906, "policy_loss": 0.7773920853932699, "vf_loss": 10.0, "vf_explained_var": -4.76837158203125e-07, "kl": 0.009725932128882656, "entropy": 28.989443270365395, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 795.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10214.07075956869, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86937362781559, "mean_inference_ms": 0.4613842074386626, "mean_action_processing_ms": 0.09799099702559343, "mean_env_wait_ms": 6.427225082019401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003887988902904369, "StateBufferConnector_ms": 0.0028098071063006364, "ViewRequirementAgentConnector_ms": 0.06914580309832538}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10214.07075956869, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.86937362781559, "mean_inference_ms": 0.4613842074386626, "mean_action_processing_ms": 0.09799099702559343, "mean_env_wait_ms": 6.427225082019401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003887988902904369, "StateBufferConnector_ms": 0.0028098071063006364, "ViewRequirementAgentConnector_ms": 0.06914580309832538}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240, "num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 39.64267469418328, "num_env_steps_trained_throughput_per_sec": 39.64267469418328, "timesteps_total": 3240, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 3240, "timers": {"training_iteration_time_ms": 3103.602, "sample_time_ms": 3017.687, "load_time_ms": 0.231, "load_throughput": 519097.03, "learn_time_ms": 84.518, "learn_throughput": 1419.809, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240}, "done": false, "episodes_total": 27, "training_iteration": 27, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-52", "timestamp": 1690302112, "time_this_iter_s": 3.030179977416992, "time_total_s": 87.64441657066345, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 87.64441657066345, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 36.739999999999995, "ram_util_percent": 78.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.133713165918986, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0012599999999999994, "total_loss": 2.077862437566121, "policy_loss": 0.7847632090250651, "vf_loss": 10.0, "vf_explained_var": 2.384185791015625e-07, "kl": 0.009123653303443764, "entropy": 29.13991552988688, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10217.92288554897, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.8700901677175, "mean_inference_ms": 0.4613340731309253, "mean_action_processing_ms": 0.09797242793162031, "mean_env_wait_ms": 6.332348798376167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038794108799525668, "StateBufferConnector_ms": 0.002810784748622349, "ViewRequirementAgentConnector_ms": 0.06932786532810756}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10217.92288554897, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.8700901677175, "mean_inference_ms": 0.4613340731309253, "mean_action_processing_ms": 0.09797242793162031, "mean_env_wait_ms": 6.332348798376167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038794108799525668, "StateBufferConnector_ms": 0.002810784748622349, "ViewRequirementAgentConnector_ms": 0.06932786532810756}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 38.525485883240755, "num_env_steps_trained_throughput_per_sec": 38.525485883240755, "timesteps_total": 3360, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 3360, "timers": {"training_iteration_time_ms": 3120.747, "sample_time_ms": 3034.89, "load_time_ms": 0.236, "load_throughput": 509429.636, "learn_time_ms": 84.453, "learn_throughput": 1420.914, "synch_weights_time_ms": 0.917}, "counters": {"num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-55", "timestamp": 1690302115, "time_this_iter_s": 3.1175589561462402, "time_total_s": 90.76197552680969, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 90.76197552680969, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.175, "ram_util_percent": 77.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.893782751758893, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0012399999999999993, "total_loss": 2.0151812076568603, "policy_loss": 0.7585775415102641, "vf_loss": 10.0, "vf_explained_var": -2.0265579223632812e-06, "kl": 0.013237866541991631, "entropy": 29.314289347330728, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3480, "num_env_steps_trained": 3480, "num_agent_steps_sampled": 3480, "num_agent_steps_trained": 3480}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10229.891555831475, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.87155421867449, "mean_inference_ms": 0.46127414979487585, "mean_action_processing_ms": 0.09795209326939017, "mean_env_wait_ms": 6.2432462648581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039676140094625535, "StateBufferConnector_ms": 0.002812517100367053, "ViewRequirementAgentConnector_ms": 0.06924251030231345}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10229.891555831475, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.87155421867449, "mean_inference_ms": 0.46127414979487585, "mean_action_processing_ms": 0.09795209326939017, "mean_env_wait_ms": 6.2432462648581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039676140094625535, "StateBufferConnector_ms": 0.002812517100367053, "ViewRequirementAgentConnector_ms": 0.06924251030231345}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480, "num_agent_steps_trained": 3480, "num_env_steps_sampled": 3480, "num_env_steps_trained": 3480, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.04806175348263, "num_env_steps_trained_throughput_per_sec": 37.04806175348263, "timesteps_total": 3480, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 3480, "timers": {"training_iteration_time_ms": 3137.494, "sample_time_ms": 3051.572, "load_time_ms": 0.237, "load_throughput": 506456.51, "learn_time_ms": 84.485, "learn_throughput": 1420.366, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 3480, "num_env_steps_trained": 3480, "num_agent_steps_sampled": 3480, "num_agent_steps_trained": 3480}, "done": false, "episodes_total": 29, "training_iteration": 29, "trial_id": "2492c_00000", "date": "2023-07-25_19-21-58", "timestamp": 1690302118, "time_this_iter_s": 3.242111921310425, "time_total_s": 94.00408744812012, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 94.00408744812012, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 26.7, "ram_util_percent": 77.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.928574748833974, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0012199999999999997, "total_loss": 1.9627750436464946, "policy_loss": 0.7686951458454132, "vf_loss": 10.0, "vf_explained_var": -2.0265579223632812e-06, "kl": 0.014382037630033059, "entropy": 29.537363306681314, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 885.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3600, "num_env_steps_trained": 3600, "num_agent_steps_sampled": 3600, "num_agent_steps_trained": 3600}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10252.310393569946, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.87164147464058, "mean_inference_ms": 0.46123646106413213, "mean_action_processing_ms": 0.09793569346845042, "mean_env_wait_ms": 6.159159569584476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003950595855712891, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.0691684087117513}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10252.310393569946, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.87164147464058, "mean_inference_ms": 0.46123646106413213, "mean_action_processing_ms": 0.09793569346845042, "mean_env_wait_ms": 6.159159569584476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003950595855712891, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.0691684087117513}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600, "num_agent_steps_trained": 3600, "num_env_steps_sampled": 3600, "num_env_steps_trained": 3600, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 39.985722235838125, "num_env_steps_trained_throughput_per_sec": 39.985722235838125, "timesteps_total": 3600, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 3600, "timers": {"training_iteration_time_ms": 3132.607, "sample_time_ms": 3046.39, "load_time_ms": 0.237, "load_throughput": 505845.709, "learn_time_ms": 84.779, "learn_throughput": 1415.452, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 3600, "num_env_steps_trained": 3600, "num_agent_steps_sampled": 3600, "num_agent_steps_trained": 3600}, "done": false, "episodes_total": 30, "training_iteration": 30, "trial_id": "2492c_00000", "date": "2023-07-25_19-22-01", "timestamp": 1690302121, "time_this_iter_s": 3.0037178993225098, "time_total_s": 97.00780534744263, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 97.00780534744263, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 33.974999999999994, "ram_util_percent": 77.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.15082973142465, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0012, "total_loss": 1.879574759801229, "policy_loss": 0.732520341873169, "vf_loss": 10.0, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.016001199855236337, "entropy": 29.714864031473795, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 915.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3720, "num_env_steps_trained": 3720, "num_agent_steps_sampled": 3720, "num_agent_steps_trained": 3720}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10263.721529672106, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.871713948553335, "mean_inference_ms": 0.4612032525709602, "mean_action_processing_ms": 0.09792031601542682, "mean_env_wait_ms": 6.079885907038527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00392698472545993, "StateBufferConnector_ms": 0.0028064174036825855, "ViewRequirementAgentConnector_ms": 0.06910139514553931}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10263.721529672106, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.871713948553335, "mean_inference_ms": 0.4612032525709602, "mean_action_processing_ms": 0.09792031601542682, "mean_env_wait_ms": 6.079885907038527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00392698472545993, "StateBufferConnector_ms": 0.0028064174036825855, "ViewRequirementAgentConnector_ms": 0.06910139514553931}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3720, "num_agent_steps_trained": 3720, "num_env_steps_sampled": 3720, "num_env_steps_trained": 3720, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.9520212578651, "num_env_steps_trained_throughput_per_sec": 37.9520212578651, "timesteps_total": 3720, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 3720, "timers": {"training_iteration_time_ms": 3138.52, "sample_time_ms": 3052.347, "load_time_ms": 0.236, "load_throughput": 507733.764, "learn_time_ms": 84.736, "learn_throughput": 1416.169, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 3720, "num_env_steps_trained": 3720, "num_agent_steps_sampled": 3720, "num_agent_steps_trained": 3720}, "done": false, "episodes_total": 31, "training_iteration": 31, "trial_id": "2492c_00000", "date": "2023-07-25_19-22-04", "timestamp": 1690302124, "time_this_iter_s": 3.16461181640625, "time_total_s": 100.17241716384888, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 100.17241716384888, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 27.259999999999998, "ram_util_percent": 78.44000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.469478805859883, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0011866666666666668, "total_loss": 1.8254709521929422, "policy_loss": 0.7552606443564097, "vf_loss": 10.0, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.007711909007048235, "entropy": 29.864788818359376, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3840, "num_env_steps_trained": 3840, "num_agent_steps_sampled": 3840, "num_agent_steps_trained": 3840}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10231.992193337668, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.87250754099818, "mean_inference_ms": 0.46117579006955794, "mean_action_processing_ms": 0.09790635216394544, "mean_env_wait_ms": 6.004948423928825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003917515277862549, "StateBufferConnector_ms": 0.002794712781906128, "ViewRequirementAgentConnector_ms": 0.06905198097229004}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10231.992193337668, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.87250754099818, "mean_inference_ms": 0.46117579006955794, "mean_action_processing_ms": 0.09790635216394544, "mean_env_wait_ms": 6.004948423928825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003917515277862549, "StateBufferConnector_ms": 0.002794712781906128, "ViewRequirementAgentConnector_ms": 0.06905198097229004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840, "num_agent_steps_trained": 3840, "num_env_steps_sampled": 3840, "num_env_steps_trained": 3840, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.0119284370256, "num_env_steps_trained_throughput_per_sec": 37.0119284370256, "timesteps_total": 3840, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 3840, "timers": {"training_iteration_time_ms": 3142.788, "sample_time_ms": 3056.357, "load_time_ms": 0.237, "load_throughput": 507068.789, "learn_time_ms": 84.99, "learn_throughput": 1411.934, "synch_weights_time_ms": 0.948}, "counters": {"num_env_steps_sampled": 3840, "num_env_steps_trained": 3840, "num_agent_steps_sampled": 3840, "num_agent_steps_trained": 3840}, "done": false, "episodes_total": 32, "training_iteration": 32, "trial_id": "2492c_00000", "date": "2023-07-25_19-22-07", "timestamp": 1690302127, "time_this_iter_s": 3.244969129562378, "time_total_s": 103.41738629341125, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 103.41738629341125, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 16.450000000000003, "ram_util_percent": 77.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8730570157368978, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0011733333333333329, "total_loss": 1.815770395596822, "policy_loss": 0.7289213756720225, "vf_loss": 10.0, "vf_explained_var": -8.344650268554688e-07, "kl": 0.010284178315972288, "entropy": 29.842287826538087, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 975.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3960, "num_env_steps_trained": 3960, "num_agent_steps_sampled": 3960, "num_agent_steps_trained": 3960}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10260.585030406039, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097, -11175.555816593844], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.872125019218732, "mean_inference_ms": 0.4611259575222507, "mean_action_processing_ms": 0.09788997878339123, "mean_env_wait_ms": 5.933772991175815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039050073334665008, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.06898605462276575}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10260.585030406039, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097, -11175.555816593844], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.872125019218732, "mean_inference_ms": 0.4611259575222507, "mean_action_processing_ms": 0.09788997878339123, "mean_env_wait_ms": 5.933772991175815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039050073334665008, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.06898605462276575}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3960, "num_agent_steps_trained": 3960, "num_env_steps_sampled": 3960, "num_env_steps_trained": 3960, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 40.38898624476256, "num_env_steps_trained_throughput_per_sec": 40.38898624476256, "timesteps_total": 3960, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 3960, "timers": {"training_iteration_time_ms": 3124.898, "sample_time_ms": 3039.051, "load_time_ms": 0.237, "load_throughput": 506405.554, "learn_time_ms": 84.406, "learn_throughput": 1421.705, "synch_weights_time_ms": 0.947}, "counters": {"num_env_steps_sampled": 3960, "num_env_steps_trained": 3960, "num_agent_steps_sampled": 3960, "num_agent_steps_trained": 3960}, "done": false, "episodes_total": 33, "training_iteration": 33, "trial_id": "2492c_00000", "date": "2023-07-25_19-22-10", "timestamp": 1690302130, "time_this_iter_s": 2.9740591049194336, "time_total_s": 106.39144539833069, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 106.39144539833069, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.179999999999996, "ram_util_percent": 77.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.017816853523255, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0011600000000000002, "total_loss": 1.7711615204811095, "policy_loss": 0.7371229648590087, "vf_loss": 10.0, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.013709312119196208, "entropy": 30.06221408843994, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1005.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4080, "num_env_steps_trained": 4080, "num_agent_steps_sampled": 4080, "num_agent_steps_trained": 4080}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10269.538484902101, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097, -11175.555816593844, -10565.00248327219], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.872232711746154, "mean_inference_ms": 0.4610715788777806, "mean_action_processing_ms": 0.09787322668825277, "mean_env_wait_ms": 5.866020803694391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003889027763815487, "StateBufferConnector_ms": 0.0027908998377182905, "ViewRequirementAgentConnector_ms": 0.06888333488913144}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10269.538484902101, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097, -11175.555816593844, -10565.00248327219], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.872232711746154, "mean_inference_ms": 0.4610715788777806, "mean_action_processing_ms": 0.09787322668825277, "mean_env_wait_ms": 5.866020803694391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003889027763815487, "StateBufferConnector_ms": 0.0027908998377182905, "ViewRequirementAgentConnector_ms": 0.06888333488913144}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4080, "num_agent_steps_trained": 4080, "num_env_steps_sampled": 4080, "num_env_steps_trained": 4080, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.7768570924196, "num_env_steps_trained_throughput_per_sec": 37.7768570924196, "timesteps_total": 4080, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 4080, "timers": {"training_iteration_time_ms": 3137.345, "sample_time_ms": 3051.534, "load_time_ms": 0.237, "load_throughput": 505337.831, "learn_time_ms": 84.361, "learn_throughput": 1422.465, "synch_weights_time_ms": 0.955}, "counters": {"num_env_steps_sampled": 4080, "num_env_steps_trained": 4080, "num_agent_steps_sampled": 4080, "num_agent_steps_trained": 4080}, "done": false, "episodes_total": 34, "training_iteration": 34, "trial_id": "2492c_00000", "date": "2023-07-25_19-22-14", "timestamp": 1690302134, "time_this_iter_s": 3.179517984390259, "time_total_s": 109.57096338272095, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 109.57096338272095, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 27.075000000000003, "ram_util_percent": 77.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.999880473812421, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0011466666666666665, "total_loss": 1.757922903696696, "policy_loss": 0.7606332182884217, "vf_loss": 10.0, "vf_explained_var": -1.430511474609375e-06, "kl": 0.012227455369429662, "entropy": 30.16572157541911, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1035.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10294.502149544604, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097, -11175.555816593844, -10565.00248327219, -11143.26674738967], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.872898164405495, "mean_inference_ms": 0.4610072240739275, "mean_action_processing_ms": 0.09785516342138974, "mean_env_wait_ms": 5.801544927134609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038725989205496652, "StateBufferConnector_ms": 0.0027826854160853793, "ViewRequirementAgentConnector_ms": 0.06880419594900948}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10294.502149544604, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097, -11175.555816593844, -10565.00248327219, -11143.26674738967], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.872898164405495, "mean_inference_ms": 0.4610072240739275, "mean_action_processing_ms": 0.09785516342138974, "mean_env_wait_ms": 5.801544927134609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038725989205496652, "StateBufferConnector_ms": 0.0027826854160853793, "ViewRequirementAgentConnector_ms": 0.06880419594900948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200, "num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 37.37262907280006, "num_env_steps_trained_throughput_per_sec": 37.37262907280006, "timesteps_total": 4200, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 4200, "timers": {"training_iteration_time_ms": 3133.916, "sample_time_ms": 3047.96, "load_time_ms": 0.236, "load_throughput": 508811.646, "learn_time_ms": 84.512, "learn_throughput": 1419.908, "synch_weights_time_ms": 0.949}, "counters": {"num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200}, "done": false, "episodes_total": 35, "training_iteration": 35, "trial_id": "2492c_00000", "date": "2023-07-25_19-22-17", "timestamp": 1690302137, "time_this_iter_s": 3.2136528491973877, "time_total_s": 112.78461623191833, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 112.78461623191833, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 22.2, "ram_util_percent": 78.02000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.215893721580505, "cur_kl_coeff": 3.8443359375000012, "cur_lr": 0.0011333333333333332, "total_loss": 1.6900486429532369, "policy_loss": 0.7464441080888112, "vf_loss": 10.0, "vf_explained_var": 5.960464477539063e-08, "kl": 0.009146801502599071, "entropy": 30.305194854736328, "entropy_coeff": 0.30000000000000004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1065.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4320, "num_env_steps_trained": 4320, "num_agent_steps_sampled": 4320, "num_agent_steps_trained": 4320}, "sampler_results": {"episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10309.660671085638, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097, -11175.555816593844, -10565.00248327219, -11143.26674738967, -10840.208925021874], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.873122951886334, "mean_inference_ms": 0.46093326918849786, "mean_action_processing_ms": 0.09783572953178252, "mean_env_wait_ms": 5.74023114593952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038597318861219618, "StateBufferConnector_ms": 0.0027749273512098524, "ViewRequirementAgentConnector_ms": 0.06885064972771539}}, "episode_reward_max": -3701.422946165961, "episode_reward_min": -12023.30167856081, "episode_reward_mean": -10309.660671085638, "episode_len_mean": 120.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3701.422946165961, -4356.1733646595885, -9741.433348946648, -10210.581128632315, -10729.562351905548, -12023.30167856081, -10416.369966889772, -10346.804180291385, -10612.882375624758, -11728.789132109572, -10035.490014245703, -10886.870068847398, -10194.927746345367, -11586.802634484948, -11208.021616509966, -11996.622547138779, -10203.67380267761, -11103.589703647598, -9937.329987256828, -10492.191610881275, -11138.662553119795, -10048.816790997402, -10391.096349744708, -10937.441770666368, -10414.25958237646, -9831.342562982283, -11505.450692645818, -10321.930287016476, -10565.014323741607, -10902.456687985637, -10606.05561273689, -9248.382766970097, -11175.555816593844, -10565.00248327219, -11143.26674738967, -10840.208925021874], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.873122951886334, "mean_inference_ms": 0.46093326918849786, "mean_action_processing_ms": 0.09783572953178252, "mean_env_wait_ms": 5.74023114593952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038597318861219618, "StateBufferConnector_ms": 0.0027749273512098524, "ViewRequirementAgentConnector_ms": 0.06885064972771539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320, "num_agent_steps_trained": 4320, "num_env_steps_sampled": 4320, "num_env_steps_trained": 4320, "num_env_steps_sampled_this_iter": 120, "num_env_steps_trained_this_iter": 120, "num_env_steps_sampled_throughput_per_sec": 38.89383166191154, "num_env_steps_trained_throughput_per_sec": 38.89383166191154, "timesteps_total": 4320, "num_steps_trained_this_iter": 120, "agent_timesteps_total": 4320, "timers": {"training_iteration_time_ms": 3122.974, "sample_time_ms": 3037.266, "load_time_ms": 0.236, "load_throughput": 507989.988, "learn_time_ms": 84.303, "learn_throughput": 1423.442, "synch_weights_time_ms": 0.919}, "counters": {"num_env_steps_sampled": 4320, "num_env_steps_trained": 4320, "num_agent_steps_sampled": 4320, "num_agent_steps_trained": 4320}, "done": false, "episodes_total": 36, "training_iteration": 36, "trial_id": "2492c_00000", "date": "2023-07-25_19-22-20", "timestamp": 1690302140, "time_this_iter_s": 3.0880181789398193, "time_total_s": 115.87263441085815, "pid": 78734, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": [[0, 0.002], [1800, 0.0015], [3600, 0.0012], [5400, 0.001], [7200, 0.0008], [9000, 0.0005], [10800, 0.00025], [12600, 0.00012], [14400, 0.0001], [16200, 8e-05], [18000, 7.5e-05], [19800, 5e-06], [21600, 2.5e-06], [23400, 1e-06], [25200, 1e-06], [27000, 5e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f73a280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 115.87263441085815, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 32.25, "ram_util_percent": 78.275}}
